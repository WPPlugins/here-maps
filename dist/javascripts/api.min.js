// Source: ./source/javascripts/api/mapsjs-core.js
(function(){var p,aa=this;
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}function ca(a){return"string"==typeof a}function da(a){return"function"==ba(a)}function ea(a){return a[fa]||(a[fa]=++ha)}var fa="closure_uid_"+(1E9*Math.random()>>>0),ha=0;function ia(a,b,c){return a.call.apply(a.bind,arguments)}
function ja(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ka(a,b,c){ka=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ja;return ka.apply(null,arguments)}
function q(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function r(a,b){function c(){}c.prototype=b.prototype;a.a=b.prototype;a.prototype=new c;a.prototype.constructor=a};function la(a){var b=ma,c;for(c in b)a.call(void 0,b[c],c,b)}var na="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function oa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<na.length;f++)c=na[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var pa=function(){return this}();q("H.lang.inherits",r);var t=ka;q("H.lang.bind",t);var qa=String;function ra(a){return eval(""+a)}var u=ra(),sa=ra(null);function ta(a,b){return qa(a).split(b!==u?b:" ")}q("H.lang.tokenize",ta);var ua="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(a,b,c,d){if(!(b=a instanceof b)&&c)throw new x(c,d,void 0!==u?void 0:a);return b}function va(a,b){return v(a,b)&&a.constructor===b}
function wa(a,b){if(!0===va(a,b))throw new TypeError("Illegal constructor "+xa(b));}function ya(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function za(a){var b=ba(a);return"array"==b||"object"==b&&"number"==typeof a.length}function Aa(a,b,c,d,e){if(!(b=Ba(a)===b)&&c)throw new x(c,d,e!==u?e:a);return b}var y=isNaN;function Ca(a){return!y(+a)}function Ba(a){var b=Object[ua[0]][ua[6]].call(a).match(/^\[object (\w+)\]$/);return b?b[1]:typeof a}
function xa(a,b,c,d){var e="",f=2>arguments.length;f&&(b={H:pa.H},c="",d=[]);Da(b,!0,function(b,f){var k=b[f];f=Ea(b,k);var l;if(l=!(ya(k)&&k.window===k&&k.self===k))l=!(ya(k)&&0<k.nodeType&&da(k.cloneNode));if(l&&ya(k)){if(k===a)return e=c+"."+f,!0;if(0>d.indexOf(k)&&(d.push(k),e=xa(a,k,c+"."+f,d)))return!0}});f&&(e=e?e.substr(1).replace("."+ua[0]+".","#"):"~"+(da(a)?Fa(a)+"()":Ba(a)));return e}function Ea(a,b){var c=[];Da(a,!1,function(a,e){a[e]===b&&c.push(e)});return c.sort(Ga)[0]}
function Ga(a,b){return b.length-a.length}function Da(a,b,c){var d,e;if(a){for(d in a)if((!b||a[ua[2]](d))&&c(a,d,!0))return;for(e=ua.length;e--&&(d=ua[e],b&&!a[ua[2]](d)||!c(a,d,!1)););}}q("H.lang.forEachProp",Da);function Fa(a){return(a=/function ([^\( ]+)/.exec(a))?a[1]:"anonymous"}function Ha(a,b,c){c[b]="#"+b};function x(a,b,c){var d=arguments.length,e;b=1<d?+b:b;d=2<d?qa(c):"";b!==u&&(e=(e=/.*\(([^\)]+)/.exec((""+a).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?ta(e[1].replace(/\s+/g,""),","):[],e.forEach(Ha),e=e[b]||"#"+b);this.message=(a?xa(a):"")+(e||d?" (":"")+(e?"Argument "+e:"")+(d?(e?" ":"")+d:"")+(e||d?")":"")}q("H.lang.InvalidArgumentError",x);x.prototype=Error();x.prototype.name="InvalidArgumentError";var Ia=Math,Ka=Ia.random,La=Ia.min,Ma=Ia.max,Na=Ia.round,Oa=Ia.floor,Pa=Ia.ceil,Qa=Ia.abs,Ra=Ia.log,Sa=Ia.sqrt,Ta=Ia.pow,Ua=Ia.exp,Va=Ia.sin,Wa=Ia.asin,Xa=Ia.cos,Ya=Ia.tan,Za=Ia.atan,$a=Ia.atan2,ab=Ia.LN2,bb=Ia.PI,cb=bb/2,db=bb/4,eb=2*bb,fb=3*bb,gb=bb/180,hb=180/bb,ib=Ta(-2,53);function jb(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}function kb(a,b,c){return(a-=0)>c?c:a<b?b:a}function lb(a,b,c,d){(d-=0)||(d=0);return b<c?a>=b-d&&a<=c+d:a>=c-d&&a<=b+d}
function nb(a,b,c,d,e,f){return Sa(Ta((a-e)*(d-f)-(b-f)*(c-e),2)/(Ta(c-e,2)+Ta(d-f,2)))}
function ob(a,b,c,d,e){for(var f=c.length,g=f,h,k,l,m=c[0],n=0,w=0,z=0,s=d/2||0,C=e?1:3;1!=n&&g>C;){h=c[--g];d=c[--g];l=c[g?g-1:(f+(g-1))%f];k=c[g?g-2:(f+(g-2))%f];if(d>=a-s&&d<=a+s&&h>=b-s&&h<=b+s||k>=a-s&&k<=a+s&&l>=b-s&&l<=b+s)n=1;else if(!n&&d===a)k===a&&(h<b&&l>b||h>b&&l<b)||(m<=a&&k>a||m>=a&&k<a)&&(h>=b?++w:++z),n=lb(b,h,l,s)&&nb(a,b,d,h,k,l)<=s?2:0;else if(!n&&lb(a,d,k,s)){if(d<a&&k>a||d>a&&k<a)m=h+(a-d)/(k-d)*(l-h),w+=m>b,z+=m<b;n=lb(b,h,l,s)&&nb(a,b,d,h,k,l)<=s?2:0}m=d}return e&&3===n&&n||
n?n:e&&0!==z&&0!==w%2?3:0};var pb={undefined:"GL",GL:"GL",OL:"OL",SL:"SL",SB:"SB",WE:"WE",WG:"WG"};q("H.geo.AltitudeContext",pb);function qb(a,b,c){var d=kb(+a,-90,90);if(b&&y(d))throw new x(b,c,a);return d}function rb(a,b,c){var d=+a;if(-180>d||180<d)d=jb(d+180,360)-180;if(b&&y(d))throw new x(b,c,a);return d}function sb(a,b,c){var d;if(a!==u&&y(d=+a)&&b)throw new x(b,c,a);return d}function tb(a,b,c){var d=!pb[a];if(b&&d)throw new x(b,c,a);return!d}function ub(a){return!a||y(a.lat)||y(a.lng)?!1:!0};function A(a,b,c,d){this.lat=qb(a,A,0);this.lng=rb(b,A,1);c!==u&&(this.alt=sb(c,A,2));d!==u&&tb(d,A,3)&&(this.ctx=d)}q("H.geo.Point",A);A.prototype.M=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&pb[this.ctx]===pb[a.ctx]&&(this.alt||0)===(a.alt||0)};A.prototype.equals=A.prototype.M;
A.prototype.distance=function(a){var b,c;this===a||this.lat===a.lat&&this.lng===a.lng?a=0:(b=this.lat*gb,c=a.lat*gb,a=1.274200158E7*Wa(La(1,Sa(Ta(Va((b-c)/2),2)+Xa(b)*Xa(c)*Ta(Va((this.lng*gb-a.lng*gb)/2),2)))));return a};A.prototype.distance=A.prototype.distance;
A.prototype.tf=function(a,b,c){var d,e,f,g,h,k;if(c){if(b/=6371000.79){a*=gb;d=gb*this.lat;f=Va(d);g=Va(b);h=Xa(b);e=gb*this.lng;var l=Xa(d);d=Wa(l*Xa(a)*g+f*h);a=$a(Va(a)*l*g,h-f*Va(d));l=((e+a+bb)%(2*bb)-bb)*hb}return b?new A(d*hb,(l+540)%360-180):this}a=(a%360+360)%360;if(0===(a+90)%180)return d=this.lng+b/(6371000.79*eb*Xa(this.lat*gb))*(270===a?-360:360),new A(this.lat,(d+540)%360-180);if(b/=6371000.79)a*=gb,e=this.lat*gb,f=this.lng*gb,g=e+b*Xa(a),h=g-e,d=Ra(Ya(g/2+db)/Ya(e/2+db)),d=y(h/d)?Xa(e):
h/d,k=b*Va(a)/d,Qa(g)>cb&&(g=0<g?bb-g:-(bb+g));return b?new A(g*hb,((f+k+fb+(Qa(e+h)>cb?bb:0))%eb-bb)*hb):this};A.prototype.walk=A.prototype.tf;function vb(a,b,c){var d=!!a&&!(y(a.lat=qb(a.lat))||y(a.lng=rb(a.lng))||a.alt!==u&&y(a.alt=sb(a.alt))||a.ctx!==u&&!tb(a.ctx));if(!d&&b)throw new x(b,c,a);return d}A.validate=vb;function wb(a){if(!a)throw new x(wb,0,a);return v(a,A)?a:new A(a.lat,a.lng,a.alt,a.ctx)}A.fromIPoint=wb;function B(a,b,c,d){xb(this,qb(a,B,0),rb(b,B,1),qb(c,B,2),rb(d,B,3))}q("H.geo.Rect",B);B.prototype.M=function(a){return this===a||!!a&&this.u===a.u&&this.l===a.l&&this.s===a.s&&this.m===a.m};B.prototype.equals=B.prototype.M;function xb(a,b,c,d,e){a.l=c;a.m=e;b<d&&(c=b,b=d,d=c);a.u=b;a.s=d;a.Rc=a.gc=a.Wa=null;return a}B.prototype.bb=function(){this.Rc||(this.Rc=new A(this.u,this.l));return this.Rc};B.prototype.getTopLeft=B.prototype.bb;
B.prototype.Ya=function(){this.gc||(this.gc=new A(this.s,this.m));return this.gc};B.prototype.getBottomRight=B.prototype.Ya;B.prototype.Di=function(){return this.u};B.prototype.getTop=B.prototype.Di;B.prototype.ki=function(){return this.s};B.prototype.getBottom=B.prototype.ki;B.prototype.ti=function(){return this.l};B.prototype.getLeft=B.prototype.ti;B.prototype.Ci=function(){return this.m};B.prototype.getRight=B.prototype.Ci;
B.prototype.N=function(){this.Wa||(this.Wa=new A(this.s+(this.u-this.s)/2,yb(this.l,this.U())));return this.Wa};B.prototype.getCenter=B.prototype.N;B.prototype.U=function(){return zb(this.l,this.m)};B.prototype.getWidth=B.prototype.U;B.prototype.Kb=function(){return this.u-this.s};B.prototype.getHeight=B.prototype.Kb;B.prototype.Nb=function(){return this.l>this.m};B.prototype.isCDB=B.prototype.Nb;B.prototype.pg=function(){return!this.U()&&!this.Kb()};B.prototype.isEmpty=B.prototype.pg;
B.prototype.bd=function(a,b,c){var d=this.N();c||(a=qb(a,this.bd,0),b=rb(b,this.bd,1));b=this.La(a,b,c);a=b.N();return a.lat===d.lat&&a.lng===d.lng&&this.Kb()===b.Kb()&&this.U()===b.U()};B.prototype.containsLatLng=B.prototype.bd;B.prototype.ge=function(a,b){b||vb(a,this.ge,0);return this.bd(a.lat,a.lng,b)};B.prototype.containsPoint=B.prototype.ge;
B.prototype.he=function(a,b){var c=this.N(),d,e;if(!b&&!v(a,B))throw new x(this.he,0,a);e=this.ib(a,b);d=e.N();return d.lat===c.lat&&d.lng===c.lng&&this.Kb()===e.Kb()&&this.U()===e.U()};B.prototype.containsRect=B.prototype.he;B.prototype.La=function(a,b,c,d){if(!c){if(y(a=qb(a)))throw new x(this.La,0,a);if(y(b=rb(b)))throw new x(this.La,1,b);}return Ab(this.u,this.l,this.s,this.m,a,b,a,b,d)};B.prototype.mergeLatLng=B.prototype.La;
B.prototype.He=function(a,b,c){b||vb(a,this.He,0);return this.La(a.lat,a.lng,b,c)};B.prototype.mergePoint=B.prototype.He;B.prototype.ib=function(a,b,c){if(!b&&!v(a,B))throw new x(this.ib,0,a);return Ab(this.u,this.l,this.s,this.m,a.u,a.l,a.s,a.m,c)};B.prototype.mergeRect=B.prototype.ib;B.prototype.jb=function(a,b,c,d,e,f){e||(a=qb(a,this.jb,0),b=rb(b,this.jb,1),c=qb(c,this.jb,2),d=rb(d,this.jb,3));return Ab(this.u,this.l,this.s,this.m,a,b,c,d,f)};B.prototype.mergeTopLeftBottomRight=B.prototype.jb;
B.prototype.mg=function(a,b){if(!b&&!v(a,B))throw new x(this.mg,0,a);var c=this.l<=this.m,d=a.l<=a.m,e=this.l<a.m,f=a.l<this.m;return this.s<=a.u&&a.s<=this.u&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};B.prototype.intersects=B.prototype.mg;function zb(a,b){var c=b-a;return c+(0>c?360:0)}function yb(a,b){var c=a+b/2;return c-(180<c?360:0)}
function Ab(a,b,c,d,e,f,g,h,k){var l,m,n;c=La(c,g);a=Ma(a,e);e=zb(b,d);l=yb(b,e);g=zb(f,h);n=yb(f,g)-l;n+=0>n-1E-6?360:0;180>n-1E-6?(l=b,m=h):(n=360-n,l=f,m=d);n=n+e/2+g/2;360<=n+5E-7?(l=-180,m=180):n-5E-7<e?(l=b,m=d):n-5E-7<g&&(l=f,m=h);return k?xb(k,a,l,c,m):new B(a,l,c,m)}B.merge=Ab;function Bb(a,b,c){c||(vb(a,Bb,0),vb(b,Bb,1));return new B(a.lat,a.lng,b.lat,b.lng)}B.fromPoints=Bb;
function Cb(a,b){if(!za(a))throw new x(Cb,0,a);var c=1,d=a.length,e,f=null;if(0<d)for(e=a[0],f=Bb(e,e,b);c<d;c++)e=a[c],f.La(e.lat,e.lng,b,f);return f}B.coverPoints=Cb;function Db(a,b){if(!(b||a&&null!=a.length))throw new x(Db,0,a);var c=3,d=a.length,e;if(0<d)for(e=new B(a[0],a[1],a[0],a[1]);c<d;c+=3)e.La(a[c],a[c+1],b,e);return e}B.coverLatLngAlts=Db;
function Eb(a,b){if(b&&(!a||null==a.length))throw new x(Eb,0,a);var c=1,d=a.length,e;if(0<d)for(e=new B(a[0].u,a[0].l,a[0].s,a[0].m);c<d;c++)e.ib(a[c],b,e);return e}B.coverRects=Eb;B.prototype.ih=function(a,b){vb(a,this.ih,0);var c=this.l,d=this.u,e=this.m,f=this.s,g=this.N().lng,h=a.lat-f-(d-f)/2,k=a.lng-g,k=180<k||-180>k?-(g+a.lng):k,c=c+(0>k?2*k:0),c=-180>c?360+c:c,e=e+(0<k?2*k:0),e=180<e?e-360:e,d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?xb(b,d,c,f,e):new B(d,c,f,e)};
B.prototype.resizeToCenter=B.prototype.ih;function E(a,b){if(a&&0!==a.length%3)throw new x(E,0,a);this.n=null;this.A=a||[];this.na=b;this.ka=Fb(this,0,this.A.length)}q("H.geo.Strip",E);function Fb(a,b,c){a=a.A;var d,e=c-2,f=0;0>b&&(b=0);c>a.length&&(c=a.length);b+=1;for(e=c-2;b<e;b+=3)c=a[b],d=a[b+3],Gb(c,d)&&f++;return f}E.prototype.Ed=function(a,b,c){var d=this.A.length;this.A.push(a,b,c);3<=d&&(a=this.A[d-2],Gb(a,b)&&(this.ka+=1));this.n=null};E.prototype.pushLatLngAlt=E.prototype.Ed;
E.prototype.Nd=function(a,b,c){if(c&&0!==c.length%3)throw new x(this.Nd,2,c);var d;b&&(this.ka-=Fb(this,a-3,a+b+3));d=c?this.A.splice.apply(this.A,[a,b].concat(c)):this.A.splice(a,b);c&&(this.ka+=Fb(this,a-3,a+c.length+3));b&&!c&&(this.ka+=Fb(this,a-3,a-3));this.n=null;return d};E.prototype.spliceLatLngAlts=E.prototype.Nd;E.prototype.kg=function(a,b,c,d){this.Nd(a,0,[b,c,d])};E.prototype.insertLatLngAlt=E.prototype.kg;E.prototype.dh=function(a){this.Nd(a,3)};E.prototype.removeLatLngAlt=E.prototype.dh;
E.prototype.Xg=function(a){this.Ed(a.lat,a.lng,a.alt)};E.prototype.pushPoint=E.prototype.Xg;E.prototype.pd=function(a,b){this.kg(3*a,b.lat,b.lng,b.alt)};E.prototype.insertPoint=E.prototype.pd;E.prototype.dj=function(a){this.dh(3*a)};E.prototype.removePoint=E.prototype.dj;E.prototype.pe=function(a,b){var c=this.A,d=3*a,e=c[d],f=c[d+1],c=c[d+2];b&&(b.lat=e,b.lng=f,b.alt=c,void 0!==c&&this.na&&(b.ctx=this.na));return b||new A(e,f,c,null!=c?this.na:void 0)};E.prototype.extractPoint=E.prototype.pe;
E.prototype.Vf=function(a,b,c){var d=this.A;b=b||0;for(c=c||d.length;b<c;b+=3)a(d[b],d[b+1],d[2],b/3)};E.prototype.eachLatLngAlt=E.prototype.Vf;E.prototype.fd=function(a){var b=this.ka,c;a&&(a=this.A[1],c=this.A[this.A.length-2],Gb(c,a)&&(b+=1));return b};E.prototype.getDBCs=E.prototype.fd;E.prototype.eg=function(){return this.A.length/3};E.prototype.getPointCount=E.prototype.eg;E.prototype.ri=function(){return this.A};E.prototype.getLatLngAltArray=E.prototype.ri;
E.prototype.o=function(){var a;if(!(a=this.n)){a=this.A;var b=a.length,c=3,d,e,f,g,h,k=null,l=Ab;if(3<=b)for(d=e=a[0],f=g=a[1],k=new B(d,f,e,g);c<b;c+=3){d=a[c-3];f=a[c-2];e=a[c];g=a[c+1];if(f>g&&180<g-f||f<g&&-180>f-g||g<f&&180>Qa(g-f))h=f,f=g,g=h;d<e&&(h=d,d=e,e=h);l(k.u,k.l,k.s,k.m,d,f,e,g,k)}a=this.n=k}return a};E.prototype.getBounds=E.prototype.o;E.prototype.Ii=function(){return null!==this.n};E.prototype.hasBounds=E.prototype.Ii;function Gb(a,b){return 0>a/b&&180<Qa(b-a)}E.isDBC=Gb;
function Hb(a){var b=new E,c=0,d=a.length;if(0<d%2)throw new x(Hb,0,a);for(;c<d;)b.Ed(a[c++],a[c++],0);return b}E.fromLatLngArray=Hb;function Ib(a,b,c,d,e){this.Yh=a||10;this.cb=this.oc=this.kh=null;this.Mf=d||0;this.Nf=e||0;this.ah=b||1;this.bh=c||1;this.flush()}function Jb(a,b){for(var c,d,e,f,g,h,k,l=0,m,n,w=4,z;w--;){z=w+4;g=[];c=+!(w%3);h=b[w];for(m=(d=a[w]).length;m--;){e=d[m];if(f=e.d)for(n=f.length;n--;)((k=f[n][w])>h)-c&&(h=k);for(n=4;n--;)if(f=e[n])c?f[z]<h&&g.push(f):f[z]>h&&g.push(f)}l+=g.length;b[w]=h;a[w]=g}l&&(b=Jb(a,b));return b}
Ib.prototype.flush=function(){this.cb=this.kh=new Kb(null,0,this.Mf-this.ah,this.Nf-this.bh,this.Mf+this.ah,this.Nf+this.bh);this.oc=null};Ib.prototype.remove=function(a){var b,c=a.Zg,d=c.d;if(d&&(b=d.indexOf(a),-1!==b&&(d.splice(b,1),!d.length))){delete c.d;for(var e=this.cb;(d=c.Ad)&&!(c.d||c[0]||c[1]||c[2]||c[3]);)c===e&&(e=d),delete c.Ad,delete d[c.xh],c=d;this.cb=e;Lb(this)}(b=0<=b)&&Mb(this,a,!1);return b};
function Mb(a,b,c){var d,e;if(d=a.oc)for(e=4;e--;)if(e%3?b[e]>=d[e]:b[e]<=d[e])if(c)d[e]=b[e];else{a.oc=null;break}}Ib.prototype.gb=function(a,b,c,d,e,f){var g=a[8],h=a[9];f&&(d<g||d<a[5]&&b>=g)&&(e<h||e<a[6]&&c>=h)?b=this.gb(Nb(a,(c>=h?2:0)|b>=g),b,c,d,e,f-1):(b=new Ob(a,b,c,d,e),(a.d||(a.d=[])).push(b),Mb(this,b,!0),Lb(this,a));return b};
function Lb(a,b){var c=a.cb,d;if(b){if(d=b,d!==c)for(c=d;d=d.Ad;)if(d.d||3>!d[0]+!d[1]+!d[2]+!d[3])c=d}else for(;!c.d&&2< !c[0]+!c[1]+!c[2]+!c[3];)if(d=c[0]||c[1]||c[2]||c[3])c=d;else break;a.cb=c}Ib.prototype.V=function(a,b,c,d){var e=[];Pb(this,this.cb,e,a,b,c,d);return e};
function Pb(a,b,c,d,e,f,g){var h,k,l=b.d;k=b[7];var m=b[8],n=b[5],w=b[4],z=b[9],s=b[6],C;if(l)if(h=l.length,d>k||f<n||e>w||g<s)for(;h--;)k=l[h],n=k[3],w=k[0],s=k[1],C=k[2],n>f||s<d||w>g||C<e||c.push(k);else for(;h--;)c.push(l[h]);f>=m&&(e<=z&&b[1]&&Pb(a,b[1],c,d,e,f,g),g>=z&&b[3]&&Pb(a,b[3],c,d,e,f,g));d<=m&&(e<=z&&b[0]&&Pb(a,b[0],c,d,e,f,g),g>=z&&b[2]&&Pb(a,b[2],c,d,e,f,g))}
function Kb(a,b,c,d,e,f){a?(this.Ad=a,this.xh=b,b&1?(c=a[8],e=a[5]):(c=a[7],e=a[8]),b&2?(d=a[9],f=a[6]):(d=a[4],f=a[9])):this.xh=this.Ad=null;this[7]=c;this[5]=e;this[8]=(c+e)/2;this[4]=d;this[6]=f;this[9]=(d+f)/2}function Nb(a,b){return a[b]||(a[b]=new Kb(a,b))}function Ob(a,b,c,d,e){this.id=++Qb;this.Zg=a;this[0]=c;this[1]=d;this[2]=e;this[3]=b}var Qb=0;function Rb(a){this.Sd=new Ib(+a||10,180,90,0,0);this.$c=[];this.Ce=!1;this.Va=this.ub=this.n=null}p=Rb.prototype;p.Hb=0;p.Nb=function(){return this.Ce};
p.o=function(){var a,b,c;if(!this.n){c=[];var d;if(d=!this.ub){a=this.Sd;var e;!(e=a.oc)&&(d=a.cb,d.d||d[0]||d[1]||d[2]||d[3])&&(e=[d],e=Jb([e,e,e,e],[d[6],d[7],d[4],d[5]]),a.oc=e);d=a=e}d&&(this.ub=new B(-a[0],a[3],-a[2],a[1]));(b=this.ub)&&c.push(b);var f,g,h,k;if(!this.Va&&(k=(g=this.$c).length)){a=90;d=360;e=-90;for(f=0;k--;)h=g[k],a=La(a,h[0]),d=La(d,h[3]),e=Ma(e,h[2]),f=Ma(f,h[1]);this.Va=new B(-a,d,-e,f-360)}(b=this.Va)&&c.push(b);if(b=c[0])c[1]&&(b=b.ib(c[1],!0)),this.n=b}return this.n};
p.gb=function(a,b,c,d,e){e?(e=new Ob(null,d,-a,b+360,-c),this.$c.push(e),this.Ce=!0,this.Va&&this.Va.jb(a,b,c,d,!0,this.Va)):(e=this.Sd,e=e.gb(e.kh,b,-a,d,-c,e.Yh),this.ub&&this.ub.jb(a,b,c,d,!0,this.ub));++this.Hb;this.n=null;return e};p.pd=function(a){var b=a.lng;a=a.lat;return this.gb(a,b,a,b,!1)};p.remove=function(a){var b,c=!1;if(a.Zg)c=this.Sd.remove(a),this.ub=null;else if(a=(b=this.$c).indexOf(a),c=0<=a)b.splice(a,1),this.Ce=0<b.length,this.Va=null;c&&(--this.Hb,this.n=null);return c};
function Sb(a,b,c,d,e){a=a.$c;var f=a.length,g,h=[],k,l;if(f)for(k=c+360,l=e+360;f--;)g=a[f],Tb(g,b,c,d,e)?h.push(g):Tb(g,b,k,d,l)&&h.push(g);return h}function Tb(a,b,c,d,e){var f=a[0],g=a[1],h=a[2];return!(a[3]>e||g<c||f>d||h<b)}function Ub(a,b){var c,d,e,f;if(d=b.length){c=a.length;for(e={};c--;)e[a[c].id]=1;for(;d--;)(f=b[d]).id in e||a.push(f)}}
function Vb(a,b){var c=a.Sd,d=b.bb(),e=b.Ya(),f=-d.lat,d=d.lng,g=-e.lat,e=e.lng,h;b.Nb()?(h=c.V(-180,f,e,g),Ub(h,c.V(d,f,180,g)),Ub(h,Sb(a,f,e,g,d+360))):(h=c.V(d,f,e,g),Ub(h,Sb(a,f,d,g,e)));return h};function F(){}q("H.map.provider.Invalidations",F);F.MARK_INITIAL=ib;F.prototype.update=function(a,b){b!==Wb&&(this.Bb=a,b&Xb&&(this.uh=a),b&Yb&&(this.Ch=a),b&Zb&&(this.If=a),b&$b&&(this.eh=a),b&ac&&(this.Gh=a))};F.prototype.update=F.prototype.update;F.prototype.vi=function(){return this.Bb};F.prototype.getMark=F.prototype.vi;F.prototype.Bb=ib;F.prototype.rd=function(a){return this.Bb>a};F.prototype.isAny=F.prototype.rd;F.prototype.Ch=ib;F.prototype.tc=function(a){return this.Ch>a};
F.prototype.isVisual=F.prototype.tc;F.prototype.uh=ib;F.prototype.Pb=function(a){return this.uh>a};F.prototype.isSpatial=F.prototype.Pb;F.prototype.If=ib;F.prototype.ng=function(a){return this.If>a};F.prototype.isAdd=F.prototype.ng;F.prototype.eh=ib;F.prototype.sg=function(a){return this.eh>a};F.prototype.isRemove=F.prototype.sg;F.prototype.Gh=ib;F.prototype.Ee=function(a){return this.Gh>a};F.prototype.isZOrder=F.prototype.Ee;var Wb=0,Yb=1,Xb=2,Zb=4,$b=8,ac=16;
F.Flag={NONE:Wb,zj:Yb,yj:Xb,xb:Zb,yb:$b,Aj:ac};var bc=!!pa.VBArray;q("H.util.getSuperProto",function(a){return a.a});q("H.util.eval",function(a){return eval(a)});q("H.util.getValue",function(a,b){return a!==u?a:b});var cc=0;function dc(){return!1}function ec(){}var fc=[];function gc(a){return"CANVAS"===a.tagName?[a]:a.getElementsByTagName("CANVAS")}function hc(a,b,c){var d;b=a.ownerDocument===b?a.cloneNode(!0):b.importNode(a,!0);if(c)for(a=gc(a),c=gc(b),d=c.length;d--;)c[d].getContext("2d").drawImage(a[d],0,0);return b}var ic,jc=document.createElement("CANVAS");
jc.width=jc.height=1;ic=jc.getContext("2d");function kc(a){var b=a.complete,c=0<a.naturalWidth;if(b&&!c&&bc)try{ic.drawImage(a,0,0),c=!0}catch(d){}return b&&c};function lc(a,b){var c=[];a&&c.push(xa(a));1<arguments.length&&c.push(b);this.message=c.join(" ")}r(lc,Error);q("H.lang.IllegalOperationError",lc);lc.prototype=Error();lc.prototype.name="IllegalOperationError";function mc(){0!=nc&&(oc[ea(this)]=this)}var nc=0,oc={};mc.prototype.Tf=!1;mc.prototype.k=function(){if(!this.Tf&&(this.Tf=!0,this.c(),0!=nc)){var a=ea(this);delete oc[a]}};mc.prototype.Ab=function(a,b){this.Ac||(this.Ac=[]);this.Ac.push(ka(a,b))};mc.prototype.c=function(){if(this.Ac)for(;this.Ac.length;)this.Ac.shift()()};function pc(a,b){this.type=a;this.currentTarget=this.target=b}p=pc.prototype;p.c=function(){};p.k=function(){};p.ob=!1;p.defaultPrevented=!1;p.Hd=!0;p.stopPropagation=function(){this.ob=!0};p.preventDefault=function(){this.defaultPrevented=!0;this.Hd=!1};q("H.util.Event",pc);pc.prototype.stopPropagation=pc.prototype.stopPropagation;pc.prototype.stopPropagation=pc.prototype.stopPropagation;pc.prototype.CAPTURING_PHASE=1;pc.prototype.AT_TARGET=2;pc.prototype.BUBBLING_PHASE=3;pc.prototype.eventPhase=0;function qc(a,b,c){qc.a.constructor.call(this,a);this.oldValue=c;this.newValue=b}r(qc,pc);q("H.util.ChangeEvent",qc);function rc(a,b){return a<b?-1:a>b?1:0};var sc=0;function tc(){}p=tc.prototype;p.key=0;p.pb=!1;p.Yc=!1;p.od=function(a,b,c,d,e,f){if(da(a))this.qg=!0;else if(a&&a.handleEvent&&da(a.handleEvent))this.qg=!1;else throw Error("Invalid listener argument");this.Ja=a;this.Wg=b;this.src=c;this.type=d;this.de=!!e;this.ye=f;this.Yc=!1;this.key=++sc;this.pb=!1};p.handleEvent=function(a){return this.qg?this.Ja.call(this.ye||this.src,a):this.Ja.handleEvent.call(this.Ja,a)};var uc,vc,wc,xc;function yc(){return aa.navigator?aa.navigator.userAgent:null}xc=wc=vc=uc=!1;var zc;if(zc=yc()){var Ac=aa.navigator;uc=0==zc.indexOf("Opera");vc=!uc&&-1!=zc.indexOf("MSIE");wc=!uc&&-1!=zc.indexOf("WebKit");xc=!uc&&!wc&&"Gecko"==Ac.product}var Bc=uc,Cc=vc,Dc=xc,Ec=wc;function Fc(){var a=aa.document;return a?a.documentMode:void 0}var Gc;
a:{var Hc="",Ic;if(Bc&&aa.opera)var Jc=aa.opera.version,Hc="function"==typeof Jc?Jc():Jc;else if(Dc?Ic=/rv\:([^\);]+)(\)|;)/:Cc?Ic=/MSIE\s+([^\);]+)(\)|;)/:Ec&&(Ic=/WebKit\/(\S+)/),Ic)var Kc=Ic.exec(yc()),Hc=Kc?Kc[1]:"";if(Cc){var Lc=Fc();if(Lc>parseFloat(Hc)){Gc=String(Lc);break a}}Gc=Hc}var Mc={};
function Nc(a){var b;if(!(b=Mc[a])){b=0;for(var c=String(Gc).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",k=/(\d*)(\D*)/g,l=/(\d*)(\D*)/g;do{var m=k.exec(g)||["","",""],n=l.exec(h)||["","",""];if(0==m[0].length&&0==n[0].length)break;b=rc(0==m[1].length?0:parseInt(m[1],10),0==n[1].length?0:parseInt(n[1],10))||rc(0==m[2].length,0==n[2].length)||rc(m[2],n[2])}while(0==
b)}b=Mc[a]=0<=b}return b}var Oc=aa.document,Pc=Oc&&Cc?Fc()||("CSS1Compat"==Oc.compatMode?parseInt(Gc,10):5):void 0;var Qc;(Qc=!Cc)||(Qc=Cc&&9<=Pc);var Rc=Qc,Sc=Cc&&!Nc("9");!Ec||Nc("528");Dc&&Nc("1.9b")||Cc&&Nc("8")||Bc&&Nc("9.5")||Ec&&Nc("528");Dc&&!Nc("8")||Cc&&Nc("9");var Tc=Array.prototype,Uc=Tc.indexOf?function(a,b,c){return Tc.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(ca(a))return ca(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};function Vc(a){Vc[" "](a);return a}Vc[" "]=function(){};function Wc(a,b){a&&this.od(a,b)}r(Wc,pc);p=Wc.prototype;p.target=null;p.relatedTarget=null;p.offsetX=0;p.offsetY=0;p.clientX=0;p.clientY=0;p.screenX=0;p.screenY=0;p.button=0;p.keyCode=0;p.charCode=0;p.ctrlKey=!1;p.altKey=!1;p.shiftKey=!1;p.metaKey=!1;p.nc=null;
p.od=function(a,b){var c=this.type=a.type;pc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Dc){var e;a:{try{Vc(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=null)}}else"pointerenter"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Ec||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=Ec||void 0!==a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:
a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.nc=a;a.defaultPrevented&&this.preventDefault();delete this.ob};p.stopPropagation=function(){Wc.a.stopPropagation.call(this);this.nc.stopPropagation?this.nc.stopPropagation():this.nc.cancelBubble=!0};
p.preventDefault=function(){Wc.a.preventDefault.call(this);var a=this.nc;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Sc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};p.c=function(){};var ma={},Xc={},Yc={},Zc={};function $c(a,b,c,d,e){if("array"==ba(b)){for(var f=0;f<b.length;f++)$c(a,b[f],c,d,e);return null}a=ad(a,b,c,!1,d,e);b=a.key;ma[b]=a;return b}
function ad(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");e=!!e;var g=Xc;b in g||(g[b]={Y:0,K:0});g=g[b];e in g||(g[e]={Y:0,K:0},g.Y++);var g=g[e],h=ea(a),k;g.K++;if(g[h]){k=g[h];for(var l=0;l<k.length;l++)if(g=k[l],g.Ja==c&&g.ye==f){if(g.pb)break;d||(k[l].Yc=!1);return k[l]}}else k=g[h]=[],g.Y++;l=bd();g=new tc;g.od(c,l,a,b,e,f);g.Yc=d;l.src=a;l.Ja=g;k.push(g);Yc[h]||(Yc[h]=[]);Yc[h].push(g);a.addEventListener?a!=aa&&a.customEvent_||a.addEventListener(b,l,e):a.attachEvent(b in Zc?Zc[b]:Zc[b]=
"on"+b,l);return g}function bd(){var a=cd,b=Rc?function(c){return a.call(b.src,b.Ja,c)}:function(c){c=a.call(b.src,b.Ja,c);if(!c)return c};return b}function dd(a,b,c,d,e){if("array"==ba(b)){for(var f=0;f<b.length;f++)dd(a,b[f],c,d,e);return null}a=ad(a,b,c,!0,d,e);b=a.key;ma[b]=a;return b}
function ed(a,b,c,d,e){if("array"==ba(b)){for(var f=0;f<b.length;f++)ed(a,b[f],c,d,e);return null}d=!!d;a:{f=Xc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=ea(a),f[a]))){a=f[a];break a}a=null}if(!a)return!1;for(f=0;f<a.length;f++)if(a[f].Ja==c&&a[f].de==d&&a[f].ye==e)return fd(a[f].key);return!1}
function fd(a){var b=ma[a];if(!b||b.pb)return!1;var c=b.src,d=b.type,e=b.Wg,f=b.de;c.removeEventListener?c!=aa&&c.customEvent_||c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Zc?Zc[d]:Zc[d]="on"+d,e);c=ea(c);if(Yc[c]){var e=Yc[c],g=Uc(e,b);0<=g&&Tc.splice.call(e,g,1);0==e.length&&delete Yc[c]}b.pb=!0;if(b=Xc[d][f][c])b.Ig=!0,gd(d,f,c,b);delete ma[a];return!0}
function gd(a,b,c,d){if(!d.ud&&d.Ig){for(var e=0,f=0;e<d.length;e++)d[e].pb?d[e].Wg.src=null:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Ig=!1;0==f&&(delete Xc[a][b][c],Xc[a][b].Y--,0==Xc[a][b].Y&&(delete Xc[a][b],Xc[a].Y--),0==Xc[a].Y&&delete Xc[a])}}function hd(a){var b=0;if(null!=a){if(a=ea(a),Yc[a]){a=Yc[a];for(var c=a.length-1;0<=c;c--)fd(a[c].key),b++}}else la(function(a,c){fd(c);b++})}
function id(a,b,c,d,e){var f=1;b=ea(b);if(a[b]){var g=--a.K,h=a[b];h.ud?h.ud++:h.ud=1;try{for(var k=h.length,l=0;l<k;l++){var m=h[l];m&&!m.pb&&(f&=!1!==jd(m,e))}}finally{a.K=Math.max(g,a.K),h.ud--,gd(c,d,b,h)}}return Boolean(f)}function jd(a,b){a.Yc&&fd(a.key);return a.handleEvent(b)}
function kd(a,b){var c=b.type||b,d=Xc;if(!(c in d))return!0;if(ca(b))b=new pc(b,a);else if(b instanceof pc)b.target=b.target||a;else{var e=b;b=new pc(c,a);oa(b,e)}var e=1,f,d=d[c],c=!0 in d,g;if(c){f=[];for(g=a;g;g=g.$a())f.push(g);g=d[!0];g.K=g.Y;for(var h=f.length-1;!b.ob&&0<=h&&g.K;h--)b.currentTarget=f[h],e&=id(g,f[h],b.type,!0,b)&&!1!=b.Hd}if(!1 in d)if(g=d[!1],g.K=g.Y,c)for(h=0;!b.ob&&h<f.length&&g.K;h++)b.currentTarget=f[h],e&=id(g,f[h],b.type,!1,b)&&!1!=b.Hd;else for(d=a;!b.ob&&d&&g.K;d=d.$a())b.currentTarget=
d,e&=id(g,d,b.type,!1,b)&&!1!=b.Hd;return Boolean(e)}
function cd(a,b){if(a.pb)return!0;var c=a.type,d=Xc;if(!(c in d))return!0;var d=d[c],e,f;if(!Rc){var g;if(!(g=b))a:{g=["window","event"];for(var h=aa;e=g.shift();)if(null!=h[e])h=h[e];else{g=null;break a}g=h}e=g;g=!0 in d;h=!1 in d;if(g){if(0>e.keyCode||void 0!=e.returnValue)return!0;a:{var k=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(l){k=!0}if(k||void 0==e.returnValue)e.returnValue=!0}}k=new Wc;k.od(e,this);e=!0;try{if(g){for(var m=[],n=k.currentTarget;n;n=n.parentNode)m.push(n);f=d[!0];
f.K=f.Y;for(var w=m.length-1;!k.ob&&0<=w&&f.K;w--)k.currentTarget=m[w],e&=id(f,m[w],c,!0,k);if(h)for(f=d[!1],f.K=f.Y,w=0;!k.ob&&w<m.length&&f.K;w++)k.currentTarget=m[w],e&=id(f,m[w],c,!1,k)}else e=jd(a,k)}finally{m&&(m.length=0)}return e}c=new Wc(b,this);return e=jd(a,c)};function G(){mc.call(this)}r(G,mc);G.prototype.customEvent_=!0;p=G.prototype;p.af=null;p.$a=function(){return this.af};p.ea=function(a){this.af=a};p.addEventListener=function(a,b,c,d){$c(this,a,b,c,d)};p.removeEventListener=function(a,b,c,d){ed(this,a,b,c,d)};p.dispatchEvent=function(a){return kd(this,a)};p.c=function(){G.a.c.call(this);hd(this);this.af=null};q("H.util.EventTarget",G);G.prototype.ea=G.prototype.ea;G.prototype.setParentEventTarget=G.prototype.ea;G.prototype.$a=G.prototype.$a;G.prototype.getParentEventTarget=G.prototype.$a;G.prototype.addEventListener=G.prototype.addEventListener;G.prototype.addEventListener=G.prototype.addEventListener;G.prototype.removeEventListener=G.prototype.removeEventListener;G.prototype.removeEventListener=G.prototype.removeEventListener;G.prototype.dispatchEvent=G.prototype.dispatchEvent;
G.prototype.dispatchEvent=G.prototype.dispatchEvent;G.prototype.k=G.prototype.k;G.prototype.dispose=G.prototype.k;G.prototype.Ab=G.prototype.Ab;G.prototype.addOnDisposeCallback=G.prototype.Ab;function I(a){var b;wa(this,I);I.a.constructor.call(this);this.oa=ld++;a&&(b="min",b in a&&(this.Hg=+a[b]),b="max",b in a&&(this.Gg=+a[b]),b="visibility",b in a&&(this.Td=!!a[b]),b="zIndex",b in a&&(this.Tc=+a[b]||0),b="provider",b in a&&(this.sa=a[b]))}r(I,G);q("H.map.Object",I);I.prototype.rg=!1;I.prototype.b={Nh:"visibilitychange",Oh:"zindexchange"};var ld=ib;I.prototype.pi=function(){return this.oa};I.prototype.getId=I.prototype.pi;I.prototype.Hg=-1/0;I.prototype.Gg=1/0;I.prototype.Td=!0;
I.prototype.setVisibility=function(a){var b=this.Td;(a=!!a)^b&&(this.Td=a,this.v(Yb),this.dispatchEvent(new qc(this.b.Nh,a,b)));return this};I.prototype.setVisibility=I.prototype.setVisibility;I.prototype.getVisibility=function(a){for(var b=this,c;(c=b.Td)&&a&&(b=b.O););return c};I.prototype.getVisibility=I.prototype.getVisibility;I.prototype.Tc=u;I.prototype.Hi=function(){return this.Tc};I.prototype.getZIndex=I.prototype.Hi;
I.prototype.nj=function(a){var b=this.Tc;a!==b&&(this.Hc(),this.Tc=a,this.v(ac),this.dispatchEvent(new qc(this.b.Oh,a,b)));return this};I.prototype.setZIndex=I.prototype.nj;I.prototype.Vd=u;function md(a){var b=a.Vd,c,d,e;b||(c=(d=a.Tc)!==u,(b=a.O)?(b=md(b).slice(),b[0]|=c):b=[c|0],b.push(d||0,(e=a.th)!==u?e:a.oa),a.Vd=b);return b}I.prototype.Hc=function(){this.Vd=u};
function nd(a,b,c){if(!c||a[0]|b[0])for(var d=a.length,e=b.length,f=La(d,e),g,h=1,k=1+c;h<f;h+=k)if(g=a[h]-b[h])return g;return c?0:d-e}I.compareZOrder=function(a,b){return a.ad(b)};I.prototype.ad=function(a){return this.dc-a.dc||nd(md(this),md(a),!1)};I.prototype.compareZOrder=I.prototype.ad;p=I.prototype;p.previousSibling=sa;p.nextSibling=sa;p.th=u;p.O=sa;p.yi=function(){return this.O};I.prototype.getParentGroup=I.prototype.yi;I.prototype.Lb=function(){for(var a=this,b;b=a.O;)a=b;return a};
I.prototype.getRootGroup=I.prototype.Lb;I.prototype.contains=function(a){return this===a};I.prototype.contains=I.prototype.contains;I.prototype.ea=function(a){if(this.O)throw new lc(this.ea,"Not allowed for a child of a group");I.a.ea.call(this,a)};I.prototype.setParentEventTarget=I.prototype.ea;I.prototype.sa=null;I.prototype.gd=function(){return this.sa};I.prototype.getProvider=I.prototype.gd;
I.prototype.Zb=function(a,b){var c=this.sa,d,e;if(d=c!==a){if(b&&c&&!v(c,J)||a&&!v(a,J))throw new lc(b,"Only LocalObjectProvider allows an object transfers");e=!this.rg;c&&(this.v($b),e&&c.L(this));this.hb=sa;if(this.sa=a)e&&a.B(this),this.v(Zb)}return d};I.prototype.fa=function(){return this.hb||(this.hb=new F)};I.prototype.getInvalidations=I.prototype.fa;I.prototype.v=function(a){var b=this.gd(),c;(c=!!b)&&b.rc(this,a);return c};I.prototype.invalidate=I.prototype.v;
I.prototype.c=function(){this.O&&this.O.L(this);delete this.hb;I.a.c.call(this)};function od(a){var b=pd,c,d;if(a)for(;b--;)if((c=qd[b])in a){if((d=rd[b](a[c]))===sd)throw new x(od,0,c+": "+a[c]);d!==u&&d!==this[c]&&(this[c]=d)}}q("H.map.SpatialStyle",od);var qd=[];od.prototype[qd[0]="strokeColor"]="rgba(0,85,170,.6)";od.prototype[qd[1]="fillColor"]="rgba(0,85,170,.4)";od.prototype[qd[2]="lineWidth"]=2;od.prototype[qd[3]="lineCap"]="round";od.prototype[qd[4]="lineJoin"]="miter";od.prototype[qd[5]="miterLimit"]=10;od.prototype[qd[6]="lineDash"]=fc;
od.prototype[qd[7]="lineDashOffset"]=0;var pd=qd.length;od.prototype.M=function(a){var b,c;b=this===a;if(!b&&a){for(b=0;b<pd&&(c=qd[b],this[c]===a[c]);b++);b=b===pd}return b};od.prototype.equals=od.prototype.M;od.prototype.pc=function(){return new od(this)};od.prototype.getClone=od.prototype.pc;
var sd={},rd=[function(a){return a?qa(a):sd},function(a){return a?qa(a):sd},function(a){return 0<=a&&100>=a?+a:sd},function(a){return"butt"===(a=qa(a))||"square"===a||"round"===a?a:sd},function(a){return"round"===a||"bevel"===a||"miter"===a?a:sd},function(a){return 0<a&&a!==1/0?+a:sd},function(a){return a&&a.every&&a.every(Ca)?a:sd},function(a){return y(+a)?sd:+a}];od.MAX_LINE_WIDTH=100;var td=new od;od.DEFAULT_STYLE=td;function ud(a,b){if(!v(this,L)&&!v(this,vd))throw Error("Illegal constructor call "+xa(ud));ud.a.constructor.call(this,b);this.q(a);b&&this.sh(b.style)}r(ud,I);q("H.map.Spatial",ud);ud.prototype.dc=0;ud.prototype.Gf={Kh:"stripchange",Lh:"stylechange"};ud.prototype.xa=null;ud.prototype.Fa=function(){return this.xa};ud.prototype.getStrip=ud.prototype.Fa;
ud.prototype.q=function(a){var b;if(null!==a&&!v(a,E))throw new x(ud.prototype.q,0,a);b=this.xa;this.xa=a;null!==b&&(this.dispatchEvent(new qc(this.Gf.Kh,a,b)),this.v(Xb));return this};ud.prototype.setStrip=ud.prototype.q;ud.prototype.Mb=function(){return(this.wh||td).pc()};ud.prototype.getStyle=ud.prototype.Mb;ud.prototype.sh=function(a){var b=this.Mb();a?v(a,od)||(a=new od(a)):(delete this.wh,a=td);a&&!b.M(a)&&(this.wh=a.pc(),this.dispatchEvent(new qc(this.Gf.Lh,a,b)),this.v(Yb));return this};
ud.prototype.setStyle=ud.prototype.sh;ud.prototype.getBounds=ud.prototype.o;function vd(a,b){vd.a.constructor.call(this,a,b)}r(vd,ud);q("H.map.Polyline",vd);vd.prototype.o=function(){return this.Yg.o()};vd.prototype.getBounds=vd.prototype.o;vd.prototype.q=function(a){var b,c,d,e=this.Yg=new Rb;a.Vf(function(a,g,h,k){if(0<k){var l,m,n;c<g?(h=c,m=g):(h=g,m=c);b<a?(l=a,n=b):(l=b,n=a);d=e.gb(l,h,n,m,180<m-h);d.Wd=k-1}b=a;c=g});return vd.a.q.call(this,a)};vd.prototype.setStrip=vd.prototype.q;
vd.prototype.clip=function(a){var b=Vb(this.Yg,a).sort(this.ai),c,d=this.xa.A;a=0;for(var e=b.length,f,g=-2,h=[],k,l=Gb;a<e;a++)c=b[a],f=c.Wd,c=3*f,g+1!==f&&h.push(k=[d[c],d[c+1]]),g=f,c+=3,f=d[c],c=d[c+1],k.push(f,c);if(this.xa.fd()){d=[];for(a=0;a<h.length;a++)if(k=h[a],e=k.length){g=[];for(b=0;b<e;b+=2)0==b||0<b&&!l(k[b+1],k[b-1])?g.push(k[b],k[b+1]):(g.push(k[b],k[b+1]),d.push(g),g=[],k[b-1]+=0>k[b-1]?360:-360,g.push(k[b-2],k[b-1],k[b],k[b+1]));d.push(g)}h=d}return h};vd.prototype.clip=vd.prototype.clip;
vd.prototype.ai=function(a,b){return a.Wd-b.Wd};function L(a,b){L.a.constructor.call(this,a,b)}r(L,ud);q("H.map.Polygon",L);L.prototype.o=function(){var a,b,c,d;if(!(a=this.Ta)){if(b=this.Fa())if(a=b.o())(c=b.fd(!0))&&(d=b.eg())&&(a=a.ib(Cb([b.pe(0),b.pe(d-1)],!0),!0)),360===a.U()&&1===c%2&&(a=a.La(this.Ob?90:-90,0));this.Ta=a||null}return a};L.prototype.getBounds=L.prototype.o;L.prototype.Ta=null;L.prototype.q=function(a){if(!v(a,E)&&(va(this,L)||null!==a))throw new x(L.prototype.q,0,a);this.Ta=null;return L.a.q.call(this,a)};
L.prototype.setStrip=L.prototype.q;L.prototype.Ob=!0;L.prototype.Mc=function(a){this.Ob!==a&&(this.Ob=a,this.Ta=null,this.v(Xb));return this};L.prototype.setNorthPoleCovering=L.prototype.Mc;L.prototype.xi=function(){return this.Ob};L.prototype.getNorthPoleCovering=L.prototype.xi;
L.prototype.clip=function(a){var b;a.N();var c,d;a=[[]];c=this.Fa().A;b=[];d=c.length;var e,f,g,h=!1;for(e=0;e<d;e+=3)f=c[e],g=c[e+1],h||180!=Qa(g)||(b.push(f),b.push(g),b.push(f),b.push(-g),h=!0),b.push(f),b.push(g);c=this.o();d=c.U();360>d&&-180==c.l&&(c=new B(c.u,180,c.s,c.m));360>d&&180==c.m&&(c=new B(c.u,c.l,c.s,-180));if(c.Nb()){var h=b.length,k,l;d=-1;f=Gb;for(e=0;e<h-2;e+=2)if(f(b[e+1],b[e+3])){d=e+2;break}-1===d&&f(b[h-1],b[1])&&(d=h);-1!==d&&(f=b[d-2],e=b[d-1],g=b[d%h],k=b[(d+1)%h],180!==
Qa(f)&&180!==Qa(g)&&(l=Qa(g-f),h=Qa(k-e),h+=180<h?-360:0,k=Qa(180-k),k+=180<k?-360:0,l/=Qa(h)/Qa(k),f=g+(g>f?-l:l),e=0<e?180:-180,b.splice(d,0,f,e,f,-e)))}a[0]=wd([].concat(b),c.l);360>c.U()&&c.ge(new A(c.u,180))&&(b=wd([].concat(b),c.m),a.push(b));return a};L.prototype.clip=L.prototype.clip;function wd(a,b){for(var c=[],d=Number.POSITIVE_INFINITY,e=-1,f,g=a.length,c=0;c<g;c+=2)f=Qa(a[c+1]-b),f+=180<f?360-f:f,f<d&&(d=f,e=c);return 0<c?(c=a.splice(e,a.length-e),c.concat(a)):a};function xd(a,b){xd.a.constructor.call(this,null,b);this.kf(a)}r(xd,L);q("H.map.Rect",xd);xd.prototype.kf=function(a){if(!v(a,B))throw new x(this.kf,0,a);this.Ta&&this.Ta.M(a)||(this.n=a,xd.a.q.call(this,null),this.Ta=a)};xd.prototype.setBounds=xd.prototype.kf;xd.prototype.o=function(){return this.n};xd.prototype.getBounds=xd.prototype.o;xd.prototype.Mc=function(){return this};xd.prototype.setNorthPoleCovering=xd.prototype.Mc;xd.prototype.q=function(){return this};xd.prototype.setStrip=xd.prototype.q;
xd.prototype.Fa=function(){return this.xa||xd.a.q.call(this,this.xe()).xa};xd.prototype.getStrip=xd.prototype.Fa;xd.prototype.xe=function(){var a=this.n,b,c,d,e,f=[b=a.u,c=a.l,u,b,e=a.m,u,d=a.s,e,u,d,c,u];180<=a.U()&&(f.splice(9,0,d,a=a.N().lng,u),f.splice(3,0,b,a,u));return new E(f)};function Bd(a,b,c){if(!a||!b||!c)throw new x(Bd,null,"Must specify name, version and revision parameter");this.name=a;this.version=b;this.revision=c}q("H.util.BuildInfo",Bd);Bd.prototype.toString=function(){return this.name+";"+this.version+";"+this.revision};var Cd={};function Dd(a,b,c){if(!a)throw new x(Dd,1,"Must specify a name parameter");return Cd[a]||(Cd[a]=new Bd(a,b,c))}Bd.get=Dd;q("H.util.Disposable",mc);mc.prototype.Ab=mc.prototype.Ab;mc.prototype.addOnDisposeCallback=mc.prototype.Ab;function Ed(a){a&&"function"==typeof a.k&&a.k()};function Fd(a,b){var c=a.t,d=c.ownerDocument;Fd.a.constructor.call(this);this.X=a;this.t=c=c.appendChild(Gd(d,"DIV","position:absolute;bottom:4em;left:0.5em;z-index:1;height:0px"));this.Ph=Gd(d,"DIV","position:absolute;top:0px;pointer-events:none;",Hd);this.Qh=c.appendChild(this.Ph).firstChild.firstChild.style;c=c.appendChild(Gd(d,"DIV","whiteSpace:nowrap;position:relative;top:2.2em;"));this.Pf=c.appendChild(Gd(d,"SPAN"));this.Pf.setAttribute("unselectable","on");this.zh=c.appendChild(Gd(d,"A","color:inherit",
"Terms of use"));this.zh.target="_blank";this.hj=c=c.appendChild(Gd(d,"SPAN","color:inherit"," | "));this.ij=c.appendChild(function(){var a=Gd(d,"A","color:inherit","Report image");a.target="_blank";return a}());this.vg=Id.slice();this.Kd(b);this.bc=t(this.bc,this);this.qa=t(this.qa,this);this.X.addEventListener(this.X.b.Bf,this.bc);this.X.f.addEventListener("add",this.qa);this.X.f.addEventListener("remove",this.qa);this.X.f.addEventListener("set",this.qa);this.qa()}r(Fd,mc);q("H.map.Imprint",Fd);
var Jd=ta("font href invert reportHref"),Id=ta("11px Arial,sans-serif;http://here.com/terms;;http://here.com/",";");Fd.prototype.Kd=function(a){var b=Jd.length,c,d,e;a||(this.vg=Id.slice());for(e=this.vg;b--;)c=Jd[b],d=a&&c in a?e[b]=a[c]:e[b],2===b?(this.Qh.fill=d?"#FFF":"#1B468D",this.t.style.color=d?"#FFF":"#333"):1===b?this.zh[c]=d:this.t.style[c]=d};Fd.prototype.setOptions=Fd.prototype.Kd;function Gd(a,b,c,d){a=a.createElement(b);c&&(a.style.cssText=c);d&&(a.innerHTML=d);return a}
Fd.prototype.ve=function(){return this.t};Fd.prototype.getElement=Fd.prototype.ve;Fd.prototype.bc=function(){var a=Id[3],b=this.X,c=this.ij,d=this.hj,e;b.dg().type===Kd?d.style.display="none":(b=b.ia.Za(),e=b.position,d.style.display="inline",c.href=a+[e.lat,e.lng,22,b.yaw,90+b.pitch].join()+",panorama.day,report");this.Pf.innerHTML="&copy; "+this.Ea()+" | "};Fd.prototype.qa=function(){this.bc();setTimeout(this.bc,5E3)};
var Hd='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="3em" height="2.2em" viewBox="0 0 540 430"><path d="M 0,303 127,430 h 77 l -53,-53 c -19,-18 -24,-31 -13,-43 8,-9 18,-8 30,3 l 64,65 39,-39 -69,-70 c -28,-28 -55,-34 -81,-7 -16,15 -18,30 -17,44 L 38,265 0,303 z m 322,-97 c -41,-41 -79,-43 -113,-9 -34,34 -28,77 5,110 41,41 86,34 120,0 17,-16 26,-31 30,-41 l -34,-19 c -5,9 -12,20 -21,28 -19,19 -36,19 -48,9 l 70,-69 -9,-8 z m -85,57 c -11,-12 -11,-26 0,-37 11,-11 24,-11 38,0 l -38,37 z m 138,-3 39,-39 -42,-42 C 337,145 347,127 355,119 361,113 367,109 371,108 L 339,71 c -2,1 -7,5 -12,9 -13,14 -17,35 -13,49 L 297,114 263,148 374,260 z M 494,34 C 453,-8 415,-10 381,25 c -33,33 -25,79 6,109 41,41 85,35 119,1 20,-20 30,-39 32,-48 L 505,68 c -4,9 -13,24 -24,34 -18,19 -36,19 -48,9 L 503,42 494,34 z m -85,57 c -11,-12 -11,-26 0,-37 11,-11 24,-11 37,0 l -37,37 z" /></svg>',Ld=
"1987&ndash;"+Ma(2014,(new Date).getFullYear())+" HERE";Fd.prototype.Ea=function(){var a=this.X,b=a.getZoom(),c=a.fg(),a=a.f,d=a.d.length,e={},f=0,g,h,k,l=[Ld];if(c)for(;f<d;f++)if(h=a.get(f).getCopyrights(c,b))for(g=0;g<h.length;g++)e[k=h[g].label]||(l.push(k),e[k]=1);return l.join(", ")};Fd.prototype.getCopyrights=Fd.prototype.Ea;Fd.prototype.Mb=function(){return this.t.style};Fd.prototype.getStyle=Fd.prototype.Mb;
Fd.prototype.c=function(){this.X.removeEventListener(this.X.b.Bf,this.bc);this.X.f.removeEventListener("add",this.qa);this.X.f.removeEventListener("remove",this.qa);this.X.f.removeEventListener("set",this.qa);this.t.parentNode&&this.t.parentNode.removeChild(this.t)};function Md(a,b,c,d){Md.a.constructor.call(this,a,b,c);this.modifiers=d}r(Md,qc);q("H.map.ChangeEvent",Md);Md.prototype.FOV=1;Md.prototype.PITCH=2;Md.prototype.POSITION=4;Md.prototype.ROLL=8;Md.prototype.SIZE=16;Md.prototype.YAW=32;Md.prototype.ZOOM=64;var Nd=dd;q("H.util.events.listenOnce",Nd);q("H.util.events.dispatchEvent",kd);q("H.util.events.fireListeners",function(a,b,c,d){var e=Xc;return b in e&&(e=e[b],c in e)?id(e[c],a,b,c,d):!0});q("H.util.events.listen",$c);q("H.util.events.unlisten",ed);
var Od=jd,jd=function(a,b){var c,d,e,f=!0;c=b[b.currentTarget===b.target?"AT_TARGET":a.de?"CAPTURING_PHASE":(d=!0,"BUBBLING_PHASE")];if(!d||"pointerenter"!==(e=b.type)&&"pointerleave"!==e)b.eventPhase=c,f=Od(a,b),d&&a.src.$a&&null===a.src.$a()&&delete b.eventPhase;return f};function M(){M.a.constructor.call(this);this.P={};this.Fd={position:new A(0,0),pitch:0,yaw:0,roll:0,fov:70};this.sb=0}r(M,G);q("H.map.ViewModel",M);M.prototype.b={j:"update",ec:"sync"};M.prototype.Yd=ta("position pitch yaw roll fov zoom");var Pd=ta("fov pitch position roll yaw zoom").reduce(function(a,b){a[b]=Md.prototype[b.toUpperCase()];return a},{});
function Qd(a,b,c,d){var e=d.length,f,g,h;a.Oc=0;a.Pe={};for(a.Me={};e--;)if(f=d[e],h=c[f],g=b[f],null!=h){if(a.Pe[f]=g,a.Me[f]=h,b[f]=h,ub(h)&&ub(g)&&(h.lat!==g.lat||h.lng!==g.lng)||!ub(h)&&h!==g)a.Oc|=Pd[f]}else delete b[f];return b}M.prototype.Za=function(){return Qd(this,{},this.Fd,this.Yd)};M.prototype.getCameraData=M.prototype.Za;
M.prototype.Jc=function(a){var b,c=a.animate;if(!a)throw new x(this.Jc,0,a);if((b=a.position)&&!ub(b))throw new x(this.Jc,0,"position");this.P.zoom=y(a.zoom)?y(this.P.zoom)?this.sb:this.P.zoom:a.zoom;b=this.P.zoom;a=Qd(this,{},a,this.Yd);this.P={animate:c,zoom:b,camera:a};this.dispatchEvent(new Rd(this.P));return this};M.prototype.setCameraData=M.prototype.Jc;
M.prototype.Qd=function(a){var b=a.zoom;Qd(this,this.Fd,a,this.Yd);b!==this.sb&&(this.Oc|=Pd.zoom);this.Pe.zoom=this.sb;this.Me.zoom=b;this.sb=null!=b?b:this.sb;this.Fd.zoom=this.sb;this.P={};this.dispatchEvent(new Md(this.b.ec,this.Me,this.Pe,this.Oc))};M.prototype.setZoom=function(a,b){if(y(a=+a))throw new x(this.setZoom,0,a);this.P={animate:b,zoom:a,camera:this.P.camera||this.Fd};this.dispatchEvent(new Rd(this.P))};M.prototype.setZoom=M.prototype.setZoom;M.prototype.getZoom=function(){return this.sb};
M.prototype.getZoom=M.prototype.getZoom;M.prototype.Bi=function(){var a=this.P.camera,b=this.P.zoom;a.zoom=b===+b?this.P.zoom:a.zoom;return a};M.prototype.getRequestedCameraData=M.prototype.Bi;M.prototype.startControl=M.prototype.va;M.prototype.control=M.prototype.control;M.prototype.endControl=M.prototype.endControl;function Rd(a){Rd.a.constructor.call(this,M.prototype.b.j);this.requested=a}r(Rd,pc);function N(a,b){this.x=+a;this.y=+b}q("H.math.Point",N);N.prototype.set=N;N.prototype.set=N.prototype.set;N.prototype.la=function(a){a?(a.x=this.x,a.y=this.y):a=new N(this.x,this.y);return a};N.prototype.clone=N.prototype.la;N.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};N.prototype.add=N.prototype.add;N.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};N.prototype.sub=N.prototype.sub;N.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};
N.prototype.scale=N.prototype.scale;N.prototype.round=function(){this.x=Na(this.x);this.y=Na(this.y);return this};N.prototype.round=N.prototype.round;N.prototype.floor=function(){this.x=Oa(this.x);this.y=Oa(this.y);return this};N.prototype.floor=N.prototype.floor;N.prototype.ceil=function(){this.x=Pa(this.x);this.y=Pa(this.y);return this};N.prototype.ceil=N.prototype.ceil;N.prototype.M=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};N.prototype.equals=N.prototype.M;
N.prototype.distance=function(a){return Sa(Ta(this.x-a.x,2)+Ta(this.y-a.y,2))};N.prototype.distance=N.prototype.distance;var O={};q("H.geo.mercator",O);O.yg=function(a){return La(1,Ma(0,0.5-Ra(Ya(db+cb*a/180))/bb/2))};O.Bg=function(a){return a/360+0.5};O.sd=function(a,b,c){c?(c.x=O.Bg(b),c.y=O.yg(a)):c=new N(O.Bg(b),O.yg(a));return c};O.latLngToPoint=O.sd;O.se=function(a,b){return O.sd(a.lat,a.lng,b)};O.geoToPoint=O.se;O.Eh=function(a){return 0>=a?90:1<=a?-90:hb*(2*Za(Ua(bb*(1-2*a)))-cb)};O.Dh=function(a){return 360*(1===a?1:jb(a,1))-180};
O.ya=function(a,b,c){c?(c.lat=O.Eh(b),c.lng=O.Dh(a)):c=new A(O.Eh(b),O.Dh(a));return c};O.xyToGeo=O.ya;O.Sg=function(a,b){return O.ya(a.x,a.y,b)};O.pointToGeo=O.Sg;function Sd(a,b){this.projection=a||O;this.r=0;this.Qc=this.exp=Ra(b||256)/ab;Td(this);this.y=this.x=0}q("H.geo.PixelProjection",Sd);Sd.prototype.G=function(a){if(y(a))throw new x(this.G,0,a);var b=this.x/this.w,c=this.y/this.h;this.r=a;this.Qc=this.exp+a;Td(this);this.x=b*this.w;this.y=c*this.h};Sd.prototype.rescale=Sd.prototype.G;function Td(a){30<a.Qc&&(a.Qc=30);a.w=Ta(2,a.Qc);a.h=Ta(2,a.Qc)}Sd.prototype.gg=function(){return this.r||0};Sd.prototype.getZoomScale=Sd.prototype.gg;
Sd.prototype.geoToPixel=function(a,b){var c=this.projection.sd(a.lat,a.lng,b);c.x=c.x*this.w-this.x;c.y=c.y*this.h-this.y;return c};Sd.prototype.geoToPixel=Sd.prototype.geoToPixel;Sd.prototype.pixelToGeo=function(a,b){return this.projection.ya((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};Sd.prototype.pixelToGeo=Sd.prototype.pixelToGeo;Sd.prototype.ya=function(a,b,c){return this.projection.ya((a+this.x)/this.w,(b+this.y)/this.h,c)};Sd.prototype.xyToGeo=Sd.prototype.ya;
Sd.prototype.Fe=function(a,b,c){a=this.projection.sd(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};Sd.prototype.latLngToPixel=Sd.prototype.Fe;Sd.prototype.Cd=function(a){return new N(a.x*this.w-this.x,a.y*this.h-this.y)};Sd.prototype.pointToPixel=Sd.prototype.Cd;function P(a){P.a.constructor.call(this);a=a||{};this.min=0;this.max=22;this.Wh=!!a.dark;a.min&&this.Jd(a.min);a.max&&this.Id(a.max);this.pixelProjection=new Sd(a.projection,a.minWorldSize)}r(P,G);q("H.map.layer.Layer",P);P.prototype.b={j:"update",Df:"minchange",Cf:"maxchange"};P.prototype.Ji=function(a){return this.min<=a&&a<=this.max};P.prototype.isValid=P.prototype.Ji;
P.prototype.Jd=function(a){var b=this.min;if(a!==b){if(y(a))throw new x(P.prototype.Jd,0,"min is NaN");if(a<=this.max)this.min=a,this.dispatchEvent(new qc(this.b.Df,a,b));else throw new x(P.prototype.Jd,0,"min > max");}return this};P.prototype.setMin=P.prototype.Jd;P.prototype.Id=function(a){var b=this.max;if(a!==b){if(y(a))throw new x(P.prototype.Id,0,"max is NaN");if(a>=this.min)this.max=a,this.dispatchEvent(new qc(this.b.Cf,a,b));else throw new x(P.prototype.Id,0,"max < min");}return this};
P.prototype.setMax=P.prototype.Id;P.prototype.$=function(){this.dispatchEvent(this.b.j)};P.prototype.c=function(){P.a.c.call(this)};P.prototype.Ea=function(){return null};P.prototype.getCopyrights=P.prototype.Ea;function Q(a){var b={};Q.a.constructor.call(this,a);this.md=b.previousSibling=b.nextSibling=b;a&&"objects"in a&&this.zb(a.objects)}r(Q,I);q("H.map.Group",Q);Q.prototype.rg=!0;Q.prototype.Zb=function(a,b){var c;(c=Q.a.Zb.call(this,a,b))&&this.forEach(Ud,!0);return c};Q.prototype.setProvider=Q.prototype.Zb;function Ud(a,b,c){a.Zb(c.sa)}Q.prototype.contains=function(a){var b=this===a;if(!b&&this.md.nextSibling!==this.md&&v(a,I))for(;!b&&a;)a===this?b=!0:a=a.O;return b};Q.prototype.contains=Q.prototype.contains;
Q.prototype.Hc=function(){this.Vd=u;this.forEach(Vd,!0)};Q.prototype.resetZInfo=Q.prototype.Hc;function Vd(a){a.Hc()}Q.prototype.v=function(a){var b=Q.a.v.call(this,a);b&&(this.$f=a,this.forEach(Wd,!0),delete this.$f);return b};Q.prototype.invalidate=Q.prototype.v;function Wd(a,b,c){a.v(c.$f)}Q.prototype.forEach=function(a,b,c){for(var d=this.md,e=d.nextSibling,f=0,g;e!==d;)g=e.nextSibling,a.call(c,e,f++,this),b&&v(e,Q)&&e.forEach(a,b,c),e=g};Q.prototype.forEach=Q.prototype.forEach;
Q.prototype.qc=function(a){var b=[];this.forEach(Xd,a,b);return b};Q.prototype.getObjects=Q.prototype.qc;Q.prototype.o=function(){var a=null;this.forEach(function(b){a?b.o?(b=b.o())&&(a=a.ib(b)):a=a.He(b.getPosition()):a=b.o?b.o():Cb([b.getPosition()])});return a};Q.prototype.getBounds=Q.prototype.o;function Xd(a){this.push(a)}Q.prototype.Ri=ib;
Q.prototype.B=function(a){var b=this.md,c=b.previousSibling,d,e;v(a,I,this.B,0);if(a.contains(this))throw new lc(this.B,"The new object contains the parent group");e=a.Zb(this.sa,this.B);if((d=a.O)!==this){if(d){d=a.previousSibling;var f=a.nextSibling;d.nextSibling=f;f.previousSibling=d}a.O=this;I.a.ea.call(a,this);c.nextSibling=a;a.previousSibling=c;a.nextSibling=b;b.previousSibling=a}a.th=this.Ri++;a.Hc();e||a.v(ac);return a};Q.prototype.addObject=Q.prototype.B;
Q.prototype.zb=function(a){var b,c;Aa(a,"Array",this.zb,0,void 0);b=a.length;for(c=0;c<b;c++)this.B(a[c])};Q.prototype.addObjects=Q.prototype.zb;Q.prototype.L=function(a){if(!a||a.O!==this)throw new lc(this.L,"object not found");var b=a.previousSibling,c=a.nextSibling;b.nextSibling=c;c.previousSibling=b;a.O=null;I.a.ea.call(a,null);delete a.previousSibling;delete a.nextSibling;v(a.sa,J)&&a.Zb(null,this.L);return a};Q.prototype.removeObject=Q.prototype.L;
Q.prototype.Vb=function(a){var b,c;Aa(a,"Array",this.Vb,0,void 0);b=a.length;for(c=0;c<b;c++)this.L(a[c])};Q.prototype.removeObjects=Q.prototype.Vb;Q.prototype.Oa=function(){var a=this.qc();this.Vb(a)};Q.prototype.removeAll=Q.prototype.Oa;function Yd(a,b,c){var d=[];1<arguments.length&&d.push(b);2<arguments.length&&d.push("out of ["+c[0]+"..."+c[1]+"]");this.message=(a?xa(a):"")+(d.length?" ("+d.join(" ")+")":"")}q("H.lang.OutOfRangeError",Yd);Yd.prototype=Error();Yd.prototype.name="OutOfRangeError";function Zd(a,b){var c=this;if(!da(b))throw new x($d,1,b);if(!da(a.next||da(a.cycle)))throw new x(Zd,2,'Argument "mode" must implement H.util.AsyncQueue.Mode');this.$g=[];this.Vg=[];this.Oi=a;this.sf=[];this.aj=b;this.bj=function(){ae(c)};this.bf=null;this.lh=function(){c.bf||(c.bf=pa.setTimeout(c.bj,1))}}q("H.util.AsyncQueue",Zd);Zd.prototype.push=function(a,b){if(!da(b))throw new x(this.push,1,b);var c=be((this.sf.length?this.sf.pop():null)||new ce,a,this.lh,b);this.$g.push(c);this.lh();return c};
Zd.prototype.push=Zd.prototype.push;Zd.prototype.cf=function(){ae(this)};function ae(a){var b,c=a.Vg,d=0,e=a.Oi;e.Rf();for(a.bf=null;d<c.length;)b=c[d],b.og?(a.sf.push(b),c.splice(d,1)):d++;for(;b=e.next(a.$g,a.Vg);)b.cancelled?b.lc(null,"cancelled"):(c.push(b),a.aj(b,b.data))}function ce(){be(this,null,null,null)}Zd.Task=ce;function be(a,b,c,d){a.data=b;a.cancelled=!1;a.og=!1;a.Ti=c;a.Ui=d;a.ce=null;return a}ce.prototype.lc=function(a,b){this.og=!0;this.Ti();this.Ui(this,a,b)};
ce.prototype.done=ce.prototype.lc;ce.prototype.cancel=function(){this.ce&&this.ce();this.cancelled=!0};ce.prototype.cancel=ce.prototype.cancel;ce.prototype.ph=function(a){this.ce=a;return this};ce.prototype.setCancelFn=ce.prototype.ph;function de(a,b){de.a.constructor.call(this,new ee(a),b)}r(de,Zd);q("H.util.SequentialQueue",de);function ee(a){if(isNaN(a)||0>a)throw new x(de,1,'Argument "maxTime" must be a positive number');this.Mi=a;this.Nc=fe()}ee.prototype.next=function(a){return a.length&&fe()-this.Nc<this.Mi?a.shift():null};ee.prototype.Rf=function(){this.Nc=fe()};function ge(a,b,c,d,e){void 0===d&&(d=0,e=a.length-1);for(var f,g=b*b,h=0,k=d,l=a[d].x,m=a[d].y,n=a[e].x,w=a[e].y,z=d+1,s,C=l!==n?(w-m)/(n-l):null;z<e;)s=a[z++],f=s.x,s=s.y,h<(f=La(null!==C?Ta(Qa(s-C*f-(m-C*l)),2)/(Ta(C,2)+1):Qa(f-l),Ta(f-l,2)+Ta(s-m,2),Ta(f-n,2)+Ta(s-w,2)))&&(h=f,k=z-1);h>=g||0<c?(d=ge(a,b,c=(c||0)-1,d,k),d.splice(d.length-1,1),d=d.concat(ge(a,b,c,k,e))):d=[a[d],a[e]];return d};function he(a,b,c,d){this.key="";this.x=a;this.y=b;this.z=c;this.data=d;this.valid=!0}q("H.map.provider.Tile",he);function ie(a,b,c,d,e){var f,g,h=a.length,k,l,m,n,w,z,s;if(h){for(f=[];h--;)for(z=a[h],n=z.length,w=0,k=1;k<n;k++)if(s=je(z[k-1],z[k],b,c,d,e))l=s[0],m=s[1],w&&w.M(l)?g.push(m):f.push(g=s),w=m;n=f.length;1<n&&f[0][0].M(f[n-1][f[n-1].length-1])&&f[0].splice.apply(f[0],[0,1].concat(f.splice(n-1,1)[0]))}else f=a;return f}
function je(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;var k,l,m;c=-c;f=-f;if(g>h){if(h>e||g<d)return;l=g;m=a;g=h;a=b;h=l;b=m;l=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;k=1;a=-a;b=-b;m=f;f=-c;c=-m}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);k&&(a=-a,b=-b);return l?[new N(h,-b),new N(g,-a)]:[new N(g,-a),new N(h,-b)]}
function ke(a,b,c,d,e,f){var g={};g.x=a;g.y=b;g.next=c;if(g.ba=d)g.ba.next=g;c&&(g.next.ba=g);g.Ne=null;g.Le=null;g.V=e;g.oe=0;g.Ud=0;g.alpha=f;return g}function le(a){for(;a&&a.V;)a=a.next;return a}function me(a){if(a)for(;a.next;)a=a.next;return a}function ne(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.V||b.V&&b.Ud))}return b}function oe(a){var b=me(a);b.ba.next=a;a.ba=b.ba}function pe(a,b,c,d){return Sa((a-c)*(a-c)+(b-d)*(b-d))}
function qe(a,b,c,d,e,f){var g=a.x+f*(b.x-a.x);f=a.y+f*(b.y-a.y);e.Jf=pe(a.x,a.y,g,f)/pe(a.x,a.y,b.x,b.y);e.Kf=pe(c.x,c.y,g,f)/pe(c.x,c.y,d.x,d.y);e.sj=1*g;e.tj=1*f}
function re(a,b,c,d,e){var f,g;g=(b.x-a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x);var h;if(!g&&(a.yd=a.x,a.$e=a.y,a.x+=(Ka()-0.5)/1E4,a.y+=(Ka()-0.5)/1E4,g=(b.x-a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x),!g))return 0;f=((c.x-a.x)*(d.y-c.y)-(c.y-a.y)*(d.x-c.x))/g;g=((b.y-a.y)*(c.x-a.x)-(b.x-a.x)*(c.y-a.y))/g;if(0>f||1<f||0>g||1<g)return 0;qe(a,b,c,d,e,f);0===e.Jf&&0<=(h=e.Kf)&&1>=h&&(a.yd||(a.yd=a.x,a.$e=a.y),a.x+=(Ka()-0.5)/1E4,a.y+=(Ka()-0.5)/1E4,qe(a,b,c,d,e,f));return 1}
function se(a,b){var c,d,e=0,f;ke(0,a.y,null,null,0,0);d=ke(-2147483648,a.y,null,null,0,0);for(c=b;c.next;c=c.next)(f=re(d,a,c,c.next,{}))&&e++;return e%2}function te(a,b,c){for(;b!==c&&b.alpha<a.alpha;)b=b.next;a.next=b;a.ba=b.ba;a.next.ba=a;a.ba.next=a}function ue(a){for(var b,c=null,d=0,e=a.length;d<e;d++){b=ke(a[d].x,a[d].y,c,null,0,0);if(b.next=c)c.ba=b;c=b}return c};function ve(a,b,c,d,e,f,g){var h=0<d?we:0;ve.a.constructor.call(this,b,c,d,null);this.key=a;this.e=g;this.S=e;this.J=f;this.Eg=h;this.ha=new Sd(u,e);this.ha.G(d);this.ha.x=b*e;this.ha.y=c*e;this.Ma=null;this.rb={};this.n=Bb(this.ha.pixelToGeo(new N(0-h,0-h)),this.ha.pixelToGeo(new N(e+h,e+h)));this.Uh=[new N(-h,-h),new N(this.S+h,-h),new N(this.S+h,this.S+h),new N(-h,this.S+h)]}r(ve,he);q("H.map.provider.SpatialTile",ve);var we=Na(od.MAX_LINE_WIDTH/2)+1,xe=[],ye=[];
function ze(a,b){return nd(md(a),md(b),!1)}ve.prototype.Wb=function(){this.Ma?this.e.fa().Ee(this.gh)&&this.Ma.sort(ze):this.Ma=this.e.Gd(this.n,this.z,!1,!1).sort(ze);return this.Ma};
function Ae(a){var b=a.gh||ib,c=a.e.fa(),d=a.Ma||a.Wb(),e,f,g,h=d.length;a.Ga=!0;a.Ha=!0;if(c.rd(b))if(c.ng(b)||c.sg(b))a.Ga=a.Ha=!1;else if(c.Pb(b)||c.tc(b)){if(c.Pb(b)){e=a.e.Gd(a.n,a.z,!1,!1);f=e.length;if(f!==h)a.Ha=!1;else for(;f--;)g=e[f],a.rb[g.oa]?g.fa().Pb(b)&&(a.Ha=!1):a.Ha=!1;a.Ga&=a.Ha}if(c.tc(b))for(;h--;)c=d[h].fa(),c.rd(b)&&c.tc(b)&&(a.Ga=!1)}else c.Ee(b)&&(a.Ga=!1)}function Be(a){var b=a.data;a.data=null;return b}
ve.prototype.D=function(a,b,c){if(null===this.Ma)return fc;for(var d=this.Ma,e=d.length,f,g,h,k,l=this.rb,m,n,w,z=[],s,C;e--;)if(g=d[e],g.getVisibility(!0)){h=g.Mb();k="none"!==h.strokeColor?h.lineWidth:0;h=(w=v(g,L))&&"none"!==h.fillColor;f=g.oa;m=l[f][1];if(m===xe)h&&z.push(g);else if(m!==ye)for(f=m.length;f--;){n=[];C=m[f].length;for(s=0;s<C;s++)n.push(m[f][s].x,m[f][s].y);n=ob(a,b,n,k,w);if(0!==n&&(3!==n||h)){z.push(g);break}}if(c&&z.length)break}return z};
ve.prototype.qb=function(a){var b=a.getContext("2d"),c=this.Wb(),d=c.length,e,f,g;a.width=a.height=this.S;b.clearRect(0,0,this.S,this.S);if(d){for(e=0;e<d;e++)if(f=c[e],g=f.Mb(),v(f,vd)){var h=b,k=this.rb,k=(k=k&&k[f.oa])&&k[1],l=this.Eg;k||(k=f.clip(this.n),k=Ce(this,k,!1),k=ie(k,-l,-l,this.S+l,this.S+l),k=De(k));this.rb[f.oa]=[f,k];f.getVisibility(!0)&&Ee(k,h,!1,Fe(h,g,this.J),!1)}else if(v(f,L)){var h=b,k=(k=(k=this.rb)&&k[f.oa])&&k[1],m=l=void 0,n=this.Eg,w=void 0,z=void 0,s=void 0,m=w=w=s=m=
l=void 0;if(!k){k=f.clip(this.n,this.ha);k=Ce(this,k,!0);l=f.o();m=f.Fa().fd(!0);w=f.Ob;if(360===l.U()&&1==m%2){var m=w,C=void 0,D=void 0,K=void 0,ga=void 0,s=this.ha,z=we+1,D=C=void 0;k[0][1].x>k[0][k[0].length-1].x&&(k[0]=k[0].reverse());K=[];D=k[0].length-1;for(C=0;C<D;C++)ga=k[0][C],K[C]=new N(ga.x-2*s.w,ga.y),K[C+D]=new N(ga.x-s.w,ga.y),K[C+2*D]=new N(ga.x,ga.y),K[C+3*D]=new N(ga.x+s.w,ga.y),K[C+4*D]=new N(ga.x+2*s.w,ga.y);k[0]=K;C=s.Fe(m?90:-90,0);C.y=m?C.y-z:C.y+z;D=C.la();C.x=k[0][k[0].length-
1].x+1;D.x=k[0][0].x-1;k[0].push(C,D)}m=k.length;z=new N(-n,-n);s=Ge(z,k[0],w);1<m&&(s^=Ge(z,k[1],w));w=ie(k,-n,-n,this.S+n,this.S+n).length;if(0===w)k=s?xe:ye;else if(!this.n.he(l)){l=[];for(w=m;w--;){var m=k[w],D=z=void 0,n=ue(this.Uh),m=ue(m),Ja=K=D=void 0,mb=void 0,yd=mb=void 0,ff=Ja=s=void 0,C=D=D=s=void 0,s={},C=z=1,D=0,D=~~(1*D);switch(D){case 1:C=z=0;break;case 2:z=0;C=1;break;case 3:z=1,C=0}var D=C,C=z,ga=D,zd=void 0,Ad=void 0,Ja=z=void 0;if(m&&n){D=me(m);ke(m.x,m.y,null,D,0,0);K=me(n);ke(n.x,
n.y,null,K,0,0);for(D=m;D.next;D=D.next)if(!D.V)for(K=n;K.next;K=K.next)!K.V&&(zd=le(D.next),Ad=le(K.next),Ja=re(D,zd,K,Ad,s))&&(Ja=s.Jf,ff=s.Kf,mb=s.sj,yd=s.tj,Ja=ke(mb,yd,null,null,1,Ja),mb=ke(mb,yd,null,null,1,ff),Ja.Le=mb,mb.Le=Ja,te(Ja,D,zd),te(mb,K,Ad));s=se(m,n);C&&(s=1-s);for(D=m;D.next;D=D.next)D.V&&(D.oe=s,s=1-s);s=se(n,m);ga&&(s=1-s);for(K=n;K.next;K=K.next)K.V&&(K.oe=s,s=1-s);oe(m);for(oe(n);(s=ne(m))!=m;){for(D=null;!s.Ud;s=s.Le)for(C=s.oe;;)if(D=ke(s.x,s.y,D,null,0,0),s.Ud=1,s=C?s.next:
s.ba,s.V){s.Ud=1;break}D.Ne=z;z=D}m=z}else m=void 0;if(m)for(s=He(m),l.push(s);m.Ne;)m=m.Ne,s=He(m),l.push(s)}k=l}k=De(k)}this.rb[f.oa]=[f,k];f.getVisibility(!0)&&(k===xe&&Ie(h,g)?h.fillRect(0,0,this.S,this.S):k!==ye&&Ee(k,h,!0,Fe(h,g,this.J),Ie(h,g)))}this.data=a}this.Ga=this.Ha=!0;this.gh=this.e.fa().Bb;return 0<d};function De(a){for(var b=a.length;b--;)a[b]=ge(a[b],0.6,2);return a}
function Ge(a,b,c){for(var d=b.length,e=1,f=0,g=b[0],h,k;e<d;e++)h=b[e],k=g.y+(a.x-g.x)/(h.x-g.x)*(h.y-g.y),La(g.x,h.x)<=a.x&&Ma(g.x,h.x)>=a.x&&(c?k>a.y:k<a.y)&&f++,g=h;return 0<f%2}function He(a){var b=[],c,d=a,e,f;do{e=Na(100*(d.yd?d.yd:d.x))/100;f=Na(100*(d.$e?d.$e:d.y))/100;if(!c||0.01<Sa(Ta(c.x-e,2)+Ta(c.y-f,2)))c=new N(e,f),b.push(c);d=d.next}while(d&&d!==a);return b}
function Fe(a,b,c){var d,e,f;if(f="none"!==(d=b.strokeColor)&&0<(e=b.lineWidth))a.strokeStyle=d,a.lineWidth=e*c,a.lineCap=b.lineCap,a.lineJoin=b.lineJoin,a.miterLimit=b.miterLimit,b.lineDash!==fc&&a.setLineDash&&(a.setLineDash(b.lineDash),a.lineDashOffset=b.lineDashOffset);return f}function Ie(a,b){var c,d;if(d="none"!==(c=b.fillColor))a.fillStyle=c;return d}
function Ee(a,b,c,d,e){var f,g,h,k,l;if(d||e)for(f=a.length,k=0;k<f;k++)if(g=a[k],h=g.length){b.beginPath();b.moveTo(g[0].x,g[0].y);for(l=1;l<h;l++)b.lineTo(g[l].x,g[l].y);c&&(b.closePath(),e&&b.fill());d&&b.stroke()}}function Ce(a,b,c){var d=[],e=b.length,f,g;for(f=0;f<e;f++)g=b[f],g.length&&d.push(Je(a,g,c,a.ha));return d}function Je(a,b,c,d){var e,f=[],g=b.length,h=0;a.Ah=0;for(e=e||0;h<g;)f.push(Ke(a,b[h++],b[h++],e,d));c&&f.push(Ke(a,b[0],b[1],e,d));return f}
function Ke(a,b,c,d,e){var f=a.Ah;f&&180<Qa(f-c)&&(c+=0>f?-360:360);a.Ah=c;return e.Fe(b,c+d)};var Le,Me=function(){function a(){}for(var b,c,d,e=ta("o ms moz webkit "),f=5;f--&&!b;)b=e[f],b=(c=pa[b+(b?"R":"r")+"equestAnimationFrame"])&&!y(c.call(window,a))&&(d=pa[b+(b?"C":"c")+"ancelAnimationFrame"]);Le=b?function(a){return c.call(pa,a)}:function(a){return pa.setTimeout(a,25)};return b?function(a){return d.call(pa,a)}:function(a){return pa.clearTimeout(a)}}(),fe=pa.performance&&pa.performance.now?function(){return pa.performance.now()}:function(){return Date.now()};function Ne(a){a=a||{};this.min=a.min||0;this.max=a.max||22;this.uid=""+cc++;Ne.a.constructor.call(this)}r(Ne,G);q("H.map.provider.Provider",Ne);Ne.prototype.b={j:"update"};Ne.prototype.$=function(){this.dispatchEvent(this.b.j)};Ne.prototype.c=function(){G.prototype.c.call(this)};Ne.prototype.Ea=function(){return null};Ne.prototype.getCopyrights=Ne.prototype.Ea;function R(a,b,c){if(!(0<=a))throw new x(R,0,a);if(b&&!da(b))throw new x(R,1,b);if(c&&!da(c))throw new x(R,2,c);this.Ge=+a;this.Ba=0;this.Lg=b;this.filter=c;this.d={};this.uc=this.Ib=null}q("H.util.Cache",R);R.prototype.add=function(a,b,c){if(c!=+c||0>c)throw new x(this.add,2,c);var d=this.d[a],e=!0;this.filter&&(e=this.filter(a,b,c));d?e?(this.Ba+=c-d.size,d.size=c,d.data=b,Oe(this,d)):this.ua(d,!0):e&&(this.d[a]=Pe(this,{id:a,data:b,size:c,Sb:null,Na:null},this.Ib));Qe(this);return e};
R.prototype.add=R.prototype.add;R.prototype.get=function(a,b){var c=b?this.d[a]:Oe(this,this.d[a]);return c&&c.data};R.prototype.get=R.prototype.get;R.prototype.le=function(a){var b;(b=this.d[a])&&this.ua(b,!0)};R.prototype.drop=R.prototype.le;R.prototype.forEach=function(a,b,c){var d,e;for(e in this.d)d=this.d[e],(c?c(e,d.data,d.size):1)&&a.call(b,e,d.data,d.size)};R.prototype.Oa=function(a){var b,c;for(c in this.d)b=this.d[c],(a?a(c,b.data,b.size):1)&&this.ua(this.d[c],!0)};
R.prototype.removeAll=R.prototype.Oa;R.prototype.mj=function(a){this.Ge=a;Qe(this);return this};R.prototype.setMaxSize=R.prototype.mj;R.prototype.wi=function(){return this.Ge};R.prototype.getMaxSize=R.prototype.wi;R.prototype.mi=function(){return this.Ba};R.prototype.getCurrentSize=R.prototype.mi;function Oe(a,b){b&&(a.Ib=Pe(a,b,a.Ib));return b}function Qe(a){for(;a.Ba>a.Ge&&a.uc;)a.ua(a.uc,!0)}
function Pe(a,b,c){if(c!==b){(b.Sb||b.Na)&&a.ua(b);if(b.Sb=c)b.Na=c.Na,c.Na=b;b.Na||(a.Ib=b);b.Sb||(a.uc=b);a.Ba+=b.size}return b}R.prototype.ua=function(a,b){var c=a.Na,d=a.Sb;if(c||d||a==this.Ib&&a==this.uc)c?c.Sb=d:this.Ib=d,d?d.Na=c:this.uc=c,this.Ba-=a.size,b&&(this.Lg&&this.Lg(a.id,a.data,a.size),delete this.d[a.id]);a.Sb=a.Na=null;return a};function Re(a){var b;wa(this,Re);Re.a.constructor.call(this,a);if("tileSize"in a){b=Ra(+a.tileSize)/ab;if(isNaN(b)||b%1||0>b||30<b)throw new x(Re,0,"tileSize: "+a.tileSize);this.tileSize=+a.tileSize}}r(Re,Ne);q("H.map.provider.TileProvider",Re);function Se(a,b,c,d){return a.uid.concat("_",b,"_",c,"_",d)}Re.prototype.tileSize=256;function Te(a,b){Te.a.constructor.call(this,b);this.e=a;this.J=b.pixelRatio;this.tileSize*=Na(this.J);this.Ye=t(this.Ye,this);this.Se=t(this.Se,this);this.hf=t(this.hf,this);this.Ze=t(this.Ze,this);this.e.addEventListener(this.e.b.j,this.$,!1,this);this.e.addEventListener(this.e.b.j,this.$,!1,this);this.Fb=[];this.Pc=new R(b.tileCacheSize||256,this.Ye);this.cd=new R(b.dataCacheSize||512,this.Se);this.fh=new de(20,this.hf);this.lb={};this.wg=fe()}r(Te,Re);q("H.map.provider.SpatialTileProvider",Te);
Te.prototype.ca=function(a,b,c,d){var e=Se(this,a,b,c),f;if(f=this.Pc.get(e,d)){var g;(g=d)||(g=f,g.Ga&&Ae(g),g=g.Ga);if(g)return f;d||this.Pc.le(e)}if(f=this.cd.get(e,d)){(g=d)||(g=f,g.Ha&&Ae(g),g=g.Ha);if(g)return a=this.Fb.pop()||document.createElement("canvas"),f.qb(a)||this.Fb.push(a),this.Pc.add(e,f,1),f;d||this.cd.le(e)}d||((f=this.lb[e])?f.count++:(f=this.fh.push([e,a,b,c],this.Ze),f.count=1,this.lb[e]=f))};Te.prototype.requestTile=Te.prototype.ca;
Te.prototype.cf=function(){var a=fe();33<a-this.wg&&(this.fh.cf(),this.wg=a)};Te.prototype.Aa=function(a,b,c){this.Zc(Se(this,a,b,c))};Te.prototype.cancelTile=Te.prototype.Aa;Te.prototype.Zc=function(a){var b;if(b=this.lb[a])b.count--,b.count||(b.cancel(),delete this.lb[a])};Te.prototype.cancelTileByKey=Te.prototype.Zc;p=Te.prototype;
p.hf=function(a,b){var c=new ve(b[0],b[1],b[2],b[3],this.tileSize,this.J,this.e),d=this.Fb.pop()||document.createElement("canvas");c.qb(d)||this.Fb.push(d);b.push(c);a.lc(c)};p.Ze=function(a,b){var c=a.data[0];b&&this.Pc.add(c,b,1);delete this.lb[c];this.$()};p.Ye=function(a,b){b.data&&this.Fb.push(Be(b));this.cd.add(a,b,1)};p.Se=function(a,b){b.rb={};b.Ma=null};p.c=function(){for(var a in this.lb)this.lb[a].cancel();this.Pc.Oa();this.cd.Oa();this.Fb.length=0;Te.a.c.call(this)};function Ue(a,b){Ue.a.constructor.call(this,new Ve(a),b)}r(Ue,Zd);q("H.util.ParallelQueue",Ue);function Ve(a){if(isNaN(a)||0>a)throw new x(Ue,1,'Argument "maxParallel" must be a positive number');this.Li=a}Ve.prototype.next=function(a,b){return a.length&&b.length<this.Li?a.shift():null};Ve.prototype.Rf=function(){};function We(a,b,c){var d=this;this.jj=new Ue(a||6,function(a){Xe(d,a)});this.jc=c||document;this.Ve=t(this.Ve,this);this.qe=null;b&&(this.wd=this.Qi)}q("H.net.ImageLoader",We);We.prototype.load=function(a,b,c,d){if(!a||!ca(a))throw new x(We.prototype.load,0,a);if(!da(b))throw new x(We.prototype.load,1,b);if(c&&!da(c))throw new x(We.prototype.load,2,c);return this.jj.push({url:a,Rh:b,Yf:c,crossOrigin:d},this.Ve)};We.prototype.load=We.prototype.load;
We.prototype.Ve=function(a,b,c){b?a.data.Rh(b):a.data.Yf&&a.data.Yf(c||"failed")};function Xe(a,b){var c=b.data,d;d=a.wd(function(){var c=d.element;c.ownerDocument!==a.jc&&(d.element=c=a.jc.importNode(c,!0));b.lc(c,null)},function(a){b.lc(null,a)});b.ph(d.cancel);c.crossOrigin&&(d.element.crossOrigin=c.crossOrigin);d.element.src=c.url}
We.prototype.wd=function(a,b){var c=this.jc.createElement("img");c.onload=a;c.onerror=b;return{element:c,cancel:function(){c.onerror=c.onload=null;c.removeAttribute("src");b("cancelled")}}};We.prototype.Qi=function(a,b){this.qe||(this.qe=new Ye(this.jc));return this.qe.wd(a,b)};function Ye(a){this.frame=a.createElement("iframe");this.frame.style.display="none";this.rf=[];this.jc=a;a.body.appendChild(this.frame)}
Ye.prototype.wd=function(a,b){var c=this,d=this.rf.pop()||this.frame.contentDocument.createElement("iframe"),e,f;f=function(a){e.onload=e.onerror=null;c.rf.push(d);b(a)};d.parentNode||this.frame.contentDocument.body.appendChild(d);e=new d.contentWindow.vj;e.onload=function(){e.onload=e.onerror=null;c.rf.push(d);a()};e.onerror=f;return{element:e,cancel:function(){d.contentWindow.stop();f("cancelled")}}};var Ze=new We;q("H.net.images",Ze);function $d(a){Ne.call(this,a);if(!a||!da(a.getURL))throw new x($d,0,"options.getURL");this.Ei=a.getURL;this.tileSize=a.tileSize||256;this.Vh=a.crossOrigin;this.Eb=t(this.Eb,this);this.Be=t(this.Be,this);this.da={}}r($d,Re);q("H.map.provider.ImageTileProvider",$d);var $e=new R(65536);$d.cache=$e;$d.prototype.c=function(){var a,b;for(a in this.da)this.da.hasOwnProperty(a)&&(b=this.da[a])&&(b.cancel(),delete this.da[a]);$e.Oa(this.Eb);Ne.prototype.c.call(this)};
$d.prototype.Eb=function(a){return+ta(a,"_")[0]===this.uid};$d.prototype.cacheFilter=$d.prototype.Eb;$d.prototype.Be=function(a,b){b.valid=!1};
$d.prototype.ca=function(a,b,c,d){var e=this,f,g;if(y(a=+a))throw new x(this.ca,0,a);if(y(b=+b))throw new x(this.ca,0,b);if(y(c=+c))throw new x(this.ca,0,c);c=~~c;f=Se(this,a,b,c);g=$e.get(f);g&&g.valid||d||this.da[f]||(d=this.Ei(a,b,c))&&(this.da[f]=Ze.load(d,function(d){delete e.da[f];g=new he(a,b,c,d);g.key=f;$e.add(f,g,e.tileSize);e.$()},function(){delete e.da[f]},this.Vh));return g};$d.prototype.requestTile=$d.prototype.ca;$d.prototype.Zc=function(a){(a=this.da[a])&&a.cancel()};
$d.prototype.cancelTileByKey=$d.prototype.Zc;$d.prototype.Aa=function(a,b,c){this.cancelTileByKey(Se(this,a,b,c))};$d.prototype.cancelTile=$d.prototype.Aa;$d.prototype.reload=function(a){var b;a?$e.Oa(this.Eb):$e.forEach(this.Be,this,this.Eb);for(b in this.da)this.da[b].cancel();this.$()};$d.prototype.reload=$d.prototype.reload;function af(a,b,c,d){this.left=+a;this.top=+b;this.right=+c;this.bottom=+d}q("H.math.Rect",af);af.prototype.set=af;af.prototype.set=af.prototype.set;af.prototype.bb=function(){return this.Rc||(this.Rc=new N(this.left,this.top))};af.prototype.getTopLeft=af.prototype.bb;af.prototype.Ya=function(){return this.gc||(this.gc=new N(this.right,this.bottom))};af.prototype.getBottomRight=af.prototype.Ya;af.prototype.Of=function(a,b){return this.left<=a&&this.right>=a&&this.top<=b&&this.bottom>=b};
af.prototype.containsXY=af.prototype.Of;function bf(a,b){return new af(a.x,a.y,b.x,b.y)}af.fromPoints=bf;af.prototype.la=function(){return new af(this.left,this.top,this.right,this.bottom)};af.prototype.clone=af.prototype.la;function S(a,b){var c=b||{};if(!a)throw new x(S,0,a);this.$=t(this.$,this);this.e=a;this.e.addEventListener(this.e.b.j,this.$,!1,this);this.tileSize=a.tileSize;this.Rd={};this.opacity=c.opacity||1;this.placeAtOnce=c.placeAtOnce;P.call(this,{min:this.e.min,max:this.e.max,minWorldSize:this.tileSize,projection:c.Dj,dark:c.dark})}r(S,P);q("H.map.layer.TileLayer",S);S.prototype.gd=function(){return this.e};S.prototype.getProvider=S.prototype.gd;
S.prototype.kd=function(a,b){if(!v(a,af))throw new x(this.kd,0,a);if(y(b=+b))throw new x(this.kd,1,b);var c=Ta(2,Oa(b)),d=this.tileSize,e,f;e=Oa(a.left/d);e===c&&(e-=1);f=Oa(a.right/d);f===c&&(f-=1);return new af(e,kb(Oa(a.top/d),0,c-1),f,kb(Oa(a.bottom/d),0,c-1))};S.prototype.getTileBounds=S.prototype.kd;function cf(a,b){return b[4]-a[4]}
S.prototype.hd=function(a,b,c,d,e){if(!v(a,af))throw new x(this.hd,0,a);if(y(c=+c))throw new x(this.hd,1,c);var f=Oa(c),g=Ta(2,f);c=[];var h=0,k={},l=a.left,m=a.top,n=a.right,w=n+(b?g+(n===a.left?0:1):1),z=a.bottom,s;b=[];for(var C=this.e,D=C.requestTile,n=l+(1+n-l)/2+e.x/this.tileSize-0.5,K=m+(1+z-m)/2+e.y/this.tileSize-0.5;l<w;){for(m=a.top;m<=z;)e=l%g,k[Se(C,e,m,f)]=!0,b.push([e,m,f,d,Qa(n-l)+Qa(K-m)]),m++,h++;l++}if(h)for(d||b.sort(cf),a=h;a--;)(s=D.apply(C,b[a]))&&c.push(s);if(!d){for(var ga in this.Rd)this.Rd.hasOwnProperty(ga)&&
this.Rd[ga]&&!k[ga]&&this.e.cancelTileByKey(ga);this.Rd=k}return{total:h,tiles:c}};S.prototype.getProviderTiles=S.prototype.hd;S.prototype.Qa=function(a,b,c,d){if(!v(a,B))throw new x(this.Qa,0,a);if(y(b=+b))throw new x(this.Qa,1,b);var e;b=Oa(b);this.pixelProjection.G(b);a=this.re(a);e=this.kd(a,b);return this.hd(e,a.left>a.right,b,c,d)};S.prototype.requestTiles=S.prototype.Qa;
S.prototype.re=function(a,b){var c,d=this.pixelProjection,e;if(!v(a,B))throw new x(this.re,0,a);y(b)||(c=d.gg(),d.G(b));e=bf(d.geoToPixel(a.bb()),d.geoToPixel(a.Ya()));!y(c)&&d.G(c);return e};S.prototype.geoRectToRect=S.prototype.re;S.prototype.ca=function(a,b,c,d){this.e.requestTile(a,b,c,d)};S.prototype.requestTile=S.prototype.ca;S.prototype.Aa=function(a,b,c){this.e.cancelTile(a,b,c)};S.prototype.cancelTile=S.prototype.Aa;
S.prototype.Ea=function(a,b){return this.e.getCopyrights?this.e.getCopyrights(a,b):null};S.prototype.getCopyrights=S.prototype.Ea;function df(a,b){var c=this;this.ac=new Te(a,b);this.tb=new S(this.ac,{opacity:1});b.minWorldSize=this.ac.tileSize;df.a.constructor.call(this,b);this.opacity=this.tb.opacity;this.tileSize=this.tb.tileSize;this.e=a;this.Xi=function(){c.$()};this.ac.addEventListener(this.ac.b.j,this.Xi)}r(df,P);q("H.map.layer.ObjectLayer",df);var ef={markers:fc,total:0};df.prototype.Gc=function(a,b,c){var d=this.e,e;return d.ef()&&(e=d.Gc(a,b,!0,c)).length?{markers:e,total:e.length}:ef};
df.prototype.requestMarkers=df.prototype.Gc;df.prototype.Fc=function(a,b,c){var d=this.e,e;return d.df()&&(e=d.Fc(a,b,!0,c)).length?{markers:e,total:e.length}:ef};df.prototype.requestDomMarkers=df.prototype.Fc;var gf={tiles:fc,total:0};df.prototype.Qa=function(a,b,c,d){var e;this.e.ff()?(e=this.tb.Qa(a,b,c,d),c||(this.ac.cf(),e=this.tb.Qa(a,b,!0,d))):e=gf;return e};df.prototype.requestTiles=df.prototype.Qa;df.prototype.ca=function(a,b,c,d){return this.tb.ca(a,b,c,d)};df.prototype.requestTile=df.prototype.ca;
df.prototype.Aa=function(a,b,c){this.tb.Aa(a,b,c)};df.prototype.cancelTile=df.prototype.Aa;df.prototype.c=function(){this.ac.k();this.tb.k();df.a.c.call(this)};function T(a,b){var c=b||{},d,e;if(!v(a,Element))throw new x(T,0,a);d=a.ownerDocument.createElement("div");this.t=a;T.a.constructor.call(this);this.padding=new af(0,0,0,0);this.center=new N(0,0);this.margin=0;this.element=d;d.style.zIndex=0;d.style.height=d.style.width="100%";d.style.position="relative"===a.style.position?"absolute":"relative";this.resize();a.appendChild(d);(e=c.padding)!==u&&this.mf(e.top,e.right,e.bottom,e.left);this.lf((e=c.margin)!==u?e:0);(e=c.fixedCenter)!==u&&(this.Zf=!!e)}
r(T,G);q("H.map.ViewPort",T);T.prototype.b={j:"update",ec:"sync"};T.prototype.Zf=!0;T.prototype.lf=function(a){if(this.margin!==+a){if(y(this.margin=+a))throw new x(this.lf,0,a);hf(this);this.dispatchEvent(this.b.j)}};T.prototype.setMargin=T.prototype.lf;T.prototype.mf=function(a,b,c,d){var e=this.padding;if(e.top!==a||e.right!==b||e.bottom!==c||e.left!==d){if(y(a+b+c+d))throw new x(this.mf);e.top=a;e.right=b;e.bottom=c;e.left=d;hf(this);this.dispatchEvent(this.b.j)}};T.prototype.setPadding=T.prototype.mf;
function hf(a){var b=a.padding;a.center.set((a.width+b.left-b.right)/2<<0,(a.height+b.top-b.bottom)/2<<0)}T.prototype.resize=function(){var a=this.t.offsetWidth,b=this.t.offsetHeight;if(this.width!==a||this.height!==b)this.Si=new jf(this.width,this.height),this.width=a,this.height=b,hf(this),this.dispatchEvent(this.b.j)};T.prototype.resize=T.prototype.resize;T.prototype.Qd=function(a){this.dispatchEvent(new Md(this.b.ec,this.Si,a,Md.prototype.SIZE))};
T.prototype.c=function(){pa.clearTimeout(this.Sh);this.Sh=null;this.t.removeChild(this.element);this.element=this.t=null;T.a.c.call(this)};T.prototype.startInteraction=T.prototype.wa;T.prototype.interaction=T.prototype.pa;T.prototype.endInteraction=T.prototype.endInteraction;function kf(a){wa(this,kf);kf.a.constructor.call(this,a);this.hb=new F}r(kf,Ne);q("H.map.provider.ObjectProvider",kf);kf.prototype.fa=function(){return this.hb};kf.prototype.getInvalidations=kf.prototype.fa;kf.prototype.rc=function(a,b){var c;b!==Wb&&(c=this.hb.Bb+1,this.hb.update(c,b),a.fa().update(c,b),this.$())};kf.prototype.invalidateObject=kf.prototype.rc;kf.prototype.ff=dc;kf.prototype.requestSpatials=kf.prototype.Gd;kf.prototype.ef=dc;kf.prototype.df=dc;function jf(a,b){this.w=+a;this.h=+b}q("H.math.Size",jf);function U(a,b){var c,d;U.a.constructor.call(this);if(b){c="size";if(c in b){d=b[c];if(!d||isNaN(d.w)||isNaN(d.h))throw new x(U,1,c);this.$b=new jf(d.w,d.h)}c="anchor";if(c in b){d=b[c];if(!d||isNaN(d.x)||isNaN(d.y))throw new x(U,1,c);this.fc=new N(d.x,d.y)}c="hitArea";c in b&&(d=b[c],v(d,lf,U,1),this.Ae=b[c]);c="asCanvas";c in b&&(d=b[c],this.ae=!(d!==u&&!b[c]))}c=a;switch(mf[Ba(c)]){case 2:nf(this,c,!1);this.za=c;this.Q=1;break;case 1:if(kc(c)){nf(this,c,!0);this.za=this.ae?of(this,c):c;this.Q=
1;break}c=c.src;case 0:if(c){/^<svg/.test(c)&&(c="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(c));this.Q=0;this.nd=Ze.load(c,t(this.Ng,this),t(this.Vi,this));break}default:throw this.Q=-1,new x(U,0,"No image data");}}r(U,G);q("H.map.Icon",U);U.prototype.Mh={ERROR:-1,LOADING:0,READY:1};U.prototype.State=U.prototype.Mh;U.prototype.Q=0;U.prototype.getState=function(){return this.Q};U.prototype.getState=U.prototype.getState;U.prototype.b={Ff:"statechange"};U.prototype.ae=!0;
function of(a,b){var c=document.createElement("CANVAS");c.getContext("2d").drawImage(b,0,0,c.width=a.$b.w,c.height=a.$b.h);return c}U.prototype.za=sa;U.prototype.ji=function(){return this.za};U.prototype.getBitmap=U.prototype.ji;var mf={String:0,HTMLImageElement:1,HTMLCanvasElement:2};U.prototype.$b=sa;U.prototype.ab=function(){return this.$b};U.prototype.getSize=U.prototype.ab;U.prototype.fc=sa;U.prototype.fi=function(){return this.fc};U.prototype.getAnchor=U.prototype.fi;
function nf(a,b,c){var d,e,f,g,h;if(d=a.$b)e=d.w,c=d.h;else{e=b.naturalWidth||b.width;if(0===e&&c&&bc){f=!0;if(g=b.parentNode)h=b.nextSibling;document.body.appendChild(b)}a.$b=new jf(e=b.naturalWidth||b.width,c=b.naturalHeight||b.height);f&&(g?g.insertBefore(b,h):document.body.removeChild(b))}a.fc||(a.fc=new N(e/2|0,c))}U.prototype.Ae=sa;U.prototype.ni=function(){return this.Ae};U.prototype.getHitArea=U.prototype.ni;
U.prototype.Ng=function(a){if(kc(a))delete this.nd,nf(this,a,!0),this.za=this.ae?of(this,a):a,this.Q=1,this.dispatchEvent(this.b.Ff);else{var b=this;setTimeout(function(){b.Ng(a)},0)}};U.prototype.Vi=function(){this.Q=-1;this.dispatchEvent(this.b.Ff);delete this.nd};U.prototype.c=function(){U.a.c.call(this);this.za?(this.za.removeAttribute("src"),delete this.za):this.nd&&this.nd.cancel()};function J(a){var b=new Q({provider:this});J.a.constructor.call(this,a);this.jh=b;b.ea(this);this.Ld=new Rb;this.xc=new Rb;this.dd=new Rb}r(J,kf);q("H.map.provider.LocalObjectProvider",J);J.prototype.Lb=function(){return this.jh};J.prototype.getRootGroup=J.prototype.Lb;J.prototype.rc=function(a,b){b&Xb&&this.B(a);J.a.rc.call(this,a,b)};J.prototype.invalidateObject=J.prototype.rc;
J.prototype.B=function(a){var b;v(a,I,this.B,0);if(a.sa!==this)throw new lc(this.B,"foreign object");this.L(a);if(v(a,pf))b=a.getPosition(),b=this.xc.pd(new A(b.lat,b.lng));else if(v(a,qf))b=a.getPosition(),b=this.dd.pd(new A(b.lat,b.lng));else{b=this.Ld;var c=a.o(),d=c.bb(),e=c.Ya();b=(c=c.Nb())?b.gb(d.lat,e.lng,e.lat,d.lng,c):b.gb(d.lat,d.lng,e.lat,e.lng,c)}b.yf=a;a.wf=b};J.prototype.addObject=J.prototype.B;
J.prototype.L=function(a){var b;if(a)if(a.sa!==this){if(v(a,I))throw new lc(this.B,"foreign object");}else if(b=a.wf)(v(a,pf)?this.xc:v(a,qf)?this.dd:this.Ld).remove(b),delete b.yf,delete a.wf};J.prototype.removeObject=J.prototype.L;
J.prototype.Wb=function(a,b,c,d){var e,f,g,h;if(a.Hb){h=a!==this.xc;d=!d;a=Vb(a,b);f=0;b=a.length;for(e=0;e<b;e++){g=a[e].yf;for(var k=Na(c),l=g,m=void 0;(m=l.Hg<=k&&l.Gg>=k)&&(l=l.O););m&&(d||g.getVisibility(!0))&&(h||1===g.icon.getState())&&(a[f++]=g)}a.length=f}else a=fc;return a};J.prototype.ff=function(){return 0<this.Ld.Hb};J.prototype.providesSpatials=J.prototype.ff;J.prototype.Gd=function(a,b,c,d){return this.Wb(this.Ld,a,b,c,d)};J.prototype.requestSpatials=J.prototype.Gd;
J.prototype.ef=function(){return 0<this.xc.Hb};J.prototype.providesMarkers=J.prototype.ef;J.prototype.Gc=function(a,b,c,d){return this.Wb(this.xc,a,b,c,d)};J.prototype.requestMarkers=J.prototype.Gc;J.prototype.df=function(){return 0<this.dd.Hb};J.prototype.providesDomMarkers=J.prototype.df;J.prototype.Fc=function(a,b,c,d){return this.Wb(this.dd,a,b,c,d)};J.prototype.requestDomMarkers=J.prototype.Fc;J.prototype.c=function(){this.jh.Oa();J.a.c.call(this)};function rf(a,b,c,d,e){rf.a.constructor.call(this);this.Dc={};this.yc={};this.ma=a;this.zd=a.ownerDocument;this.Ub=1;this.wb=Na(b/d)||1;this.eb=Na(c/d)||1;this.J=d;this.g=this.zd.createElement("div");sf(this,this.wb,this.eb);this.g.style.position="absolute";this.ma.appendChild(this.g);this.Wi=e}r(rf,mc);p=rf.prototype;p.pf=function(a,b){this.wb=a||1;this.eb=b||1;sf(this,a,b)};
function sf(a,b,c){1===b&&1===c?(a.g.style.width="100%",a.g.style.height="100%"):(a.g.style.width=b+"px",a.g.style.height=c+"px")}p.ab=function(){return{width:this.wb,height:this.eb,I:this.J}};p.setOpacity=function(a){this.Ub=a;this.g.style.opacity=a};
p.Gb=function(a,b,c,d,e,f){var g=this.J,h=this.Dc[b];d/=g;c/=g;e/=g;f/=g;g=h&&h.x===c&&h.y===d;h&&g?this.yc[b]=this.Dc[b]:(h?h=h.zc:(h=a,h.style.position="absolute",e&&(h.style.width=e+"px"),f&&(h.style.height=f+"px"),this.g.appendChild(h)),a="matrix("+[1,0,0,1,c,d].join()+")",h.style.webkitTransform=a,h.style.Bj=a,h.style.Cj=a,h.style.msTransform=a,h.style.transform=a,this.yc[b]={zc:h,x:c,y:d,w:e,h:f})};
function tf(a){var b,c;for(b in a.Dc)a.yc[b]||(c=a.Dc[b].zc,a.Wi(c),a.g.removeChild(c));a.Dc=a.yc;a.yc={}}p.clear=function(){tf(this)};p.c=function(){this.ma.removeChild(this.g);this.g=this.ma=null;uf.a.c.call(this)};function vf(a,b,c){var d=b.ab();c=c||{};this.ma=b.ma;this.td=a;this.zd=b.ma.ownerDocument;this.kc=new rf(this.ma,d.width,d.height,d.I,this.Th);this.J=d.I;this.g=b;this.Cc={};this.ee={};this.ze=!1;this.Bd=[];this.mc=c&&c.enableSubpixelRendering}r(vf,mc);p=vf.prototype;p.Fh=function(a,b){return a.ad(b)};
p.qb=function(a,b,c,d,e,f){var g=this.td,h=g.max,k,l,m,n,w=this.Cc,z=this.ee,s=this.mc,C=0,D,K;k=this.g;l=this.kc;n=g.opacity;var ga=this.zd;if(d<g.min||d>h)return!0;h=g.Gc(a,d,e,f).markers.sort(this.Fh);h=h.concat(g.Fc(a,d,e,f).markers.sort(this.Fh));a=h.length;this.ze=!1;this.Cc={};this.Bd=[];this.ee={};k.Ub!==n&&k.setOpacity(n);for(l.Ub!==n&&l.setOpacity(n);C<a;C++)if(k=h[C],d=k.icon){l=k.oa;e=k.fa();n=e.Bb;g=k.getPosition();f=c;g=f.geoToPixel(new A(g.lat,g.lng));f=f.w;g.x-=Na(g.x/f)*f;g=g.add(b);
f=s?g.x:Na(g.x);g=s?g.y:Na(g.y);if(v(k,qf)){if(m=w[l])K=m.zc;D=m?m.qd:ib;if(m&&!e.tc(m.qd)&&e.Pb(m.qd))n=m.qd;else if(!m||e.rd(D)&&!e.Pb(D))K=d.pc(k,ga),K.Xd=k,K.xf=d,this.ee[l]=d;K.style.zIndex=""+C;this.kc.Gb(K,l+"-"+n,f,g,0,0);this.ze=!0}else K=d.za,m=d.ab(),e=m.w,m=m.h,D=d.fc,f-=D.x,g-=D.y,this.g.Gb(K,l+"-"+n,f,g,e,m),this.Bd.push([l,new af(f,g,f+e,g+m)]);this.Cc[l]={marker:k,qd:n,zc:K,icon:d}}for(var Ja in z)c=z[Ja],(b=this.Cc[Ja])&&b.icon===c&&c.Re&&c.Re(b.zc,c,b.marker);tf(this.kc);return!0};
p.Th=function(a){var b=a.xf,c=a.Xd;delete a.xf;delete a.Xd;b.Ue&&b.Ue(a,b,c)};
p.D=function(a,b,c){var d;if(isNaN(a)||isNaN(b))throw new x(vf.prototype.D,isNaN(a)?0:1);var e,f,g,h,k,l,m,n,w;e=a/this.J;f=b/this.J;if(this.ze){g=this.zd;h=g.documentElement;k=this.kc.g;l=k.getBoundingClientRect();e+=l.left;for(f+=l.top;(n=l=g.elementFromPoint(e,f))&&n!==k&&n!==h;){for(;(w=n.parentNode)&&(!da(w.contains)||!w.contains(k));)n=w;if(w===k&&(n!==l||"svg"!==n.nodeName)&&((d||(d=[])).push(n.Xd),c))break;m||(m=[]);l=n.style;m.push({Sf:l.getPropertyValue("display"),Zh:l.getPropertyPriority("display"),
style:l});l.setProperty("display","none","important")}if(m)for(f=m.length;f--;)e=m[f],e.style.removeProperty("display"),ca(e.Sf)&&e.style.setProperty("display",e.Sf,e.Zh)}d=d||fc;return 0!==d.length&&c?d:d.concat(wf(this,a,b,c))};function wf(a,b,c,d){for(var e=[],f,g,h=!1,k=a.Bd.length,l=a.Bd,m=a.Cc;k--;)if(f=l[k][0],a=l[k][1],a.Of(b,c)){g=m[f].marker;f=g.icon.Ae;if(!f||f.hg(b-a.left,c-a.top))e.push(g),h=!0;if(d&&h)break}return e}p.c=function(){this.kc.k();vf.a.c.call(this)};function V(a,b){if(y(this.x=+a))throw new x(V,0,a);if(y(this.y=+b))throw new x(V,1,b);}q("H.math.Vector",V);V.prototype.add=function(a){return new V(this.x+a.x,this.y+a.y)};V.prototype.add=V.prototype.add;V.prototype.oj=function(a){return new V(this.x-a.x,this.y-a.y)};V.prototype.subtract=V.prototype.oj;V.prototype.ke=function(a){if(!v(a,V))throw new x(this.ke,0,a);a=this.multiply(a);return a.x+a.y};V.prototype.dot=V.prototype.ke;
V.prototype.multiply=function(a){if(!v(a,V))throw new x(this.multiply,0,a);return new V(this.x*a.x,this.y*a.y)};V.prototype.multiply=V.prototype.multiply;V.prototype.G=function(a){return new V(this.x*a,this.y*a)};V.prototype.rescale=V.prototype.G;V.prototype.wc=function(){return Sa(this.ke(this))};V.prototype.magnitude=V.prototype.wc;V.prototype.normalize=function(){var a=this.wc();return 0!==a?new V(this.x/a,this.y/a):this};V.prototype.normalize=V.prototype.normalize;function xf(a){a=a||{};this.Ni=a.minSpeed||3;this.Bh=a.vectorTolerance||3;this.Fg=a.maxSpeed||300;this.qj=a.timeTolerance||50;this.ra=[];this.sc=this.Ic=!1;this.mb=this.Z=null}function yf(a,b){var c,d,e,f;b?(a.bifocal&&b.bifocal?(c=zf(a),d=zf(b)):b.bifocal?(c=Af(a),e=Af(b).distance(c),f=Af(b,!0).distance(c),d=e>f?Af(b,!0):Af(b)):a.bifocal&&!b.bifocal?(d=Af(b),e=Af(a).distance(d),f=Af(a,!0).distance(d),c=e>f?Af(a,!0):Af(a)):(c=a,d=b),e=c.x-d.x,c=c.y-d.y,c=new V(e,c)):c=new V(0,0);return c}
function Bf(a){var b;if(!a||y(a.bx)||y(a.by))return 0;b=a.bx-a.x;a=a.by-a.y;return Sa(b*b+a*a)}function zf(a){var b,c;!a||y(a.bx)||y(a.by)||(b=a.x-a.bx,c=a.y-a.by,b=new N(a.x-b/2,a.y-c/2));return b}function Af(a,b){return b?new N(a.bx,a.by):new N(a.x,a.y)}p=xf.prototype;p.start=function(a,b){if(y(a))throw new x(this.start,0,a);this.Ic&&this.clear();this.Pi=a;this.Ic=!0;this.sc=!!b};
p.vh=function(a,b,c,d,e){var f=y(a)?0:y(b)?1:null!=c&&y(c)?2:null!=d&&y(d)?3:null!=e&&y(e)?4:u;if(0<=f)throw new x(this.vh,f,arguments[f]);this.Ic&&(e=e||(new Date).getTime(),this.mb=this.Z,this.Z={x:a,y:b,bx:null!=c?c:NaN,by:null!=d?d:NaN,ts:e,bifocal:null!=c&&null!=d},this.sc&&this.ra.push(this.Z))};p.clear=function(){this.ra=[];this.sc=this.Ic=!1;this.Z=this.mb=null};p.ld=function(a){if(y(a))throw new x(this.ld,0,a);return!!(this.Pi&a)};p.W=function(){return this.Ic};
p.ue=function(){var a=this.ra.length,b=0,c=new V(0,0);if(this.sc)for(;--a&&b<this.Bh;)c=c.add(yf(this.ra[a],this.ra[a-1])),b++;else c=yf(this.Z,this.mb);return c.normalize()};p.jd=function(a){a=a||Date.now();var b=this.ra.length,c=this.ra[b-1],d=0,e=0;if(this.sc){for(;--b&&d<this.Bh;)e+=yf(this.ra[b],this.ra[b-1]).wc(),d++;b=e/d}else c=this.Z,b=yf(this.Z,this.mb).wc();return b=b>=this.Ni&&a-c.ts<=this.qj?b>this.Fg?this.Fg:b:0};
p.bg=function(a){var b,c;if(y(a))throw new x(this.bg,0,a);this.mb&&this.Z&&(b=Bf(this.mb),0!==b&&(c=Bf(this.Z),a=Ra(Ta(2,a)*(c/b))/ab));return a};function Cf(){this.Cg=91.401472;this.reset()}r(Cf,G);Cf.prototype.start=function(a,b){this.Ia&&this.reset();y(a)||y(b)||(this.atX=a,this.atY=b);this.Ia=!0};Cf.prototype.b={zf:"animationupdate"};function Df(a){Df.a.constructor.call(this,Cf.prototype.b.zf);this.offset=a}r(Df,pc);p=Cf.prototype;p.W=function(){return this.Ia};p.set=function(a,b,c){!this.Ia||this.Ie===a&&this.Je===b&&this.Ke===c||(this.Ie=a,this.Je=b,this.Ke=c,this.dispatchEvent(new Df(Ef(this))))};
function Ef(a){return{x:a.Ie*a.Cg,y:a.Je*a.Cg,z:a.Ke}}p.reset=function(){this.Ia=!1;this.atY=this.atX=null;this.Ke=this.Je=this.Ie=0};p.jd=function(){var a=Ef(this);return Sa(a.x*a.x+a.y*a.y+a.z*a.z)};p.ue=function(){var a=Ef(this),b=this.jd()||1;return{x:a.x/b,y:a.y/b,z:a.z/b}};p.c=function(){this.reset();Cf.a.c.call(this)};var Ff={zoom:{min:-8,max:22},camera:{alt:{min:0,max:0},pitch:{min:0,max:0},roll:{min:0,max:0},yaw:{min:0,max:0},fov:{min:70,max:70}},interaction:{ZOOM:1,uj:16}};q("H.map.render.p2d.capabilities",Ff);function Gf(a,b,c){if(!a)throw new x(Gf,0,a);if(!b)throw new x(Gf,1,b);this.td=a;this.g=b;this.Rg={};this.mc=c&&c.enableSubpixelRendering}
Gf.prototype.qb=function(a,b,c,d,e,f){var g=Na(d),h=this.td,k=g+(c.exp-h.pixelProjection.exp),l=h.placeAtOnce,m=h.max;d=h.tileSize;var n=h.opacity,w,z=this.g,s=z.Ub;w=z.ab().width;var C=c.w,D=c.x,K=c.y,ga={};if(g<h.min||g>m)return!0;e=h.Qa(a,k,e,f);a=e.total;e=e.tiles;f=e.length;if(l&&a!==f)return!1;this.ha=c;this.kj=b;this.uf=k;s!==n&&z.setOpacity(n);c=d=d*C/(Ta(2,k)*d);this.mc||(d%1&&(d=Oa(d),C=c/d,D/=C,K/=C,C=Ta(2,k)*d),D=Oa(D),K=Oa(K));this.gj=c;k=-d;s=w+d;for(g=0;g<f;g++){w=e[g];c=b.x-(D-w.x*
d);l=b.y-(K-w.y*d);z.Gb(w.data,0,c,l,d,d);for(n=c;(n-=C)>k;)z.Gb(w.data,0,n,l,d,d);for(n=c;(n+=C)<s;)z.Gb(w.data,0,n,l,d,d);ga[this.uf+"_"+w.x+"_"+w.y]=w}this.Rg=ga;return f===a};Gf.prototype.D=function(a,b,c){if(this.uf!==u){var d=this.gj,e=d/this.td.tileSize,f=this.ha,g=this.kj,h,k;a=f.x+(a-g.x);b=f.y+(b-g.y);h=Oa(f.w/d);var l=f=Oa(a/d),g=Oa(b/d);Qa(l)>=h&&(l%=h);0>l&&(l=h+l);(h=this.Rg[this.uf+"_"+l+"_"+g])&&h.D&&(k=h.D((a-d*f)/e,(b-d*g)/e,c))}return k||fc};q("H.util.animation.ease.LINEAR",function(a){return a});q("H.util.animation.ease.EASE_IN_QUAD",function(a){return a*a});function Hf(a){return-a*(a-2)}q("H.util.animation.ease.EASE_OUT_QUAD",Hf);q("H.util.animation.ease.EASE_IN_OUT_QUINT",function(a){a*=2;return 1>a?Ta(a,5)/2:(a-=2,Ta(a,5)/2+1)});q("H.util.animation.ease.EASE_OUT_CIRC",function(a){return Sa(2*a-a*a)});function If(a,b){if(y(this.$d=+a))throw new x(If,0,a);this.Md=this.me=0;b&&this.rh(b)}q("H.util.kinetics.KineticMove",If);If.prototype.rh=function(a){this.Md=a;this.me=this.cg();return this};If.prototype.setInitialSpeed=If.prototype.rh;If.prototype.cg=function(){return this.Md/this.$d};If.prototype.getDuration=If.prototype.cg;If.prototype.te=function(a){return this.Md+this.$d*a};If.prototype.getCurrentSpeed=If.prototype.te;If.prototype.li=function(a){return this.Md*a+this.$d*a*a/2};
If.prototype.getCurrentPath=If.prototype.li;function Jf(a,b,c,d){if(!da(this.rj=a))throw new x(Jf,0,a);if(y(this.me=+b))throw new x(Jf,1,b);if(!da(this.Jg=c)&&null!=c)throw new x(Jf,2,c);if(!da(this.Wf=d)&&null!=d)throw new x(Jf,3,d);this.id=cc++;this.Ia=!1}q("H.util.animation.Animation",Jf);Jf.prototype.start=function(){var a=this,b,c=Le,d;d=function(){var e=fe(),f=e-a.Nc,g=f/a.me,g=1<g?1:g;a.Wf&&(g=a.Wf(g));a.rj(g,f,e-b,e);b=e;1<=g?a.stop():a.Lf=c(d)};a.Nc=fe();b=a.Nc;a.Ia=!0;a.Lf=c(d)};Jf.prototype.start=Jf.prototype.start;
Jf.prototype.stop=function(a){Me(this.Lf);this.Ia=!1;a||this.Jg&&this.Jg(this)};Jf.prototype.stop=Jf.prototype.stop;Jf.prototype.W=function(){return this.Ia};Jf.prototype.isRunning=Jf.prototype.W;function Kf(a,b,c,d){var e=new af(0,0,0,0);Kf.a.constructor.call(this);this.I=d.pixelRatio;this.Sc={1:e.la(),2:e.la(),4:e.la()};this.ja=a;if(!a)throw new x(Kf,0,a);Lf(this);a.addEventListener(a.b.j,this.Tb,!1,this);this.wa=t(this.wa,this);this.pa=t(this.pa,this);this.endInteraction=t(this.endInteraction,this);a.startInteraction=this.wa;a.interaction=this.pa;a.endInteraction=this.endInteraction;this.vb=b;if(!b)throw new x(Kf,1,b);this.va=t(this.va,this);this.control=t(this.control,this);this.endControl=
t(this.endControl,this);b.startControl=this.va;b.control=this.control;b.endControl=this.endControl;b.addEventListener(b.b.j,this.Bc,!1,this);this.ic=c;if(!c)throw new x(Kf,2,c);}r(Kf,G);q("H.map.render.RenderEngine",Kf);Kf.prototype.getBBox=Kf.prototype.Ca;
function Lf(a){var b=a.ja,c=b.width,d=b.height,e=b.padding,f=e.top,g=e.left,h=e.bottom,e=e.right,b=b.margin,k=-(c+g-e)/2<<0,l=-(d+f-h)/2<<0,c=c+k,d=d+l,m=a.Sc;a=a.I;m[1].set((k-b)*a,(l-b)*a,(c+b)*a,(d+b)*a);m[2].set(k*a,l*a,c*a,d*a);m[4].set((k+g)*a,(l+f)*a,(c-e)*a,(d-h)*a)}Kf.prototype.Tb=function(){Lf(this)};
Kf.prototype.c=function(){var a=this.vb,b=this.ja;a.removeEventListener(a.b.j,this.Bc,!1,this);a.startControl===this.va&&(a.startControl=M.prototype.va);a.control===this.control&&(a.control=M.prototype.control);a.endControl===this.endControl&&(a.endControl=M.prototype.endControl);b.removeEventListener(b.b.j,this.Tb,!1,this);b.startInteraction===this.wa&&(b.startInteraction=T.prototype.wa);b.interaction===this.pa&&(b.interaction=T.prototype.pa);b.endInteraction===this.endInteraction&&(b.endInteraction=
T.prototype.endInteraction)};Kf.prototype.getCamForBounds=Kf.prototype.Da;Kf.prototype.setPointer=Kf.prototype.setPointer;function Mf(a,b){a.style.transition="1.5s";a.addEventListener("transitionend",function(){b()},!1);a.style.opacity=0}var Nf={ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16};Kf.InteractionModifiers=Nf;Kf.prototype.b={Ef:"render"};var Of={P2D:0,PANORAMA:1};Kf.EngineType=Of;function uf(a,b,c,d){uf.a.constructor.call(this);var e;this.ma=a;this.Ua=e=a.ownerDocument.createElement("canvas");e.style.position="absolute";e.style.top="0px";e.style.left="0px";this.na=this.Ua.getContext("2d");this.Ub=this.na.globalAlpha;this.J=d;this.pf(b,c);a.insertBefore(e,a.firstChild)}r(uf,mc);p=uf.prototype;p.pf=function(a,b){var c=this.J;this.wb=a||1;this.eb=b||1;this.Ua.width=this.wb;this.Ua.height=this.eb;this.Ua.style.width=Na(a/c)+"px";this.Ua.style.height=Na(b/c)+"px"};
p.setOpacity=function(a){this.Ub=a;this.na.globalAlpha=a};p.ab=function(){return{width:this.wb,height:this.eb,I:this.J}};p.Gb=function(a,b,c,d,e,f){a&&this.na.drawImage(a,c,d,e,f)};p.clear=function(){this.na.clearRect(0,0,this.wb,this.eb)};p.c=function(){this.ma.removeChild(this.Ua);this.na=this.Ua=null;uf.a.c.call(this)};function W(a,b,c,d){var e;W.a.constructor.call(this,a,b,c,d);this.nb=new N(0,0);if(e=d.renderBaseBackground)this.fj=e.lower,this.ej=e.higher;this.mc=!!d.enableSubpixelRendering;this.pj=1E3;this.xg=this.r=0;this.vf=this.ug=!1;this.Ka=new N(0.5,0.5);this.ta=Ra(this.I)/ab;this.F=new xf;this.T=d=new Cf;this.Qe=t(this.Qe,this);d.addEventListener(d.b.zf,this.Qe);this.p=new Sd;d=a.element;this.Qb=a=d.ownerDocument.createElement("div");a.style.position="absolute";a.style.width=a.style.height="100%";a.style.zIndex=
0;d.insertBefore(a,d.firstChild);this.g=new uf(this.Qb,1,1,this.I);a=this.ic.Cb();d=0;e=a.length;var f;this.Jb=[];this.Jb.length=e;this.Xb=[];this.Xb.length=e;for(this.Rb=a;d<e;d++)f=a[d],Pf(this,d,f,1),0===d&&Qf(this,f,!0);Rf(this);c.addEventListener("update",this.Kg,!1,this);c.addEventListener(c.b.xb,this.We,!1,this);c.addEventListener(c.b.yb,this.Xe,!1,this);c.addEventListener(c.b.Xc,this.Og,!1,this);this.jf=t(W.prototype.jf,this);this.Q=Sf;this.ag=[];this.mh=[];this.hh();this.r=Tf(this,this.vb.getZoom()+
this.ta);Rf(this);Uf(this,b.Za().position,this.r);this.R();this.Tb()}r(W,Kf);q("H.map.render.p2d.RenderEngine",W);W.prototype.type=Of.P2D;W.prototype.type=W.prototype.type;var Sf=2;W.prototype.hc=Ff;W.prototype.getState=function(){return this.Q};W.prototype.getState=W.prototype.getState;function Vf(a,b,c){b=c-b;return Qa(b)<a.p.w/2?b:b-a.p.w*c/Qa(c)}
W.prototype.Bc=function(a){var b=this,c,d,e=a.requested,f=e.animate,e=e.camera.position,g=b.p.geoToPixel(e),h=g.x,k=g.y,l=this.r,m=this.Ka,n=0,w,z,s;this.nb.set(0,0);a=Wf(this,a);c=a.zoom;s=a.position;if(f){if(d=c-l,w={x:m.x,y:m.y},f=this.p.Cd(w).x,z=this.p.projection.se(e),z.x!==this.Ka.x||z.x!==this.Ka.x||c!==this.r)h=Vf(this,f,h),Xf(this,function(a){var e=a-n,f;c!==l&&(g=b.p.Cd(z),f=b.p.Cd(w),h=Vf(b,f.x,g.x),k=g.y-f.y);n=a;Yf(b,h*e,k*e);l+=d*e;Zf(b,l);b.R();$f(b)},this.Vc,function(){Uf(b,s,c);
Zf(b,c);b.R(s);$f(b)},this.Wc)}else ag(this),Uf(this,s,c),Zf(this,c),this.R(s);$f(this)};W.prototype.Vc=300;W.prototype.nh=function(a){var b=a===+a;if(!b||b&&0>a)throw new x(this.nh,1,"positive number required");this.Vc=a};W.prototype.setAnimationDuration=W.prototype.nh;W.prototype.gi=function(){return this.Vc};W.prototype.getAnimationDuration=W.prototype.gi;W.prototype.Wc=Hf;W.prototype.oh=function(a){if(!da(a))throw new x(this.oh,1,"function required");this.Wc=a};W.prototype.setAnimationEase=W.prototype.oh;
W.prototype.hi=function(){return this.Wc};W.prototype.getAnimationEase=W.prototype.hi;W.prototype.hh=function(){this.Wc=Hf;this.Vc=300};W.prototype.resetAnimationDefaults=W.prototype.hh;p=W.prototype;p.Kg=function(){$f(this)};p.We=function(a){var b=a.added;a=a.idx;Pf(this,a,b);0===a&&(Rf(this),Qf(this,b,!0));bg(this);$f(this)};
p.Xe=function(a,b){var c=a.removed,d=a.idx,e;this.tg=fe();(e=this.Jb.splice(d,1)[0])&&e.k&&e.k();(e=this.Xb.splice(d,1)[0])&&e.k&&e.k();this.Rb=this.ic.Cb();0===d&&(Qf(this,c,!1),Rf(this));bg(this);b||$f(this)};p.Og=function(a){this.Xe(a,!0);this.We(a)};function Qf(a,b,c){c=c?b.addEventListener:b.removeEventListener;c.call(b,b.b.Df,a.Pg,!1,a);c.call(b,b.b.Cf,a.Pg,!1,a)}p.Pg=function(){Rf(this);$f(this)};
function Pf(a,b,c,d){var e,f,g={enableSubpixelRendering:a.mc};d=d||0;c&&(c.requestTiles&&(e=new Gf(c,a.g,g)),c.requestMarkers&&(f=new vf(c,a.g,g)));a.Jb.splice(b,d,e);a.Xb.splice(b,d,f);a.Rb=a.ic.Cb()}function Rf(a){var b;if(0<a.Rb.length)b=a.Rb[0].max,a.Ag=a.Rb[0].min,a.zg=b;else{b=a.hc.zoom;var c=b.max;a.Ag=b.min;a.zg=c}b=cg(a,a.r);b!==a.r&&(a.r=b,a.p.G(b),a.R())}
function Wf(a,b){var c=b.requested,d,e;e=(d=c.camera)&&d.position;d=cg(a,cg(a,c.zoom)+a.ta);e=dg({position:new A(e.lat,e.lng)});a.r=c.animate?a.r:d;e.zoom=d;return e}function Uf(a,b,c){var d=a.p;d.G(c);a.Ka=d.projection.se(b);d.x=d.w*a.Ka.x;d.y=d.h*a.Ka.y}function cg(a,b){var c=a.hc.zoom;return kb(b,Ma(c.min,a.Ag),La(c.max,a.zg))}function dg(a){a.yaw=a.pitch=a.roll=0;a.fov=70;return a}p.Ra=function(a,b){var c=this.ja.center,d=this.I;return this.p.ya((a-c.x)*d,(b-c.y)*d)};W.prototype.screenToGeo=W.prototype.Ra;
W.prototype.setPointer=ec;W.prototype.setPointer=W.prototype.setPointer;W.prototype.Yb=function(a,b){var c=this.Ra(a,b),d=this.vb.Za();d.position=c;return d};W.prototype.screenToCameraData=W.prototype.Yb;W.prototype.Xa=function(a){var b=this.I,c=this.ja.center,d=c.x*b,c=c.y*b;a=this.p.geoToPixel(a);var e=this.p.w;return new N(Na((a.x-Na(a.x/e)*e+d)/b),Na((a.y+c)/b))};W.prototype.geoToScreen=W.prototype.Xa;
W.prototype.Ca=function(a,b){var c=this.Sc[a||4],d=this.p,e=c.left-b,f=d.ya(e,c.top-b),g=c.right+b,c=d.ya(g,c.bottom+b);g-e>=d.w&&(f.lng=-(c.lng=180));return Bb(f,c)};W.prototype.getBBox=W.prototype.Ca;W.prototype.D=function(a,b,c){var d=[],e=this.I,f=this.Jb,g=this.Xb;a*=e;b*=e;d=eg(d,g,a,b,c);return c&&d.length?d:eg(d,f,a,b,c)};W.prototype.getObjectsAt=W.prototype.D;function eg(a,b,c,d,e){for(var f=b.length,g;f--&&!((g=b[f])&&g.D&&(a=a.concat(g.D(c,d,e)),e)););return a}W.prototype.Pd=sa;
W.prototype.Tb=function(){var a=this.Sc,b=this.g.ab(),c,d,e;this.ja.Zf||(c=a[2].la());W.a.Tb.call(this);d=this.Sc[2];this.nb.set(0,0);e=d.right-d.left;d=d.bottom-d.top;if(b.width!==e||b.height!==d)this.g.pf(e,d),this.Pd=new jf(e,d);c&&(d=a[2],Yf(this,c.left-d.left,c.top-d.top),this.R());$f(this)};W.prototype.ed=function(){return Ff};W.prototype.getCapabilities=W.prototype.ed;function fg(a){fe()-a.tg<a.pj&&!a.Pa?a.ei=Le(a.jf):(a.Pa&&(bg(a),gg(a)),a.Q=Sf)}
function bg(a){a.ag.length=0;a.mh.length=0}
W.prototype.jf=function(){var a=this.Jb,b=this.Xb,c=this.ja.center.la().scale(this.I),d=this.Ca(1,0),e=this.Ca(1,256),f=this.r,g,h,k=this.ta,l,m=this.p;g=this.fj;var n=this.ej,w=a[0],z=this.nb;this.g.clear();if(w){if(g)for(;g;)h=f+k-g,w.qb(d,c,m,h,!0,z),g-=1;if(n&&this.vf)for(l=1;l<=n&&(h=f-k+l,m.G(h),g=this.Ca(2,0),m.G(f),!w.qb(g,c,m,h,!0,z));l++);}a=hg(this,a,this.ag,d,c,f,z);b=hg(this,b,this.mh,e,c,f,z);this.Pa=a&&b;this.Od&&(this.vb.Qd(this.Od),this.Od=null);this.Pd&&(this.ja.Qd(this.Pd),this.Pd=
sa);f<this.xg?this.vf=!0:this.ug&&(this.vf=!1);this.xg=f;this.ug=a;fg(this)};function hg(a,b,c,d,e,f,g){for(var h=b.length,k=a.Rb,l,m=!!h,n=0,n=0;n<h;n++)b[n]&&((l=b[n].qb(d,e,a.p,f,!1,g))&&!c[n]&&(gg(a,k[n]),c[n]=!0),c[n]||(m=!1));return m}function gg(a,b){a.dispatchEvent({type:a.b.Ef,target:b||a})}
W.prototype.c=function(){var a=this.ic,b=this.ic.Cb()[0],c=this.Jb,d=this.Xb;Me(this.ei);ag(this,!0);a.removeEventListener("update",this.Kg,!1,this);a.removeEventListener(a.b.xb,this.We,!1,this);a.removeEventListener(a.b.yb,this.Xe,!1,this);a.removeEventListener(a.b.Xc,this.Og,!1,this);b&&Qf(this,b,!1);this.g.k();for(a=c.length;a--;)Ed(c[a]);for(a=d.length;a--;)Ed(d[a]);this.Qb.parentNode&&this.Qb.parentNode.removeChild(this.Qb);this.Qb=null;this.Q=3;W.a.c.call(this)};
function $f(a){a.tg=fe();a.Q===Sf&&(a.Pa=!1,a.Q=1,fg(a))}function ig(a){return dg({position:a.p.projection.Sg(a.Ka)})}W.prototype.R=function(a){var b=ig(this);a&&(b.position=a);this.Od=b;this.Od.zoom=this.r-this.ta};function jg(a,b,c){Yf(a,b*a.I,c*a.I);a.nb.set(0,0);a.R();$f(a)}function Yf(a,b,c){var d=a.p;a=a.Ka;d.x=jb(d.x+b,d.w);d.y+=c;a.x=d.x/d.w;a.y=d.y/d.h}W.prototype.Uc=function(a,b,c){a=cg(this,cg(this,a)+this.ta);Zf(this,a,b,c)};W.prototype.zoomAt=W.prototype.Uc;
function Zf(a,b,c,d){var e=a.I,f=a.ja.center;c===+c&&d===+d?(c=(c-f.x)*e,d=(d-f.y)*e,a.nb.set(c,d),Yf(a,c,d),a.p.G(b),Yf(a,-c,-d)):(a.nb.set(0,0),a.p.G(b));a.r=b;a.R();$f(a)}
W.prototype.Da=function(a,b,c){var d=this.ed().zoom.max,e=a.N(),f,g,h;a.pg()||(f=new Sd(this.p.projection),f.G(d),g=f.geoToPixel(a.bb()).round(),h=f.geoToPixel(a.Ya()).round(),d=f.w,a.Nb()&&(g.x-=d),c?(f=f.geoToPixel(e),a=2*Ma(f.x-g.x,h.x-f.x),c=2*Ma(f.y-g.y,h.y-f.y)):(a=h.x-g.x,c=h.y-g.y,e=f.pixelToGeo(g.add(h).scale(0.5))),g=this.Sc[4],f=g.right-g.left,g=g.bottom-g.top,d=-8+La(Ra(f/a*d)/ab,Ra(g/c*d)/ab)-this.ta);return{zoom:cg(this,b?Oa(d):d),position:e}};W.prototype.getCamForBounds=W.prototype.Da;
W.prototype.wa=function(a,b){this.T.W()&&this.endControl(!0);this.F.W()&&this.endInteraction(!0);this.ga=b;ag(this,!0);this.F.start(a,!!b)};W.prototype.startInteraction=W.prototype.wa;function Tf(a,b){return cg(a,cg(a,b-a.ta)+a.ta)}
W.prototype.pa=function(a,b,c,d,e){var f=!1;this.F.W()&&(this.F.vh(a,b,c,d,e),this.F.ld(Nf.COORD)&&(a=this.F,a=yf(a.Z,a.mb),0<a.wc()&&(jg(this,-a.x,-a.y),f=!0)),this.F.ld(Nf.ZOOM)&&c===+c&&d===+d&&(d=zf(this.F.Z),c=this.F.bg(this.r),c!==this.r&&(c=Tf(this,c),Zf(this,c,d.x,d.y),f=!0)),f&&$f(this))};W.prototype.interaction=W.prototype.pa;
W.prototype.endInteraction=function(a){var b=this,c,d,e,f;this.F.W()&&!a&&(this.ga&&(a=this.F.jd(),e=this.F.ue(),f=this.ga.duration,c=(this.ga.$i||1)*a,d=new If(-(c/f),c),!y(e.x)&&!y(e.y)&&0<c&&b.F.ld(Nf.COORD)&&Xf(this,function(a){c=d.te(a*f);y(c)||jg(b,Na(-e.x*c),Na(-e.y*c))},f,void 0,this.ga.$h)),this.ga=null,this.F.clear())};W.prototype.endInteraction=W.prototype.endInteraction;
W.prototype.va=function(a,b,c){this.F.W()&&this.endInteraction(!0);this.T.W()&&this.endControl(!0);this.T.start(b,c);this.ga=a};W.prototype.startControl=W.prototype.va;W.prototype.control=function(a,b,c,d,e,f,g){if(y(c=+g||+c))throw new x(this.control,2,c);if(y(a))throw new x(this.control,0,a);if(y(b))throw new x(this.control,2,b);this.T.W()&&this.T.set(a,b,c)};W.prototype.control=W.prototype.control;
W.prototype.endControl=function(a,b){var c=this,d,e,f,g,h,k;ag(this,!0);!this.ga||a||b?"function"===typeof b&&(d={camera:ig(this),zoom:this.r-this.ta},b(d),this.Bc({requested:d})):(d=this.T.jd(),g=this.T.ue(),h=this.ga.duration,e=(this.ga.$i||1)*d,f=new If(-(e/h),e),!y(g.x)&&!y(g.y)&&0<e&&Xf(this,function(a){e=f.te(a*h);y(e)||((k=g.z*e)&&Zf(c,Tf(c,c.r+k),c.T.atX,c.T.atY),jg(c,Na(g.x*e),Na(g.y*e)))},h,void 0,this.ga.$h));this.T.reset()};W.prototype.endControl=W.prototype.endControl;
W.prototype.Qe=function(a){var b=this,c=a.offset;this.nb.set(0,0);c.x||c.y||c.z?Xf(this,function(){c.z&&Zf(b,Tf(b,b.r+c.z),b.T.atX,b.T.atY);jg(b,c.x,c.y);$f(b)},Number.POSITIVE_INFINITY):ag(this,!0)};function Xf(a,b,c,d,e){a.Sa&&a.Sa.W()&&a.Sa.stop(!0);a.Sa=new Jf(b,c,d,e);a.Sa.start()}function ag(a,b){a.Sa&&a.Sa.W()&&a.Sa.stop(b)}W.prototype.enter=ec;W.prototype.enter=W.prototype.enter;
W.prototype.exit=function(a){var b=this.vb.Za();this.Bc({requested:{camera:b,zoom:b.zoom,animate:!0}});Mf(this.Qb,a)};W.prototype.exit=W.prototype.exit;function X(){this.d=[];X.a.constructor.call(this)}r(X,G);q("H.util.OList",X);function kg(a,b,c){a=a.d.length;var d;if(c)d=a;else if(y(d=0>(d=+b)?Ma(0,a+d):La(a,d)))throw new Yd(X,b,[0,a-1]);return d}X.prototype.add=function(a,b){var c=kg(this,b,y(b));this.d.splice(c,0,a);this.dispatchEvent(new lg(this,this.b.xb,c,a,null,null))};X.prototype.add=X.prototype.add;X.prototype.ua=function(a){var b=this.d.splice(a,1)[0];this.dispatchEvent(new lg(this,this.b.yb,a,null,b,null));return b};
X.prototype.Ec=function(a){this.get(a);return this.ua(a)};X.prototype.removeAt=X.prototype.Ec;X.prototype.remove=function(a){a=this.indexOf(a);return 0<=a?(this.ua(a),!0):!1};X.prototype.remove=X.prototype.remove;X.prototype.set=function(a,b){var c=this.get(a);a=kg(this,a,!1);c=this.d[a];this.d[a]=b;this.dispatchEvent(new lg(this,this.b.Xc,a,b,c,null));return c};X.prototype.set=X.prototype.set;X.prototype.indexOf=function(a){return this.d.indexOf(a)};X.prototype.indexOf=X.prototype.indexOf;
X.prototype.get=function(a){a=kg(this,a,!1);if((a=kg(this,a,!1))>=this.d.length)throw new Yd(this.get,a,[0,this.d.length-1]);return this.d[a]};X.prototype.get=X.prototype.get;X.prototype.ui=function(){return this.d.length};X.prototype.getLength=X.prototype.ui;X.prototype.Cb=function(){return[].concat(this.d)};X.prototype.asArray=X.prototype.Cb;X.prototype.flush=function(){for(var a=this.d.length;a--;)this.ua(a)};X.prototype.flush=X.prototype.flush;X.prototype.c=function(){this.flush();X.a.c.call(this)};
X.prototype.b={xb:"add",yb:"remove",Xc:"set",xj:"move"};function lg(a,b,c,d,e,f){lg.a.constructor.call(this,b,a);this.idx=c;this.added=d;this.removed=e;this.moved=f}r(lg,pc);function mg(a){mg.a.constructor.call(this);if(a)for(var b=0,c=a.length;b<c;b++)this.add(a[b])}r(mg,X);q("H.map.DataModel",mg);mg.prototype.add=function(a,b){v(a,P,this.add,0);mg.a.add.call(this,a,b);a.addEventListener(a.b.j,this.dispatchEvent,!1,this)};mg.prototype.add=mg.prototype.add;mg.prototype.set=function(a,b){var c;v(b,P,this.set,0);c=mg.a.set.call(this,a,b);b.addEventListener(b.b.j,this.dispatchEvent,!1,this);c.removeEventListener(c.b.j,this.dispatchEvent,!1,this);return c};
mg.prototype.set=mg.prototype.set;mg.prototype.Ec=function(a){(a=mg.a.Ec.call(this,a))&&a.removeEventListener(a.b.j,this.dispatchEvent,!1,this);return a};mg.prototype.removeAt=mg.prototype.Ec;mg.prototype.flush=function(){for(var a=this.Cb(),b=a.length;b--;)a[b].removeEventListener(a[b].b.j,this.dispatchEvent,!1,this);mg.a.flush.call(this)};mg.prototype.flush=mg.prototype.flush;function Y(a,b,c){Y.a.constructor.call(this);this.ne=t(Y.prototype.ne,this);this.aa=ng(c,Y);this.ia=c=new M;this.vd=!1;c.addEventListener(c.b.ec,this.Qg,!1,this);if(!v(a,Element))throw new x(Y,0,a);c=this.t=a.ownerDocument.createElement("div");c.style.position="relative";c.style.height=c.style.width="100%";c.style.overflow="hidden";a.appendChild(c);this.cc=new T(this.t,this.aa);this.cc.addEventListener(this.cc.b.ec,this.Qg,!1,this);a=this.f=new mg(this.aa.layers);a.addEventListener(a.b.Xc,this.Te,
!1,this);a.addEventListener(a.b.xb,this.Te,!1,this);a.addEventListener(a.b.yb,this.Te,!1,this);(this.vc=new J).ea(this);this.Oe=new df(this.vc,this.aa);this.Hf(this.Oe);this.Db=null;this.f.add(b,0);this.C=this.ie(this.aa.engineType||og.P2D,this.aa);b=this.aa.center||new A(0,0);a=+this.aa.zoom||0;c=this.aa.bounds;this.xd=t(this.xd,this);this.je=t(this.je,this);v(c,B)?this.qf(c):(this.Kc(b),this.setZoom(a));b=this.aa.imprint;if(b!==u&&"object"!==typeof b)throw new x(Y,1,"imprint");this.fb=null===b?
b:new Fd(this,b);b=this.aa.autoColor;this.be=b===u||!!b;pg(this)}r(Y,G);q("H.Map",Y);function ng(a,b){var c;if(a)if(c=a.pixelRatio,c===u)a.pixelRatio=1;else{if(!(0<c))throw new x(b,0,"pixelRatio: "+c);}else a={pixelRatio:1};a.renderBaseBackground||(a.renderBaseBackground={lower:3,higher:2});return a}Y.prototype.Jh=333;Y.prototype.c=function(){this.be=!1;this.fb&&this.fb.k();this.Oe.k();this.vc.k();this.f.k();this.ia.k();this.cc.k();this.C.k();this.t.parentNode.removeChild(this.t);this.t=null;G.prototype.c.call(this)};
Y.prototype.ve=function(){return this.t};Y.prototype.getElement=Y.prototype.ve;function pg(a){a.fb&&a.be&&a.fb.Kd({invert:a.Db.Wh})}Y.prototype.Te=function(a){0===a.idx&&(this.dispatchEvent(new qc(this.b.Hh,this.Db=a.type!==this.f.b.yb?a.added:0<this.f.d.length?this.f.get(0):sa,a.type!==this.f.b.xb?a.removed:1<this.f.d.length?this.f.get(1):sa)),pg(this))};
Y.prototype.Qg=function(a){a.modifiers&&(this.vd||(qg(this,"start"),this.vd=!0),qg(this,"",a));this.vd&&(this.Dg&&pa.clearTimeout(this.Dg),this.Dg=pa.setTimeout(this.je,this.Jh))};function qg(a,b,c){a.dispatchEvent(c?new Md(a.b.Af,c.newValue,c.oldValue,c.modifiers):a.b.Af+b)}Y.prototype.je=function(){qg(this,"end");this.vd=!1};Y.prototype.Kc=function(a,b){this.ia.Jc({animate:!!b,position:a});return this};Y.prototype.setCenter=Y.prototype.Kc;Y.prototype.N=function(){return(this.ia.Za()||{}).position};
Y.prototype.getCenter=Y.prototype.N;Y.prototype.setZoom=function(a,b){this.ia.setZoom(a,!!b);return this};Y.prototype.setZoom=Y.prototype.setZoom;Y.prototype.getZoom=function(){return this.ia.getZoom()};Y.prototype.getZoom=Y.prototype.getZoom;Y.prototype.Uc=function(a,b,c){this.C.Uc(a,b,c)};Y.prototype.zoomAt=Y.prototype.Uc;Y.prototype.qf=function(a,b){if(!v(a,B))throw new x(this.qf,0,a);var c=this.C.Da(a,!0,!1);c.animate=b;this.ia.Jc(c);return this};Y.prototype.setViewBounds=Y.prototype.qf;
Y.prototype.fg=function(){return this.C.Ca(4,0)};Y.prototype.getViewBounds=Y.prototype.fg;Y.prototype.Da=function(a,b,c){return this.C.Da(a,b,c)};Y.prototype.getCamForBounds=Y.prototype.Da;Y.prototype.Gi=function(){return this.cc};Y.prototype.getViewPort=Y.prototype.Gi;Y.prototype.Fi=function(){return this.ia};Y.prototype.getViewModel=Y.prototype.Fi;Y.prototype.si=function(){return this.f};Y.prototype.getLayers=Y.prototype.si;Y.prototype.qi=function(){return this.fb};Y.prototype.getImprint=Y.prototype.qi;
Y.prototype.dg=function(){return this.kb||this.C};Y.prototype.getEngine=Y.prototype.dg;Y.prototype.qh=function(a){this.C.type===a||this.jg||(this.jg=!0,this.kb=this.ie(a),this.kb.addEventListener("render",this.xd));return this};Y.prototype.setEngineType=Y.prototype.qh;Y.prototype.xd=function(a){a.target===this.kb&&(this.kb.removeEventListener("render",this.xd),this.kb.enter(),this.C.exit(this.ne))};
Y.prototype.ne=function(){var a=this.C.type;this.C.k();this.C=this.kb;this.kb=u;this.jg=!1;this.dispatchEvent(new qc(this.b.Ih,this.C.type,a))};Y.prototype.ie=function(a,b){var c=b?ng(b,this.ie):this.aa;if(a===og.PANORAMA)return this.fb&&this.be&&this.fb.Kd({invert:!0}),new pa.H.map.render.panorama.RenderEngine(this.cc,this.ia,this.f,c);if(a===og.P2D)return pg(this),new W(this.cc,this.ia,this.f,c);throw new x(this.qh,0,a);};
Y.prototype.Hf=function(a,b){-1===this.f.indexOf(a)&&this.f.add(a,y(b)?this.f.d.length-1:b);return this};Y.prototype.addLayer=Y.prototype.Hf;Y.prototype.cj=function(a){var b=this.f.indexOf(a);a!==this.Db&&a!==this.Oe&&-1!==b&&this.f.Ec(b);return this};Y.prototype.removeLayer=Y.prototype.cj;Y.prototype.lj=function(a){this.Db!==a&&(this.f.set(0,a),this.Db=a);return this};Y.prototype.setBaseLayer=Y.prototype.lj;Y.prototype.ii=function(){return this.Db};Y.prototype.getBaseLayer=Y.prototype.ii;
Y.prototype.Xa=function(a){if(!vb(a))throw new x(this.Xa,0,a);return this.C.Xa(a)};Y.prototype.geoToScreen=Y.prototype.Xa;Y.prototype.Ra=function(a,b){var c;if(c=+y(a)||2*y(b))throw new x(this.Ra,c-1,arguments[c-1]);return this.C.Ra(a,b)};Y.prototype.screenToGeo=Y.prototype.Ra;Y.prototype.Yb=function(a,b){return this.C.Yb(a,b)};Y.prototype.screenToCameraData=Y.prototype.Yb;Y.prototype.B=function(a){if(!v(a,I))throw new x(this.B,0,a);this.vc.Lb().B(a);return a};Y.prototype.addObject=Y.prototype.B;
Y.prototype.L=function(a){if(!v(a,I))throw new x(this.L,0,a);this.vc.Lb().L(a);return a};Y.prototype.removeObject=Y.prototype.L;Y.prototype.qc=function(){return this.vc.Lb().qc(!0)};Y.prototype.getObjects=Y.prototype.qc;Y.prototype.zb=function(a){var b,c;if(!za(a))throw new x(this.zb,0,a);b=a.length;for(c=0;c<b;c++)this.B(a[c]);return this};Y.prototype.addObjects=Y.prototype.zb;Y.prototype.Vb=function(a){if(!v(a,Q)&&!za(a))throw new x(this.Vb,0,a);a.forEach(this.L,this);return this};
Y.prototype.removeObjects=Y.prototype.Vb;Y.prototype.we=function(a,b){var c;if(c=+y(a)||2*y(b))throw new x(this.we,c-1,arguments[c-1]);return this.C.D(a,b,!0)[0]||sa};Y.prototype.getObjectAt=Y.prototype.we;Y.prototype.D=function(a,b){var c;if(c=+y(a)||2*y(b))throw new x(this.we,c-1,arguments[c-1]);return this.C.D(a,b,!1)};Y.prototype.getObjectsAt=Y.prototype.D;var Kd=0,og={P2D:Kd,PANORAMA:1};Y.EngineType=og;
Y.prototype.b={wj:"mapviewchangestart",Af:"mapviewchange",Bf:"mapviewchangeend",Hh:"baselayerchange",Ih:"enginechange"};function Z(a,b,c){Z.a.constructor.call(this,null,c);this.Kc(a);this.of(b);c&&"precision"in c&&this.nf(c.precision)}r(Z,L);q("H.map.Circle",Z);Z.prototype.Kc=function(a){(a=wb(a)).M(this.Wa)||(this.Wa=a,Z.a.q.call(this,null))};Z.prototype.setCenter=Z.prototype.Kc;Z.prototype.N=function(){return this.Wa};Z.prototype.getCenter=Z.prototype.N;Z.prototype.of=function(a){if(y(a=kb(a,0,6371000.79*bb/2)))throw new x(this.of,0,a);this.gf!==a&&(this.gf=a,Z.a.q.call(this,null))};Z.prototype.setRadius=Z.prototype.of;
Z.prototype.Ai=function(){return this.gf};Z.prototype.getRadius=Z.prototype.Ai;Z.prototype.Dd=60;Z.prototype.nf=function(a){if(a!==+a)throw new x(this.nf,0,a);this.Dd!==(a=kb(Na(a),4,360))&&(this.Dd=a,Z.a.q.call(this,null))};Z.prototype.setPrecision=Z.prototype.nf;Z.prototype.zi=function(){return this.Dd};Z.prototype.getPrecision=Z.prototype.zi;Z.prototype.Mc=function(){return this};Z.prototype.setNorthPoleCovering=Z.prototype.Mc;Z.prototype.q=function(){return this};Z.prototype.setStrip=Z.prototype.q;
Z.prototype.Fa=function(){return this.xa||Z.a.q.call(this,this.xe()).xa};Z.prototype.getStrip=Z.prototype.Fa;Z.prototype.xe=function(){var a=this.Wa,b=a.lat,c=this.gf,d=0,e=new E;this.Ob=0<b;if(90===Qa(b))for(b=a.tf(0,c,!0).lat;360>d;d+=120)e.Ed(b,d-180,u);else for(b=this.Dd,b=360/b;360>d;d+=b)e.Xg(a.tf(d,c,!0));return e};function rg(a,b){var c,d=a;if(!v(d,Element)){sg.innerHTML=d;d=sg.firstElementChild;if(!d)throw new x(rg,0,"No element data");sg.removeChild(d);c=!0;sg.innerHTML=""}this.fe=0!==gc(d).length;this.Xf=c?d:hc(d,pa.document,this.fe);b&&(c="onAttach",c in b&&Aa(d=b[c],"Function",rg,1,c)&&(this.Re=d),c="onDetach",c in b&&Aa(d=b[c],"Function",rg,1,c)&&(this.Ue=d))}q("H.map.DomIcon",rg);var sg=document.createElement("DIV");rg.prototype.Re=null;rg.prototype.Ue=null;
rg.prototype.pc=function(a,b){return hc(this.Xf,b,this.fe)};rg.prototype.fe=!1;function lf(a,b){var c,d,e,f,g,h,k;f=a;e=[tg.RECT,tg.CIRCLE,tg.POLYGON];b=[].concat(b);c=d=b.length;if(-1===e.indexOf(f))throw new x(lf,0,a);if(!b)throw new x(lf,1,b);for(;d--;)if(y(b[d]))throw new x(lf,1,b);f===tg.RECT&&3<c&&(b=[b[0],b[1],b[2],b[1],b[2],b[3],b[0],b[3]],f=tg.POLYGON);if(f===tg.CIRCLE&&2<c&&(e=b[2],0<e)){f=b[0];g=b[1];d=La(2*Pa(e),40);h=360/d;for(b=[];d--;)k=h*d*gb,b.push(f+Va(k)*e,g+Xa(k)*e);f=tg.POLYGON}if(f!==tg.POLYGON||!c||b.length%2)throw new x(lf,1,b);this.Zi=b}
q("H.map.HitArea",lf);lf.prototype.hg=function(a,b,c){return ob(a,b,this.Zi,c,!0)};lf.prototype.hitTest=lf.prototype.hg;var tg={RECT:0,CIRCLE:1,POLYGON:2};lf.ShapeType=tg;function ug(a,b){var c;wa(this,ug);ug.a.constructor.call(this,b);this.setPosition(a);b&&"icon"in b&&(c=b.icon);this.Lc(c||vg(this))}r(ug,I);q("H.map.AbstractMarker",ug);ug.prototype.ad=function(a){var b,c,d=this.dc-a.dc;d||(d=nd(b=md(this),c=md(a),!0)||a.getPosition().lat-this.getPosition().lat||nd(b,c,!1));return d};ug.prototype.getPosition=function(){return this.Tg};ug.prototype.getPosition=ug.prototype.getPosition;
ug.prototype.setPosition=function(a){var b=this.Tg,c=!b;if(c||!b.M(a))vb(a,c?ug:this.setPosition,0),this.Tg=wb(a),c||this.v(Xb);return this};ug.prototype.setPosition=ug.prototype.setPosition;ug.prototype.oi=function(){return this.icon};ug.prototype.getIcon=ug.prototype.oi;ug.prototype.Lc=function(a){var b=this.icon,c=!b;if(b!==a){if(!v(a,this.ig))throw x.apply(b=new x,c?[this.constructor,1,"icon"]:[this.setPosition,0,a]),b;this.icon=a;c||this.v(Yb)}return this};ug.prototype.setIcon=ug.prototype.Lc;
function vg(a){var b=a.Xh;b||(b=a.constructor.prototype.Xh=a.Qf(wg));return b}
var wg={yh:'<svg xmlns="http://www.w3.org/2000/svg" width="28px" height="36px"><path d="M 19 31 C 19 32.7 16.3 34 13 34 C 9.7 34 7 32.7 7 31 C 7 29.3 9.7 28 13 28 C 16.3 28 19 29.3 19 31 Z" fill="#000" fill-opacity=".2"/><path d="M 13 0 C 9.5 0 6.3 1.3 3.8 3.8 C 1.4 7.8 0 9.4 0 12.8 C 0 16.3 1.4 19.5 3.8 21.9 L 13 31 L 22.2 21.9 C 24.6 19.5 25.9 16.3 25.9 12.8 C 25.9 9.4 24.6 6.1 22.1 3.8 C 19.7 1.3 16.5 0 13 0 Z" fill="#fff"/><path d="M 13 2.2 C 6 2.2 2.3 7.2 2.1 12.8 C 2.1 16.1 3.1 18.4 5.2 20.5 L 13 28.2 L 20.8 20.5 C 22.9 18.4 23.8 16.2 23.8 12.8 C 23.6 7.07 20 2.2 13 2.2 Z" fill="#18d"/></svg>',size:new jf(28,
36),anchor:new N(14,32),hitArea:new lf(2,[0,16,0,7,8,0,18,0,26,7,26,16,18,34,8,34])};function qf(a,b){qf.a.constructor.call(this,a,b)}r(qf,ug);q("H.map.DomMarker",qf);qf.prototype.dc=2;qf.prototype.Qf=function(a){var b=new rg(a.yh,a);a=a.anchor;b.Xf.style.margin=-a.y+"px 0 0 -"+a.x+"px";return b};qf.prototype.ig=rg;function pf(a,b){pf.a.constructor.call(this,a,b)}r(pf,ug);q("H.map.Marker",pf);p=pf.prototype;p.dc=1;p.v=function(a){var b;if(a!==Yb||1===this.Ug||1===this.icon.getState())b=pf.a.v.call(this,a);return b||!1};p.Ug=0;p.ig=U;p.De=!1;p.Mg=function(){this.v(Yb)};p.Lc=function(a){var b=this.icon;this.De&&(b.removeEventListener("statechange",this.Mg,!1,this),delete this.De);b&&(this.Ug=b.getState());pf.a.Lc.call(this,a);0===a.getState()&&(this.De=!0,Nd(a,"statechange",this.Mg,!1,this));return this};
pf.prototype.setIcon=pf.prototype.Lc;pf.prototype.Qf=function(a){return new U(a.yh,a)};var H=pa.H||{};q("H.buildInfo",function(){return Dd("mapsjs-core","0.3.0","829e580e0adaf40ec7ad4a1eb3de488ae4f6349b")});
;this['mapsjs'] = H;}());//# sourceMappingURL=mapsjs-core.map;// Source: ./source/javascripts/api/mapsjs-mapevents.js
(function(ns){var H = ns;var g,k=this,l="closure_uid_"+(1E9*Math.random()>>>0),n=0;function p(a,b,c){return a.call.apply(a.bind,arguments)}function q(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function r(a,b,c){r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:q;return r.apply(null,arguments)}function s(a,b){var c=a.split("."),d=k;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b};function t(a,b,c,d){if(isNaN(a))throw Error("x needs to be a number");if(isNaN(b))throw Error("y needs to be a number");if(isNaN(c))throw Error("pointer must have an id");this.viewportX=a;this.viewportY=b;this.target=null;this.id=c;this.type=d;this.dragTarget=null}s("H.mapevents.Pointer",t);function u(a,b,c){if(isNaN(b))throw Error("x needs to be a number");if(isNaN(c))throw Error("y needs to be a number");a.viewportX=b;a.viewportY=c};function w(a){var b=a.ownerDocument,b=b.documentElement||b.body.parentNode||b.body;a=a.getBoundingClientRect();return{x:a.left+("number"===typeof window.pageXOffset?window.pageXOffset:b.scrollLeft),y:a.top+("number"===typeof window.pageYOffset?window.pageYOffset:b.scrollTop)}};function x(a,b,c,d,e,f,h){H.util.getSuperProto(x).constructor.call(this,a);this.pointers=b;this.changedPointers=c;this.targetPointers=d;this.currentPointer=e;this.originalEvent=h;this.target=f}H.lang.inherits(x,H.util.Event);s("H.mapevents.Event",x);function y(a){this.b=a instanceof Array?a.slice(0):[]}g=y.prototype;g.clear=function(){this.b.splice(0,this.b.length)};g.length=function(){return this.b.length};g.item=function(a){return this.b[a]};g.indexOf=function(a){for(var b=this.b.length;b--;)if(this.b[b].id===a)return b;return-1};function z(a,b){var c=a.indexOf(b);return-1!==c?a.b[c]:null}g.remove=function(a){a=this.indexOf(a);return-1!==a?this.b.splice(a,1)[0]:null};
function A(a,b){for(var c=a.b.length,d=[];c--;)a.b[c].type!==b&&d.push(a.b[c]);a.b=d}function B(a,b){for(var c=a.b.length;c--;)if(a.b[c].dragTarget===b)return!0;return!1}g.push=function(a){if(a instanceof t)return this.b.push(a);throw Error("list needs a pointer");};g.asArray=function(){return this.b};g.clone=function(){return new y(this.b)};function C(){0!=D&&(E[this[l]||(this[l]=++n)]=this)}var D=0,E={};C.prototype.N=!1;C.prototype.dispose=function(){if(!this.N&&(this.N=!0,this.q(),0!=D)){var a=this[l]||(this[l]=++n);delete E[a]}};C.prototype.addOnDisposeCallback=function(a,b){this.u||(this.u=[]);this.u.push(r(a,b))};C.prototype.q=function(){if(this.u)for(;this.u.length;)this.u.shift()()};function F(a,b,c){c=c||{};if(!(a instanceof H.Map))throw Error("events: map instance required");if(!(b instanceof Array))throw Error("events: map array required");C.call(this);this.M=c.M||500;this.L=c.L||50;this.R=c.R||1E3;this.Q=c.Q||50;this.map=a;this.i=this.map.getViewPort();this.element=this.i.element;this.D=b;this.c=new y;this.e=new y;this.l={};this.h=null;this.v=!0;this.t={};this.s={};this.r=null;this.o=H.lang.bind(this.o,this);this.ia={pointerdown:this.fa,pointermove:this.ga,pointerup:this.ha,
pointercancel:this.ea};G(this)}H.lang.inherits(F,C);function G(a,b){for(var c,d,e=0,f=a.D.length,e=0;e<f;e++)d=a.D[e],c=d.g,"function"===typeof c&&(b?(d.target||a.element).removeEventListener(d.f,c):(d.target||a.element).addEventListener(d.f,c))}
function I(a,b,c){var d,e=a.ia[b],f,h;if("function"===typeof e)for("pointermove"!==b&&(a.v=!0),f=0,h=a.e.length();f<h;f++)b=a.e.item(f),a.element.contains(c.target)?(d=a,d=d.h===b?b.target:0<=b.viewportX&&b.viewportX<d.i.width&&0<=b.viewportY&&b.viewportY<d.i.height?d.map.getObjectAt(b.viewportX,b.viewportY)||d.map:null):d=null,J(b.id,a.t),e.call(a,b,d,c);a.e.clear()}g=F.prototype;
g.ha=function(a,b,c){a.target=b;K(this,a,c);L(this,b,"pointerenter",c,a);"mouse"!==a.type&&L(this,b,"pointerleave",c,a);b=this.l[a.id];var d=c.timeStamp,e=a.target,f=this.r;b&&b===e?(L(this,e,"tap",c,a),f&&f.target===e&&d-f.ka<this.M?f.da.distance({x:a.viewportX,y:a.viewportY})<this.L&&(L(this,e,"dbltap",c,a),this.r=null):this.r={target:e,da:new H.math.Point(a.viewportX,a.viewportY),ka:c.timeStamp}):this.r=null;this.l={};J(a.id,this.s)};
function K(a,b,c){b===a.h&&(L(a,b.dragTarget,"dragend",c,b),a.h=null,J(b.id,a.t));b.dragTarget=null}g.o=function(a,b){var c=this;L(this,a.dragTarget,"drag",b,a);J(a.id,this.t);this.t[a.id]=setTimeout(function(){c.o(a,b)},150)};function J(a,b){b[a]&&(clearTimeout(b[a]),delete b[a])}
function M(a,b,c){var d=b.target,e=new H.math.Point(b.viewportX,b.viewportY),f=b.id;J(f,a.s);a.s[f]=setTimeout(function(){d&&d===b.target&&e.distance({x:b.viewportX,y:b.viewportY})<a.Q&&(L(a,d,"longpress",c,b),delete a.l[b.id])},a.R)}
g.ga=function(a,b,c){var d=a.dragTarget,e=a.id,f;f=a.target;a.target=b;f!==b&&(L(this,f,"pointerleave",c,a),L(this,b,"pointerenter",c,a));d?this.h?this.o(a,c):this.v?this.v=!1:(this.h=a,L(this,d,"dragstart",c,a),this.o(a,c),this.l[e]=null,this.v=!0):(!this.h||this.h&&this.h.dragTarget!==b&&this.h.dragTarget!==this.map)&&L(this,b,"pointermove",c,a)};
g.fa=function(a,b,c){var d=a.type,d="mouse"!==d&&"pen"!==d||0===c.button?!0:!1,e;b&&(a.target=b,this.l[a.id]=b,"mouse"!==a.type&&L(this,b,"pointerenter",c,a),e=L(this,b,"pointerenter",c,a),!this.h&&d&&(b.draggable&&!B(this.c,b)?a.dragTarget=b:!this.map.draggable||e.defaultPrevented||B(this.c,this.map)||(a.dragTarget=this.map)),M(this,a,c))};
g.ea=function(a,b,c){a.target=null;b?(L(this,b,"pointerleave",c,a),L(this,b,"pointercancel",c,a)):L(this,this.map,"pointercancel",c,a);K(this,a,c);this.l={};J(a.id,this.s)};function L(a,b,c,d,e){var f;if(b&&"function"===typeof b.dispatchEvent){f=x;var h=a.c.asArray(),m=a.e.asArray();a=a.c;var v,W=a.b.length,Q=[];for(v=0;v<W;v++)a.b[v].target===b&&Q.push(a.b[v]);f=new f(c,h,m,Q,e,b,d);b.dispatchEvent(f)}return f}
g.q=function(){G(this,!0);this.c.clear();this.e.clear();var a=this.t,b;for(b in a)J(b,a);var a=this.s,c;for(c in a)J(c,a);this.h=this.l=this.r=this.map=this.e=this.c=this.D=null;C.prototype.q.call(this)};function N(a){this.m=H.lang.bind(this.m,this);F.call(this,a,[{f:"touchstart",g:this.m},{f:"touchmove",g:this.m},{f:"touchend",g:this.m},{f:"touchcancel",g:this.m}]);this.$={touchstart:"pointerenter",touchmove:"pointermove",touchend:"pointerenter",touchcancel:"pointercancel"};this.P=(a=(a=a.getImprint())?a.getElement():null)?Array.prototype.slice.call(a.querySelectorAll("a"),0):[]}H.lang.inherits(N,F);
N.prototype.m=function(a){var b=a.touches,c=this.c.length(),d;if("touchstart"===a.type&&c>=b.length){c=this.c.clone();for(d=b.length;d--;)c.remove(b[d].identifier);for(d=c.length();d--;)this.c.remove(c.item(d).id);this.e=c;I(this,"pointercancel",a);this.e.clear()}if(this.$[a.type]){b=w(this.i.element);c=a.type;d=a.changedTouches;var e=d.length,f,h,m;this.e.clear();for(m=0;m<e;m++)h=d[m],(f=z(this.c,h.identifier))?"touchmove"===c?u(f,h.pageX-b.x,h.pageY-b.y):"touchend"===c&&this.c.remove(f.id):(f=
new t(h.pageX-b.x,h.pageY-b.y,h.identifier,"touch"),this.c.push(f)),this.e.push(f);I(this,this.$[a.type],a);-1===this.P.indexOf(a.target)&&a.preventDefault()}};N.prototype.q=function(){this.P=null;F.prototype.q.call(this)};function O(a){var b=[],b=P(this);(navigator.pointerEnabled||navigator.msPointerEnabled)&&b.push({f:"MSHoldVisual",g:"prevent"});F.call(this,a,b)}H.lang.inherits(O,F);function P(a){var b=navigator.pointerEnabled,c,d,e=[];a.F=H.lang.bind(a.F,a);"MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach(function(f){c=f.toLowerCase().replace(/ms/g,"");d=b?c:f;e.push({f:d,g:a.F,target:"MSPointerUp"===f||"MSPointerMove"===f?window:null})});return e}
var R={2:"touch",3:"pen",4:"mouse"};O.prototype.C=function(a,b){var c;c=a.pointerType;"number"===typeof c&&(c=R[c]);c=new t(b.x,b.y,a.pointerId,c);this.c.push(c);return c};
O.prototype.F=function(a){var b=navigator.ma?a.type:a.type.toLowerCase().replace(/ms/g,""),c=w(this.element),d=z(this.c,a.pointerId),e=a.pageX-c.x,c=a.pageY-c.y,f=R[a.pointerType]||a.pointerType;d||b in{pointerup:1,pointerout:1,pointercancel:1}||"touch"===f&&"pointerenter"!==b||(d=this.C(a,{x:e,y:c}));d&&(b in{pointerup:1,pointercancel:1}&&this.c.remove(d.id),"pointerenter"===b&&"touch"===a.pointerType&&(A(this.c,"mouse"),A(this.c,"pen")),this.e.push(d),"pointermove"!==b?(u(d,e,c),I(this,"pointerout"===
b||"pointerover"===b?"pointermove":b,a)):d.viewportX===e&&d.viewportY===c||a.target===document.documentElement||(u(d,e,c),I(this,b,a)));this.e.clear()};function S(a,b,c,d,e){H.util.getSuperProto(S).constructor.call(this,"wheel");this.delta=a;this.viewportX=b;this.viewportY=c;this.target=d;this.originalEvent=e}H.lang.inherits(S,H.util.Event);s("H.mapevents.WheelEvent",S);function T(a){var b="onwheel"in document;this.ca=b;this.ba=(b?"d":"wheelD")+"elta";this.G=H.lang.bind(this.G,this);H.util.getSuperProto(T).constructor.call(this,a,[{f:(b?"":"mouse")+"wheel",g:this.G}])}H.lang.inherits(T,F);T.prototype.normalize=function(a,b,c){var d=this.ba,e=a[d+(d+"Y"in a?"Y":"")],f,h,m;e&&(m=Math.abs,f=m(e),e=(!(h=a[d+"X"])||3<=f/m(h))&&(!(h=a[d+"Z"])||3<=f/m(h))?((0<e)-(0>e))*(this.ca?1:-1):0);return new S(e,b,c,null,a)};
T.prototype.G=function(a){var b=w(this.element);a=this.normalize(a,a.pageX-b.x,a.pageY-b.y);a.delta&&(a.target=this.map.getObjectsAt(a.viewportX,a.viewportY)[0],a.target&&"function"===typeof a.target.dispatchEvent&&a.target.dispatchEvent(a),a.defaultPrevented||this.map.dispatchEvent(a))};function U(a){var b=window;this.k=H.lang.bind(this.k,this);F.call(this,a,[{f:"mousedown",g:this.k},{f:"mousemove",g:this.k,target:b},{f:"mouseup",g:this.k,target:b},{f:"pointerenter",g:this.k},{f:"mouseout",g:this.k},{f:"dragstart",g:this.A}])}H.lang.inherits(U,F);U.prototype.C=function(a,b){var c=new t(b.x,b.y,1,"mouse");this.c.push(c);return c};
U.prototype.k=function(a){var b=a.type,c=w(this.element),c={x:a.pageX-c.x,y:a.pageY-c.y},d=this.c.item(0)||this.C(a,c);this.e.push(d);u(d,c.x,c.y);b in{mousemove:1,mouseover:1,mouseout:1}?I(this,"pointermove",a):I(this,b.replace("mouse","pointer"),a);this.e.clear()};U.prototype.A=function(a){a.preventDefault()};function V(a){this.a=a;this.aa=this.H=this.J=null;navigator.msPointerEnabled||navigator.pointerEnabled?this.J=new O(this.a):(this.J=new N(this.a),this.H=new U(this.a));this.aa=new T(this.a);this.a.addOnDisposeCallback(this.p,this);H.util.getSuperProto(V).constructor.call(this)}H.lang.inherits(V,H.util.EventTarget);s("H.mapevents.MapEvents",V);V.prototype.p=function(){this.a=null;this.J.dispose();this.aa.dispose();this.H&&this.H.dispose();this&&"function"==typeof this.dispose&&this.dispose()};
V.prototype.destroy=V.prototype.p;V.prototype.ja=function(){return this.a};V.prototype.getAttachedMap=V.prototype.ja;function X(a,b){var c=b||{},d;this.a=d=a.a;this.a.draggable=!0;this.la=c.zoomDuration||300;this.w=c.kinetics||{duration:600,ease:H.util.animation.ease.EASE_OUT_QUAD};this.O=7;this.enable(c.enabled||this.O);c=H.Map.EngineType;this.i=this.a.getViewPort();this.n=this.i.element;this.B=this.a.getViewModel();this.j=null;this.K=!1;this.Y=c.P2D;this.n.style.msTouchAction="none";this.n.style.na="none";d.addEventListener("dragstart",this.A,!1,this);d.addEventListener("drag",this.U,!1,this);d.addEventListener("dragend",
this.V,!1,this);d.addEventListener("wheel",this.X,!1,this);d.addEventListener("dbltap",this.T,!1,this);d.addEventListener("tap",this.W,!1,this);d.addEventListener("pointermove",this.Z,!1,this);H.util.events.listen(this.n,"contextmenu",this.S,!1,this);a.addOnDisposeCallback(this.p,this)}s("H.mapevents.Behavior",X);X.prototype.d=0;X.DRAGGING=1;X.WHEELZOOM=2;X.DBLTAPZOOM=4;g=X.prototype;
g.A=function(a){var b=a.pointers;a=this.i;var c=b[0],b=b[1]||{};this.d&1&&(a.startInteraction(17,this.w),a.interaction(c.viewportX,c.viewportY,b.viewportX,b.viewportY))};g.U=function(a){var b=a.pointers[0],c=a.pointers[1]||{};this.d&1&&(this.i.interaction(b.viewportX,b.viewportY,c.viewportX,c.viewportY),a.originalEvent.preventDefault())};
g.V=function(a){var b=a.currentPointer.type,c=a.pointers,d=c[0],c=c[1]||{},e=this.i;this.d&1&&(e.endInteraction(!this.w),0<a.targetPointers.length&&"touch"===b&&(e.startInteraction(17,this.w),e.interaction(d.viewportX,d.viewportY,c.viewportX,c.viewportY)))};g.I=function(){this.K=!1;this.B.removeEventListener("sync",this.I,!1,this)};
g.zoom=function(a,b,c,d){var e=this,f=this.a,h=+b-+a;if(isNaN(+a))throw Error("start zoom needs to be a number");if(isNaN(+b))throw Error("to zoom needs to be a number");this.K||(this.K=!0,this.j=new H.util.animation.Animation(function(b){f.zoomAt(a+h*b,c,d);1===b&&e.B.addEventListener("sync",e.I,!1,e)},this.la),this.j.start())};
g.X=function(a){var b,c,d,e;this.d&2&&(b=a.delta,c=this.a.getZoom(),e=Math[0>b?"ceil":"floor"](c-b),d=this.a,d.getEngine().type===this.Y?this.zoom(c,e,a.viewportX,a.viewportY):(c=this.a.getViewModel().getCameraData(),c.fov-=b,d.getViewModel().setCameraData(c)),a.originalEvent.preventDefault())};g.W=function(a){a=a.currentPointer;var b=this.a.getEngine();this.Y!==b.type&&(a=this.a.screenToCameraData(a.viewportX,a.viewportY),this.a.getViewModel().setCameraData(a))};
g.Z=function(a){a=a.currentPointer;this.a.getEngine().setPointer(a.viewportX,a.viewportY)};g.T=function(a){var b=a.currentPointer,c=this.a.getZoom();a="mouse"===a.currentPointer.type?c+(0===a.originalEvent.button?1:-1):c+(0<a.pointers.length?-1:1);this.d&4&&this.zoom(c,a,b.viewportX,b.viewportY)};g.S=function(a){return this.d&4?(a.preventDefault(),!1):!0};
g.p=function(){var a=this.a;a.draggable=!1;this.n.style.msTouchAction="";this.B.removeEventListener("sync",this.I,!1,this);H.util.events.unlisten(this.n,"contextmenu",this.S,!1,this);a.removeEventListener("dragstart",this.A,!1,this);a.removeEventListener("drag",this.U,!1,this);a.removeEventListener("dragend",this.V,!1,this);a.removeEventListener("wheel",this.X,!1,this);a.removeEventListener("tap",this.W,!1,this);a.removeEventListener("dbltap",this.T,!1,this);a.removeEventListener("pointermove",this.Z,
!1,this);this.j&&this.j.stop(!0);this.a=this.B=this.w=this.i=this.j=this.n=null};X.prototype.destroy=X.prototype.p;X.prototype.disable=function(a){this.i.endInteraction(!0);this.j&&this.j.stop(!0);a?this.d&a&&(this.d-=a,a&1&&(this.a.draggable=!1)):(this.d=0,this.a.draggable=!1)};X.prototype.disable=X.prototype.disable;X.prototype.enable=function(a){a?this.d&a||(this.d+=a,a&1&&(this.a.draggable=!0)):(this.d=this.O,this.a.draggable=!0)};X.prototype.enable=X.prototype.enable;
X.prototype.isEnabled=function(a){if(isNaN(a))throw Error("behavior: number required");return!!(this.d&a)};X.prototype.isEnabled=X.prototype.isEnabled;var H=H||{};s("H.mapevents.buildInfo",function(){return H.util.BuildInfo.get("mapsjs-mapevents","0.3.0","91f67c5ec7a701b0322952c0f3293b9aa0f9b28b")});
}(H));//# sourceMappingURL=mapsjs-mapevents.map;// Source: ./source/javascripts/api/mapsjs-pano.js
// 2014-07-10 16:40.45
// v: 1.0.3.0, build:48, changeset:daa8704f24b4f4c93aab5bf9a234bc286aee10f0
/* Copyright (C) 2014, HERE Deutschland GmbH, Germany
*/
(function() {if(window['Object']['create']) {'use strict';var p,ba=this;function ca(a,b){for(var c in b)a[c]=b[c]}function da(a,b){var c=a.split("."),d=ba;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function ha(a,b){function c(){}c.prototype=b.prototype;a.Du=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.ft=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};var ia,ja,la,ma,na;function oa(){}na=function(){};ma=function(){};la=function(){};ja=function(){};ia=function(){};function pa(){return new oa}function qa(){};function ra(a,b){this.b=a;this.a=b||null}function sa(a){this.a=[];this.b=a}sa.prototype.qc=function(a,b){this.a.push(new ra(a,b||null))};sa.prototype.disconnect=function(a,b){var c=this.a,d=0;if(a||b)for(var e=a||null,f=b||null,g=0;g<c.length;){var h=c[g];f!==h.a||e&&e!==h.b?++g:(c.splice(g,1),++d)}else d=c.length,c.length=0;return d};
sa.prototype.call=function(a){var b=this.a.slice(),c=this.b;if(c){for(var d=[],e=0,f=b.length;e<f;++e){var g=b[e],h=g.b,g=g.a,h=h.apply(g,arguments);d.push(h)}if(0<d.length)return d.reduce(c)}else{e=0;for(f=b.length;e<f;++e)g=b[e],h=g.b,g=g.a,h=h.apply(g,arguments);return h}};function q(a){this.Eb=a.Eb;this.duration=a.duration||1E3;this.H=a.rc;this.j=a.ee||this;this.Ma=a.td;this.Wa=a.Sb;this.d=this.Ae=0;this.b=null;this.Fj=new sa(void 0);this.o=!1;this.Ee=q.STATE.Sd;this.Pi=null;this.xa=this.aa=0;this.n=this.duration}q.STATE={Sd:"stopped",Ze:"running",Jf:"paused"};p=q.prototype;p.t=function(){this.Pi=this.Wa=this.Ma=this.j=this.H=this.Eb=null;this.Fj.disconnect()};p.Od=function(a){this.n=this.duration=a};
p.start=function(){this.Ae=this.d=0;this.b=null;ta(this,q.STATE.Ze);void 0!==this.Ma&&"function"===typeof this.Ma&&this.Ma.call(this.j);0===this.duration?this.finish():this.hf(0)};p.qa=function(){return this.Ee===q.STATE.Ze};p.finish=function(){this.hf(1);void 0!==this.Wa&&"function"===typeof this.Wa&&this.Wa.call(this.j);this.d=this.Ae=0;this.Rg(1);ta(this,q.STATE.Sd);this.b=null};p.cancel=function(){this.qa()&&(this.hf(0),ta(this,q.STATE.Sd),this.b=null)};p.pause=function(){this.qa()&&ta(this,q.STATE.Jf)};
p.stop=function(){this.qa()&&ta(this,q.STATE.Sd)};p.Af=function(){this.qa()||this.Ee!==q.STATE.Jf||(this.o=!0,this.hf(this.Ae),ta(this,q.STATE.Ze))};p.Rg=function(a){this.aa=this.d;this.xa=this.Ae;this.n=this.d+(this.duration-this.d)/a};function ta(a,b){a.Ee!==b&&(a.Ee=b,a.Fj.call({target:a,state:b}))}p.hf=function(a){var b=a;this.H&&"function"===typeof this.H&&(b=this.H(a));this.Eb.call(this.j,b)};
p.Dh=function(a){null===this.b?(this.b=a,this.hf(0)):(this.o?(this.d=this.Ae*this.n,this.b=a-this.d,this.o=!1):this.d=a-this.b,this.d>=this.n?this.finish():(this.Ae=this.xa+(1-this.xa)*(this.d-this.aa)/(this.n-this.aa),this.hf(this.Ae)))};function ua(a){q.call(this,a);this.a=a.i||[];0>=this.a.length&&ia();for(a=0;a<this.a.length;a++)this.a[a].Pi=this}ua.prototype=new q({});p=ua.prototype;p.Od=function(){};p.t=function(){q.prototype.t.call(this);for(var a=0;a<this.a.length;a++)this.a[a].t();this.a=null};p.start=function(){void 0!==this.Ma&&"function"===typeof this.Ma&&this.Ma.call(this.j);this.Ae=this.d=0;this.b=null;ta(this,q.STATE.Ze);for(var a=0;a<this.a.length;a++)this.a[a].start()};
p.finish=function(){for(var a=0;a<this.a.length;a++)this.a[a].qa()&&this.a[a].finish();void 0!==this.Wa&&"function"===typeof this.Wa&&this.Wa.call(this.j);ta(this,q.STATE.Sd);this.b=null};p.cancel=function(){for(var a=0;a<this.a.length;a++)this.a[a].cancel();ta(this,q.STATE.Sd);this.b=null};p.stop=function(){for(var a=0;a<this.a.length;a++)this.a[a].stop();ta(this,q.STATE.Jf);this.b=null};
p.Af=function(){if(!this.qa()){for(var a=0;a<this.a.length;a++)this.a[a].Af();this.Ee===q.STATE.Jf&&(this.o=!0,ta(this,q.STATE.Ze))}};p.Rg=function(a){for(var b=0;b<this.a.length;b++)this.a[b].qa()&&this.a[b].Rg(a)};p.hf=function(){};p.Dh=function(a){var b=0;if(null===this.b)this.b=a;else{for(var c=!1,b=0;b<this.a.length;b++)this.a[b].qa()&&(this.a[b].Dh(a),c=!0);c?ta(this,q.STATE.Ze):(this.finish(),ta(this,q.STATE.Sd))}};function va(a,b){return"in"===a?function(a){return wa(a,b)}:"out"===a?function(a){return xa(a,b)}:function(a){return 0.5>a?0.5*wa(2*a,b):0.5*xa(2*a,b,2)}}function ya(a){return function(b){return 0.5>=b?xa(2*b,a):xa(2-2*b,a)}}function wa(a,b){return Math.pow(a,b||2)}function xa(a,b,c){c=c||1;return b%2?Math.pow(a-c,b)+c:-(Math.pow(a-c,b)-c)}var Aa=va("in",2),Ba=va("out",2),Ca=va("inout",2),Da=va("in",3);function Ea(a,b){q.call(this,{duration:b,rc:Aa,ee:this,Sb:this.Wa,td:this.Ma,Eb:this.Qr});this.q=a;this.mc=null;this.Mb=[0,0,0];this.Ed=[0,0,0];this.af=[0,0,0];this.$d=[0,0,0];this.Be=[0,0,0];this.Zi=[0,0,0];this.Mi=[0,0,0];this.Uc=0;this.gm=!1;this.ge=1;this.te=0;this.Qn=!0}var Fa=pa();Ea.prototype=new q({});p=Ea.prototype;p.t=function(){q.prototype.t.call(this);this.q=null};p.kb=Fa;
p.Mc=function(a,b){a&&(this.mc=Ga(a));this.Uc=b;var c=Ha(this.Mb),d=Ja(this.Mb);this.Uc?(c=Ka(c,-(this.Uc*u)),c=Oa(c),this.Ed=z.I(c,d)):this.Ed=d};
p.Ma=function(){var a=this.q;this.gm&&(a.l.i.transition.start(),a.l.i.transition.finish());Pa(a.k);Qa(a,0);a.k.Xe(a.vf);a.k.Bf(a.lg);this.Mb=a.k.r.ib().slice(0,3);var b=Ha(this.Mb),c=Ja(this.Mb);this.mc||(this.mc=this.Mb);z.$f(this.mc,this.Mb)?z.sub(this.Mb,b,this.$d):this.$d=this.Mb;this.Be=Ra(Ta(a.Zd,!0));this.Zi=z.sub(this.$d,this.mc);this.Mi=z.sub(this.Be,this.Mb);if(this.Uc){var d=Ka(b,-(this.Uc*u)),d=Oa(d);this.Ed=z.I(d,c)}else this.Ed=c;this.af=b;a.lg&&(Ua(a.k),Va(a.N(),this.$d,this.Ed,this.mc));
a.k.Gd();this.Qn?(Wa(a.k,a.Hf),a.k.Pd(a.xi)):(Wa(a.k,a.Hd),a.k.Pd(!1));this.gm=!1;a.u()};p.Wa=function(){var a=this.q;a.l.i.hg.stop();a.l.i.qf.start();Xa(a.N(),a.k.r.ib());a.lg&&Ya(a.k);Za(a);a.u();a.Za.Ga.handleEvent("ENTER_ANIMATION_FINISHED",a.k.r)};p.Qr=function(a){var b=this.q,c=z.ma(this.mc,this.Mb,a),d=z.wn(this.Zi,this.Mi,a),d=z.add(c,d),e=z.wn(this.Ed,this.af,a);b.am=0===this.te&&1===this.ge?a:this.te+a*(this.ge-this.te);Va(b.N(),d,e,c);b.u()};function $a(a,b){q.call(this,{duration:b,rc:Ca,ee:this,Sb:this.Wa,td:this.Ma,Eb:this.a});this.q=a;this.Yi=0;this.Fl=this.Li=90*u}$a.prototype=new q({});$a.prototype.t=function(){q.prototype.t.call(this);this.q=null};$a.prototype.Ma=function(){this.Li=this.Fl;this.Yi=this.q.Ca.ka();this.q.u()};$a.prototype.Wa=function(){this.q.Za.Ga.handleEvent("FOV_ANIMATION_FINISHED");this.q.Za.C.U("fovChangeFinished")};$a.prototype.a=function(a){this.q.Ca.Ja(ab(this.Yi,this.Li,a));this.q.u()};function cb(a){this.a=a.Eb;a.Eb=this.s;q.call(this,a);this.g=a.propertyName;this.c=a.jm?a.jm:0;this.p=a.Qj?a.Qj:0;this.e=a.object}cb.prototype=new q({});cb.prototype.t=function(){q.prototype.t.call(this);this.e=this.p=this.c=this.g=this.a=null};cb.prototype.s=function(a){this.a&&"function"===typeof this.a&&this.a(a);this.e[this.g]=this.c+a*(this.p-this.c)};function db(a,b){q.call(this,{duration:b,rc:function(a){return a},ee:this,Sb:this.Wa,td:this.Ma,Eb:this.Rr});this.q=a;this.ae=[0,0,0];this.Uf=[0,0,0];this.Ih=this.Uc=0}var eb=pa();db.prototype=new q({});p=db.prototype;p.kb=eb;p.t=function(){q.prototype.t.call(this);this.q=null};
p.Ma=function(){var a=this.q,b=a.l.i.xf.qa(),c;b&&(c=a.l.i.xf.Ae,0==c&&(b=!1));a.l.i.xf.stop();Pa(a.k);Pa(a.Z);this.ae=a.ya.S.slice();this.Uf=a.Z.r.ib().slice(0,3);var d=z.sub(this.Uf,this.ae);this.Ll=z.length(d);this.Pj=0;0==this.duration?b=!1:this.Od(gb.transition);if(b&&(b=0,d=c,c=0.01,d<c?c=d:b=d-c,0!=c)){for(var b=(Aa(d)-Aa(b))/c*1E3/a.l.i.xf.duration/a.l.i.xf.Ll,d=0,e,f=-1,g=1E5;0.5>=d;){e=1-d;e=(Ca(d+c)-Ca(d))/c/e/this.Ll;e=Math.abs(b-e);if(e<g&&(f=d,g=e,0.001>g))break;d+=c}0<f&&(this.Od((1-
f)*gb.transition),this.Pj=f)}this.q.l.i.qf.stop();hb(a)?(Wa(a.k,a.Hf),Wa(a.Z,a.Hf),a.k.Bf(a.lg)):(a.k.Pd(!1),a.Z.Pd(!1),Wa(a.k,a.Hd),Wa(a.Z,a.Hd),a.cursor.G(!1),a.l.i.hg.finish(),a.k.Bf(!1),a.gh.G(!1));a.k.Xe(a.vf);a.Z.Bf(!1);this.Uc=this.q.N().fa();this.Ih=this.q.N().ia();z.$f(this.ae,this.Uf)&&this.finish();ib&&this.Od(0);a.u()};
p.Wa=function(){var a=this.q;Pa(a.k);Pa(a.Z);if(a.Z.r){a.Z.Xe(a.vf);a.k.Xe(!1);var b=a.k;a.k=a.Z;a.Z=b}Za(a);hb(a)?(Wa(a.k,a.Hd),Wa(a.Z,a.Hd)):(a.k.Pd(a.xi),a.Z.Pd(a.xi),a.cursor.G(!0),a.gh.G(!0));Qa(a,0);Ya(a.k);a.l.i.hg.start();a.k.Bf(a.lg);a.Z.Bf(!1);a.lg&&(Ua(a.k),Ya(a.k),Xa(a.N(),a.k.r.ib()));a.u();a.nh.kn()};
p.Rr=function(a){var b=this.q,c=a*(1-this.Pj)+this.Pj,d=1-Ca(this.Pj),c=(Ca(c)-Ca(this.Pj))/d;Qa(b,Da(a));a=z.ma(this.ae,this.Uf,c);Xa(b.N(),a);b=Ra(jb(a,this.Uc,this.Ih));Va(this.q.N(),b,Ha(a))};function ob(){this.i={};this.b=-1;this.a=!1;this.c=new sa(void 0);this.d=this.e.bind(this)}ob.prototype.add=function(a){return a?(this.b++,this.i[this.b]=a,a.id=this.b,a.Fj.qc(this.d),this.b):null};ob.prototype.remove=function(a){if(a in this.i){var b=this.i[a];delete this.i[a];b.Fj.disconnect(this.d);return!0}return!1};ob.prototype.t=function(){for(var a in this.i){var b=this.i[a];b&&b.t();this.c.disconnect()}this.a=!1;this.i=null};ob.prototype.e=function(a){a.state==q.STATE.Ze&&(this.a=!0);this.c.call(a)};function pb(a,b){q.call(this,{duration:b,ee:this,Sb:this.Wa,td:this.Ma,Eb:this.Pr});this.q=a;this.mc=[0,0,0];this.Mb=[0,0,0];this.Ed=[0,0,0];this.af=[0,0,0];this.$d=[0,0,0];this.Be=[0,0,0];this.oo=qb;this.Hq=rb;this.wh=1;this.te=0;this.ge=1;this.Qn=!0;this.yh=-45;this.a=2;this.pc=ya(this.a)}var qb=3.5,rb=0,sb=pa();pb.prototype=new q({});p=pb.prototype;p.t=function(){q.prototype.t.call(this);this.q=null};p.kb=sb;
p.Ma=function(){var a=this.q;this.Qn?(Wa(a.k,a.Hf),a.k.Pd(a.xi)):(Wa(a.k,a.Hd),a.k.Pd(!1));Za(a);var b=a.Cd,c=b.Ua(),d=tb(c);this.mc=Ra(c);this.Mb=z.add(this.mc,z.scale(d,this.oo));this.wh=1-this.Hq/(2*this.oo);Za(a);this.$d=Ra(Ta(b,!0));this.Be=this.mc;this.Be=Ra(jb(c,b.fa(),this.yh))||[];this.Ed=Ha(ub(a.ya));c=z.sub(this.Be,this.Mb);d=z.sub(this.$d,this.mc);d=z.normalize(z.pa(c,d));b.ia()>this.yh?this.af=z.normalize(z.pa(d,c)):this.af=z.normalize(z.pa(c,d));a.l.i.qf.stop();a.l.i.hg.start();a.k.Lc(!0);
a.Z.Lc(!0);1>this.ge&&(this.Mb=z.ma(this.mc,this.Mb,this.ge),this.Be=z.ma(this.$d,this.Be,this.ge),this.af=z.ma(this.Ed,this.af,this.ge));0<this.te&&(this.mc=z.ma(this.mc,this.Mb,this.te),this.$d=z.ma(this.$d,this.Be,this.te),this.Ed=z.ma(this.Ed,this.af,this.te));a.u()};p.Wa=function(){var a=this.q;a.l.i.hg.stop();a.l.i.qf.start();a.u();a.Za.Ga.handleEvent("BOUNCE_ANIMATION_FINISHED")};
p.Pr=function(a){var b=this.q,c=this.pc(a);if(1!==this.wh&&0.5<=a&&c<=2-2*this.wh)1!==a&&(this.stop(),this.Pi&&this.Pi.stop());else{var d=z.ma(this.mc,this.Mb,c),e=z.ma(this.$d,this.Be,c),f=z.ma(this.Ed,this.af,c);Xa(b.N(),d);Va(b.N(),e,f);b.u();1!==this.wh&&0.5<=a&&c<=2-2*this.wh&&this.finish()}};function vb(a,b){this.a=3;q.call(this,{duration:b,rc:ya(this.a),ee:this,Sb:this.Wa,td:this.Ma,Eb:this.c});this.q=a;this.Eq=-(8*u)}vb.prototype=new q({});vb.prototype.t=function(){q.prototype.t.call(this);this.q=null};vb.prototype.Ma=function(){this.qa()||(this.Yi=this.q.Ca.ka(),this.Li=this.Yi+this.Eq,this.q.u())};vb.prototype.Wa=function(){this.q.Za.Ga.handleEvent("FOV_BOUNCE_ANIMATION_FINISHED")};vb.prototype.c=function(a){this.q.Ca.Ja(ab(this.Yi,this.Li,a));this.q.u()};function wb(a,b){q.call(this,{duration:b,rc:Ca,ee:this,Sb:this.Wa,td:this.Ma,Eb:this.a});this.q=a;this.yh=this.xh=this.Ih=this.Uc=0;this.Zi=[0,0,0];this.Mi=[0,0,0];this.Fg=this.zl=null}wb.prototype=new q({});wb.prototype.t=function(){q.prototype.t.call(this);this.q=null};
wb.prototype.Ma=function(){var a=this.q;Za(a);var b=a.Cd,c=a.Zd;this.zl=Ra(Ta(b,!0));this.Fg=(this.Fg=Ta(c))?Ra(this.Fg):null;this.Zi=z.sub(this.zl,a.ya.S);this.Uc=b.fa();this.Ih=b.ia();this.xh=c.fa();this.yh=c.ia();null!=this.xh&&(b=this.Uc-this.xh,180<xb(b)&&(this.xh=this.Uc-(0>b?360+b:-360+b)),yb(this.Uc,this.xh,0.001,1)&&yb(this.Ih,this.yh,0.001,1)&&this.finish());a.u()};wb.prototype.Wa=function(){Za(this.q);this.q.Za.Ga.handleEvent("LOOK_AT_ANIMATION_FINISHED")};
wb.prototype.a=function(a){if(this.qa()){var b=this.q.ya.S;this.Fg&&!z.$f(this.zl,this.Fg)?(this.Mi=z.sub(this.Fg,b),a=z.wn(this.Zi,this.Mi,a),a=z.add(b,a),Va(this.q.N(),a,Ha(b))):(b=ab(this.Ih,this.yh,a),this.q.N().sb(ab(this.Uc,this.xh,a)),this.q.N().Cb(b))}};function zb(a){q.call(this,a);this.a=a.i||[];0<this.a.length?this.c=0:ia();for(a=0;a<this.a.length;a++)this.a[a].Pi=this}zb.prototype=new q({});p=zb.prototype;p.Od=function(){};p.t=function(){q.prototype.t.call(this);for(var a=0;a<this.a.length;a++)this.a[a].t();this.a=null};p.start=function(){void 0!==this.Ma&&"function"===typeof this.Ma&&this.Ma.call(this.j);this.c=this.Ae=this.d=0;this.b=null;ta(this,q.STATE.Ze);this.a[this.c].start()};
p.finish=function(){for(var a=!1,b=0;b<this.a.length;b++)this.a[b].qa()&&(a=!0),a&&(this.a[b].start(),this.a[b].finish());this.a[this.a.length-1].finish();void 0!==this.Wa&&"function"===typeof this.Wa&&this.Wa.call(this.j);ta(this,q.STATE.Sd);this.b=null;this.c=0};p.cancel=function(){for(var a=this.c;0<=a;a--)this.a[a].cancel();ta(this,q.STATE.Sd);this.b=null};p.stop=function(){this.qa()&&(this.a[this.c].stop(),ta(this,q.STATE.Jf),this.b=null)};
p.Af=function(){this.qa()||this.Ee!==q.STATE.Jf||(this.a[this.c].Af(),ta(this,q.STATE.Ze),this.o=!0)};p.Rg=function(a){for(var b=this.c;b<this.a.length;b++)this.a[b].Rg(a)};p.hf=function(){};p.Dh=function(a){null===this.b?this.b=a:this.a[this.c].qa()?this.a[this.c].Dh(a):this.a.length>this.c+1?(this.c++,this.a[this.c].start()):this.finish()};function Cb(a,b){q.call(this,{duration:b,rc:Aa,ee:this,td:this.Ma,Eb:this.a});this.q=a;this.ae=[0,0,0];this.Uf=[0,0,0]}var Db=pa();Cb.prototype=new q({});Cb.prototype.t=function(){q.prototype.t.call(this);this.q=null};Cb.prototype.kb=Db;
Cb.prototype.Ma=function(){this.ae=this.q.ya.S.slice();var a=this.q.Z.r.ib(),b=z.sub(a,this.ae),a=z.distance(a,this.ae);z.$f(b,[0,0,0])?(this.Uf=this.ae,this.cancel()):(b=z.scale(z.normalize(b),Math.min(0.8*a,50)),this.Uf=z.add(this.ae,b),this.Ll=z.length(b),this.q.k.Lc(this.q.wi),Wa(this.q.k,this.q.Hf),this.q.Z.Lc(this.q.wi),Wa(this.q.Z,this.q.Hf));this.q.u()};Cb.prototype.a=function(a){a=z.ma(this.ae,this.Uf,a);Xa(this.q.N(),a)};function Eb(a,b,c){this.qa=!1;this.a=a;this.object=b;this.c=c;this.b=this.startTime=null}Eb.prototype.start=function(){this.qa||(this.qa=!0,this.a.pe.push(this),this.startTime=null);Fb(this.a)};Eb.prototype.stop=function(){if(this.qa){this.qa=!1;var a=this.a;a.pe.splice(a.pe.indexOf(this),1)}Fb(this.a)};function Gb(a){q.call(this,{duration:void 0,rc:void 0,ee:this,Sb:this.Wa,td:this.Ma});this.q=a;this.pe=[]}Gb.prototype=new q({});
function Fb(a){for(var b=!1,c=a.pe.length-1;0<=c;c--)if(a.pe[c].qa){b=!0;break}b?a.start():a.stop()}p=Gb.prototype;p.t=function(){q.prototype.t.call(this);this.q=this.pe=null};p.Ma=function(){};p.Wa=function(){for(var a=this.pe.length-1;0<=a;a--)this.pe[a].stop();this.pe=[]};p.hf=function(){};p.Dh=function(a){for(var b=this.pe.length-1;0<=b;b--){var c=this.pe[b];null===c.startTime&&(c.startTime=a);c.b=a;if(c.c){var d=c.c(c.b-c.startTime,c);E(d)||d||c.stop()}}};function Hb(a){this.q=a;var b=this;this.l=new ob;this.i={};this.a=this.l.c;this.i.transition=new db(this.q,gb.transition);this.i.gb=new Ea(this.q,gb.gb);this.i.pc=new pb(this.q,gb.pc);this.i.xf=new Cb(this.q,gb.xf);this.i.rb=new wb(this.q,gb.rb);this.i.ld=new $a(this.q,gb.ld);this.i.hm=new vb(this.q,gb.hm);this.i.qf=new cb({duration:gb.qf,rc:Ca,propertyName:"globalLabelOpacity",Sb:function(){b.q.Za.Ga.handleEvent("FADED_IN")},Eb:function(){b.q.u()},object:this.q,Qj:1});this.i.qf.Vh=!0;this.i.hg=new cb({duration:gb.hg,
rc:Ca,Sb:function(){b.q.Za.Ga.handleEvent("FADED_OUT")},Eb:function(){b.q.u()},propertyName:"globalLabelOpacity",object:this.q,Qj:0});this.i.hg.Vh=!0;this.i.fh=new cb({duration:gb.fh,rc:Ca,Sb:function(){b.q.Za.Ga.handleEvent("ALL_FADED_OUT")},propertyName:"globalOverlayOpacity",object:this.q,jm:1,Qj:0});this.i.fh.Vh=!0;this.i.vi=new cb({duration:gb.vi,rc:Ca,Sb:function(){b.q.Za.Ga.handleEvent("ALL_FADED_IN")},propertyName:"globalOverlayOpacity",object:this.q,jm:0,Qj:1});this.i.vi.Vh=!0;this.i.Rj=
new ua({i:[this.i.transition,this.i.rb],Sb:function(){b.q.Za.Ga.handleEvent("TRANSITION_FINISHED",b.q.k.r)}});this.i.Sj=new zb({i:[this.i.transition,this.i.rb],Sb:function(){b.q.Za.Ga.handleEvent("TRANSITION_FINISHED",b.q.k.r)}});this.i.fc=new ua({i:[this.i.xf,this.i.rb]});this.i.ai=new ua({i:[this.i.ld,this.i.rb],td:function(){this.i.rb.Od(gb.ld)},Sb:function(){this.i.rb.Od(gb.rb)},ee:this});this.i.Cj=new Gb({ee:this});this.i.Cj.Vh=!0;for(var c in this.i)this.i.hasOwnProperty(c)&&this.l.add(this.i[c])}
Hb.prototype.t=function(){this.l.t();this.q=null;delete this.i};var gb={transition:1300,gb:800,kd:800,pc:800,xf:2500,qu:200,rb:1300,qf:300,hg:300,vi:800,fh:800,ld:500,hm:400};Hb.prototype.enable=function(a){for(var b in this.i)if(this.i.hasOwnProperty(b))if(a)this.i[b].Od(gb[b]);else{var c=this.i[b];c.Vh||((c.qa()||c.Ee===q.STATE.Jf)&&c.finish(),c.Od(0))}b=this.q;a||b.l.i.fc.cancel();b.vo=a&&(0!=b.va&&1==b.va?!1:!0)};
function Ib(a){if(a.l.a){a=a.l.i;for(var b in a){var c=a[b];if(!c.Vh&&c.qa())return!0}}return!1}function Nb(a){return a.i.transition.qa()||a.i.xf.qa()?!0:!1};var Ob={transitionHighlight:{vs:"precision highp float;attribute vec3 a_vertex;attribute vec3 a_normal;uniform mat4 u_mat_proj;uniform mat4 u_mat_view;uniform mat4 u_mat_model;uniform vec3 u_mesh_diff_0;uniform vec3 u_mesh_diff_1;uniform float u_transition_factor;uniform vec4 u_highlight_color;uniform mat4 u_mat_normal;uniform vec4 u_ambient_color;uniform vec3 u_directional_light_direction;uniform vec4 u_directional_light_color;uniform vec3 u_point_light_position;uniform vec4 u_point_light_color;varying vec4 v_position;varying vec3 v_view_ray;varying vec3 v_cam_ray0;varying vec3 v_cam_ray1;varying vec4 v_light_weight;void main(void){vec3 offset_0 = u_mesh_diff_0 + a_vertex;vec3 offset_1 = u_mesh_diff_1 + a_vertex;v_cam_ray0 = vec3(offset_0.x, offset_0.z, offset_0.y);v_cam_ray1 = vec3(offset_1.x, offset_1.z, offset_1.y);offset_0 += (u_mesh_diff_0 - u_mesh_diff_1) * u_transition_factor;v_view_ray = vec3(offset_0.x, offset_0.z, offset_0.y);gl_Position = u_mat_proj * u_mat_view * u_mat_model * vec4(a_vertex, 1.0);v_position = u_mat_model * vec4(a_vertex, 1.0);vec4 vertex = vec4(a_vertex, 1.0);vec4 mv_position = u_mat_view * u_mat_model * vertex;vec4 trans_normal = u_mat_normal * vec4(a_normal, 0.0);vec3 point_light_dir = normalize(u_point_light_position - mv_position.xyz);float point_light_weight = max(dot(trans_normal.xyz, point_light_dir), 0.0);float dir_light_weight = max(dot(trans_normal.xyz,normalize(u_directional_light_direction)), 0.0);v_light_weight = u_ambient_color + u_directional_light_color * dir_light_weight + u_point_light_color * point_light_weight;}",
fs:"precision highp float;uniform samplerCube u_cube_sampler0;uniform samplerCube u_cube_sampler1;uniform float u_transition_factor;uniform vec4 u_highlight_color;varying vec3 v_view_ray;varying vec3 v_cam_ray0;varying vec3 v_cam_ray1;varying vec4 v_position;varying vec4 v_light_weight;void main(void){vec2  transition_ratio = vec2(1.0 - u_transition_factor, u_transition_factor);vec3  nv = normalize(v_view_ray);vec2  k = max(vec2(0.1),vec2(dot(normalize(v_cam_ray0), nv),dot(normalize(v_cam_ray1), nv)));transition_ratio = k * transition_ratio;transition_ratio = transition_ratio / dot(transition_ratio, vec2(1.0));gl_FragColor = (transition_ratio.x * textureCube( u_cube_sampler0,v_cam_ray0) +transition_ratio.y *textureCube(u_cube_sampler1,v_cam_ray1));gl_FragColor = vec4(  0.5 * gl_FragColor.rgb+ 0.5 * v_light_weight.rgb* u_highlight_color.rgb, 1.0);}",
defaultUniformValues:'{"u_cube_sampler0": 0,"u_cube_sampler1": 1,"u_ambient_color": [0.4, 0.4, 0.4, 1],"u_directional_light_direction": [-1, 1, 0],"u_directional_light_color": [0.9, 0.9, 0.9, 1],"u_point_light_position": [0, 0, 0],"u_point_light_color": [1, 1, 1, 1],"u_transition_factor": 1.0,"u_highlight_color": [1, 1, 1, 1]}'},transition:{vs:"precision highp float;attribute vec3 a_vertex;uniform mat4 u_mat_proj;uniform mat4 u_mat_view;uniform mat4 u_mat_model;uniform vec3 u_mesh_diff_0;uniform vec3 u_mesh_diff_1;uniform float u_transition_factor;varying vec3 v_view_ray;varying vec3 v_cam_ray0;varying vec3 v_cam_ray1;void main(void){vec3 offset_0 = u_mesh_diff_0 + a_vertex;vec3 offset_1 = u_mesh_diff_1 + a_vertex;v_cam_ray0 = vec3(offset_0.x, offset_0.z, offset_0.y);v_cam_ray1 = vec3(offset_1.x, offset_1.z, offset_1.y);offset_0 += (u_mesh_diff_0 - u_mesh_diff_1) * u_transition_factor;v_view_ray = vec3(offset_0.x, offset_0.z, offset_0.y);gl_Position = u_mat_proj * u_mat_view * u_mat_model * vec4(a_vertex, 1.0);}",
fs:"precision highp float;uniform samplerCube u_cube_sampler0;uniform samplerCube u_cube_sampler1;uniform float u_transition_factor;varying vec3 v_view_ray;varying vec3 v_cam_ray0;varying vec3 v_cam_ray1;void main(void){vec2  transition_ratio = vec2(1.0 - u_transition_factor, u_transition_factor);vec3  nv = normalize(v_view_ray);vec2  k = max(vec2(0.1),vec2(dot(normalize(v_cam_ray0), nv),dot(normalize(v_cam_ray1), nv)));transition_ratio = k * transition_ratio;transition_ratio = transition_ratio / dot(transition_ratio, vec2(1.0));gl_FragColor = (transition_ratio.x * textureCube( u_cube_sampler0,v_cam_ray0) +transition_ratio.y *textureCube(u_cube_sampler1,v_cam_ray1));}",
defaultUniformValues:'{"u_cube_sampler0": 0,"u_cube_sampler1": 1,"u_transition_factor" : 0}'},fixedCube:{vs:"precision highp float;attribute vec4 a_vertex;uniform mat4 u_mat_proj;uniform mat4 u_mat_view;uniform mat4 u_mat_model;varying vec3 v_cam_ray0;void main(void){vec4 pos = u_mat_proj * u_mat_view * u_mat_model * a_vertex;v_cam_ray0 = vec3( a_vertex.x , a_vertex.z, a_vertex.y );gl_Position = pos;}",fs:"precision highp float;uniform samplerCube u_cube_sampler0;varying vec3 v_cam_ray0;void main(void){gl_FragColor = textureCube(u_cube_sampler0,v_cam_ray0);}",
defaultUniformValues:'{"u_cube_sampler0": 0}'},renderToDepthBuffer:{vs:"precision highp float;attribute vec3 a_vertex;uniform mat4 u_mat_proj;uniform mat4 u_mat_view;uniform mat4 u_mat_model;void main(void){gl_Position = u_mat_proj * u_mat_view * u_mat_model * vec4(a_vertex, 1.0);}",fs:"precision highp float;void main(void){gl_FragColor = vec4(0, 0, 1, 1);}"},transitionFixedCube:{vs:"precision highp float;attribute vec4 a_vertex;uniform mat4 u_mat_proj;uniform mat4 u_mat_view;uniform mat4 u_mat_model;uniform float u_transition_factor;varying vec3 v_cam_ray0;varying vec2 v_transition_ratio;void main(void){v_cam_ray0 = vec3( a_vertex.x , a_vertex.z, a_vertex.y );v_transition_ratio = vec2(1.0 - u_transition_factor, u_transition_factor);gl_Position = u_mat_proj * u_mat_view * u_mat_model * a_vertex;}",
fs:"precision highp float;uniform samplerCube u_cube_sampler0;uniform samplerCube u_cube_sampler1;varying vec2 v_transition_ratio;varying vec3 v_cam_ray0;void main(void){vec2 k = vec2(0.1);vec2 transition_ratio = k * v_transition_ratio;transition_ratio = transition_ratio / dot(transition_ratio, vec2(1.0));gl_FragColor = (transition_ratio.x * textureCube( u_cube_sampler0,v_cam_ray0) +transition_ratio.y *textureCube(u_cube_sampler1,v_cam_ray0));}",defaultUniformValues:'{"u_cube_sampler0": 0,"u_cube_sampler1": 1,"u_transition_factor": 0.0}'},
template:{vs:"precision highp float;attribute vec3 a_vertex;uniform mat4 u_mat_proj;uniform mat4 u_mat_view;uniform mat4 u_mat_model;void main(void){gl_Position = u_mat_proj * u_mat_view * u_mat_model * vec4(a_vertex, 1.0);}",fs:"precision highp float;uniform vec4 u_color;void main(void){gl_FragColor = u_color;}",defaultUniformValues:'{"u_color": [0.4, 0.4, 0.4, 1],}'},transitionHitPoint:{vs:"precision highp float;attribute vec3 a_vertex;uniform mat4 u_mat_proj;uniform mat4 u_mat_view;uniform mat4 u_mat_model;uniform vec3 u_mesh_diff_0;uniform vec3 u_mesh_diff_1;uniform float u_transition_factor;varying vec4 v_position;varying vec3 v_view_ray;varying vec3 v_cam_ray0;varying vec3 v_cam_ray1;void main(void){vec3 offset_0 = u_mesh_diff_0 + a_vertex;vec3 offset_1 = u_mesh_diff_1 + a_vertex;v_cam_ray0 = vec3(offset_0.x, offset_0.z, offset_0.y);v_cam_ray1 = vec3(offset_1.x, offset_1.z, offset_1.y);offset_0 += (u_mesh_diff_0 - u_mesh_diff_1) * u_transition_factor;v_view_ray = vec3(offset_0.x, offset_0.z, offset_0.y);gl_Position = u_mat_proj * u_mat_view * u_mat_model * vec4(a_vertex, 1.0);v_position = u_mat_model * vec4(a_vertex, 1.0);}",
fs:"precision highp float;uniform samplerCube u_cube_sampler0;uniform samplerCube u_cube_sampler1;uniform float u_transition_factor;uniform float u_highlight_factor;uniform vec3 u_hit_point;uniform vec4 u_highlight_color;varying vec3 v_view_ray;varying vec3 v_cam_ray0;varying vec3 v_cam_ray1;varying vec4 v_position;void main(void){vec2  transition_ratio = vec2(1.0 - u_transition_factor, u_transition_factor);vec3  nv = normalize(v_view_ray);vec2  k = max(vec2(0.1),vec2(dot(normalize(v_cam_ray0), nv),dot(normalize(v_cam_ray1), nv)));transition_ratio = k * transition_ratio;transition_ratio = transition_ratio / dot(transition_ratio, vec2(1.0));gl_FragColor = (transition_ratio.x * textureCube( u_cube_sampler0,v_cam_ray0) +transition_ratio.y *textureCube(u_cube_sampler1,v_cam_ray1));vec4 highlight_color = vec4(1, 0, 0, 1);float distance = length(v_position.xyz - u_hit_point);if (distance < .5)  {gl_FragColor = (1.0 - u_highlight_factor) * gl_FragColor + u_highlight_factor * highlight_color;}}",
defaultUniformValues:'{"u_cube_sampler0": 0,"u_cube_sampler1": 1,"u_transition_factor": 1.0,"u_highlight_factor": [1, 1, 1, 1],"u_hit_point": [0, 0, 0]}'}};function Pb(){}(function(a){this.message=a||""}).prototype=Object.create(Error.prototype);var Qb={},Rb=[];function Sb(a){switch(a){case 1:case 2:return 1;case 3:case 4:return 2;case 5:case 6:case 7:return 4;case 8:return 8}return 0}function F(a){throw Error(a);}function J(a){return"undefined"===typeof a}function K(a,b){return J(a)?b:a}function Ub(a){return"number"===typeof a}function Vb(a){return null!==a&&"object"===typeof a||Array.isArray(a)||"function"===typeof a}
function Xb(a,b){for(var c in b)b.hasOwnProperty(c)&&(Vb(b[c])&&Vb(a[c])?a[c]=Xb(a[c],b[c]):a[c]||(a[c]=b[c]));return a}function Yb(a){if(a){if(a.Db)return a.Db();if(a.slice)return a.slice();if(a.subarray)return new a.constructor(a);if(a instanceof Node)return a.cloneNode();if(Vb(a))return Xb({},a)}return a}function Zb(a,b){Math.log(9999999);Math.log(10);return("0000000000"+a.toString()).slice(-b)}function $b(a,b,c){return a>>b-c+1&(1<<c)-1}
function ac(a,b,c,d){b=b-c+1;c=(1<<c)-1;return a&~(c<<b)|(d&c)<<b};var fc=Math.PI,gc=1/fc,hc=fc/2,ic=fc/360,jc=2*fc,u=fc/180,kc=180/fc,mc=45*u,nc=90*u,oc=180*u,pc=360*u,qc=Math.pow(2,32)/360,rc=360/Math.pow(2,32);function sc(a,b){return a>b?a:b}function tc(a,b,c){return b>a?b:a<c?a:c}function uc(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}function vc(a,b,c){c=K(c,1E-6);if(Ub(a))return Math.abs(a-b)<=c;if(Array.isArray(a)){if(a.length!==b.length)return!1;for(var d=0,e=a.length;d<e;++d)if(!vc(a[d],b[d],c))return!1;return!0}return!1}
function wc(a){return a*u}function xc(a){return a*kc}function N(a,b,c){return a+(b-a)*c}function yc(a,b,c){return a*a+b*b+c*c};var zc=Math.PI,Ac=zc/180,Bc=180/zc;function Dc(a,b){return a>b?a:b}function Fc(a,b,c){return b>a?b:a<c?a:c}function xb(a){return 0<a?a:-a}function yb(a,b,c,d){if(a==b)return!0;var e=xb(a-b);return e<(d||1E-6)||e<=Dc(xb(a),xb(b))*(c||1E-6)?!0:!1}function Hc(a){return a*Ac}function Kc(a){return Math.log(a)/Math.log(2)}function Lc(a,b){return Math.log(a)/Math.log(b)}function ab(a,b,c){return a+(b-a)*c};(function(a){this.name="InvalidArgumentError";this.message=a||""}).prototype=Object.create(Error.prototype);(function(a){this.name="NotImplemented";this.message=a||""}).prototype=Object.create(Error.prototype);function E(a){return void 0===a}function Mc(a){return"number"===typeof a}function Nc(a){return"string"===typeof a||a instanceof String}function Oc(a){return"function"===typeof a}function Pc(a){return null!==a&&"object"===typeof a||Array.isArray(a)||Oc(a)}
function Rc(a){if(a){if(a.Db)return a.Db();if(Array.isArray(a))return a.slice();if(Pc(a)&&0<a.length&&Mc(a.byteLength))return new a.constructor(a);if(a instanceof Node)return a.cloneNode(!1);if(Pc(a)){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}}return a}function Sc(a,b){var c=0>a;0>a&&(a=-a);var d=1+(Math.log(a)/Math.log(10)|0),d=b-d,d=0<d?"00000000000000000000".substr(0,d):"",e="";c&&(e+="-");return e=e+d+a}function Tc(a){window.setTimeout(a,0)};var P={Hi:2,sq:2,aq:1};P.ll=Array;P.create=function(a,b){var c=new P.ll(P.Hi);E(b)||(c[0]=a,c[1]=b);return c};P.set=function(a,b,c){c[0]=a;c[1]=b;return c};P.A=function(a,b){return b?(b[0]=a[0],b[1]=a[1],b):P.create(a[0],a[1])};P.Mo=function(a,b){b[0]=a[0];b[1]=a[1]};P.$f=function(a,b,c){c=K(c,1E-6);return a.length===b.length&&vc(a[0],b[0],c)&&vc(a[1],b[1],c)};P.So=function(a,b){var c=K(void 0,1E-6);return vc(a[0],b[0],c)&&vc(a[1],b[1],c)};
P.gl=function(a,b){return Math.max(-1,Math.min(1,a[0]*b[0]+a[1]*b[1]))};P.Up=function(a,b,c){return Math.max(-1,Math.min(1,a[0]*b+a[1]*c))};P.L=function(a,b){return a[0]*b[0]+a[1]*b[1]};P.pb=function(a,b){return Math.atan2(b[1]-a[1],b[0]-a[0])};P.Sl=function(a){return Math.atan2(a-0,1)};P.Zk=function(a,b){return Math.atan2(a[0]*b[1]-a[1]*b[0],a[0]*b[0]+a[1]*b[1])};P.Op=function(a,b){var c=Math.atan2(a[0]*b[1]-a[1]*b[0],a[0]*b[0]+a[1]*b[1]);0>c&&(c=jc+c);return c};
P.Gr=function(a,b,c,d){a=c-a;b=d-b;return Math.sqrt(a*a+b*b)};P.normalize=function(a){var b=a[0];a=a[1];var c=Math.sqrt(b*b+a*a);return[b/c,a/c]};P.Ok=function(a){var b=a[0],c=a[1],d=Math.sqrt(b*b+c*c);a[0]=b/d;a[1]=c/d;return d};P.X=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d};P.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)};P.lr=function(a,b,c,d){a=c-a;b=d-b;return a*a+b*b};P.st=function(a,b,c,d){a=c-a;b=d-b;return Math.sqrt(a*a+b*b)};
P.jb=function(a){var b=a[0];a=a[1];return b*b+a*a};P.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};P.add=function(a,b){var c=new P.ll(2);c[0]=a[0]+b[0];c[1]=a[1]+b[1];return c};P.Nl=function(a,b){var c=P.bl;b[0]=a[0]+c[0];b[1]=a[1]+c[1]};P.Ao=function(a,b,c){return[a[0]+b[0]+c[0],a[1]+b[1]+c[1]]};P.cb=function(a,b,c){var d=P.create();d[0]=a[0]+b[0]*c;d[1]=a[1]+b[1]*c;d[2]=a[2]+b[2]*c;return d};P.jk=function(a,b,c,d){d[0]=a[0]+b[0]*c;d[1]=a[1]+b[1]*c};
P.sub=function(a,b){var c=new P.ll(2);c[0]=a[0]-b[0];c[1]=a[1]-b[1];return c};P.Gf=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];return c};P.scale=function(a,b){return[a[0]*b,a[1]*b]};P.qn=function(a){var b=P.xd,c=P.bl;c[0]=b[0]*a;c[1]=b[1]*a};P.ma=function(a,b,c){return[N(a[0],b[0],c),N(a[1],b[1],c)]};P.pa=function(a){return[a[1],-a[0]]};P.xd=P.create();P.Ei=P.create();P.bl=P.create();
P.Ta=function(a,b,c,d){P.Gf(b,a,P.xd);P.Gf(c,a,P.Ei);c=P.L(P.Ei,P.xd);if(0>=c)return d&&(d.split=!1,d.Hb=0),a;var e=P.L(P.xd,P.xd);if(c>=e)return d&&(d.split=!1,d.Hb=1),b;b=c/e;P.qn(b);return d&&(d.split=!0,d.Hb=b,d.ub)?(P.Nl(a,d.ub),d.ub):P.add(a,P.bl)};P.Io=function(a,b,c,d){var e=Uc;P.Gf(b,a,P.xd);P.Gf(c,a,P.Ei);c=P.L(P.Ei,P.xd);if(0>=c)return d.split=!1,d.Hb=0,a;var f=P.L(P.xd,P.xd);if(c>=f)return d.split=!1,d.Hb=1,b;b=c/f;P.qn(b);d.split=!0;d.Hb=b;P.Nl(a,e);return e};
P.ot=function(a,b,c,d,e,f){if(c[0]+d<(a[0]<b[0]?a[0]:b[0])||c[0]-d>(a[0]>b[0]?a[0]:b[0])||c[1]+d<(a[1]<b[1]?a[1]:b[1])||c[1]-d>(a[1]>b[1]?a[1]:b[1]))return null;P.Gf(b,a,P.xd);P.Gf(c,a,P.Ei);c=P.L(P.Ei,P.xd);if(0>=c)return f&&(f.split=!1,f.Hb=0),a;d=P.L(P.xd,P.xd);if(c>=d)return f&&(f.split=!1,f.Hb=1),b;b=c/d;P.qn(b);f&&(f.split=!0,f.Hb=b);return e?(P.Nl(a,e),e):P.add(a,P.bl)};P.pt=function(a,b,c,d){b=P.sub(b,a);c=P.L(P.sub(c,a),b);var e=P.L(b,b);c/=e;d&&(d.Hb=c);return P.add(a,P.scale(b,c))};
P.ut=function(a,b,c){b=P.sub(b,a);var d=P.L(P.sub(c,a),b),e=P.L(b,b);a=P.add(a,P.scale(b,d/e));return P.X(a,c)};P.Pg=function(a,b,c){return P.X(P.Ta(a,b,c),c)};P.Al=function(a,b,c,d){a=z.sub(a,c);d=P.jb(a)-d*d;b=P.L(b,a);d=b*b-d;return 1E-6<d?(d=Math.sqrt(d),[-b-d,-b+d]):-1E-6>d?null:[-b]};
P.pp=function(a,b,c,d){var e=[0.5*(a[0]+b[0]),0.5*(a[1]+b[1])];a=P.sub(b,a);b=0.5*P.Ok(a);c=P.Al(e,a,c,d);if(null===c)return null;d=c.length;if(1===d){if(Math.abs(c[0])>b)return null}else c[1]<-b||c[0]>b?d=0:c[1]<=b?c[0]<-b&&(d=1,c[0]=c[1]):d=c[0]>=-b?1:0;var f=[];for(b=0;b<d;++b)f.push(P.add(e,P.scale(a,c[b])));return f};
P.ig=function(a,b,c,d){var e=[0.5*(a[0]+b[0]),0.5*(a[1]+b[1])];a=P.sub(b,a);b=0.5*P.Ok(a);c=P.Al(e,a,c,d);if(null===c||1===c.length||c[1]<-b||c[0]>b)return null;d=null;c[0]>-b&&(d=[null,null],d[0]=P.add(e,P.scale(a,c[0])));c[1]<b&&(d||(d=[null,null]),d[1]=P.add(e,P.scale(a,c[1])));return d};P.se=function(a,b,c){b=P.sub(b,a);b=[-b[1],b[0]];a=P.L(P.sub(c,a),b);return 0===a?0:0>a?-1:1};
P.Oe=function(a,b,c,d,e,f,g,h,k){var l;l=(h-f)*(c-a)-(g-e)*(d-b);g=(g-e)*(b-f)-(h-f)*(a-e);f=(c-a)*(b-f)-(d-b)*(a-e);if(-1E-12<g&&1E-12>g&&-1E-12<f&&1E-12>f&&-1E-12<l&&1E-12>l)return k[0]=0.5*(a+c),k[1]=0.5*(b+d),2;if(-1E-12<l&&1E-12>l)return k[0]=0,k[1]=0;e=g/l;l=f/l;k[0]=a+e*(c-a);k[1]=b+e*(d-b);a=0>e||1<e;b=0>l||1<l;return a&b?5:a?3:b?4:1};
P.Km=function(a,b,c,d,e,f,g,h,k){if((b>d?b:d)<(f<h?f:h)||(b<d?b:d)>(f>h?f:h)||(a>c?a:c)<(e<g?e:g)||(a<c?a:c)>(e>g?e:g))return 5;var l;l=(h-f)*(c-a)-(g-e)*(d-b);g=(g-e)*(b-f)-(h-f)*(a-e);f=(c-a)*(b-f)-(d-b)*(a-e);if(-1E-12<g&&1E-12>g&&-1E-12<f&&1E-12>f&&-1E-12<l&&1E-12>l)return k&&(k[0]=0.5*(a+c),k[1]=0.5*(b+d)),2;if(-1E-12<l&&1E-12>l)return k&&(k[0]=0,k[1]=0),0;e=g/l;l=f/l;k&&(k[0]=a+e*(c-a),k[1]=b+e*(d-b));a=0>e||1<e;b=0>l||1<l;return a&b?5:a?3:b?4:1};
P.Dr=function(a,b,c,d,e,f,g,h){var k=Vc,l;l=(h-f)*(c-a)-(g-e)*(d-b);g=(g-e)*(b-f)-(h-f)*(a-e);f=(c-a)*(b-f)-(d-b)*(a-e);if(-1E-12<g&&1E-12>g&&-1E-12<f&&1E-12>f&&-1E-12<l&&1E-12>l)return k&&(k[0]=0.5*(a+c),k[1]=0.5*(b+d)),2;if(-1E-12<l&&1E-12>l)return k&&(k[0]=0,k[1]=0),0;e=g/l;l=f/l;k&&(k[0]=a+e*(c-a),k[1]=b+e*(d-b));return(a=0>l||1<l)?5:a?4:1};var z={Hi:3,sq:3,aq:1};function Wc(a){return!!a&&a.length>=z.Hi}z.create=function(a,b,c){var d=Array(z.Hi);J(c)||(d[0]=a,d[1]=b,d[2]=c);return d};z.ks=Array(z.Hi);z.set=function(a,b,c,d){d[0]=a;d[1]=b;d[2]=c;return d};z.A=function(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b):z.create(a[0],a[1],a[2])};z.$f=function(a,b,c){c=K(c,1E-6);return a.length===b.length&&vc(a[0],b[0],c)&&vc(a[1],b[1],c)&&vc(a[2],b[2],c)};
z.sr=function(a,b){var c=K(void 0,1E-6);return vc(a[0],b[0],c)&&vc(a[1],b[1],c)&&vc(a[2],b[2],c)};z.vp=function(a,b){var c=b||z.create();c[0]=-a[0];c[1]=-a[1];c[2]=-a[2];return c};z.add=function(a,b,c){c=c||z.create();c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c};z.Ao=function(a,b,c){return[a[0]+b[0]+c[0],a[1]+b[1]+c[1],a[2]+b[2]+c[2]]};z.cb=function(a,b,c,d){d=d||z.create();d[0]=a[0]+b[0]*c;d[1]=a[1]+b[1]*c;d[2]=a[2]+b[2]*c;return d};
z.sub=function(a,b,c){c=c||z.create();c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};z.I=function(a,b,c){c=c||z.create();var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c};z.eu=function(a,b,c){c=c||z.create();var d=b[0],e=b[1],f=b[2];b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*b;return c};
z.tf=function(a,b,c){c=c||z.create();var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b;c[1]=a[1]*d+a[5]*e+a[9]*b;c[2]=a[2]*d+a[6]*e+a[10]*b;return c};z.si=function(a,b){var c=z.create();c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];return c};z.scale=function(a,b,c){c=c||z.create();c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c};z.length=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])};z.jb=function(a){return z.L(a,a)};z.distance=function(a,b){return Math.sqrt(z.X(a,b))};
z.X=function(a,b){return z.jb(z.sub(a,b))};z.tt=function(a,b,c){a=z.sub(a,b,z.ks);return a[0]*a[0]+a[1]*a[1]+c*a[2]*a[2]};z.normalize=function(a,b){var c=b||z.create(),d=1/z.length(a);c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;return c};z.Ok=function(a){var b=z.length(a),c=1/b;a[0]*=c;a[1]*=c;a[2]*=c;return b};z.L=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};z.pa=function(a,b,c){c=c||z.create();var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1];b=b[2];c[0]=e*b-a*g;c[1]=a*f-d*b;c[2]=d*g-e*f;return c};
z.axis=function(a,b,c){c=c||z.create();z.pa(a,b,c);z.normalize(c,c);return c};z.pb=function(a,b){var c=z.L(a,b),d=z.length(a),e=z.length(b);return Math.acos(Fc(c/(d*e),-1,1))};z.su=function(a,b,c){c=c||z.create();var d=1/z.jb(b);a=z.L(a,b)*d;c[0]=b[0]*a;c[1]=b[1]*a;c[2]=b[2]*a;return c};z.mu=function(a,b,c){c=c||z.create();var d=1/z.jb(b),d=z.L(a,b)*d;c[0]=a[0]-b[0]*d;c[1]=a[1]-b[1]*d;c[2]=a[2]-b[2]*d;return c};
z.Ab=function(){var a=z.create(),b=z.create();return function(c,d,e,f){z.sub(d,c,a);z.sub(e,c,b);return z.pa(a,b,f)}}();z.Yt=function(a,b){var c=a||Math.random,d=b||z.create(),e=Math.abs(c()%1),c=Math.abs(c()%1),e=jc*e,c=Math.acos(2*c-1)-hc;d[0]=Math.cos(e);d[1]=Math.sin(c);d[2]=Math.sin(e);z.normalize(d,d);return d};z.ma=function(a,b,c,d){d=d||z.create();d[0]=N(a[0],b[0],c);d[1]=N(a[1],b[1],c);d[2]=N(a[2],b[2],c);return d};
z.hu=function(a,b,c,d){d=d||z.create();d[0]=N(a[0],b[0],c);d[1]=N(a[1],b[1],c);d[2]=N(a[2],b[2],c);z.normalize(d,d);return d};z.wn=function(a,b,c){var d,e,f;a=z.normalize(z.A(a));b=z.normalize(z.A(b));if(0>=c)return a;if(1<=c)return b;e=z.L(a,b);e=Fc(e,-1,1);1E-6<1-e?(d=Math.acos(e),f=Math.sin(d),e=Math.sin((1-c)*d)/f,c=Math.sin(c*d)/f):e=1-c;return a=z.add(z.scale(a,e),z.scale(b,c))};z.toString=function(a,b){var c,d=K(b,4);c="["+uc(a[0],d);c+=",";c+=uc(a[1],d);c+=",";c+=uc(a[2],d);return c+="]"};
z.Ta=function(a,b,c,d){var e=z.sub(b,a);c=z.L(z.sub(c,a),e);if(0>=c)return d&&(d.split=!1,d.Hb=0),a;var f=z.L(e,e);if(c>=f)return d&&(d.split=!1,d.Hb=1),b;b=c/f;d&&(d.split=!0,d.Hb=b);return z.add(a,z.scale(e,b))};z.jr=function(a,b,c){var d=Xc;b=z.sub(b,a);c=z.L(z.sub(c,a),b);var e=z.L(b,b);c/=e;return d?(z.scale(b,c,d),z.add(a,d,d),d):z.add(a,z.scale(b,c))};
z.ig=function(a,b,c,d){var e=[0.5*(a[0]+b[0]),0.5*(a[1]+b[1]),0.5*(a[2]+b[2])];a=z.sub(b,a);b=0.5*z.Ok(a);c=P.Al(e,a,c,d);if(null===c||1===c.length||c[1]<-b||c[0]>b)return null;d=null;c[0]>-b&&(d=[null,null],d[0]=z.add(e,z.scale(a,c[0])));c[1]<b&&(d||(d=[null,null]),d[1]=z.add(e,z.scale(a,c[1])));return d};function Yc(a,b,c,d){var e=Array(4);J(d)?(e[0]=1,e[1]=0,e[2]=0,e[3]=0):(e[0]=a,e[1]=b,e[2]=c,e[3]=d);return e}function Zc(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):Yc(a[0],a[1],a[2],a[3])}function $c(a,b,c){c=c||Yc();var d=a[0],e=a[1],f=a[2];a=a[3];var g=b[0],h=b[1],k=b[2];b=b[3];c[0]=d*g-e*h-f*k-a*b;c[1]=d*h+e*g+f*b-a*k;c[2]=d*k-e*b+f*g+a*h;c[3]=d*b+e*k-f*h+a*g}function jd(a,b){var c=b||Yc(),d=1/Math.sqrt(kd(a,a));c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d}
function kd(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Ka(a,b,c){c=c||Yc();b*=0.5;var d=Math.sin(b);c[0]=Math.cos(b);c[1]=a[0]*d;c[2]=a[1]*d;c[3]=a[2]*d;return c}
function ld(a,b,c,d,e){d=d||"xyz";e=e||Yc();var f=0.5*a;a=0.5*b;var g=0.5*c;c=Math.sin(f);f=Math.cos(f);b=Math.sin(a);var h=Math.cos(a);a=Math.sin(g);g=Math.cos(g);c=Yc(f,c,0,0);b=Yc(h,0,b,0);a=Yc(g,0,0,a);"zxy"===d?($c(a,c,e),$c(e,b,e)):"zyx"===d?($c(a,b,e),$c(e,c,e)):"xzy"===d?($c(c,a,e),$c(e,b,e)):"yzx"===d?($c(b,a,e),$c(e,c,e)):"yxz"===d?($c(b,c,e),$c(e,a,e)):"xyz"===d?($c(c,b,e),$c(e,a,e)):F("invalid euler order: "+d);jd(e,e);return e}
function Oa(a,b){var c=b||R(),d=a[0],e=a[1],f=a[2],g=a[3],h=e*e,k=f*f,l=g*g,m=d*e,n=d*f,d=d*g,r=e*f,e=e*g,f=f*g;c[0]=1-2*(k+l);c[1]=2*(r+d);c[2]=2*(e-n);c[3]=0;c[4]=2*(r-d);c[5]=1-2*(h+l);c[6]=2*(f+m);c[7]=0;c[8]=2*(e+n);c[9]=2*(f-m);c[10]=1-2*(h+k);c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c}
function md(a,b){var c=b||Yc(),d=a[0],e=a[4],f=a[8],g=a[1],h=a[5],k=a[9],l=a[2],m=a[6],n=a[10],r=Math.sqrt(yc(d,g,l)),s=Math.sqrt(yc(e,h,m)),t=Math.sqrt(yc(f,k,n)),d=d*r,h=h*s,n=n*t,v=0.5*Math.sqrt(sc(1+d+h+n,0)),w=0.5*Math.sqrt(sc(1+d-h-n,0)),x=0.5*Math.sqrt(sc(1-d+h-n,0)),d=0.5*Math.sqrt(sc(1-d-h+n,0)),w=0>m*s-k*t?-Math.abs(w):Math.abs(w),x=0>f*t-l*r?-Math.abs(x):Math.abs(x),d=0>g*r-e*s?-Math.abs(d):Math.abs(d);c[0]=v;c[1]=w;c[2]=x;c[3]=d;return c}
(function(){var a=z.create();return function(b,c){var d,e=K(c,4),f=b[0];d=b[1];var g=b[2],h=b[3],k;1<f&&(k=1/Math.sqrt(kd(b,b)),f*=k,d*=k,g*=k,h*=k);k=2*Math.acos(f);f=Math.sqrt(1-f*f);1E-6>f?(a[0]=1,a[1]=0,a[2]=0):(f=1/f,a[0]=d*f,a[1]=g*f,a[2]=h*f);d=""+z.toString(a,e);return d=d+","+uc(k*kc,e)}})();var nd={Os:1,Gs:2,LINE_STRIP:3,TRIANGLE:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};function od(){}p=od.prototype;p.Pa=function(){};p.tc=function(){};p.pg=function(){};p.ol=function(){};p.vn=function(){};p.cc=function(){};p.za=function(){};p.Wk=function(){};p.clear=function(){};p.Bi=function(){};p.Yk=function(){};p.un=function(){};p.na=function(){};function pd(a,b,c){this.o=a;this.a=this.d=null;this.j=0;this.c=null;this.p=0;this.b=null;this.n=0;this.g=this.e=null;if(b instanceof qd){var d=K(c,rd);a=b.d;c=new sd(b.s);var e=this.o.Je(b.g);td(c,e);ud(this,c,a);e=null;0<b.ji()&&(e=b.a);vd(this,e,d);e=null;if(0<b.a.length){if(!b.n){for(var e=b.a,f=b.a.length,g=new Uint16Array(2*f),h=0,k=0;h<f;h+=3,k+=6){var l=e[h+0],m=e[h+1],n=e[h+2];g[k+0]=l;g[k+1]=m;g[k+2]=m;g[k+3]=n;g[k+4]=n;g[k+5]=l}b.n=g}e=b.n}d=K(d,rd);f=this.b;e?(0!==e.length%2&&F("bad index count"),
g=e.byteLength,f&&f.od()>=g&&f.ml()===d?f.Yj(e):(f&&f.Na(),this.b=this.o.nf(e,d)),this.n=e.length/2):f&&(f.Na(),this.b=null);this.d=b;this.a=c;this.j=a;this.p=b.ji();this.n=b.a.length;this.g=this.e=null}}p=pd.prototype;p.Na=function(){this.a&&this.a.Na();this.c&&this.c.Na();this.b&&this.b.Na()};p.Fb=function(){var a=0;if(this.a)for(var b=this.a,c=b.j.a.length,d=0;d<c;++d){var e=b.a[d];e&&(a+=e.Fb())}this.c&&(a+=this.c.Fb());this.b&&(a+=this.b.Fb());return a};p.hb=function(){return this.d};
function ud(a,b,c){a.a&&a.a.Na();a.d=null;a.a=b;a.j=c;a.e=null;a.g=null}function vd(a,b,c){c=K(c,rd);var d=a.c;if(b){0!==b.length%3&&F("bad index count");var e=b.byteLength;d&&d.od()>=e&&d.ml()===c?d.Yj(b):(d&&d.Na(),a.c=a.o.nf(b,c));a.p=b.length/3}else d&&(d.Na(),a.c=null)}p.ji=function(){return this.p};p.Ug=function(){!this.e&&this.d&&(this.e=this.d.Ug());return this.e};p.vk=function(){!this.g&&this.d&&(this.g=this.d.vk());return this.g};
p.na=function(a,b,c,d){if(this.a){var e,f,g;switch(K(b,3)){case 1:f=this.j;b=this.a;c=K(c,0);c=tc(c,0,f);g=f-c;d=K(d,g);d=tc(d,0,g);a.na(1,b,null,c,d);break;case 2:(e=this.n)||F("no index data");b=this.a;f=this.b;c=K(c,0);c=tc(c,0,e);g=e-c;d=K(d,g);d=tc(d,0,g);a.na(2,b,f,2*c,2*d);break;case 3:(g=this.ji())||F("no index data"),e=nd.TRIANGLE,b=this.a,f=this.c,c=K(c,0),c=tc(c,0,g),g-=c,d=K(d,g),d=tc(d,0,g),c*=3,d*=3,a.na(e,b,f,c,d)}}};function R(a,b,c,d,e,f,g,h,k,l,m,n,r,s,t,v){var w=Array(16);J(v)||(w[0]=a,w[1]=e,w[2]=k,w[3]=r,w[4]=b,w[5]=f,w[6]=l,w[7]=s,w[8]=c,w[9]=g,w[10]=m,w[11]=t,w[12]=d,w[13]=h,w[14]=n,w[15]=v);return w}function wd(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b):R(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}
function xd(a,b,c){c=c||R();var d=a[0],e=a[4],f=a[8],g=a[12],h=a[1],k=a[5],l=a[9],m=a[13],n=a[2],r=a[6],s=a[10],t=a[14],v=a[3],w=a[7],x=a[11];a=a[15];var y=b[0],A=b[4],C=b[8],B=b[12],I=b[1],G=b[5],D=b[9],L=b[13],O=b[2],M=b[6],Z=b[10],V=b[14],Q=b[3],ga=b[7],fa=b[11];b=b[15];c[0]=d*y+e*I+f*O+g*Q;c[1]=h*y+k*I+l*O+m*Q;c[2]=n*y+r*I+s*O+t*Q;c[3]=v*y+w*I+x*O+a*Q;c[4]=d*A+e*G+f*M+g*ga;c[5]=h*A+k*G+l*M+m*ga;c[6]=n*A+r*G+s*M+t*ga;c[7]=v*A+w*G+x*M+a*ga;c[8]=d*C+e*D+f*Z+g*fa;c[9]=h*C+k*D+l*Z+m*fa;c[10]=n*C+r*
D+s*Z+t*fa;c[11]=v*C+w*D+x*Z+a*fa;c[12]=d*B+e*L+f*V+g*b;c[13]=h*B+k*L+l*V+m*b;c[14]=n*B+r*L+s*V+t*b;c[15]=v*B+w*L+x*V+a*b;return c}function Bd(a,b){var c=b||R(),d=a[1],e=a[2],f=a[3],g=a[6],h=a[7],k=a[11];c[0]=a[0];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=d;c[5]=a[5];c[6]=a[9];c[7]=a[13];c[8]=e;c[9]=g;c[10]=a[10];c[11]=a[14];c[12]=f;c[13]=h;c[14]=k;c[15]=a[15]}
function Cd(a,b){var c=b||R(),d=a[0],e=a[4],f=a[8],g=a[12],h=a[1],k=a[5],l=a[9],m=a[13],n=a[2],r=a[6],s=a[10],t=a[14],v=a[3],w=a[7],x=a[11],y=a[15],A=k*s*y-k*x*t-l*r*y+l*w*t+m*r*x-m*w*s,C=-h*s*y+h*x*t+l*n*y-l*v*t-m*n*x+m*v*s,B=h*r*y-h*w*t-k*n*y+k*v*t+m*n*w-m*v*r,I=-h*r*x+h*w*s+k*n*x-k*v*s-l*n*w+l*v*r,G=-e*s*y+e*x*t+f*r*y-f*w*t-g*r*x+g*w*s,D=d*s*y-d*x*t-f*n*y+f*v*t+g*n*x-g*v*s,L=-d*r*y+d*w*t+e*n*y-e*v*t-g*n*w+g*v*r,O=d*r*x-d*w*s-e*n*x+e*v*s+f*n*w-f*v*r,M=e*l*y-e*x*m-f*k*y+f*w*m+g*k*x-g*w*l,Z=-d*l*
y+d*x*m+f*h*y-f*v*m-g*h*x+g*v*l,y=d*k*y-d*w*m-e*h*y+e*v*m+g*h*w-g*v*k,w=-d*k*x+d*w*l+e*h*x-e*v*l-f*h*w+f*v*k,x=-e*l*t+e*s*m+f*k*t-f*r*m-g*k*s+g*r*l,V=d*l*t-d*s*m-f*h*t+f*n*m+g*h*s-g*n*l,g=-d*k*t+d*r*m+e*h*t-e*n*m-g*h*r+g*n*k,e=d*k*s-d*r*l-e*h*s+e*n*l+f*h*r-f*n*k,d=d*A+h*G+n*M+v*x;if(vc(d,0))return null;d=1/d;c[0]=A*d;c[1]=C*d;c[2]=B*d;c[3]=I*d;c[4]=G*d;c[5]=D*d;c[6]=L*d;c[7]=O*d;c[8]=M*d;c[9]=Z*d;c[10]=y*d;c[11]=w*d;c[12]=x*d;c[13]=V*d;c[14]=g*d;c[15]=e*d;return c}
function Dd(a){a=a||R();a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function Ed(a,b,c,d){d=d||R();d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=0;d[4]=b[0];d[5]=b[1];d[6]=b[2];d[7]=0;d[8]=c[0];d[9]=c[1];d[10]=c[2];d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1}
var Fd=function(){var a=z.create(),b=z.create(),c=z.create();return function(d,e,f,g){g=g||R();f=f||z.create(0,0,0);e=e||z.create(0,1,0);z.sub(f,d,c);z.normalize(c,c);1E-6>=z.jb(c)&&z.set(0,0,1,c);z.pa(e,c,a);z.normalize(a,a);z.pa(c,a,b);z.normalize(b,b);g[0]=a[0];g[1]=a[1];g[2]=a[2];g[3]=0;g[4]=b[0];g[5]=b[1];g[6]=b[2];g[7]=0;g[8]=c[0];g[9]=c[1];g[10]=c[2];g[11]=0;g[12]=f[0];g[13]=f[1];g[14]=f[2];g[15]=1;return g}}();
function Hd(a,b,c,d){d=d||R();d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;Wc(a)?(d[12]=a[0],d[13]=a[1],d[14]=a[2]):(d[12]=a,d[13]=b,d[14]=c);d[15]=1}
function Id(a,b,c,d){d=d||R();d[0]=N(a[0],b[0],c);d[1]=N(a[1],b[1],c);d[2]=N(a[2],b[2],c);d[3]=N(a[3],b[3],c);d[4]=N(a[4],b[4],c);d[5]=N(a[5],b[5],c);d[6]=N(a[6],b[6],c);d[7]=N(a[7],b[7],c);d[8]=N(a[8],b[8],c);d[9]=N(a[9],b[9],c);d[10]=N(a[10],b[10],c);d[11]=N(a[11],b[11],c);d[12]=N(a[12],b[12],c);d[13]=N(a[13],b[13],c);d[14]=N(a[14],b[14],c);d[15]=N(a[15],b[15],c)}
function Jd(a,b,c,d,e,f,g){g=g||R();var h=f-e,k=1/(b-a),l=1/(d-c),m=2*e;g[0]=m*k;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=m*l;g[6]=0;g[7]=0;g[8]=(b+a)*k;g[9]=(d+c)*l;g[10]=-(f+e)/h;g[11]=-1;g[12]=0;g[13]=0;g[14]=-f*m/h;g[15]=0;return g}function Kd(a,b,c,d,e,f,g){g=g||R();var h=f-e,k=1/(b-a),l=1/(d-c);g[0]=2*k;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2*l;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=-2/h;g[11]=0;g[12]=-(b+a)*k;g[13]=-(d+c)*l;g[14]=-(f+e)/h;g[15]=1;return g};function Ld(a,b,c){a instanceof Ld?this.A(a):a instanceof Md&&(this.De="",this.b=a,this.Gg=b||{},this.ef=c||new Nd,this.Sf=3,this.a=[])}p=Ld.prototype;p.A=function(a){this.De=a.De;this.b=a.b;this.Gg=Yb(a.Gg);this.ef=Yb(a.ef);this.Sf=a.Sf;this.a=Yb(a.a)};p.Db=function(){return new this.constructor(this)};p.getName=function(){return this.De};p.fb=function(a){this.De=a};function Od(a,b,c){J(c)||null===c?delete a.Gg[b]:a.Gg[b]=c}p.tc=function(){return this.ef};p.pg=function(a){this.ef=a};p.cc=function(a){return this.a[a]};
p.za=function(a,b){b?this.a[a]=b:delete this.a[a]};p.Kj=function(a){a.vn(this.b,this.Gg);a.pg(this.ef);for(var b=0;b<this.a.length;b++)a.za(b,this.a[b])};function Pd(a,b,c,d){var e=Array(4);J(d)||(e[0]=a,e[1]=b,e[2]=c,e[3]=d);return e}function Qd(a,b){var c=b||Pd(),d=1/Math.sqrt(yc(a[0],a[1],a[2]));c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d}function Rd(a,b,c,d,e,f,g){var h=a[0],k=a[1],l=a[2];a=a[3];var m;0>h?m=b:(m=e,e=b);0>k?b=c:(b=f,f=c);0>l?(c=d,d=g):c=g;return 0>h*m+k*b+l*c+a?-1:0<h*e+k*f+l*d+a?1:0};function Xd(a){if(a instanceof Xd){this.Cg=R();this.b=R();this.c=!1;for(var b=this.a=[],c=0;6>c;++c)b.push(R());this.A(a)}else a&&16===a.length&&(this.Cg=wd(a),this.b=R(),this.c=!1,b=this.a=[],a=this.Cg,b.push(Zd(a)),b.push($d(a)),b.push(ae(a)),b.push(be(a)),b.push(ce(a)),b.push(de(a)))}Xd.prototype.Db=function(){return new this.constructor(this)};
Xd.prototype.A=function(a){wd(a.Cg,this.Cg);wd(a.b,this.b);this.c=a.c;var b=this.a,c=a.a,d=0;for(a=a.a.length;d<a;++d){var e=c[d],f=b[d];f?(f[0]=e[0],f[1]=e[1],f[2]=e[2],f[3]=e[3]):Pd(e[0],e[1],e[2],e[3])}};Xd.prototype.d=function(){var a=R();return function(b){xd(this.Cg,b,a);return new Xd(a)}}();
function ee(a,b){var c=!1,d=K(void 0,0),e=a.a;if(0<d){var f=b(e[d]);if(void 0!==f)return f;for(var g=0,h=e.length;g<h;++g)if(g!==d&&(f=b(e[g]),void 0!==f)){c=f;break}}else for(g=0,h=e.length;g<h;++g)if(f=b(e[g]),void 0!==f){c=f;break}return c}Xd.prototype.rj=function(){var a=z.create();return function(b,c,d){d=d||fe();2<=b.length&&(c=b[1],b=b[0]);ge(this,b,c,-1,d);ge(this,b,c,1,a);z.sub(a,d,a);z.normalize(a,a);d[3]=a[0];d[4]=a[1];d[5]=a[2];return d}}();
function ge(a,b,c,d,e){if(!(-1>d||1<d)){a.c||(Cd(a.Cg,a.b),a.c=!0);a=a.b;var f=a[3]*b+a[7]*c+a[11]*d+a[15];yb(f,0)||(f=1/f,z.set(b,c,d,e),z.I(a,e,e),z.scale(e,f,e))}}function Zd(a){var b=Pd();b[0]=a[3]+a[0];b[1]=a[7]+a[4];b[2]=a[11]+a[8];b[3]=a[15]+a[12];Qd(b,b);return b}function $d(a){var b=Pd();b[0]=a[3]-a[0];b[1]=a[7]-a[4];b[2]=a[11]-a[8];b[3]=a[15]-a[12];Qd(b,b);return b}function ae(a){var b=Pd();b[0]=a[3]+a[1];b[1]=a[7]+a[5];b[2]=a[11]+a[9];b[3]=a[15]+a[13];Qd(b,b);return b}
function be(a){var b=Pd();b[0]=a[3]-a[1];b[1]=a[7]-a[5];b[2]=a[11]-a[9];b[3]=a[15]-a[13];Qd(b,b);return b}function ce(a){var b=Pd();b[0]=a[3]-a[2];b[1]=a[7]-a[6];b[2]=a[11]-a[10];b[3]=a[15]-a[14];Qd(b,b);return b}function de(a){var b=Pd();b[0]=a[3]+a[2];b[1]=a[7]+a[6];b[2]=a[11]+a[10];b[3]=a[15]+a[14];Qd(b,b);return b};function he(a){a instanceof he?this.A(a):this.b=this.ne=this.rf=this.sf=this.a=this.object=null}he.prototype.Db=function(){return new this.constructor(this)};he.prototype.A=function(a){this.object=a.object;this.a&&a.a?wd(a.a,this.a):this.a=Yb(a.a);this.sf&&a.sf?wd(a.sf,this.sf):this.sf=Yb(a.sf);this.rf&&a.rf?wd(a.rf,this.rf):this.rf=Yb(a.rf);this.ne&&a.ne?wd(a.ne,this.ne):this.ne=Yb(a.ne);this.b&&a.b?this.b.A(a.b):this.b=Yb(a.b)};var ie=function(){var a=0;return function(b){if(b instanceof ie){this.ga=a++;this.Tc=this.hd=null;this.ea=[];for(var c=b.ea,d=0,e=c.length;d<e;++d)this.add(c[d].Db());this.De=b.De;this.sa=b.sa;this.Vf=b.Vf;this.S=z.A(b.S);this.bc=Zc(b.bc);this.Dc=z.A(b.Dc);this.Bg=wd(b.Bg);this.Qf=b.Qf;this.Eh=wd(b.Eh);this.Pf=b.Pf}else this.ga=a++,this.Tc=this.hd=null,this.ea=[],this.De="",this.sa=0,this.Vf=!0,this.S=z.create(0,0,0),this.bc=Yc(1,0,0,0),this.Dc=z.create(1,1,1),this.Bg=R(),this.Qf=!1,this.Eh=R(),this.Pf=
!1;this.Cl=R();this.Ti=!1;this.Dl=R();this.Si=!1;this.Gl=Yc();this.Hl=!1}}();p=ie.prototype;p.Db=function(){return new this.constructor(this)};p.Da=function(){return this.ga};p.getName=function(){return this.De};p.fb=function(a){this.De=a};function je(a,b){a.sa=b;var c=a.hd;c&&ke(c,a)}p.eg=function(){return this.Vf};p.Qa=function(){for(var a=this;a;a=a.getParent())if(!a.eg())return!1;return!0};p.G=function(a){this.Vf=a};p.$g=function(){return this.hd};p.getParent=function(){return this.Tc};p.dg=function(){return this.ea.length};
p.Zg=function(a){(0>a||a>=this.ea.length)&&F("index out of range");return this.ea[a]};
p.add=function(a){if(a===this)return!1;var b=a.Tc;b!==this&&(b&&(b=b.ea,b.splice(b.indexOf(a),1)),this.ea.push(a),a.Tc=this,a.ob());var c=this instanceof le?this:this.hd;if(a instanceof le){var d=a.hd;d!==c&&(d&&me(d,a),c&&ne(c,a),a.hd=c)}else d=a.hd,d!==c&&(d&&oe(a,void 0,function(a){me(d,a);return!(a instanceof le)}),c?oe(a,void 0,function(a){a.hd=c;ne(c,a);return!(a instanceof le)}):oe(a,void 0,function(a){a.hd=null;return!(a instanceof le)}));return!0};
p.remove=function(a){var b=this.ea,c=b.indexOf(a);if(0>c)return!1;b.splice(c,1);a.Tc=null;var d=a.hd;d&&oe(a,void 0,function(a){me(d,a);a.hd=null;return!(a instanceof le)});return!0};function pe(a){a.Tc&&a.Tc.remove(a)}p.bm=function(){this.Tc&&this.Tc.remove(this);for(var a=this.ea;0<a.length;){var b=a[a.length-1];a.length--;b.Tc=null}};p.sc=function(){return null};p.le=function(){return!1};p.No=function(){return 0};p.nl=function(){};p.$h=function(){};
p.forEach=function(a,b){for(var c=this.ea,d=b,e=0,f=c.length;e<f;++e){var g=c[e];if(a&&(g=a(g),!J(g))){d=g;break}}return d};function oe(a,b,c){var d=[a];if(!c||c(a))for(d.push(null);0<d.length;){a=d.shift();if(b&&(b(a),!J(void 0)))break;if(a&&(a=a.ea,0<a.length)){for(var e=0,f=a.length;e<f;++e){var g=a[e];c&&!c(g)||d.push(g)}d.push(null)}}}function qe(a,b){var c=[];oe(a,function(a){a&&(b&&!b(a)||c.push(a))});return c}function re(a,b){return qe(a,function(a){return a.getName()===b})}
function se(a,b){z.A(b,a.S);a.ob()}function te(a,b){z.A(b,a.S);var c=b[4],d=b[5],e=b[6],f=a.bc;f[0]=b[3];f[1]=c;f[2]=d;f[3]=e;a.ob()}p.Ak=function(){return this.bc};function ue(a,b){Zc(b,a.bc);a.ob()}function ve(a,b){z.A(b,a.Dc);a.ob()}p.translate=function(a){z.add(a,this.S,this.S);this.ob()};p.rotate=function(){var a=R();return function(b,c){c&&(Oa(b,a),z.sub(this.S,c,this.S),z.I(a,this.S,this.S),z.add(this.S,c,this.S));$c(b,this.bc,this.bc);jd(this.bc,this.bc);this.ob()}}();
p.rotateAxisAngle=function(){var a=Yc();return function(b,c,d){Ka(b,c,a);this.rotate(a,d)}}();(function(){var a=Yc();return function(b,c,d,e,f){ld(b,c,d,e,a);this.rotate(a,f)}})();p=ie.prototype;p.scale=function(a){var b=this.Dc;b[0]*=a[0];b[1]*=a[1];b[2]*=a[2];this.ob()};
p.Yg=function(){if(!this.Qf){var a=this.Bg,b=this.S,c=this.Dc[0],d=this.Dc[1],e=this.Dc[2];Oa(this.bc,a);if(1!=c||1!=d||1!=e)a[0]*=c,a[4]*=d,a[8]*=e,a[1]*=c,a[5]*=d,a[9]*=e,a[2]*=c,a[6]*=d,a[10]*=e;a[12]=b[0];a[13]=b[1];a[14]=b[2];this.Qf=!0}return this.Bg};
p.Xg=function(){if(!this.Pf){var a=this.Eh,b=this.S,c=this.Dc[0],d=this.Dc[1],e=this.Dc[2];Oa(this.bc,a);Bd(a,a);var f=b[0],g=b[1],b=b[2];a[12]=-(a[0]*f+a[4]*g+a[8]*b);a[13]=-(a[1]*f+a[5]*g+a[9]*b);a[14]=-(a[2]*f+a[6]*g+a[10]*b);if(1!=c||1!=d||1!=e)c=1/c,d=1/d,e=1/e,a[0]*=c,a[4]*=c,a[8]*=c,a[12]*=c,a[1]*=d,a[5]*=d,a[9]*=d,a[13]*=d,a[2]*=e,a[6]*=e,a[10]*=e,a[14]*=e;this.Pf=!0}return this.Eh};
function we(a){if(!a.Ti){var b=a.Tc;!b||b instanceof le?wd(a.Yg(),a.Cl):xd(we(b),a.Yg(),a.Cl);a.Ti=!0}return a.Cl}function xe(a){if(!a.Si){var b=a.Tc;!b||b instanceof le?wd(a.Xg(),a.Dl):xd(a.Xg(),xe(b),a.Dl);a.Si=!0}return a.Dl}function ye(a){if(!a.Hl){var b=a.Tc;!b||b instanceof le?Zc(a.bc,a.Gl):$c(ye(b),a.bc,a.Gl);a.Hl=!0}return a.Gl}
function ze(a,b){var c=a.Tc;if(!c||c instanceof le)Zc(b,a.bc);else{var d=ye(c),e=(c=a.bc||Yc())||Yc(),f=e||Yc();f[0]=d[0];f[1]=-d[1];f[2]=-d[2];f[3]=-d[3];d=1/kd(e,e);f=e||Yc();f[0]=e[0]*d;f[1]=e[1]*d;f[2]=e[2]*d;f[3]=e[3]*d;$c(c,b,c)}a.ob()}p.update=function(){};p.na=function(){};function Ae(a){oe(a,function(a){a&&(a.Ti=!1,a.Si=!1,we(a),xe(a))})}p.ob=function(){this.Hl=this.Si=this.Ti=this.Pf=this.Qf=!1;var a=this.hd;a&&ke(a,this)};function Be(a,b){if(a instanceof Be)ie.call(this,a),this.o=a.o,this.Ha=a.Ha,this.a=a.a;else if(a instanceof pd){var c=K(b,null);ie.call(this);this.o=a;this.Ha=c;this.a=null}}Be.prototype=Object.create(ie.prototype);p=Be.prototype;p.nd=function(){return this.o};p.$o=function(){return this.Ha};p.le=function(a){var b=this.sc();if(b&&!b.le(a))return!1;b=this.nd().hb();if(!b)return!1;var c=b.b;return!!b.bg(function(b,e,f,g,h,k,l){if(0<=Ce(a,f,h,l,c))return!0},0)};
p.nl=function(a){var b=this.sc();if(b&&!b.le(a))return-Infinity;b=this.nd().hb();if(!b)return-Infinity;var c=!1,d=Infinity,e=b.b;b.bg(function(b,g,h,k,l,m,n){b=Ce(a,h,l,n,e);0<=b&&b<d&&(c=!0,d=b)});return c?d:-Infinity};
p.$h=function(a,b,c){var d=this.sc();if(d&&!d.le(a))return-Infinity;d=this.nd().hb();if(!d)return-Infinity;var e=!1,f=Infinity,g=z.create(),h=d.b;d.bg(function(d,l,m,n,r,s,t){l=Je(a,m,r,t,g,c,h);0<=l&&l<f&&(e=!0,f=l,z.A(g,b),J(c)||(c.Nc=d))});if(!e)return-Infinity;!J(c)&&null!=d.c&&0<d.c.length&&(c.Oc=Ke(d,c.Nc));return f};p.No=function(a){var b=this.sc();if(b&&!b.le(a))return 0;b=this.nd().hb();if(!b)return 0;var c=0;b.bg(function(b,e,f,g,h,k,l){b=Ce(a,f,h,l,!0);0<=b&&Infinity>b&&c++});return c};
p.sc=function(){this.a||(this.a=this.nd().vk());return this.a};p.update=function(a){var b=this.Ha;b&&(Od(b,"u_mat_proj",a.a),Od(b,"u_mat_view",a.sf),Od(b,"u_mat_model",a.rf),Od(b,"u_mat_normal",a.ne))};p.na=function(a,b){var c=3;this.update(b);var d=this.Ha;d&&(c=d.Sf,d.Kj(a));this.o.na(a,c)};var rd=1;function Le(a,b,c,d,e){this.type=a;this.size=b;this.offset=c;this.xn=d;this.normalize=K(e,!1)}Le.prototype.od=function(){return this.size*Sb(this.type)};Le.prototype.toString=function(){return window.JSON.stringify(this)};function Me(a){this.a=[];this.b={};if(a){var b=this.b,c;for(c in a)b[c]&&F("duplicate role '"+c+"'"),this.b[c]=a[c];this.a.push(a);a=this.a[this.a.length-1];b=0;for(c in a)var d=a[c],d=d.offset+d.od(),b=sc(b,d);for(c in a)d=a[c],J(d.xn)&&(d.xn=b)}}
function sd(a){this.j=a;this.a=Array(a.a.length)}sd.prototype.Na=function(){for(var a=this.a,b=0,c=a.length;b<c;++b){var d=a[b];d&&d.Na()}};function td(a,b){var c=a.a;if(Ub(void 0))void 0>=c.length&&F("invalid args"),c[void 0]=b;else for(var d=0,e=c.length;d<e;++d)c[d]=b};function Ne(a,b){if(a instanceof Ne)Be.call(this,a),this.p=a.p,this.d=a.d,this.g=a.g,this.H=a.H,this.s=a.s,this.Xa=a.Xa,this.e=a.e,this.n=a.n,this.c=Yb(a.c),this.j=Yb(a.j),this.b=a.b,this.v=a.v;else if(a instanceof Oe){var c=b||Qb,d=c.Se,c=c.Gc;if(!c){var c=a.Am(),e=c.tq;if(!e){var f=new Me({position:new Le(7,3,0),texcoord:new Le(7,2,12),normal:new Le(7,3,20)}),e=null,e=new Float32Array([-0.5,0.5,0,0,0,0,0,1,-0.5,-0.5,0,0,1,0,0,1,0.5,-0.5,0,1,1,0,0,1,0.5,0.5,0,1,0,0,0,1]),g=null,g=new Uint16Array([0,
1,2,2,3,0]),e=a.Je(e),f=new sd(f);td(f,e);e=new pd(a.oj());ud(e,f,4);vd(e,g);c.tq=e}c=e}Be.call(this,c,d);this.p=1;this.g=this.d=2;this.H=P.create(0,0);this.s=0;this.e=this.Xa=null;this.n=!1;this.c=new Pe(0,0,1,1);this.j=Array(9);this.b=!1;this.v=!0}}Ne.prototype=Object.create(Be.prototype);p=Ne.prototype;p.vd=function(a){this.p=tc(a,0,1)};p.cc=function(){return this.Xa};p.za=function(a,b,c){a!==this.Xa&&(this.Xa=a,this.e=b,this.n=c||!1,this.ob(),this.b=!1)};
function Qe(a,b,c,d,e){var f=a.c;if(b!==f.x||c!==f.y||d!==f.width||e!==f.height)f.set(b,c,d,e),a.ob(),a.b=!1}function Re(a){a.v=!1;a.b=!1}
p.Yg=function(){if(!this.Qf){var a=this.Bg,b=this.S,c=this.bc,d=this.Dc[0],e=this.Dc[1],f=this.Dc[2],g=this.cc();if(this.v&&g){var g=P.create(),h=this.s,k=this.Xa,l=this.c,m=l.width,l=l.height,n=k.pd(),k=k.md();0<h?(h=1/h,g[0]=m*n*h,g[1]=l*k*h):(m*=n,l*=k,g[0]=0,g[1]=0,l&&(g[0]=m<l?m/l:1),m&&(g[1]=m>l?l/m:1));m=P.create();switch(this.d){case 1:m[0]=0.5;break;case 2:m[0]=0;break;case 3:m[0]=-0.5}switch(this.g){case 1:m[1]=0.5;break;case 2:m[1]=0;break;case 3:m[1]=-0.5}var h=this.H,r=this.Xa,n=this.c,
l=n.width,n=n.height,k=r.pd(),r=r.md(),s=this.s;0<s?(s=1/s,m[0]=m[0]*l*k*s,m[1]=m[1]*n*r*s,m[0]+=h[0]*k*s,m[1]-=h[1]*r*s):(l*=k,n*=r,l&&(m[0]+=h[0]/l),n&&(m[1]-=h[1]/n));Dd(a);a[0]=g[0];a[5]=g[1];a[12]=m[0]*d;a[13]=m[1]*e;xd(Oa(c),a,a)}else Oa(c,a);if(1!=d||1!=e||1!=f)a[0]*=d,a[4]*=e,a[8]*=f,a[1]*=d,a[5]*=e,a[9]*=f,a[2]*=d,a[6]*=e,a[10]*=f;a[12]+=b[0];a[13]+=b[1];a[14]+=b[2];this.Qf=!0}return this.Bg};p.Xg=function(){this.Pf||(Cd(this.Yg(),this.Eh),this.Pf=!0);return this.Eh};
p.sc=function(){this.a||(this.a=this.nd().Ug());return this.a};p.update=function(a){Be.prototype.update.call(this,a);if(a=this.Ha){var b=this.Xa?this.p:0;a.za(0,this.Xa);Od(a,"u_texunit0",0);Od(a,"u_opacity",b);if(!this.b){var b=this.j,c=this.cc(),d=this.c;if(c){var c=d.x,e=d.y,f=d.width,d=d.height,b=this.j;b[0]=f;b[1]=0;b[2]=0;b[3]=0;b[4]=d;b[5]=0;b[6]=c;b[7]=e}else b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=1,b[5]=0,b[6]=0,b[7]=0;b[8]=1;this.b=!0}Od(a,"u_mat_tex",this.j)}};
p.$h=function(a,b,c){function d(d,f,r,s,t,v,w){d=Je(a,r,t,w,l,c);0<=d&&d<k&&(c?(r=P.create(r[3],r[4]),t=P.create(t[3],t[4]),w=P.create(w[3],w[4]),w=P.Ao(P.scale(r,c.Gi),P.scale(t,c.tg),P.scale(w,c.ug)),w[0]=(w[0]-g.x)*g.width,w[1]=(w[1]-g.y)*g.height,(t=0<=w[0]&&1>=w[0]&&0<=w[1]&&1>=w[1])&&!(t=!e.e)&&(t=w[0],r=w[1],w=e.e,w.data?(t=Math.floor(t*w.width),r=Math.floor(r*w.height),e.n&&(r=w.height-r-1),0>t||0>r||t>=w.width||r>=w.height?t=!1:(f=E(w.wp)?4:w.wp,t=10<w.data[(t+r*w.width)*f+(1<f?3:0)])):t=
!0),t&&(h=!0,k=d,z.A(l,b))):(h=!0,k=d,z.A(l,b)))}var e=this,f=this.sc();if(f&&!f.le(a))return-Infinity;f=this.nd().hb();if(!f)return-Infinity;var g=this.c,h=!1,k=Infinity,l=z.create();this.e&&(c=c||{});c?Se(f,d):f.bg(d);if(!h)return-Infinity;!J(c)&&null!=f.c&&0<f.c.length&&(c.Oc=Ke(f,c.Nc));return k};function Te(a){this.marker=null;this.Me=P.A(a);this.a=this.Te=null;this.b=new ie;this.d=new ie;this.c=new ie;this.c.add(this.d);this.b.add(this.c);this.R=0;this.ip=!1;this.g=this.e=null}p=Te.prototype;p.zk=function(){return this.b};p.qb=function(){return this.marker};p.mg=function(){this.marker=null};p.G=function(a){this.marker&&this.marker.G(a)};function Ue(a,b){a.a=b;se(a.b,b);var c=a.marker;c&&c.Ba&&(c.Ba.a=b)}p.sj=function(){return this.R};p.qg=function(a){this.R=a};
function Ve(a,b,c,d,e,f,g,h,k,l,m,n,r,s){this.Me=P.A(a);this.a=this.Te=null;this.buildingId=b;this.Sa=c;this.index=d;this.ep=r;this.g=s;this.label=e;this.o=f;this.n=g;this.ag=h;this.b=null;this.Nm=!1;this.jd=null;this.e=k;this.d=l;this.j=m;this.c=n}Ve.prototype.H=function(){return this.e};da("pano.MarkerInfo.prototype.isPositionFixed",Ve.prototype.H);Ve.prototype.p=function(){return this.d};da("pano.MarkerInfo.prototype.getFixedRotation",Ve.prototype.p);Ve.prototype.v=function(){return this.j};
da("pano.MarkerInfo.prototype.getHeightOverGround",Ve.prototype.v);Ve.prototype.s=function(){return this.c};da("pano.MarkerInfo.prototype.getGroundAngle",Ve.prototype.s);function Ye(a){this.Ba=a}Ye.prototype.Qa=function(){return!0};Ye.prototype.di=function(){return Ze};da("pano.MarkerBase.prototype.getBubbleType",Ye.prototype.di);
function $e(a,b){this.Ba=a;this.anchor=b;this.Ve=this.Q=null;this.He=z.create(0.5,0,1);this.distanceFactor=1;this.zd=this.Xb=this.fg=this.ni=this.height=this.width=0;this.R=Number.MAX_VALUE;this.Go=null;this.visible=!0;this.ag=a.ag;this.Dj=af;this.fn=bf;this.Ld=cf;this.Kd=df;var c=a.Sa["3d"];c&&(E(c.ag)||(this.ag=c.ag),E(c.Dj)||(this.Dj=c.Dj),E(c.fn)||(this.fn=c.fn),E(c.Ld)||(this.Ld=c.Ld),E(c.Kd)||(this.Kd=c.Kd));this.wj=!1}$e.prototype=Object.create(Ye.prototype);p=$e.prototype;p.zk=function(){return this.anchor.zk()};
function ef(a){a.Q&&(a.Q.bm(),a.Q=null)}p.G=function(a){a=(this.visible=a)&&!0;this.Q&&a!=this.Q.eg()&&this.Q.G(a)};p.eg=function(){return this.visible};p.Qa=function(){return this.visible};p.sj=function(){return this.R};p.qg=function(a){this.R=a;this.Q&&(this.Q.qg?this.Q.qg(this.R):this.Q.R=this.R)};(function(a){this.Ba=a}).prototype=Object.create(Ye.prototype);function ff(){}ff.prototype.Db=function(){return new this.constructor(this)};ff.prototype.le=function(){return!1};ff.prototype.Mm=function(){return!1};function gf(a,b){return!!ee(b,function(b){if(a.Mm(b))return!0})};function hf(a,b,c){if(a instanceof hf)c=z.A(a.Zb),a=z.A(a.Nb);else if(Wc(a)&&Wc(b))c=z.A(a),a=z.A(b);else if(Ub(c)){a=0.5*a;b=0.5*b;var d=0.5*c;c=z.create(-a,-b,-d);a=z.create(+a,+b,+d)}else F("invalid args"),c=a=z.create();this.Zb=c;this.Nb=a}hf.prototype=Object.create(ff.prototype);p=hf.prototype;p.qj=function(){var a=this.Nb[0]-this.Zb[0],b=this.Nb[1]-this.Zb[1],c=this.Nb[2]-this.Zb[2];return Math.sqrt(a*a+c*c+b*b)};p.wk=function(){return z.ma(this.Zb,this.Nb,0.5)};
p.le=function(a){return 0<=jf(a,this.Zb,this.Nb)};p.Yl=function(a){return a[0]>=this.Zb[0]&&a[0]<=this.Nb[0]&&a[1]>=this.Zb[1]&&a[1]<=this.Nb[1]&&a[2]>=this.Zb[2]&&a[2]<=this.Nb[2]};p.Mm=function(a){var b=this.Zb,c=this.Nb;return 0>Rd(a,b[0],b[1],b[2],c[0],c[1],c[2])};function kf(a,b){this.Mf=z.create();this.Hh=0;a instanceof kf?(this.Mf=z.A(a.Mf,this.Mf),this.Hh=a.Hh):Wc(a)&&Ub(b)?(this.Mf=z.A(a,this.Mf),this.Hh=b):F("invalid args")}kf.prototype=Object.create(ff.prototype);kf.prototype.wk=function(){return this.Mf};kf.prototype.qj=function(){return this.Hh};kf.prototype.le=function(a){var b=this.Mf,c=this.Hh,d=a[3],e=a[4],f=a[5],g=b[0]-a[0],h=b[1]-a[1];a=b[2]-a[2];b=d*g+e*h+f*a;d=d*b-g;e=e*b-h;f=f*b-a;return!!(d*d+e*e+f*f<=c*c)};
kf.prototype.Mm=function(a){var b=this.Mf,c=this.Hh;a=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3];return 0>(0<a-c?1:0>a+c?-1:0)};function fe(a,b,c,d,e,f){var g=Array(6);J(f)||(g[0]=a,g[1]=b,g[2]=c,g[3]=d,g[4]=e,g[5]=f);return g}function lf(a,b,c,d,e,f,g){g=g||fe();g[0]=a;g[1]=b;g[2]=c;g[3]=d;g[4]=e;g[5]=f;a=g||fe();b=1/Math.sqrt(yc(g[3],g[4],g[5]));a[0]=g[0];a[1]=g[1];a[2]=g[2];a[3]=g[3]*b;a[4]=g[4]*b;a[5]=g[5]*b;return g}function mf(a){var b=z.create();b[0]=a[0];b[1]=a[1];b[2]=a[2];return b}
function nf(a,b,c){c=c||fe();var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var k=a[0],l=a[4],m=a[8],n=a[1],r=a[5],s=a[9],t=a[13],v=a[2],w=a[6],x=a[10],y=a[14];c[0]=k*d+l*e+m*f+a[12];c[1]=n*d+r*e+s*f+t;c[2]=v*d+w*e+x*f+y;d=k*g+l*h+m*b;e=n*g+r*h+s*b;f=v*g+w*h+x*b;a=1/Math.sqrt(yc(d,e,f));c[3]=d*a;c[4]=e*a;c[5]=f*a}function of(a,b,c){c=c||z.create();c[0]=a[0]+a[3]*b;c[1]=a[1]+a[4]*b;c[2]=a[2]+a[5]*b;return c}
function Ce(a,b,c,d,e){var f=a[3],g=a[4],h=a[5],k=c[0]-b[0],l=c[1]-b[1];c=c[2]-b[2];var m=d[0]-b[0],n=d[1]-b[1],r=d[2]-b[2],s=l*r-c*n,t=c*m-k*r,v=k*n-l*m,w;d=f*s+g*t+h*v;if(1E-6<d)w=1;else if(-1E-6>d)w=-1,d=-d;else return-Infinity;if(!e&&0<w)return-Infinity;e=a[0]-b[0];var x=a[1]-b[1];a=a[2]-b[2];b=w*(f*(x*r-a*n)+g*(a*m-e*r)+h*(e*n-x*m));if(0>b)return-Infinity;f=w*(f*(l*a-c*x)+g*(c*e-k*a)+h*(k*x-l*e));if(0>f||f+b>d)return-Infinity;f=-w*(e*s+x*t+a*v);return 0>f?-Infinity:f/d}
function Je(a,b,c,d,e,f,g){var h=a[3],k=a[4],l=a[5],m=c[0]-b[0],n=c[1]-b[1],r=c[2]-b[2],s=d[0]-b[0],t=d[1]-b[1],v=d[2]-b[2],w=n*v-r*t,x=r*s-m*v,y=m*t-n*s,A,C=h*w+k*x+l*y;if(1E-6<C)A=1;else if(-1E-6>C)A=-1,C=-C;else return-Infinity;if(!g&&0<A)return-Infinity;g=a[0]-b[0];var B=a[1]-b[1];a=a[2]-b[2];s=A*(h*(B*v-a*t)+k*(a*s-g*v)+l*(g*t-B*s));if(0>s)return-Infinity;h=A*(h*(n*a-r*B)+k*(r*g-m*a)+l*(m*B-n*g));if(0>h||h+s>C)return-Infinity;k=-A*(g*w+B*x+a*y);if(0>k)return-Infinity;A=-A;e[0]=A*w;e[1]=A*x;e[2]=
A*y;f&&(f.J=z.A(b),f.W=z.A(c),f.Ye=z.A(d),f.tg=s/C,f.ug=h/C,f.Gi=1-f.tg-f.ug);return k/C}function jf(a,b,c){var d=a[0],e=a[1],f=a[2],g=1/a[3],h=1/a[4];a=1/a[5];var k;0<=g?(k=(b[0]-d)*g,g*=c[0]-d):(k=(c[0]-d)*g,g*=b[0]-d);d=k;0<=h?(k=(b[1]-e)*h,e=(c[1]-e)*h):(k=(c[1]-e)*h,e=(b[1]-e)*h);if(d>e||g<k)return-Infinity;k>d&&(d=k);e<g&&(g=e);0<=a?(e=(b[2]-f)*a,b=(c[2]-f)*a):(e=(c[2]-f)*a,b=(b[2]-f)*a);if(d>b||g<e)return-Infinity;e>d&&(d=e);return d};function qd(a,b,c,d,e){this.s=a;this.d=b;this.g=c;this.a=d;this.o=this.n=null;this.e=0;this.c=e||null;this.b=!1}p=qd.prototype;p.ji=function(){return this.a.length/3};
p.bg=function(a,b,c,d){var e=this.ji(),f=K(b,0);(0>f||f>=e)&&F("invalid args");var g=K(c,e-f),g=tc(g,0,e-f),e=this.a;c=3*f;b=pf(this);for(var h=this.e,k=z.create(),l=z.create(),m=z.create(),n=f,f=f+g;n<f;++n){var r=e[c+0],s=e[c+1],t=e[c+2],g=r*h;k[0]=b[g+0];k[1]=b[g+1];k[2]=b[g+2];g=s*h;l[0]=b[g+0];l[1]=b[g+1];l[2]=b[g+2];g=t*h;m[0]=b[g+0];m[1]=b[g+1];m[2]=b[g+2];g=a(n,r,k,s,l,t,m);if(!J(g))return g;c+=3}return d};
function Se(a,b){var c=a.ji(),d=K(void 0,0);(0>d||d>=c)&&F("invalid args");for(var e=K(void 0,c-d),e=tc(e,0,c-d),c=a.a,f=3*d,g=pf(a),h=a.e,k=z.create(),l=z.create(),m=z.create(),n=d,d=d+e;n<d;++n){var r=c[f+0],s=c[f+1],t=c[f+2],e=r*h;k[0]=g[e+0];k[1]=g[e+1];k[2]=g[e+2];k[3]=g[e+3];k[4]=g[e+4];e=s*h;l[0]=g[e+0];l[1]=g[e+1];l[2]=g[e+2];l[3]=g[e+3];l[4]=g[e+4];e=t*h;m[0]=g[e+0];m[1]=g[e+1];m[2]=g[e+2];m[3]=g[e+3];m[4]=g[e+4];e=b(n,r,k,s,l,t,m);if(!J(e))break;f+=3}}
p.Ug=function(){if(!this.j){for(var a=pf(this),b=this.e,c=0,d=Infinity,e=Infinity,f=Infinity,g=-Infinity,h=-Infinity,k=-Infinity,l=0,m=this.d;l<m;++l)var n=a[c+0],r=a[c+1],s=a[c+2],d=d<n?d:n,e=e<r?e:r,f=f<s?f:s,g=sc(g,n),h=sc(h,r),k=sc(k,s),c=c+b;a=z.create(d,e,f);g=z.create(g,h,k);this.j=new hf(a,g)}return this.j};p.vk=function(){if(!this.p){var a=this.Ug(),b=z.add(a.Zb,a.Nb);z.scale(b,0.5,b);a=z.distance(b,a.Nb);this.p=new kf(b,a)}return this.p};
p.$h=function(a,b){var c=!1,d=Infinity,e=z.create();this.bg(function(f,g,h,k,l,m,n){f=Je(a,h,l,n,e);0<=f&&f<d&&(c=!0,d=f,z.A(e,b))});return c?d:-Infinity};
function pf(a){if(!a.o){var b=a.g.buffer,c;(c=a.s.b.position)||F("no vertex position attrib");var d=c.offset,e=null;switch(c.type){case 1:e=new Int8Array(b,d);break;case 2:e=new Uint8Array(b,d);break;case 3:e=new Int16Array(b,d);break;case 4:e=new Uint16Array(b,d);break;case 7:e=new Float32Array(b,d)}a.o=e;a.e=0<a.d&&0<e.length?a.g.byteLength/a.d/(e.byteLength/e.length):0}return a.o}function Ke(a,b){for(var c=1,d=a.c,e=d.length;c<e&&!(b<d[c].index);)c++;return d[c-1]};function qf(a,b){var c=K(b,16384);this.j=a;this.c=0;this.a=this.a||new Float32Array(c/4);this.e=[];this.d=this.b=0;for(this.n=this.g=null;c>this.a.byteLength;)rf(this)}function sf(a){a.g||(a.g=[],a.n=null)}function tf(a,b,c,d,e,f,g,h,k){var l=a.d,m=a.b<<2;if(0<l)for(m%l&&F("inconsistent stride");m+l>a.a.byteLength;)rf(a);else a.d=m;uf(a,b,c,d);void 0!==e&&void 0!==f&&(a.a[a.b++]=e,a.a[a.b++]=f);void 0!==g&&void 0!==h&&void 0!==k&&uf(a,g,h,k);return a.c++}
function uf(a,b,c,d){var e=a.a,f=a.b;e[f++]=b;e[f++]=c;e[f++]=d;a.b=f}qf.prototype.Lh=function(a,b,c,d){d&&vf(this,d);d=this.e;var e=d.length;d[e++]=a;d[e++]=b;d[e++]=c};function wf(a,b,c,d,e){xf(a,b,c,d,d,e,b)}qf.prototype.hb=function(){0!==(this.b<<2)%this.d&&F("incomplete vertex buffer");var a=new Uint8Array(this.a.buffer,0,(0<this.d?this.d:this.b<<2)*this.c),a=new Uint8Array(a),b=new Uint16Array(this.e);return new qd(this.j,this.c,a,b,this.g)};
function yf(a,b,c,d,e,f){var g=a.d,h=a.b<<2;if(0<g)for(h%g&&F("inconsistent stride");h+g>a.a.byteLength;)rf(a);else a.d=h;g=a.a;h=a.b;g[h++]=b;g[h++]=c;g[h++]=d;void 0!==e&&(g[h++]=e[0],g[h++]=e[1]);void 0!==f&&(g[h++]=f[0],g[h++]=f[1],g[h++]=f[2]);a.b=h;return a.c++}
function S(a,b,c,d){var e=a.d,f=a.b<<2;if(0<e)for(f%e&&F("inconsistent stride");f+e>a.a.byteLength;)rf(a);else a.d=f;e=a.a;f=a.b;e[f++]=b[0];e[f++]=b[1];e[f++]=b[2];void 0!==c&&(e[f++]=c[0],e[f++]=c[1]);void 0!==d&&(e[f++]=d[0],e[f++]=d[1],e[f++]=d[2]);a.b=f;return a.c++}function xf(a,b,c,d,e,f,g,h){h&&vf(a,h);a=a.e;h=a.length;a[h++]=b;a[h++]=c;a[h++]=d;a[h++]=e;a[h++]=f;a[h++]=g}
function If(a,b,c,d,e,f,g,h,k,l,m){m&&vf(a,m);a=a.e;m=a.length;a[m++]=b;a[m++]=c;a[m++]=d;a[m++]=e;a[m++]=f;a[m++]=g;a[m++]=h;a[m++]=k;a[m++]=l}function vf(a,b){b!==a.n&&(a.g.push({index:a.e.length/3,Y:b}),a.n=b)}function rf(a){var b=new Float32Array(((a.a.byteLength<<1)+4-1&-4)>>2);b.set(a.a);a.a=b};function Jf(){this.a=new Kf}var Lf=pa();Lf.isEnabled=!1;Jf.distanceFactor=0.01;p=Jf.prototype;p.clear=function(){this.a=new Kf};p.t=function(){};p.Bo=function(){};p.ik=function(a){this.a.set(a.Sa.id,a)};function Mf(a,b){if(b&&b.Sa&&b.Sa.id){var c=a.a.get(b.Sa.id);c&&a.mg(c.Sa)}}p.mg=function(a){this.a.remove(a.id)};p.Md=function(){this.a=new Kf};p.uf=function(){};p.Ud=function(a){return(a=this.a.get(a.id))&&a instanceof Ve?a:null};p.Tj=function(){};p.lh=function(){};p.li=function(){};p.Kh=function(){};
p.Uh=function(){};p.bi=function(){};p.Oh=function(){};function Nf(a){if(a instanceof Nf)ie.call(this,a),this.Ce=a.Ce,this.Lb=a.Lb,this.Yb=a.Yb,this.ac=a.ac,this.kc=a.kc,this.nc=a.nc,this.Yd=a.Yd,this.Ni=a.Ni,this.Fe=Yb(a.Fe),this.Wd=wd(a.Wd),this.Xd=a.Xd,this.Oi=Yb(a.Oi),this.bf=a.bf,this.Eg=a.Eg,this.Vi=a.Vi;else{a=a||{};ie.call(this);this.Ce=mc;this.Lb=a.Tl;this.Yb=a.left;this.ac=a.right;this.kc=a.bottom;this.nc=a.top;this.Yd=K(a.Nk,0.1);this.Ni=K(a.tk,100);if(J(this.Yb)||J(this.ac)||J(this.kc)||J(this.nc)){this.Lb=K(this.Lb,1.6);this.Ja(K(a.ld,mc));
var b=this.Yd*Math.tan(0.5*this.Ce),c=b*this.Lb;this.Yb=-c;this.ac=c;this.kc=-b;this.nc=b}else b=this.ac-this.Yb,c=this.nc-this.kc,this.Ce=Math.atan(Math.abs(this.nc)/this.Yd)+Math.atan(Math.abs(this.kc)/this.Yd),this.Lb=b/c;this.Fe=a.viewport||new Pe(-1,-1,2,2);a.viewport&&this.Fe.A(a.viewport);this.Wd=R();this.Xd=!1;this.Oi=new Xd(this.Wd);this.bf=!1;this.Eg=a.Kr;this.Vi=K(a.Jr,0)}}Nf.prototype=Object.create(ie.prototype);Nf.prototype.Ja=function(a){Of(this,a)};Nf.prototype.ka=function(){return Pf(this)};
Nf.prototype.cg=function(){return this.Ce};function Of(a,b){if(b!==Pf(a)){var c=2*Math.atan(Math.sqrt(Math.pow(Math.tan(0.5*b),2)/(1+Math.pow(a.Lb,2))));if(c!==a.Ce){a.Ce=c;var c=a.Yd*Math.tan(0.5*a.Ce),d=c*a.Lb;a.Yb=-d;a.ac=d;a.kc=-c;a.nc=c;a.Xd=!1;a.bf=!1}}}function Pf(a){var b=Math.tan(0.5*a.Ce);return 2*Math.atan(Math.sqrt(Math.pow(b*a.Lb,2)+Math.pow(b,2)))}
Nf.prototype.Bi=function(a){var b=this.Fe,c=K(void 0,1E-6);vc(a.x,b.x,c)&&vc(a.y,b.y,c)&&vc(a.width,b.width,c)&&vc(a.height,b.height,c)||(this.Fe.A(a),a=this.Fe,a.x=tc(a.x,-1,1),a.y=tc(a.y,-1,1),a.width=tc(a.width,0,1-a.x),a.height=tc(a.height,0,1-a.y),this.bf=this.Xd=!1)};function Qf(a,b){var c=b||z.create(),d=a.Yg();c[0]=d[0];c[1]=d[1];c[2]=d[2];return c}function ub(a,b){var c=b||z.create(),d=a.Yg();c[0]=d[4];c[1]=d[5];c[2]=d[6];return c}
function Rf(a,b){var c=b||z.create(),d=a.Yg();c[0]=-d[8];c[1]=-d[9];c[2]=-d[10];return c}var Sf=Nf.prototype;R();Sf.Wg=function(){if(!(this.bf&&this.Xd&&this.Qf&&this.Pf&&this.Ti&&this.Si)){var a=this.hi(),b=xe(this),a=xd(a,b);this.Oi=new Xd(a);this.bf=!0}return this.Oi};p=Nf.prototype;p.rb=function(){var a=z.create();return function(b,c){var d=c||ub(this,a),e=this.Bg;Fd(b,d,this.S,e);md(e,this.bc);this.ob()}}();
p.Or=function(){var a=z.create();return function(b,c){var d=ub(this,a);this.rotateAxisAngle(d,b,c)}}();p.Cn=function(){var a=z.create();return function(b,c){var d=Qf(this,a);this.rotateAxisAngle(d,b,c)}}();p.Gp=function(){var a=z.create();return function(b,c){var d=Rf(this,a);this.rotateAxisAngle(d,-b,c)}}();
p.hi=function(){if(!this.Xd){var a=this.Fe,b=this.Yb,c=this.ac,d=this.kc,e=this.nc,f=N(b,c,0.5*(a.x+1)),b=N(b,c,0.5*(a.x+a.width+1)),c=N(d,e,0.5*(a.y+1)),a=N(d,e,0.5*(a.y+a.height+1)),d=this.Yd,e=this.Ni;this.Eg?(f=Jd(f,b,c,a,d,e),b=this.Eg.hi(),Id(f,b,this.Vi,this.Wd)):Jd(f,b,c,a,d,e,this.Wd);this.Xd=!0}return this.Wd};p.ob=function(){ie.prototype.ob.call(this);this.bf=!1};function Tf(a){if(a instanceof Tf)Nf.call(this,a);else{a=a||{};ie.call(this);this.Lb=a.Tl;this.Yb=a.left;this.ac=a.right;this.kc=a.bottom;this.nc=a.top;this.Yd=K(a.Nk,0.1);this.Ni=K(a.tk,100);if(this.Lb)if(J(this.kc)||J(this.nc))J(this.Yb)||J(this.ac)?F("invalid args"):(c=this.ac-this.Yb,b=c/this.Lb,this.kc=0.5*-b,this.nc=0.5*b);else{var b=this.nc-this.kc,c=b*this.Lb;this.Yb=0.5*-c;this.ac=0.5*c}else J(this.Yb)||J(this.ac)||J(this.kc)||J(this.nc)?F("invalid args"):(c=this.ac-this.Yb,b=this.nc-this.kc,
this.Lb=c/b);this.Fe=new Pe(-1,-1,2,2);a.viewport&&this.Fe.A(a.viewport);this.Wd=R();this.Xd=!1;this.Oi=new Xd(this.Wd);this.bf=!1;this.Eg=a.Kr;this.Vi=K(a.Jr,0)}}Tf.prototype=Object.create(Nf.prototype);Tf.prototype.Ja=function(){};
Tf.prototype.hi=function(){if(!this.Xd){var a=this.Fe,b=this.Yb,c=this.ac,d=this.kc,e=this.nc,f=N(b,c,0.5*(a.x+1)),b=N(b,c,0.5*(a.x+a.width+1)),c=N(d,e,0.5*(a.y+1)),a=N(d,e,0.5*(a.y+a.height+1)),d=this.Yd,e=this.Ni;this.Eg?(f=Kd(f,b,c,a,d,e),b=this.Eg.hi(),Id(f,b,this.Vi,this.Wd)):Kd(f,b,c,a,d,e,this.Wd);this.Xd=!0}return this.Wd};function Uf(a,b,c){ie.call(this);this.f=a;this.type=b;this.state=c;this.R=Number.MAX_VALUE;this.opacity=1;this.c=this.b=this.wf=this.Fd=this.a=this.Y=this.Q=null;this.s=!1;this.Lj=this.p=this.o=this.Se=this.Ka=null;this.n=0;this.qe=null;this.aj=0;this.be=null;this.e=Vf;this.j=!0}Uf.prototype=Object.create(ie.prototype);p=Uf.prototype;p.bm=function(){ie.prototype.bm.call(this);if(this.Q){var a=this.Q.Xa;if(a){var b=this.f.j;a&&(a=a.Xa,5>b.c.length&&b.c.push(a))}this.Q=null}};
p.vd=function(a){this.opacity=tc(a,0,1);this.Q?Od(this.Q.Ha,"u_opacity",a):(a=this.hd)&&ke(a,this)};p.tn=function(a){this.Q?Od(this.Q.Ha,"u_opacity",a):this.Se&&(Od(this.Se,"u_opacity",a),Od(this.o,"u_opacity",a),Od(this.p,"u_opacity",a),Od(this.Lj,"u_opacity",a))};p.update=function(a){this.Q||(ie.prototype.update.call(this,a),Wf(this))};
function Wf(a){var b=a.Se,c=a.o,d=a.p,e=a.Lj;if(b&&c&&d&&e){var f=a.Ka?a.opacity:0;Od(b,"u_texunit0",0);Od(b,"u_opacity",f);Od(b,"u_mat_tex",Vf);Od(c,"u_texunit0",0);Od(c,"u_opacity",f);Od(c,"u_mat_tex",a.e);Od(d,"u_texunit0",0);Od(d,"u_opacity",f);Od(d,"u_mat_tex",a.e);Od(e,"u_texunit0",0);Od(e,"u_opacity",f);Od(e,"u_mat_tex",Vf);a.s&&(b.za(0,a.Ka),c.za(0,a.Ka),d.za(0,a.Ka),e.za(0,a.Ka),a.s=!1)}}p.nd=function(){return null};p.na=function(a,b){this.update(b)};
var Xf=[[19,0,254],[3,0,205],[51,0,254]],Yf=[7,0,208];z.sub(Yf,Xf[1]);var Zf=[43,0,45],$f=[[74,0,254],[58,0,205],[106,0,254]],ag=[62,0,208],bg=[[128,0,237],[157,0,254]],cg=[[3,0,106],[98,0,201]],dg=[98,0,108],eg=[[106,0,106],[203,0,203]],fg=[108,0,108],gg=[43,0,44],hg=[43,0,44],ig=[0,0,0],jg=[hg[0]-95,0,44],kg=[144,0,246],lg=[[206,0,154],[253,0,106],[206,0,250]],mg=[250,0,112];z.sub(mg,lg[1]);var qg=[-43,0,44],Vf=[1,0,0,0,1,0,0,0,1],rg=va("in",6),sg=va("out",6);
function tg(a,b,c,d,e,f){function g(a,b,c,d){n=new qf(m);sf(n);vf(n,f);d?(k(a[0]-d[0],a[2]-d[2],a[0],a[2]),k(b[0]-d[0],b[2]-d[2],b[0],b[2]),k(c[0]-d[0],c[2]-d[2],c[0],c[2])):(l(a[0],a[2]),l(b[0],b[2]),l(c[0],c[2]));n.Lh(0,1,2);return n.hb()}function h(a,b,c){n=new qf(m);sf(n);vf(n,f);c?(k(a[0]-c[0],a[2]-c[2],a[0],a[2]),k(b[0]-c[0],a[2]-c[2],b[0],a[2]),k(b[0]-c[0],b[2]-c[2],b[0],b[2]),k(a[0]-c[0],b[2]-c[2],a[0],b[2])):(l(a[0],a[2]),l(b[0],a[2]),l(b[0],b[2]),l(a[0],b[2]));xf(n,0,1,2,0,2,3);xf(n,0,2,
1,0,3,2);return n.hb()}function k(a,b,c,d){tf(n,a,0,b,c/256,(256-d)/256,0,1,0)}function l(a,b){tf(n,a,0,256-b,a/256,b/256,0,1,0)}a.Y=f;var m=new Me({position:new Le(7,3,0),texcoord:new Le(7,3,12),normal:new Le(7,3,20)}),n=null,r=new pd(b,h(cg[0],cg[1],dg)),s=new pd(b,h(eg[0],eg[1],fg)),t=null,t=a.type===ug?new pd(b,g(Xf[0],Xf[1],Xf[2],Yf)):new pd(b,g(lg[0],lg[1],lg[2],mg)),v=new pd(b,g($f[0],$f[1],$f[2],ag)),w=new pd(b,h(bg[0],bg[1],kg));b=vg(c);b.za(0,e);var x=vg(c);x.za(0,e);var y=vg(c);y.za(0,
e);c=vg(c);c.za(0,e);je(a,wg);a.c=new Be(w,c);je(a.c,wg);a.a=new Be(r,b);je(a.a,xg);a.Fd=new Be(s,b);je(a.Fd,xg);a.wf=new Be(t,x);je(a.wf,wg);a.type===ug&&(a.b=new Be(v,y),je(a.b,wg));r=256/(Xf[0][2]-Xf[1][2]+(cg[1][2]-cg[0][2])+(bg[1][2]-bg[0][2])/2);r=[1/256*r,1,1/256*r];ve(a.Fd,r);ve(a.wf,r);ve(a.c,r);a.b&&ve(a.b,r);a.s=!0;a.G(d.eg());a.add(a.c);a.add(a.wf);a.add(a.Fd);a.add(a.a);a.b&&a.add(a.b);a.Ka=e;a.Se=b;a.o=x;a.p=y;a.Lj=c;Wf(a);yg(a,!0);zg(a);Ag(a,0);return a}
function zg(a){a.Q?ia():(Bg(a,1,!0),Cg(a,0))}Uf.prototype.u=function(){this.f.u()};Uf.prototype.open=function(a){if(!this.Q){if(E(a)||0<a){a=E(a)?300:a;var b=this.n;this.qe&&this.qe.stop();(this.qe=Dg(this.f,this,b,1,a,!0))&&this.qe.start()}else Bg(this,1,!0);this.u()}};function Ag(a,b){if(a.Q)ia();else{if(E(b)||0<b){var c=E(b)?300:b,d=a.n;a.qe&&a.qe.stop();a.qe=Dg(a.f,a,d,0,c,!1);a.qe&&a.qe.start()}else Bg(a,0,!1);a.u()}}
function Cg(a,b){if(a.Q)ia();else{a.aj=b;var c=256/(Xf[0][2]-Xf[1][2]+(cg[1][2]-cg[0][2])+(bg[1][2]-bg[0][2])/2),d=[1/256*c,1,1/256*c],c=z.si(jg,d),d=z.si(hg,d),c=z.ma(c,d,b);se(a.Fd,c);a.Fd.G(a.j&&0.05<a.aj)}}function Eg(a,b,c,d,e){if(b.Q)ia();else return new Eb(a.l.i.Cj,b.Fd,function(a,g){var h=a>e,k=h?1:tc(a/e,0,1),k=N(c,d,k),k=c<d?rg(k):sg(k);Cg(b,k);b.u();return h?(g.stop(),b.be=null,!1):!0})}var Fg=z.ma(ig,gg,0.3125);z.ma(ig,qg,0.3125);
function Bg(a,b,c){if(a.Q)ia();else{if(a.type===ug){var d=c?ig:gg,e=c?gg:Fg;a.n=b;var f=c?b:1-b,g=N(c?0:1,c?1:0.3125,f),h=256/(Xf[0][2]-Xf[1][2]+(cg[1][2]-cg[0][2])+(bg[1][2]-bg[0][2])/2),k=1/256*h,l=1/256*h,m=[k,1,l]}else d=c?ig:gg,e=c?qg:Fg,a.n=b,f=c?b:1-b,g=N(c?0:1,c?1:0.3125,f),h=256/(Xf[0][2]-Xf[1][2]+(cg[1][2]-cg[0][2])+(bg[1][2]-bg[0][2])/2),k=1/256*h,l=1/256*h,m=[k,1,l];h=N(c?0.5:1,c?1:0.25,f);h=[k*h,1,l*h];c=N(c?0:1,c?1:0.15,f);c=[k*c,1,l*c];d=z.si(d,m);e=z.si(e,m);f=z.ma(d,e,f);se(a.a,f);
a.e=[1,0,0,0,1,0,N(Zf[0]/256,0,g),N(-(Zf[2]/256),0,g),1];ve(a.a,h);ve(a.c,c);yg(a,0<b)}}function Dg(a,b,c,d,e,f){if(b.Q)ia();else return new Eb(a.l.i.Cj,b.Fd,function(a,h){var k=a>e,l=k?1:tc(a/e,0,1),l=N(c,d,l),l=c<d?rg(l):sg(l);Bg(b,l,f);b.u();return k?(h.stop(),b.qe=null,!1):!0})}p=Uf.prototype;p.sj=function(){return this.R};
p.qg=function(a){this.R=a;this.a&&(this.a.R=this.R-0.005,this.Fd.R=this.R-0.004,this.wf.R=this.R-0.002,this.c.R=this.R-0.001,this.b&&(this.b.R=this.R-0.003));this.Q&&(this.Q.R=this.R)};p.G=function(a){this.Vf!=a&&(ie.prototype.G.call(this,a),Gg(this))};function yg(a,b){a.j!=b&&(a.j=b,Gg(a))}function Gg(a){var b=a.j&&a.Vf;a.a&&(a.a.G(b),a.Fd.G(b&&0.05<a.aj),a.wf.G(b),a.c.G(b),a.b&&a.b.G(b));a.Q&&a.Q.G(b)}p.$h=function(){return-Infinity};
p.Ul=function(a,b){if(!this.Q){var c=this.f.j.Ul(this,a,b);c&&(pe(this.a),pe(this.c),pe(this.wf),pe(this.Fd),this.b&&pe(this.b),this.Q=c,this.add(c),this.e=this.Lj=this.p=this.o=this.Se=this.Ka=this.Fd=this.b=this.wf=this.c=this.a=null);return c}};function Hg(){this.Vb=this.wa=this.Jc=this.lb=this.mb=this.f=null;this.n=this.o=-1;this.Fa=this.d=this.b=this.j=this.e=this.a=null;this.c=[]}Hg.prototype.Ac=function(){};
Hg.prototype.clear=function(){this.c=this.lb=this.mb=this.f=this.Fa=this.d=this.b=this.j=this.e=this.a=this.Vb=this.wa=this.Jc=null};function Ig(a,b,c){if(a.wa){var d=a.wa.getContext();if(null==a.g||b!=a.o||c!=a.n)a.o=b,a.n=c,a.a=d.createFramebuffer(),a.a.width=b,a.a.height=c,a.g=d.createRenderbuffer();d.bindRenderbuffer(d.RENDERBUFFER,a.g);d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,a.a.width,a.a.height)}return a.a}
function Jg(a,b,c){var d=b,e=c,d=b/2,e=c/2;c=new Uint8Array(d*e);for(var f=0,g=0;g<e;g++)for(var h=g*b*8+3,k=(g+1)*b*8+3,l=0;l<d;l++)c[f]=10<a[h]||10<a[h+4]||10<a[k]||10<a[k+4]?255:0,f++,h+=8,k+=8;return{width:d,height:e,data:c,wp:1}}
Hg.prototype.Ul=function(a,b,c){var d=a.getParent();if(!d||a.Q)return null;var e=this.Jc,f=this.wa,g=f.getContext();f.bindTexture(0,null);g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,null);g.bindRenderbuffer(g.RENDERBUFFER,null);g.bindFramebuffer(g.FRAMEBUFFER,null);var h=Ig(this,b,c);g.bindFramebuffer(g.FRAMEBUFFER,h);var k=0<this.c.length?this.c.pop():this.wa.getContext().createTexture();g.bindTexture(g.TEXTURE_2D,k);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);g.texParameteri(g.TEXTURE_2D,
g.TEXTURE_MIN_FILTER,g.LINEAR_MIPMAP_NEAREST);g.texImage2D(g.TEXTURE_2D,0,g.RGBA,h.width,h.height,0,g.RGBA,g.UNSIGNED_BYTE,null);g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,k,0);g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,this.g);g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,null);g.bindRenderbuffer(g.RENDERBUFFER,null);g.bindFramebuffer(g.FRAMEBUFFER,null);g.bindFramebuffer(g.FRAMEBUFFER,h);this.Fa.clear();this.Fa.add(a);this.Fa.update();
e.clear();g.clearColor(0.5,0.5,0.5,0);g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);e.Bi(0,0,b,c);Kg(this.d,[Lg.TERRAIN,Mg,Lg.BUILDING,Ng,Wg,Xg,Lg.ROUTE,Yg,Zg,$g,ah,bh,xg,wg,ch]);var l=[],h=0.5/b,m=0.5/c,n=Number.MAX_VALUE,r=Number.MAX_VALUE,s=Number.MIN_VALUE,t=Number.MIN_VALUE;a.forEach(function(a){var b=a.nd().hb().Ug(),c=z.I(we(a),b.Zb);a=z.I(we(a),b.Nb);n=c[0]<n?c[0]:n;r=c[2]<r?c[2]:r;s=a[0]>s?a[0]:s;t=a[2]>t?a[2]:t});var v=s-n,w=t-r,x=v/w,y=1,A=1,C=1;v>w?(A=v,C=w*x,y=x):(A=v/x,C=w);v=z.I(we(a.wf),
[0,0,0]);v[0]-=n;v[1]-=r;v[0]/=A;v[1]/=C;C=new Tf({left:n,right:n+A,bottom:r,top:r+C,Nk:0,tk:100});A=C.hi();w=xe(C);w[0]=1;w[6]=1;w[9]=1;w[10]=0;w[5]=0;C=a.Lj.tc();dh(C,!1);eh(this.Fa,A,w,function(a,b){l.push(b.Db())},{Qo:!1,ne:!1});l.sort(fh);for(A=0;A<l.length;A++)w=l[A],w.object.na(e,w);this.Fa.clear();dh(C,!0);e=null;e=new Uint8Array(b*c*4);g.readPixels(0,0,b,c,g.RGBA,g.UNSIGNED_BYTE,e);e=Jg(e,b,c);g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,null);g.bindRenderbuffer(g.RENDERBUFFER,
null);g.bindFramebuffer(g.FRAMEBUFFER,null);d.add(a);if(!this.b){this.b=new gh;this.b.b=hh;this.b.a=hh;A=new Me({position:new Le(7,3,0),texcoord:new Le(7,3,12),normal:new Le(7,3,20)});d=[0,1,0];g=[[0,0,0],[1,0,0],[1,0,1],[0,0,1]];C=[[0,0],[1,0],[1,1],[0,1]];w=new qf(A);for(A=0;A<g.length;A++)S(w,g[A],C[A],d);xf(w,0,1,2,0,2,3);d=w.hb();this.e=new pd(this.mb,d);this.j=ih(this.lb)}f=new Ne(f,{Se:this.j,Gc:this.e});Re(f);b=this.Vb.Oo(b,c,jh,{Xa:k,gd:this.b});f.za(b,e,!1);f.G(a.eg());f.Y=a.Y;je(f,xg);
Qe(f,h,m,1-h,1-m);b=1/1.03*y;ve(f,[b,b,b]);se(f,[-v[0]*b,0,-v[1]*b]);f.R=a.R;return f};function kh(a,b){this.c=a;this.b=b;this.da=0;this.keys=[];this.a={};this.Wb=0}p=kh.prototype;p.set=function(a,b){if(this.da<this.c)this.a[a]||(this.da+=1,this.keys.push(a));else if(!this.a[a]&&0<this.keys.length){var c=lh(this.keys,this.a);this.b&&this.b(c.key,this.a[c.key].value);this.keys[c.index]=a;delete this.a[c.key]}else if(0==this.c)return;this.Wb+=1;this.a[a]={value:b,Wb:this.Wb}};p.get=function(a){return(a=this.a[a])?(this.Wb+=1,a.Wb=this.Wb,a.value):null};
function mh(a,b){var c=a.a[b];return c?c.value:null}p.fl=function(a){a&&(this.Wb+=1,a.Wb=this.Wb)};p.remove=function(a,b){var c=this.a[a];if(c){this.b&&void 0!==b&&!0===b&&this.b(a,c.value);for(var c=this.keys,d=c.length,e=0;e<d;++e)if(a==c[e])return delete c[e],c.splice(e,1),delete this.a[a],this.da--,!0}return!1};p.size=function(){return this.da};
p.Jj=function(a,b){if(a<this.c&&void 0!==b&&!0===b){for(;this.da>a;){var c=lh(this.keys,this.a);this.b&&this.b(c.key,this.a[c.key].value);delete this.keys[c.index];this.keys.splice(c.index,1);delete this.a[c.key];this.da--}this.c=a}else this.c=Math.max(this.c,a)};p.clear=function(){if(this.b)for(var a=0;a<this.da;a++)this.b(this.keys[a],this.a[this.keys[a]].value);this.da=0;this.keys=[];this.a={};this.Wb=0};
function lh(a,b){for(var c={key:a[0],Wb:b[a[0]].Wb,index:0},d=a.length,e=1;e<d;++e){var f=a[e],g=b[f].Wb;g<c.Wb&&(c.key=f,c.Wb=g,c.index=e)}return c}function nh(a,b){for(var c=a.a,d=a.keys,e=d.length,f=1;f<e;++f){var g=d[f],g=b(g,c[g].value);if(!E(g))break}}p.Ro=function(){};function oh(){this.$c=new ph;this.a=qh}
var qh="eng",rh={at:"Afrikaans",bt:"Albanian",dt:"Arabic",et:"Basque",ht:"Belarusian",it:"Bengali",jt:"Bosnian",kt:"Bulgarian",lt:"Catalan",mt:"Simpl. Chinese",nt:"Trad. Chinese",qt:"Czech",rt:"Danish",vt:"Dutch",wt:"English",yt:"Estonian",zt:"Filipino",At:"Finnish",Bt:"French",Ct:"German",Dt:"Irish",Et:"Galician",Ht:"Greek, Modern (1453-)",It:"Hebrew",Kt:"Hindi",Lt:"Hungarian",Mt:"Icelandic",Nt:"Indonesian",Pt:"Italian",Qt:"Japanese",Rt:"Kazakh",St:"Khmer",Tt:"Kyrgyz",Ut:"Korean",Vt:"Latvian",Wt:"Lithuanian",
Xt:"Macedonian",Zt:"Maori",$t:"Malay",au:"Maltese",bu:"Montenegro",cu:"Moldavian",du:"Mongolian",iu:"Norwegian",lu:"Persian",ou:"Polish",pu:"Portuguese",tu:"Pinyin",wu:"Romanian",xu:"Russian",yu:"Croatian",sin:"Sinhalese",zu:"Slovak",Au:"Slovenian",Bu:"Spanish",Cu:"Serbian",Eu:"Swahili",Fu:"Swedish",Hu:"Tamil",Iu:"Tagalog",Ju:"Thai",Mu:"Turkish",Nu:"Ukrainian",Ou:"Urdu",Pu:"Uzbek",Qu:"Vietnamese",Ru:"Welsh",$s:"Default"};function sh(a,b){var c,d=[0,0,0,1];d[0]=Math.floor(a/Math.pow(16,4))/255;c=a%Math.pow(16,4);d[1]=Math.floor(c/Math.pow(16,2))/255;c%=Math.pow(16,2);d[2]=c/255;void 0!==b&&(d[3]=b);return d};pa().isEnabled=!1;function th(a,b){var c=a.length,d=null,e=0,f=!1,g=Number.MAX_VALUE,h={},k=0,l=a[0],m,n=(m=2<l.length&&2<b.length)?z.Ta:P.Ta,r=m?z.X:P.X;if(2===c)m=a[k+1],d=n(l,m,b,h),e=0,f=h.split,g=r(b,d);else for(;k<c-1;k++){m=a[k+1];var s=null,t=-1,s=n(l,m,b,h),t=r(b,s);t<g&&(g=t,d=s,e=k,f=h.split);l=m}return{point:d,index:e,split:f,Zf:g}}
function uh(a,b){var c=th(a,b);if(0===c.index&&!c.split)return{Rd:null,Le:null,ub:c.point,split:!1};if(c.index===a.length-1&&!c.split)return{Rd:null,Le:null,ub:c.point,split:!1};var d=a.slice(0,c.index+1);d.push(c.point);var e=a.slice(c.index+1);e.splice(0,0,c.point);return{Rd:d,Le:e,ub:c.point,split:!0}}function vh(a){if(!(null===a||2>a.length))for(var b=0;b<a.length;b++)for(var c=b+1;c<a.length;c++)if(0.1>P.X(a[b],a[c]))return}
function wh(a,b,c){for(var d=c*c;1<a.length&&P.Pg(a[0],a[1],b)>d;)a.splice(0,1);1==a.length&&P.X(a[0],b)>d&&a.splice(0,1);if(0!=a.length){var e,f,g=0;e=a[0];for(var h=P.X(a[0],b)<d;g<a.length-1;g++){f=a[g+1];var k=P.Pg(e,f,b);if(k+0.01>d)a.splice(0,2);else{k=P.ig(e,f,b,c);if(!k){if(P.X(e,b)<d-1E-6){e=f;continue}break}!k[0]||h||0.1>P.X(k[0],e)||0.1>P.X(k[0],f)||(a[g]=k[0]);if(k[1]){P.distance(k[1],e);P.distance(k[1],f);0.1>P.X(k[1],e)||0.1>P.X(k[1],f)||(P.distance(k[1],f),a.splice(g+1,0,k[1]));break}e=
f}}vh(a);if(1<a.length)for(;1<a.length&&P.Pg(a[a.length-1],a[a.length-2],b)+0.001>d;)a.splice(a.length-1,1);var l=g;e=a[a.length-1];h=P.X(e,b)<d;for(g=a.length-1;g>l;g--)if(f=a[g-1],k=P.Pg(e,f,b),k+0.01>d)a.splice(g-1,2);else{k=P.ig(e,f,b,c);if(!k)break;if(k[0]&&!h){if(0.1>P.X(k[0],e)||0.1>P.X(k[0],f))break;a[g]=k[0]}if(k[1]){if(0.1>P.X(k[1],e)||0.1>P.X(k[1],f))break;a.splice(g,0,k[1]);break}e=f}vh(a)}}
function xh(a,b,c,d){var e=z.jb(z.sub(c,a)),f=z.jb(z.sub(c,b));if(1E-6<z.jb(z.sub(a,b))){e<f?(e=a,a=b):e=b;b={};c=z.Ta(e,a,c,b);var f=e,g=a,h=0;b.split&&(h=z.L(z.normalize(z.sub(e,c)),z.normalize(z.sub(d,c))),0<h?(f=c,g=e):(f=c,g=a));return z.normalize(z.sub(g,f))}}function yh(a,b,c,d,e){if(b!=c){e=(e-d)/Math.abs(c-b);var f=c>b?1:-1;b+=f;for(d+=e;b!=c;)a[b][2]=d,b+=f,d+=e}}function zh(a){return Array.isArray(a)&&2<a.length&&Mc(a[2])&&!isNaN(a[2])}
function Ah(a){for(var b=0;b<a.length;b++)if(!zh(a[b]))return!1;return!0}function Bh(a,b){var c=!0,d=0<b?0:a.length-1,e=0<b?a.length:-1,f=null,g=d,h=a[g][2];Mc(h)&&!isNaN(h)?f=d:(c=!1,h=null);g+=b;for(d=null;g!=e;)d=a[g],2<d.length&&Mc(d[2])&&!isNaN(d[2])&&(null!=h&&null!=f&&yh(a,f,g,h,d[2]),f=g,h=d[2]),g+=b;d&&null!=h&&null!=f&&(e=zh(d)?d[2]:h,yh(a,f,g,h,e));return c}function Ch(a){Bh(a,1)||Bh(a,-1)}var Dh=177*u;
function Eh(a){var b=Fh;if(a&&!(3>a.length))for(var c=a.length-1,d=a[0],e=1;e<c;e++){var f=a[e],g=a[e+1],h=f,k=d,l=g;Math.abs(P.Zk(P.sub(k,h),P.sub(l,h)))<Dh||0.25<P.Pg(k,l,h)?d=f:(h=P.distance(d,g),1E-4>h&&(h=1E-4),g=(g[2]-d[2])/h,k=P.distance(d,f),1E-4>k&&(k=1E-4),Math.abs(d[2]+k*g-f[2])*(1>h?1:h)<=b?(a.splice(e,1),e--,c--):d=f)}};var Gh=[{na:!1,Pc:1},{na:!0,Pc:2},{na:!0,Pc:1.5},{na:!0,Pc:1},{na:!0,Pc:1},{na:!0,Pc:1},{na:!0,Pc:1.25},{na:!1,Pc:1},{na:!1,Pc:1},{na:!0,Pc:1},{na:!0,Pc:1},{na:!0,Pc:1},{na:!1,Pc:1},{na:!1,Pc:1},{na:!0,Pc:1}];function Hh(a,b,c){this.op=a;this.we=b;this.Ai=z.create();this.kh=Ih;this.right=this.left=null;this.a=this.height=0;this.Vk=c;this.R=Number.MAX_VALUE;this.Xm=!1}function Jh(a,b,c,d,e,f){this.zc=a;this.nn=b;this.V=c;this.label=d;this.Qd=e;this.Rk=f}
function Kh(a,b,c,d,e,f){this.V=a;this.label=b;this.start=c;this.end=d;this.Sn=e;this.il=f}function Lh(){}var Mh=0.5*u;
Lh.prototype.Xl=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e&&e.left&&e.we.Qa()&&c.push(e)}c.sort(Nh);for(var f=[],d=0;d<c.length;d++){var e=c[d],g=c[d].Vk,h=z.sub(e.left,a),k=z.sub(e.right,a),h=Math.atan2(h[1],h[0]),k=Math.atan2(k[1],k[0]);0>k&&(k+=jc);0>h&&(h+=jc);var h=h-k,l=Mh,k=k-l,h=h+2*l;h>oc?h=-(pc-h):h<-oc&&(h=pc+h);for(var h=k+h,l=z.normalize(z.sub(a,e.left)),m=-P.Sl(l[2]),l=z.normalize(z.sub(a,e.right)),n=-P.Sl(l[2]),l=z.length(z.sub(a,e.Ai)),r=e.height/l,s=Math.min(m,n),
m=Math.max(m,n),t=m+r,n=0;n<f.length;n++){var v=f[n];if(v.Vk!==g){var w=k>=v.start&&k<v.end;if(w=(w=w||h>=v.start&&h<v.end)||k<=v.start&&h>=v.end){var w=t>=v.Sn&&t<v.il,x=s<=v.Sn&&t>=v.il;if(s>=v.Sn&&s<v.il||w||x)t=v.il,v=l*Math.tan(t-s),e.Xm=!0,e.we.translate([0,0,v]),m+=t-s,s=t,t=m+r}}}f.push(new Kh(g,e,k,h,s,t));h>2*fc&&f.push(new Kh(g,e,k-2*fc,h-2*fc,s,t))}};function Nh(a,b){return a.kh==Oh&&b.kh!=Oh?-1:a.kh!==Oh&&b.kh==Oh?1:a.R-b.R}
function Ph(a,b,c,d,e,f,g,h,k){this.op=a;this.V=b;this.Zf=c;this.gs=d;this.rr=e;this.ub=f;this.nn=g;this.Qd=h;this.Rk=k}function Qh(a,b,c){this.a=Rh;this.s=Wh;this.b=Xh;this.mb=a;this.Vb=b;this.lb=c;this.n=Yh;this.c=0.5*this.n;this.g={};this.d=null;Zh(this);this.e=$h;this.o=this.j=null;this.v=new Lh;this.p=qh.toUpperCase();this.H=0;this.M=1;this.aa=128}Qh.prototype.ir=function(a){this.p=a.toUpperCase()};Qh.prototype.t=function(){this.v=this.lb=this.Vb=this.mb=null};var ai=pa();ai.isEnabled=!1;
Qh.prototype.kb=ai;var bi=sh(14145535),ci=sh(10526880),Yh=1.5,di=new Me({position:new Le(7,3,0),texcoord:new Le(7,3,12),normal:new Le(7,3,20)}),ei=new Me({position:new Le(7,3,0),texcoord:new Le(7,3,12),normal:new Le(7,3,20)}),fi=40,gi=fi*fi,hi=35,ii=10,$h=!0;Qh.distanceFactor=0.04;var ji="Nokia Pure Text",ki=0.55,li=34,mi=[1,1,1,1],ni=6,oi=[0,0,0,1],pi=[0,0,0,1],qi=30,ri=120,Ih=0,Oh=2,Rh=[0,0,1],Wh=[0,0,-1],Xh=[0,0,0],si=[0,0,0];Qh.prototype.clear=function(){};
function ti(a,b){var c=b.nh,d=null,e=[];for(d in a.g){var f=a.g[d];if(f){var g;a:{g=c;if(f&&(f.jn--,0>=f.jn)){g.remove(f);f.Ka&&f.Ka.Na();g=!0;break a}g=!1}g&&e.push(d)}}for(c=0;c<e.length;c++)delete a.g[e[c]]}
function Zh(a){a.j=null;a.o=null;mi=[1,1,1,1];oi=[0,0,0,0.14];pi=[0,0,0,0];var b=ji,c=parseInt(li,10),d=mi,e=oi,f=parseInt(ni,10),g=pi,h=new ui;h.name=void 0;h.font=b;h.size=c;h.color=void 0!=d?d:[1,1,1,1];h.outlineColor=void 0!=e?e:[0,0,0,1];h.outlineWidth=void 0!=f?f:0;h.shadowColor=void 0!=g?g:null;h.a=!1;h.Ff=0;h.b=!1;a.d=h}
function vi(a,b,c,d,e,f,g,h,k,l){if(void 0===d[c.id]){d[c.id]=c;for(var m=[10,2],n=c.$,r=0;r<n.length;r++){var s=n[r];if(s!==b&&s.Ra==b.Ra&&void 0===e[s.V]&&!s.qd)for(var t=0,v=s.P;t<v.length;t++){var w=v[t];if(w!==c){if(void 0!==d[w.id])return;for(var x=0;2>x;x++){var y=a.c+m[x],y=wi(s.m,y,y),y=xi(a,s.m,y,0,l,h,k);f.push(new Jh(s,y.vc?y.vc:s.m,s.V,l,y.Qd,1==x))}vi(a,s,w,d,e,f,g,h,k,l)}}}}}
function wi(a,b,c){if(1E-6>b&&1E-6>c)return a;var d=a.length,e=b*b,f=c*c,g=a[0],h=a[d-1],k,l,m=[],n=0;k=a[0];if(0<b){var r=P.X(g,h);if(r<e)return null}if(0<c&&(r=P.X(g,h),r<f))return null;if(0<b&&0<c){for(;n<d-1;n++){l=a[n+1];r=P.X(g,l);if(r>=e)break;k=l}for(;n<d-1;n++){l=a[n+1];if((e=z.ig(k,l,g,b))&&e[1]){k=e[1];r=P.X(h,l);if(r>f){m.push(k);k=l;n++;break}if((e=z.ig(k,l,h,c))&&e[0])m.push(k),m.push(e[0]);else{if(1E-6>r){if(0==m.length)return null;n=d;break}m.push(k);m.push(l)}return m}m.push(k);k=
l}for(;n<d-1;n++)if(l=a[n+1],r=P.X(h,l),r>f)m.push(k),k=l;else{(e=z.ig(k,l,h,c))&&e[0]?(m.push(k),m.push(e[0])):(m.push(k),m.push(l));break}}else if(0<b){for(;n<d-1;n++)if(l=a[n+1],r=P.X(g,l),r<e)k=l;else{(e=z.ig(k,l,g,b))&&e[1]?m.push(e[1]):m.push(k);n++;break}for(;n<d;n++)m.push(a[n])}else for(;n<d-1;n++)if(l=a[n+1],r=P.X(h,l),r>f)m.push(k),k=l;else{(e=z.ig(k,l,h,c))&&e[0]?(m.push(k),m.push(e[0])):(m.push(k),m.push(l));break}return m}
function yi(a,b,c){z.sub(a,b,si);z.normalize(si,si);return z.L(Wh,si)>=c}
function zi(a,b,c){for(var d=0,e=b.length,f=b[0],g=null,h,k={},l=yi(f,c,Math.cos(63.5*u)),m=l;d<e-1;d++){var n=b[d+1],r=Ai(f,n,c,a.s,k),m=m&&k.valid&&0<k.is&&1>k.js;if(null!=r){if((null!=r[0]||null!=r[1])&&null===g&&(g=[],!l))for(h=0;h<d;h++)g.push(b[h]);if(null!=r[0]&&!l){g.push(f);g.push(r[0]);m=!1;break}if(null!=r[1]&&l){g.push(r[1]);for(h=d+1;h<e;h++)g.push(b[h]);return{m:g,Jo:!1}}}else g&&g.push(f);f=n}return{m:g,Jo:m}}
function Bi(a,b){if(!a||2>a.length)return!1;var c=Math.cos(62.5*u),d=yi(a[0],b,c),c=yi(a[a.length-1],b,c);return d||c}function Ci(a,b){var c=ki,d=qi,e=ri,f=1+Math.max(0,Qh.distanceFactor*b),c=c*f/b/a.M,g=1;c<d?g=d/c:c>e&&(g=e/c);return f*g}function xi(a,b,c,d,e,f,g){if(!c||2>c.length)return{vc:null,Qd:!0};d||(g=th(c,g),g=Ci(a,Math.sqrt(g.Zf)),e=f.measureText(e,a.d),d=e.width/e.height*ki*g);return 1>P.length(P.sub(c[0],c[c.length-1]))-d?{vc:wi(b,a.c,a.c),Qd:!0}:{vc:c,Qd:!1}}
function Di(a,b,c,d,e,f,g,h){for(var k=g[2]-3,l={},m=0,n=!1;2>m;m++){for(var r=[],s=e[m],t=0;t<s.length;t++){var v=s[t],w=v.V,x=v.Qd,y=v.Rk,v=v.nn;if(Ei(d,v,k)){var A=zi(a,v,g);if(!A.Jo&&(A=A.m,!Bi(A,g))){A&&1<A.length&&(v=A);var A=v[0],C=v[v.length-1],B=z.Ta(A,C,g),I=z.jb(z.sub(g,B));0<P.se(A,C,g)&&(k=z.A(A),A=C,C=k);k=B[2];Fi(d,A,v,k,!0);Fi(d,C,v,k,!0);Fi(d,B,null,k,!0);r.push(new Ph(h,w,I,A,C,B,v,x,y))}}}r.sort(Gi);var s=0,t=b.Fa,G=b.ce,D=null,L=null,D=we(b.bd),L=z.I(D,g);t.update();t=null;for(t=
function(a,b,c){a:{var d=L,e=D,f=G,g=Array(6),h=Array(3),k=Array(3);z.I(e,b,h);z.sub(h,d,k);lf(d[0],d[1],d[2],k[0],k[1],k[2],g);if(Hi(f,g,z.distance(h,d)))a=!0;else{z.I(e,a,h);z.sub(h,d,k);lf(d[0],d[1],d[2],k[0],k[1],k[2],g);if(Hi(f,g,z.distance(h,d))&&(z.I(e,c,h),z.sub(h,d,k),lf(d[0],d[1],d[2],k[0],k[1],k[2],g),Hi(f,g,z.distance(h,d)))){a=!0;break a}a=!1}}return a};s<r.length;s++){w=r[s];if(l[w.V])break;if(x=Ii(a,w.V,f,w.op,w.gs,w.rr,g,d,w.nn,k,w.Qd,w.ub,t)){c.push(x);l[w.V]=1;n=!0;break}}}return n}
function Ji(a,b,c,d,e,f,g,h,k){var l={},m=null,n;var r=Ki(e,d.og);if(2>r.length)n=null;else{n=0;for(var s,m={og:[]},t=null;n<r.length;n++){var v=r[n];v.P[0].Yc||v.P[1].Yc?(t||(t=[]),t.push(v)):m.og.push(v.V)}if(t){for(n=0;n<t.length;n++)if(v=t[n],!v.yj){v.yj=!0;var r=v.m.slice(),w=v.P[0],x=v.P[1];if(w.Yc){var y=w.$[0].V===v.V?w.$[1]:w.$[0];if(y.yj)continue;l[y.V]=1;y.yj=!0;var A=y.m;s=r[0];if(A[0][0]===s[0]&&A[0][1]===s[1]){for(s=A.length-1;0<s;s--)r.splice(0,0,A[s]);w=y.P[1];Ui(w,y,v)}else if(A[A.length-
1][0]===s[0]&&A[A.length-1][1]===s[1]){for(s=A.length-2;0<=s;s--)r.splice(0,0,A[s]);w=y.P[0];Ui(w,y,v)}}if(x.Yc){y=x.$[0].V===v.V?x.$[1]:x.$[0];if(y.yj)continue;l[y.V]=1;y.yj=!0;A=y.m;s=r[r.length-1];if(A[0][0]===s[0]&&A[0][1]===s[1]){for(s=1;s<A.length;s++)r.push(A[s]);x=y.P[1];Ui(x,y,v)}else if(A[A.length-1][0]===s[0]&&A[A.length-1][1]===s[1]){for(s=A.length-2;0<s;s--)r.push(A[s]);x=y.P[0];Ui(x,y,v)}}v.P=[w,x];v.m=r;v.qd=!Vi(v.m);if(!v.qd){for(s=0;s<r.length;s++);m.og.push(v.V)}}n=m?m:null}else n=
null}n&&(d=n);n=Ki(e,d.og);m=g[2]-3;d=[];t=null;v=Number.MAX_VALUE;for(r=0;r<n.length;r++)if(w=n[r],x=w.m,w.qd=!Ei(f,x,m),!w.qd){a:if(null!==x)for(y=0;y<x.length;y++)if(3>x[y].length)break a;y=g;A=x.length;if(2===A)x=P.Ta(x[0],x[1],y);else{var C=x[0];s=void 0;for(var B=null,I=Number.MAX_VALUE,G=0;G<A-1;G++){s=x[G+1];var C=P.Ta(C,s,y),D=P.X(y,C);D<I&&(I=D,B=C);C=s}x=B}x=P.jb(z.sub(g,x));x>gi||(d.push(w),x<v&&(t=w,v=x))}m=t;n=[[],[]];if(m){l[m.V]=1;t={};l[m.V]=1;v=m.m;r=null;w=!1;a:if(x=0,y=v.length,
B=v[0],A=Math.cos(63.5*u),I=yi(B,g,A))x=!0;else{for(;x<y-1;x++){s=v[x+1];if(I=yi(s,g,A)){x=!0;break a}B=Ai(B,s,g,a.s);if(null!=B&&(null!=B[0]||null!=B[1])){x=!0;break a}B=s}x=!1}x?(r=uh(v,g),Fi(f,r.ub,v,r.ub[2],!0),r.Rd&&0<r.Rd.length&&(r.Rd[r.Rd.length-1][2]=r.ub[2]),r.Le&&0<r.Le.length&&(r.Le[0][2]=r.ub[2]),A=P.jb(z.sub(g,r.ub)),w=r.split):A=th(v,g).Zf;if(!(A>gi||(y=x=a.c,A=Ci(a,Math.sqrt(A)),s=h.measureText(k,a.d),A=s.width/s.height*ki*A,s=z.length(z.sub(v[0],v[v.length-1]))-2*a.c,0.1>s))){1>s-
A||(m.P[0].Yc||(x=m.P[0].Pe,x=a.c+(x?0:10)),m.P[1].Yc||(y=m.P[1].Pe,y=a.c+(y?0:10)));if(w){w=wi(r.Rd,a.c+10,0);if(v=null!=w)w=new Jh(m,w?w:r.Rd,m.V,k,!1,!1),n[0].push(w);w=wi(r.Rd,a.c+2,0);w=new Jh(m,w?w:r.Rd,m.V,k,!1,!v);n[0].push(w);w=wi(r.Le,0,a.c+10);if(v=null!=w)w=new Jh(m,w?w:r.Le,-m.V,k,!1,!1),n[1].push(w);w=wi(r.Le,0,a.c+2);w=new Jh(m,w?w:r.Le,-m.V,k,!1,!v);n[1].push(w)}else w=wi(v,x,y),r=xi(a,v,w,A,k,h,g),r=new Jh(m,r.vc?r.vc:v,m.V,k,r.Qd,!1),n[0].push(r),n[1].push(r),m.P[0].Yc||(x=m.P[0].Pe,
x=a.c+(x?0:2)),m.P[1].Yc||(y=m.P[1].Pe,y=a.c+(y?0:2)),w=wi(v,x,y),r=xi(a,v,w,A,k,h,g),r=new Jh(m,r.vc?r.vc:v,m.V,k,r.Qd,!0),n[0].push(r),n[1].push(r);vi(a,m,m.P[0],t,l,n[0],e,h,g,k);vi(a,m,m.P[1],t,l,n[1],e,h,g,k)}}for(e=0;e<d.length;e++)if(m=d[e],void 0===l[m.V]&&(l[m.V]=1,v=t=0,m.P[0].Yc||(t=m.P[0].Pe,t=a.c+(t?0:10)),m.P[1].Yc||(v=m.P[1].Pe,v=a.c+(v?0:10)),t=wi(m.m,t,v),t=xi(a,m.m,t,0,k,h,g),null===t.vc||1<t.vc.length))if(v=new Jh(m,t.vc?t.vc:m.m,m.V,k,t.Qd,!1),n[0].push(v),!t.Qd&&(v=t=0,m.P[0].Yc||
(t=m.P[0].Pe,t=a.c+(t?0:2)),m.P[1].Yc||(v=m.P[1].Pe,v=a.c+(v?0:2)),t=wi(m.m,t,v),t=xi(a,m.m,t,0,k,h,g),null===t.vc||1<t.vc.length))v=new Jh(m,t.vc?t.vc:m.m,m.V,k,t.Qd,!0),n[0].push(v);return Di(a,b,c,f,n,h,g,k)}
function Ii(a,b,c,d,e,f,g,h,k,l,m,n,r){var s=z.length(z.sub(e,f));if(0.1>s)return null;n=Ci(a,P.distance(n,g));var t=c.measureText(d,a.d),t=t.width/t.height*ki*n-2*a.c;n=null;if(m||1>s-t)n=Wi(a,b,c,d,e,f,1,g,h,k,l,r);else for(m=[0,2,3],s=0;s<m.length&&(n=Wi(a,b,c,d,e,f,m[s],g,h,k,l,r),null===n&&null!==r);s++);return n}
function Wi(a,b,c,d,e,f,g,h,k,l,m,n){var r=z.A(e),s=z.A(f),t=null,v=null,w=-1,x=-1,y=c.measureText(d,a.d),w=ki,x=y.width/y.height*ki;null===r[2]&&null!==s[2]?r[2]=s[2]:null===s[2]&&null!==r[2]&&(s[2]=r[2]);var A=P.se(r,s,h),C=0<A,B,I;C?(B=s,I=r):(B=r,I=s);var G=z.normalize(z.sub(I,B)),D,L=z.Ta(B,I,h),O=!0;Fi(k,L,l,m,O);var M=L,Z=z.A(M),V=z.distance(Z,h),Q=Ci(a,V),ga=w*Q,fa=x*Q,Ia=z.scale(G,fa),za=z.scale(Ia,0.5),zf=z.length(z.sub(B,I));if(1===g)L=z.ma(B,I,0.5);else{var Tb=z.add(B,za),ad=z.sub(I,za),
bd=z.Ta(Tb,ad,h);switch(g){case 0:L=bd;break;case 2:if(1>z.X(Tb,bd))return null;L=Tb;break;case 3:if(1>z.X(ad,bd))return null;L=ad}}O=!0;if(!Xi(k,L,null,O))return null;if(1!=g){for(var kb,lc=L,cd=lc,yd=l.length,Og=Number.MAX_VALUE,dd=0,Af=l[0],Sd=Af,ed,Li=0.25*fa,Bf,Ab=[];dd<yd-1;dd++){ed=l[dd+1];var fd=P.Ta(Sd,ed,lc);Bf=P.X(h,fd);Bf<Og&&(Og=Bf,cd=fd);Sd=ed}dd=0;for(Sd=Af;dd<yd-1;dd++){ed=l[dd+1];var Jb=P.pp(Sd,ed,cd,Li),Sd=ed;null!==Jb&&(Jb[0]&&Ab.push(Jb[0]),Jb[1]&&Ab.push(Jb[1]))}var gd,zd;0===
Ab.length?(gd=l[0],zd=l[yd-1]):1===Ab.length?(gd=cd,zd=Ab[0]):(gd=Ab[0],zd=Ab[Ab.length-1]);var De=P.pb(gd,zd);Fi(k,cd,null,lc[2],!0);Fi(k,gd,null,lc[2],!0);Fi(k,zd,null,lc[2],!0);kb={point:cd,An:De,ru:gd,gu:zd};Z=M=kb.point;if(null!==kb.An){if(G=z.normalize(z.create(Math.cos(kb.An),Math.sin(kb.An),0)),Ia=z.scale(G,fa),za=z.scale(Ia,0.5),B=z.sub(M,za),I=z.add(M,za),A=P.se(B,I,h),C=0<A){var Ad=I;I=B;B=Ad}}else B=z.sub(M,za),I=z.add(M,za)}else Z=M=L,B=z.sub(M,za),I=z.add(M,za);var Mi=z.jb(z.sub(h,B)),
Ni=z.jb(z.sub(h,I)),Oi=z.jb(z.sub(B,I)),Ee,Fe;Mi<Ni?(Ee=B,Fe=I):(Ee=I,Fe=B);var Ge=z.normalize(z.sub(h,M)),Pg=P.normalize(P.sub(h,M)),Cf=z.L(Ge,a.a),Df=Math.max(0,Math.acos(Cf)*kc),Ef=P.L(Ge,z.normalize(z.sub(Fe,Ee))),Pi=Math.acos(Math.abs(Ef))*kc,hl=P.L(Pg,P.normalize(z.sub(Fe,Ee))),Qg=Math.acos(Math.abs(hl))*kc,Td=30>Qg,Rg=30<Pi,Cc=35>Qg,$=70>Df,il=35<Qg&&Rg,Ma=30>Df||Cc&&$?Oh:Td?1:il?Ih:1,Qi=Ma===Ih;if((Ma===Oh||Qi)&&zf<fa)return null;var G=z.normalize(z.sub(I,B)),Ia=z.scale(G,fa),za=z.scale(Ia,
0.5),jl=z.add(B,za),ea=z.sub(I,za),L=z.Ta(jl,ea,h),O=!0;Xi(k,L,null,O);M=L;B=z.sub(L,za);D=I=z.add(L,za);fa*fa>Oi&&(B=z.sub(M,za),D=z.add(B,Ia));var Ud=Xi(k,D,l,O),Kb=Xi(k,B,l,O),M=z.ma(B,D,0.5),Ri=Xi(k,M,l,O);if(!Ud||!Kb||!Ri)return null;var Ge=z.normalize(z.sub(h,M)),Bb;1===Ma?Bb=90:Ma===Oh?Bb=0:(Cf=z.L(Ge,a.a),Bb=Math.max(0,Math.acos(Cf)*kc),30>Bb?Bb=0:45<Bb&&(Bb=90));var Ff=Bb*u;if(1===Ma){var ka=P.pa(G),Ia=z.scale(ka,fa);Ia[2]=0;za=z.scale(Ia,0.5);B=z.sub(M,za);D=z.add(M,za);A=P.se(B,D,h);if(C=
0<A)Ad=D,D=B,B=Ad;B[2]=D[2]=M[2]}var Sa=B,Na=M,fb=D,He,hd=0,id=0;for(He=0;10>He;He++,id+=0.1){var lb=z.ma(Sa,fb,id),bb=k.mh(lb[0],lb[1],8,Yi);Yi.ua&&1<Yi.ua.length&&null!=bb&&Yi.ua&&1<Yi.ua.length&&(bb=Zi(Na[2]));Yi={ua:[],Id:[]};if(null!==bb){var La=bb-N(Sa[2],fb[2],id);La>hd&&(hd=La)}}0<hd&&(Sa[2]+=hd,Na[2]+=hd,fb[2]+=hd);if(n&&n(B,M,D))return null;var Vd=null,Lb=null,Ec=a.lb;J(Ec.g)&&(Ec.g=Ec.wa.Ob("attribute vec3 a_vertex;\nattribute vec2 a_texcoord;\nuniform mat4 u_mat_proj;\nuniform mat4 u_mat_view;\nuniform mat4 u_mat_model;\nuniform vec2 u_textureScale;\nuniform vec2 u_textureOffset;\nvarying vec2 v_texcoord;\nvoid main(void)\n{\n  vec4 vertex = vec4(a_vertex, 1.0); \n  gl_Position = u_mat_proj * u_mat_view * u_mat_model * vertex;\n  v_texcoord = (a_texcoord) * u_textureScale + u_textureOffset;\n}",
"#ifdef GL_ES\n  precision highp float;\n#endif\nuniform highp sampler2D u_texunit0;\nuniform float u_alphaFactor;\nvarying vec2 v_texcoord;\nvoid main(void) {\n   vec4 color = texture2D(u_texunit0, v_texcoord);\n   gl_FragColor = color;\n   gl_FragColor.a = gl_FragColor.a * u_alphaFactor;\n}",{position:"a_vertex",texcoord:"a_texcoord"}));Ec.a.Bc.u_textureScale=[1,1];Ec.a.Bc.u_textureOffset=[0,0];Ec.a.Bc.u_alphaFactor=1;var Wd=new Ld(Ec.g,Ec.a.Bc);Wd.fb("labelMaterial");var Mb=Wd.tc();dh(Mb,!0);$i(Mb,
0,1);aj(Mb,6,7,12,12);bj(Mb,!1);var Gc=new Nd;dh(Gc,!0);$i(Gc,0,1);aj(Gc,6,7,12,12);cj(Gc,!0);dj(Gc,2);ej(Gc,7,1,1);var Ic=new Nd;dh(Ic,!0);$i(Ic,0,1);aj(Ic,6,7,12,12);bj(Ic,!1);cj(Ic,!0);ej(Ic,4,1,1);dj(Ic,1);Wd.d=Mb;Wd.c=Gc;Wd.e=Ic;Vd=Wd;var mb=a.g[d];mb?(mb.jn++,Lb=mb):(mb={},c.create(d,a.d,mb)?(mb.jn=1,Lb=a.g[d]=mb):Lb=null);if(null===Lb)return null;Vd.za(0,Lb.Ka);var t=new ie,Sg=Lb.height/Lb.dl,Tg=1-Sg,v=new fj(a.mb,{width:x,height:w,Fn:0,Kn:Tg,En:Lb.width/Lb.el,Jn:Tg+Sg},Vd);je(v,$g);t.add(v);
var Wb=new Hh(d,t,b),G=z.normalize(z.sub(D,B));z.scale(G,fa);var Ie=z.distance(Z,h),V=z.distance(Z,h),Q=Ci(a,V),nb=Ci(a,Ie),Jc=M;Jc[2]+=0.5*w*(1-Math.cos(Ff))+(0*nb+0*Math.cos(Ff));se(t,Jc);var Gf=z.normalize([G[0],G[1],0]),Yd=a.Ak([1,0,0],[Gf[0],Gf[1],0],[0,0,1]);ue(t,Yd);var Ug=-P.Sl(G[2]),Vg=Oa(Yd),Si=z.I(Vg,[0,1,0]),Ti=Ka(Si,Ug);t.rotate(Ti);var Hf=Ka([1,0,0],Ff);ue(v,Hf);ve(v,[Q,Q,1]);Wb.R=v.R=Ie;Wb.Ai=Z;Wb.kh=Ma;Wb.left=B;Wb.right=D;Wb.height=Ma===Oh?0:ga;Wb.a=Jc[2]-m;return Wb}
function gj(a,b,c,d,e){d=hj(d.eb());for(var f=z.I(d,b.f.Ca.S),f=[f[0]-0,f[1]-0,f[2]-b.zi],g=0,h=0;h<c.length;h++)for(var k=c[h],l=0;l<k.length;l++){var m=k[l];if(null!==m&&null!==m.we){var n=m.we.ea[0],m=z.distance(m.Ai,f),r=Ci(a,m),s=Math.abs(n.R-m),g=g+s;0<s&&(n.R=m,ve(n,[r,r,1]))}}0<c.length&&(0<g||1==c.length)&&e&&(e=b.r.ib(),e=z.I(d,e),a.v.Xl([e[0]-0,e[1]-0,e[2]-b.zi],c[0],a,null))}function Fi(a,b,c,d,e){b&&b.length&&(3<=b.length||Xi(a,b,c,e,d)||void 0!==d&&(b[2]=d))}
function Ei(a,b,c){var d;for(d=0;d<b.length;d++){var e=b[d];if((3>e.length||null===e[2])&&!Xi(a,e))if(void 0!==c)e[2]=c;else return!1}return!0}function Zi(a){var b=Yi.ua;if(!b||!b.length)return a;if(2>b.length)return b[0];for(var c=b.length,d=b[c-1],e=Math.abs(a-d),c=c-2;0<=c;c--)Math.abs(a-b[c])<e&&(d=b[c]);return d}
function Xi(a,b,c,d,e){var f=null;e=E(e)?3>b.length?null:b[2]:e;d&&null!=e?(f=a.mh(b[0],b[1],8,Yi),null!=f&&Yi.ua&&1<Yi.ua.length&&(f=Zi(e)),Yi={ua:[],Id:[]}):f=a.ue(b[0],b[1],8);if(null!=f)return b[2]=f,!0;if(c){f=Number.MAX_VALUE;e=null;var g=c[0];for(d=1;d<c.length;d++){var h=c[d];if(!(3>g.length||null===g[2]||3>h.length||null===h[2])){var k={},l=z.Ta(g,h,b,k),m=z.jb(z.sub(b,l));if(m<f||null===e)f=m,l=a.ue(l[0],l[1],8),null!==l?e=l:null!==g[2]&&null!=h[2]&&(e=N(g[2],h[2],k.Hb));g=h}}if(null!==
e)return b[2]=e,!0}else if(f=a.ue(b[0],b[1],8),null!=f)return b[2]=f,!0;return!1}var Yi={ua:[],Id:[]};Qh.prototype.Ak=function(a,b,c){var d=z.L(a,b);if(1E-6>Math.abs(d- -1))return Ka(c,180*u);if(1E-6>Math.abs(d-1))return Yc();c=Math.acos(d);a=z.pa(a,b);a=z.normalize(a);return Ka(a,c)};
function ij(a,b,c,d,e,f,g,h,k,l){var m=Math.atan2(g-d,f-c),n=0.5*k,r=Math.sin(m),s=Math.cos(m),m=n*r;k=n*s;r*=n;n*=s;s=yf(b,c+m,d-k,e?e:0,a.b,a.a);yf(b,f+r,g-n,h?h:0,a.b,a.a);yf(b,f-r,g+n,h?h:0,a.b,a.a);yf(b,c-m,d+k,e?e:0,a.b,a.a);xf(b,s,s+1,s+2,s,s+2,s+3,l)}
function jj(a,b,c,d,e,f,g,h,k,l){if(!(0>=k)){h=0.5*h;g=Math.atan2(g-d,f-c);var m=h*Math.sin(g),n=h*Math.cos(g);f=yf(b,c+m,d-n,e,a.b,a.a);yf(b,c-m,d+n,e,a.b,a.a);m=Math.PI/k;for(n=0;n<k;n++){g+=m;var r=h*Math.sin(g);yf(b,c-r,d+h*Math.cos(g),e,a.b,a.a);b.Lh(f,f+n+1,f+n+2,l)}}}
function kj(a,b,c,d,e,f,g,h,k,l,m,n,r){var s=Math.atan2(k-d,h-c),t=Math.atan2(m-d,l-c),v=P.Gr(c,d,h,k);f=yf(b,f,g,e?e:0,a.b,a.a);yf(b,h,k,e?e:0,a.b,a.a);h=(t-s)/n;Math.abs(t-s)>fc&&(h=(-t-s)/n);for(t=0;t<n-1;t++)s+=h,k=Math.sin(s),yf(b,c+v*Math.cos(s),d+v*k,e?e:0,a.b,a.a),b.Lh(f,f+t+1,f+t+2,r);yf(b,l,m,e?e:0,a.b,a.a);b.Lh(f,f+t+1,f+t+2,r)}
function lj(a,b,c,d,e,f,g,h,k){var l;l=(h-f)*(c-a)-(g-e)*(d-b);g=(g-e)*(b-f)-(h-f)*(a-e);e=(c-a)*(b-f)-(d-b)*(a-e);-1E-12<g&&1E-12>g&&-1E-12<e&&1E-12>e&&-1E-12<l&&1E-12>l?(k[0]=0.5*(a+c),k[1]=0.5*(b+d)):-1E-12<l&&1E-12>l?(k[0]=0,k[1]=0):(l=g/l,k[0]=a+l*(c-a),k[1]=b+l*(d-b))}function Gi(a,b){return(a.Zf+a.Rk?1E4:0)-(b.Zf+b.Rk?1E4:0)}
function Ai(a,b,c,d,e){var f;f=Math.cos(63.5*u);var g;g=z.sub(b,a);b=z.length(g);if(1E-6<b)g=z.normalize(g);else return null;a:{var h=z.L(d,g),k=f*f,l=z.sub(a,c),m=z.L(d,l);f=z.L(g,l);var n=z.L(l,l),l=h*h-k;f=h*m-k*f;h=[null,null];e&&(e.valid=!1);if(1E-6<=Math.abs(l)){k=f*f-(m*m-k*n)*l;if(0>k){e=null;break a}1E-6<k&&(m=Math.sqrt(k),n=1/l,k=(-f-m)*n,0<=k&&k<=b&&(h[0]=z.add(a,z.scale(g,k)),l=z.sub(h[0],c),l=z.L(l,d),0>=l&&(h[0]=null)),f=(-f+m)*n,0<=f&&f<=b&&(h[1]=z.add(a,z.scale(g,f)),l=z.sub(h[1],
c),l=z.L(l,d),0>=l&&(h[1]=null)),k>f&&(a=h[1],h[1]=h[0],h[0]=a),e&&(e.valid=!0,e.is=k/b,e.js=f/b))}e=h}return e}var mj={ROUND:0,FLAT:1,TRIANGLE:2},Fh=0.25;function nj(a,b,c){this.e=a;this.d=b||2;this.c=c||Fh}nj.prototype.b=function(){};
nj.prototype.a=function(a,b,c){function d(a,b){var c=P.distance(a,b);1E-4>c&&(c=1E-4);return(b[2]-a[2])/c}function e(a){a=f[a];var b=k.ue(a[0],a[1],8);null==b&&(b=c);a[2]=b}var f=a[b].m;a=0;b=!1;if(2>f.length)return!1;var g=f.length,h;h=1;var k=this.e;e(0);for(var l=f[0][2],m=null;h<g;){e(h);null===m&&(m=d(f[0],f[1]));for(var n=f[h-1],r=f[h],s=P.distance(n,r),t=Math.floor(s/this.d+1),s=s/t,v=(r[0]-n[0])/t,w=(r[1]-n[1])/t,x=n[0]+v,n=n[1]+w,y=1;y<t;y++){var A=l+s*m,C=k.ue(x,n,8);null!=C?Math.abs(A-
C)>this.c?(l=[x,n,C],m=d(f[h-1],l),f.splice(h,0,l),l=l[2],h++,g++,a++):l=A:b=!0;x+=v;n+=w}t=k.ue(r[0],r[1],8);l=r[2]=t;h++}b&&Ch(f);for(a=0;a<f.length;a++)b=f[a],zh(b)||(b[2]=c);Pb(Ah(f));return!0};function oj(a){this.c=a}
oj.prototype.b=function(a,b){for(var c=b||2,d=0;d<a.length;d++){var e=a[d].m,f=c;if(!(2>e.length))for(var g=e.length,h=1;h<g;){var k=e[h-1],l=e[h];pj(this,k);for(var m=P.distance(k,l),m=Math.floor(m/f+1),n=(l[0]-k[0])/m,r=(l[1]-k[1])/m,s=k[0]+n,k=k[1]+r,t=1;t<m;t++){var v=[s,k];pj(this,v);e.splice(h,0,v);h++;g++;s+=n;k+=r}pj(this,l);h++}}};function qj(){this.ua=[];this.Id=[];this.Og=this.maxHeight=this.minHeight=void 0;this.dh=this.a=!1}
function pj(a,b){var c=new qj,d=a.c.mh(b[0],b[1],8,c);b[2]=d;if(1<c.ua.length){b[3]=c;c.a=!0;for(var d=!1,e=0;e<c.ua.length;e++)if(0!=c.Id[e]&&void 0!=c.Og&&Math.abs(c.ua[e]-c.Og)<rj){d=!0;break}c.dh=d}}
oj.prototype.a=function(a,b,c,d){c=a[b].m;if(!(2>c.length)){var e=c.length;d.ju=0;var f=function(a,b,c){var d=a[2],e=b[3];a=P.distance(a,b);b=[];for(var f=0;f<e.ua.length;f++){var g=e.ua[f];if(e.dh){var h=g-d;if(0<h&&h<sj){c.height=g;c.Qm=!0;return}}b.push({Oj:Math.abs(g-d)/a,height:g})}b.sort(function(a,b){return a.Oj-b.Oj});c.height=b[0].height;c.Qm=!1},g=function(c,d,e,k){var l=-1==e?-1:c.length,m=c[d];d+=e;for(var x={height:void 0,Qm:!1};d!=l;){var y=c[d];y[3]&&(f(m,y,x),y[2]=x.height,x.Qm&&0<
k&&(g(c,d,-e,k-1),0<e&&zh(c[0])?h(a,b,c[0],k):0>e&&zh(c[c.length-1])&&h(a,b,c[c.length-1],k)));d+=e;m=y}},h=function(a,b,c,d){zh(c);for(var e=0;e<a.length-1;e++)if(e!=b){var f=a[e].m;P.So(c,f[0])?(f[0][2]=c[2],g(f,0,1,d-1)):1<f.length&&P.So(c,f[f.length-1])&&(f[f.length-1][2]=c[2],g(f,f.length-1,-1,d-1))}};for(d=1;d<e;){var k=c[d-1],l=c[d];if(k[3]&&k[3].dh||l[3]&&l[3].dh){var m=P.ma(k,l,0.5),k=[m[0],m[1],N(k[2],l[2],0.5)];pj(this,k);c.splice(d,0,k);d++;e++}d++}g(c,0,1,1);Pb(Ah(c))}};function tj(a){this.a=new Kf;this.b=[];this.c={};this.f=a.f;this.n=void 0;this.M=this.j=null;this.d=R();this.e=null;this.s=new kh(uj,function(){});this.p=!1;this.g=this.o=null;this.H=this.v=this.aa=1}tj.prototype=Object.create(Jf.prototype);tj.prototype.kb=Lf;var uj=20,vj=35,wj=40;tj.maxDistance=vj+wj;var bf=5,cf=50,df=150,af=!0,xj=65*u;p=tj.prototype;p.t=function(){this.clear()};
function yj(a,b,c,d,e,f,g,h,k,l){this.Ec=a;this.width=b;this.height=c;this.Ql=d;this.Rl=e;this.Xb=f;this.zd=g;this.Ld=h;this.Kd=k;this.id=l}p.clear=function(){this.Md();this.n=void 0;this.s.clear();this.b=[];this.c={};this.j=null;this.d=R();this.e=null;this.p=!1;this.g=this.o=null};p.ik=function(a){if(!this.Ud(a.Sa)){this.a.set(a.Sa.id,a);var b=a.Me;a:for(var c=0;c<this.b.length;c++)if(1E-7>P.distance(this.b[c].Me,b))break a;b=new Te(b);this.b.push(b);c=new $e(a,b);b.marker=c;this.c[a.Sa.id]=c;c.G(!0)}};
function zj(a,b){ef(b);!b.wj&&b.Qa()&&(b.wj=!0,b.Ba.ep(b.Ba.Sa,b,function(c,d,e){if(e){var f=a.f.k;Aj(a,c,d,e);c=d.anchor;Bj(a,f,c);Cj(a,[c]);f.f.u()}b.wj=!1},function(){b.wj=!1}))}p.Tj=function(a,b,c){var d=this.Ud(a);if(d&&(void 0!=b&&(d.index=b),b=!E(c)&&c,!E(d.b)&&null!=d.b&&(a=d.g(a),b||a!=d.b))){if(b=this.c[d.Sa.id])ef(b),zj(this,b);d.b=a}};p.mg=function(a){var b=this.Ud(a);b&&(Dj(this,b),Jf.prototype.mg.call(this,a));delete this.c[a.id]};
p.Md=function(){for(var a=this.b.length-1;0<=a;a--){var b=this.b[a];b.marker&&Dj(this,b.marker.Ba)}Jf.prototype.Md.call(this);this.c={};this.b=[]};
p.Gd=function(a){this.oh();for(var b=a.eh,c=[],d=[],e=0,e=0;e<this.b.length;e++){var f=this.b[e];b.add(f.zk());if(!f.ip)a:{var g=f,f=g.Te,h=null,k=g.zk(),l=g.Me,h=Ej(this.f.k.r)[2]-3,m=g.qb(),h=Fj([l[0],l[1],h]);if(3>l.length||!l[3])if(l=Gj(this.f,h,!1))h=l,g.ip=!0;else{if(g.Te)break a;var l=Ha(h),n=Ja(h),r=z.pa(l,n);z.pa(r,l,n);var s=R(),t=Yc();Ed(n,r,l,s);md(s,t);h.splice(3,0,t[0],t[1],t[2],t[3]);h.splice(7,0,l[0],l[1],l[2])}null!=m.Ba.d&&(g.g=m.Ba.d,l=g.g,null!=l&&(l=Ka([0,0,1],-l),ue(g.c,l)));
null!=m.Ba.c&&(l=Ka([1,0,0],(m.Ba.c-90)*u),ue(g.d,l));m=m.Ba.j;null==m&&(m=0);z.cb(h,z.create(h[7],h[8],h[9]),this.f.k.zi+m,h);m=h;g.a=g.Te=m;se(g.b,m);te(k,h);null==f||z.distance(f,h)}}for(e=0;e<this.b.length;e++)f=this.b[e],this.p||Bj(this,a,f),f&&f.marker&&f.marker.Ba&&null!=f.marker.Ba.jd?d.push(f):c.push(f);Cj(this,c);this.p=!0;for(var v in c)f=c[v],b=f.marker,b.wj||!b.Qa()||b.Q||zj(this,b);Hj(this,a,d)};p.ah=function(){};
function Hj(a,b,c){a.oh();var d=new Kf,e;for(e in c){var f=c[e],g=f.marker,g=g.Ba.jd,h=d.get(g.buildingId);h||(h={Wf:g,anchors:[]},d.set(g.buildingId,h));h.anchors.push(f)}if(0!=d.size()){d.forEach(function(c,d){Ij(a,b,d.Wf,d.anchors)});for(e in c)f=c[e],g=f.marker,g.Qa()&&!g.Q&&g.Ba.ep(g.Ba.Sa,g,function(b,c,e){var f=d.get(c.Ba.jd.buildingId);if(e){var g=a.f.k;Aj(a,b,c,e);Ij(a,g,f.Wf,f.anchors);Cj(a,[c.anchor]);g.f.u()}},function(){});Cj(a)}}
p.oh=function(){if(this.f.k.r){var a=this.f.k.r.ib();null!=this.o&&z.sr(this.o,a)||(this.p=!1,this.o=z.A(a));a=Jj(this.f.Ca.S);this.M=Fj(a);this.d=hj(this.M);this.g=null;if(a=this.f.k.Ia)a=a.eb(),this.e=Kj(a)}};p.uf=function(){var a=this.f.N();this.aa=this.f.Ea.Pb().height;this.v=a.cg()*u;this.H=2*Math.tan(0.5*this.v)/this.aa;Cj(this)};p.Ud=function(a){if(a=this.c[a.id])return a.Ba};
function Dj(a,b){var c=a.c[b.Sa.id];if(c&&(c.Q&&pe(c.Q),c=c.anchor)){c.mg();var d=a.b.indexOf(c);0<=d&&a.b.splice(d,1);pe(c.b)}}
function Cj(a,b){a.oh();for(var c=b?b:a.b,d=0;d<c.length;d++){var e=c[d];if(e.Te){var f=e,g=Math.max(0.01,z.distance(f.a,a.f.Ca.S));f.qg(g);if(g<=tj.maxDistance){var g=a,f=e,e=f.d,h=f.a,k=f.e;k?(g=z.tf(g.d,k),h=Math.atan2(g[1],g[0]),h=Ka([0,0,1],h),ue(f.c,h),ue(e,Yc())):null==f.g&&(g=z.I(g.d,h),h=Math.atan2(-g[1],-g[0]),h=Ka([0,0,1],h),ue(f.c,h),null==f.qb().Ba.c&&(f=z.L(z.normalize(g),[0,0,1]),f=Ka([1,0,0],(-(Math.acos(f)*kc)+90)*u),ue(e,f)))}}}c=null;for(c in a.c)Lj(a,a.c[c])}
p.Hn=function(){for(var a=this.b,b=0;b<a.length;b++){var c=a[b];c.marker.Ba.R=c.sj()}};function Mj(a,b,c){return(b=Nj(a.f,b))&&a.e?(b[2]+=c,b=z.I(a.e,b,b)):null}
function Bj(a,b,c){if(c){var d=c.marker;if(!d||!d.Ba||null==d.Ba.jd){var e=a.f.Ca.S,f=c.Te,g=Math.max(0.01,z.distance(f,e));c.qg(g);if(g=g<=tj.maxDistance){if(!(d&&d.Ba&&d.Ba.e)&&a.e){if(a.e){var f=4,h=z.I(a.d,c.Te),k=P.length(h);if(4<=k)f=null;else if(h=z.create(h[0],h[1],0),f=z.scale(h,f/k),a.g||(a.g=Kj(a.f.k.r.ib())),f=z.I(a.g,f),f=Mj(a,f,a.f.k.zi)){var k=a.f.k.r.ib(),h=Ha(k),l=z.cb(f,h,3),h=b.ce,l=z.sub(l,k);z.normalize(l,l);k=lf(k[0],k[1],k[2],l[0],l[1],l[2]);(h=Oj(h.ea,k,5.5,!0,!1,null,!1))&&
h.object&&5.5>h.distance&&(f=Math.max(0.1,h.distance-1.5),f=of(k,f),f=Mj(a,f,a.f.k.zi))}else f=null;f?Ue(c,f):Ue(c,c.Te)}f=c.a}d&&d.Dj&&(k=b.ce,h=f,7<h.length&&(h=z.cb(h,z.create(h[7],h[8],h[9]),a.f.k.zi)),l=z.sub(f,e),z.normalize(l,l),h=Math.max(0.1,z.distance(e,h)-0.1),e=lf(e[0],e[1],e[2],l[0],l[1],l[2]),(k=Oj(k.ea,e,h,!1,!1,null,!1))&&k.object&&k.distance<h?g=!1:(k=Oj(b.n.ea,e,h,!1,!1,null,!1))&&k.object&&k.distance<h&&(g=!1));d&&d.visible&&d.Q&&(b=Math.sqrt(Math.max(d.Xb,d.zd)/2),e=we(d.Q),k=
Math.max(d.ni,d.fg),k=z.create(d.He[0]/k,0,(d.fg-d.He[2])/k),e=z.I(e,k),d.Ve=e,d.Go=new kf(d.Ve,b*d.distanceFactor),Lj(a,d))}c.G(g);Ue(c,f)}}}
function Ij(a,b,c,d){if(c.Ie)if(b.Xf.get(c.buildingId)){var e=d.length;if(!(0>=e)){var f=a.f.k.r.ib(),g=c.ta.get(),h=null;0==g[2]?(b=[g[0],g[1],Ej(b.r)[2]],h=Ga(b)):h=g;var k=z.distance(h,f);b=1;var l=0,m=0,h=0;b=Pj(a,d[0].marker,k);for(var n=0;n<e;n++){var r=d[n],g=r.marker;if(g.Qa()&&!g.Q)return;l+=r.marker.Xb}k=0.5+0.25*(e-1)+l*b;g=null;m=!0;r={};n=null;do{var s=1;do g=Qj(Rj(),c,s*k,null),s-=0.25;while(!g&&0.1<s);if(!g)break;if(m){Sj(Rj(),g,0.3,0.3);if(n=z.Ta(g.ab,g.zb,f,r)){var s=z.distance(n,
f),s=Pj(a,d[0].marker,s),t=s/b;if(0.8>t||1.25<t){b=s;k=0.5+0.25*(e-1)+l*b;continue}}else g=null;m=!1}}while(m);if(g&&n){k=z.distance(n,f);b=Pj(a,d[0].marker,k);k=0.5+0.25*(e-1)+l*b;m=d[0].marker.Xb*b;1<e&&(h=d[e-1].marker.Xb*b);var v,l=z.distance(g.ab,g.zb);c=!1;l<k?(r=g.ab,v=g.zb,c=!0):(v=z.normalize(z.sub(g.zb,g.ab)),l=k/l,0>r.Hb-0.5*l?(r=g.ab,v=z.cb(r,v,k)):1<r.Hb+0.5*l?(r=g.zb,v=z.cb(r,v,-k)):(r=z.cb(n,v,-0.5*k),v=z.cb(n,v,0.5*k)));z.distance(f,r)>z.distance(f,v)?(n=v,k=r):(n=r,k=v);v=z.normalize(z.sub(k,
n));z.distance(n,k);z.cb(n,v,0.25+0.5*m,n);z.cb(k,v,-0.25+-0.5*h,k);l=z.distance(n,k);h=0;c&&2<e&&(h=l/(e-1));c=n;for(n=0;n<e;n++){r=d[n];l=r.qb();k=l.Xb*b;m=Math.acos(z.L(g.qh,z.normalize(z.sub(f,c))));l.Ba.n&&Math.abs(m)<xj?r.e=g.qh:r.e=null;Ue(r,c);l=Math.max(0.01,z.distance(c,f));r.qg(l);if(l=r.sj()<=tj.maxDistance)if(m=r.marker,m.Qa()&&m.Q){var s=Math.sqrt(Math.max(m.Xb,m.zd)/2),t=we(m.Q),w=Math.max(m.ni,m.fg),w=z.create(m.He[0]/w,0,(m.fg-m.He[2])/w),t=z.I(t,w);m.Ve=t;m.Go=new kf(m.Ve,s*m.distanceFactor);
Lj(a,m)}r.G(l);c=z.cb(c,v,0<h?h:k+0.25)}}else for(v in d)a=d[v],a.G(!1)}}else for(v in d)a=d[v],a.G(!1)}
function Aj(a,b,c,d){if(a.d){var e=d.Ec instanceof HTMLElement,f=0,g=0,h=null;e?(f=d.width,g=d.height):(f=d.Ec.width,g=d.Ec.height,h=a.s.get(d.id),h||(h=a.f.Vb.createTexture(f,g),h.re(0,d.Ec,{he:!1}),a.s.set(d.id,h)));if(null!==a.f.wa){var k=c.Q;k&&ef(c);k=b.di?b.di():Tj;if(0<k)k=tg(new Uf(a.f,k,Uj),a.f.mb,a.f.lb,c,h,c.Ba.Sa);else{if(!a.n){var l=new Me({position:new Le(7,3,0),texcoord:new Le(7,3,12),normal:new Le(7,3,20)}),k=[0,1,0];b=[[0,0,-1],[1,0,0],[0,0,0],[1,0,-1]];for(var m=[[0,1],[1,0],[0,
0],[1,1]],l=new qf(l),n=0;n<b.length;n++)S(l,b[n],m[n],k);xf(l,0,1,2,0,3,1);k=l.hb();a.n=new pd(a.f.mb,k)}a.j||(a.j=ih(a.f.lb));k=new Ne(a.f.wa,{Se:a.j,Gc:a.n});Re(k);k.za(h,d.Ec,!1);k.G(c.eg());k.Y=c.Ba.Sa;je(k,xg);h=d.width/d.height;1<h?Qe(k,0,0,d.width/f,d.height/g*h):Qe(k,0,0,d.width/f/h,d.height/g)}e&&(k.Gm=d.Ec);c.Q=k;c.anchor.d.add(k);c.He[0]=d.Ql;c.He[2]=d.Rl;c.width=d.width;c.height=d.height;c.Xb=d.Xb;c.zd=d.zd;c.ni=f;c.fg=g;c.Ld=d.Ld;c.Kd=d.Kd;Lj(a,c);a=c.Ba;a.b=a.g(a.Sa)}}}
function Pj(a,b,c){if(!b.Q||!b.visible)return 1;var d=1+Jf.distanceFactor*c;a=b.zd*d/c/a.H;c=1;a<b.Ld?c=b.Ld/a:a>b.Kd&&(c=b.Kd/a);return d*c}
function Lj(a,b){var c=b.Q;if(c&&b.visible){var d=a.f,e;e=d.N().cg()*u;var f=d.Ea.Pb().height,d=b.anchor.R;b.distanceFactor=1+Jf.distanceFactor*d;e=b.zd*b.distanceFactor/d/(2*Math.tan(0.5*e))*f;f=1;e<b.Ld?f=b.Ld/e:e>b.Kd&&(f=b.Kd/e);e=Math.max(b.Xb,b.zd);e*=b.distanceFactor;e*=f;f=b.width/b.height;ve(c,[e,1,e]);var g=1,h=1;1<f?(g=e*-b.He[0]/b.width,h=e/f*b.He[2]/b.height):(g=e*f*-b.He[0]/b.width,h=e*b.He[2]/b.height);e=z.create(g,0,h);se(c,e);e=1;d>=vj&&b.ag&&(e=N(e,0,tc((d-vj)/wj,0,1)));b.qg(d);
c.vd?c.vd(e):0<c.dg()&&c.Zg(0).vd&&c.Zg(0).vd(e)}}function Vj(a,b){var c=a.Ud(b);return c&&(c=a.c[c.Sa.id])&&(c=c.Q)&&c instanceof Uf?c:null}p.lh=function(a,b){var c=Vj(this,a);c&&c.open(b)};p.li=function(a,b){var c=Vj(this,a);c&&Ag(c,b)};p.Kh=function(a,b){var c=Vj(this,a);if(c)if(c.Q)ia();else{if(E(b)||0<b){var d=E(b)?2E3:b,e=c.aj;c.be&&c.be.stop();c.be=Eg(c.f,c,e,1,d);c.be&&c.be.start()}else Cg(c,1);c.u()}};
p.Uh=function(a,b){var c=Vj(this,a);if(c)if(c.Q)ia();else{if(E(b)||0<b){var d=E(b)?2E3:b,e=c.aj;c.be&&c.be.stop();c.be=Eg(c.f,c,e,0,d);c.be&&c.be.start()}else Cg(c,0);c.u()}};p.bi=function(a){(a=Vj(this,a))&&a.Ul(128,128)};p.Oh=function(a,b){var c=this.Ud(a);if(c){var d=this.c[c.Sa.id];d&&(c=d.Q)&&(d=d.anchor,c.R=E(b)||b?-1:d.sj())}};function Wj(a){return{lat:a[0],lng:a[1],alt:a[2]}};function Xj(a){this.name="API_Error";this.message=a||""}ha(Xj,Error);function Yj(a){var b=Zj();b.error_enableConsoleLogOnError&&window.console.error(a);if(b.error_enableDebugBreakOnError)debugger;if(b.error_enableExceptionOnError)throw new Xj(a);}function ak(a){Yj("invalid parameter: "+a)}function bk(a,b){ak("value "+a+" not defined on parameter "+b)}function ck(a){ak("parameter "+a+" is undefined")}function dk(){ak("parameter 1 is wrong")}function kk(a,b,c,d){ak((0<c.length?c+" (parameter "+d+")":"parameter "+d)+" is of type "+a+", expected: "+b)};function lk(){this.a=null}function mk(a,b){E(a)&&ck(b)}function nk(a,b){E(a)&&ck(b);null===a&&ak("parameter "+b+" may not be null")}function ok(a,b,c,d){a=typeof a;a!=b&&kk(a,b,c,d)}function pk(a){ok(a,"string","",1);0==a.length&&ak("string 1 may not be empty")}function qk(a,b,c,d){a<c&&ak("parameter "+b+" is "+a+" and lower than "+c);a>d&&ak("parameter "+b+" is "+a+" and larger than "+d)}function rk(a,b,c){mk(a,c);E(a[b])&&bk(b,c);a=a[b];ok(a,"number",b,c);return a}
function sk(a,b,c){a=a[c];!E(a)&&ok(a,b,c,1);return a}function tk(a){mk(a,1);E(a.position)&&bk("position",1);a=a.position;ok(a,"object","position",1);return a}lk.prototype.heading=function(a,b){var c=rk(a,"heading",b);qk(c,b,0,360);return c};lk.prototype.pitch=function(a,b){var c=rk(a,"pitch",b);qk(c,b,-90,90);return c};lk.prototype.distance=function(a,b){var c=rk(a,"distance",b);qk(c,b,0,this.a.maxDistance);return c};lk.x=function(a,b,c){a=rk(a,"x",c);qk(a,c,0,b);return a};
lk.y=function(a,b,c){a=rk(a,"y",c);qk(a,c,0,b);return a};lk.w=function(a,b,c){a=rk(a,"w",c);qk(a,c,0,b);return a};lk.h=function(a,b,c){a=rk(a,"h",c);qk(a,c,0,b);return a};function uk(a){return rk(a,"lat",1)}function vk(a){return rk(a,"lng",1)};function wk(){this.auth_appCode=this.auth_appId="";this.error_enableDebugBreakOnError=!1;this.error_enableExceptionOnError=!0;this.error_enableConsoleLogOnError=!this.error_enableExceptionOnError;this.coverageServer_mode=2;this.coverageServer_MRSUrl="http://1.pano.maps.api.here.com/maptile/2.1/rcdistonlytile/newest/normal.day/";this.skip_distance_field_search=!1;this.rendering_useSoftware=ib;this.load_terrain=xk;this.load_buildings=yk;this.load_roads=zk;this.load_all_metacells=Ak;this.metacell_prefetch_radius=
Bk;this.metacell_cache_size=Ck;this.metacell_lookup_steps=Dk;this.metacell_prefetch_steps=Ek;this.max_distance_markers_to_buildings=Fk;this.road_label_world_size=ki;this.road_label_font=ji;this.road_label_font_size=li;this.road_label_font_outline_width=ni;this.road_label_min_pixel_size=qi;this.road_label_max_pixel_size=ri;this.server_useSSL=!1;this.server_requestParam={};this.server_imgUrl=this.server_buildingUrl=this.server_terrainUrl=this.server_metacellUrl="";this.server_useDomainSharding=Gk;this.visibility_load_buildings_in_range=
Hk;this.visibility_render_buildings_in_range=Ik;this.visibility_range_buildings=Jk;this.visibility_prefetch_range_buildings=Kk;this.compact_out_of_range_buildings=Lk;this.visibility_road_width=Yh;this.visibility_range_roads=hi;this.visibility_fade_range_roads=ii;this.visibility_range_road_labels=fi;this.visibility_range_markers=vj;this.visibility_fade_range_markers=wj;this.visibility_range_terrain=Mk;this.visibility_range_terrain_multi_level=Nk;this.visibility_prefetch_range_terrain=Ok;this.defer_road_creation=
Pk};function Qk(a){this.a=a instanceof Qk?Rc(a.a):Rc(new wk);this.b=new sa}var Rk=null;function Sk(){return Rk=Rk||new Qk}Qk.prototype.Db=function(){return new this.constructor(this)};Qk.prototype.get=function(a){pk(a);return this.a[a]};
Qk.prototype.set=function(a,b){pk(a);mk(b,2);var c=this.get(a);E(c)&&ak("property "+a+" is unknown");ok(b,typeof c,"",2);if(b!=c){this.a[a]=b;switch(a){case "auth_appId":Tk=b;break;case "auth_appCode":Uk=b;break;case "server_useSSL":Vk=b;break;case "server_requestParam":Wk=b;break;case "skip_distance_field_search":Xk=!0;break;case "rendering_useSoftware":Yk=ib=b;Zk=!b;break;case "server_terrainUrl":$k.bn(b);break;case "server_buildingUrl":al.bn(b);break;case "server_metacellUrl":var d=b;"/"!=d.substr(-1)&&
(d+="/");bl=d;break;case "server_imgUrl":d=b;"/"!=d.substr(-1)&&(d+="/");cl=d;break;case "server_useDomainSharding":Gk=b;break;case "load_terrain":xk=b;break;case "load_buildings":yk=b;break;case "load_roads":zk=b;break;case "load_all_metacells":Ak=b;break;case "metacell_cache_size":Ck=b;break;case "metacell_lookup_steps":Dk=b;break;case "metacell_prefetch_radius":Bk=b;break;case "metacell_prefetch_steps":Ek=b;break;case "visibility_load_buildings_in_range":Hk=b;break;case "visibility_render_buildings_in_range":Ik=
b;break;case "visibility_range_buildings":Jk=b;break;case "visibility_prefetch_range_buildings":Kk=b;break;case "compact_out_of_range_buildings":Lk=b;break;case "visibility_road_width":Yh=b;break;case "visibility_range_roads":hi=b;break;case "visibility_fade_range_roads":ii=b;break;case "visibility_range_road_labels":fi=b;break;case "visibility_range_markers":vj=b;break;case "visibility_fade_range_markers":wj=b;break;case "visibility_range_terrain":Mk=b;break;case "visibility_range_terrain_multi_level":Nk=
b;break;case "visibility_prefetch_range_terrain":Ok=b;break;case "defer_road_creation":Pk=b;break;case "max_distance_markers_to_buildings":Fk=b;break;case "road_label_world_size":ki=b;break;case "road_label_font":ji=b;break;case "road_label_font_size":li=b;break;case "road_label_font_outline_width":ni=b;break;case "road_label_min_pixel_size":qi=b;break;case "road_label_max_pixel_size":ri=b}this.b.call(a,b)}return c};da("H.PanoramaSettings.get",function(a){return Sk().get(a)});
function dl(a,b){return Sk().set(a,b)}da("H.PanoramaSettings.set",dl);function Zj(a,b){var c=b||Sk();a&&c.b.qc(a);return c.a};function el(a,b,c,d){this.ec=a;this.xc=b;this.wc=c;this.Fc=d}function fl(a,b,c,d){return new el(a<c?a:c,b<d?b:d,a>=c?a:c,b>=d?b:d)}function gl(a,b,c,d,e){return new el((a<c?a:c)-e,(b<d?b:d)-e,(a>=c?a:c)+e,(b>=d?b:d)+e)}el.prototype.Yl=function(a,b){return a>=this.ec&&a<=this.wc&&b>=this.xc&&b<=this.Fc};function kl(a,b,c,d){this.x=a;this.y=b;this.object=c;this.id=d}function ll(a,b,c){this.Vc=a;this.object=b;this.id=c}function ml(a,b){this.c=a;this.d=b;this.e=this.g=this.a=this.b=null}
function nl(a){this.Vc=a;this.a=new ml(N(a.ec,a.wc,0.5),!0)}function ol(a,b,c,d,e,f,g){var h=b.e;if(h)for(var k=0;k<h.length;k++){var l=h[k];if(l&&P.lr(c,d,l.x,l.y)<e*e&&E(g[l.id])){var m=f(l.object,l.id);if(!E(m))return m;g[l.id]=!0}}if(b.b&&(b.d?c-e:d-e)<b.c&&(m=ol(a,b.b,c,d,e,f,g),!E(m))||b.a&&(b.d?c+e:d+e)>=b.c&&(m=ol(a,b.a,c,d,e,f,g),!E(m)))return m}function pl(a,b,c,d){ol(a,a.a,b,c,0.2,d,{})}
function ql(a,b,c,d,e){var f=b.e;if(f)for(var g=0;g<f.length;g++){var h=f[g];if(h&&h.object==e)return f[g]=null,!0}f=b.d?c:d;if(b.b&&f<b.c){if(ql(a,b.b,c,d,e))return!0}else if(b.a&&ql(a,b.a,c,d,e))return!0;return!1}function rl(a,b,c,d){var e=b.e;if(e)for(var f=0;f<e.length;f++){var g=e[f];if(g&&c.Yl(g.x,g.y)&&d(g.object,g.id))return g.id}if(b.b&&(b.d?c.ec:c.xc)<b.c&&(e=rl(a,b.b,c,d),!E(e))||b.a&&(b.d?c.wc:c.Fc)>=b.c&&(e=rl(a,b.a,c,d),!E(e)))return e}
function sl(a,b,c,d,e,f,g){b=gl(b,c,d,e,f);return rl(a,a.a,b,g)}function tl(a,b,c,d,e){var f=b.g;if(f)for(var g=0;g<f.length;g++){var h=f[g],k;if(k=h)k=h.Vc,k=!(c.wc<k.ec||c.ec>k.wc||c.Fc<k.xc||c.xc>k.Fc)&&!!E(e[h.id]);if(k){k=d(h.object,h.id,b);if(!E(k))return k;e[h.id]=!0}}if(b.b&&(b.d?c.ec:c.xc)<b.c&&(k=tl(a,b.b,c,d,e),!E(k))||b.a&&(b.d?c.wc:c.Fc)>=b.c&&(k=tl(a,b.a,c,d,e),!E(k)))return k}function ul(a,b,c,d,e,f,g){b=gl(b,c,d,e,f);return tl(a,a.a,b,g,{})}
function vl(a,b,c,d){var e=b.g;if(e)for(var f=0;f<e.length;f++){var g=e[f];if(g&&g.object==d)return e[f]=null,!0}return b.b&&(b.d?c.ec:c.xc)<b.c&&vl(a,b.b,c,d)||b.a&&(b.d?c.wc:c.Fc)>=b.c&&vl(a,b.a,c,d)?!0:!1}function wl(a,b){this.b=a?a:xl;this.a=b?b:yl}var xl=5,yl=2;wl.prototype.create=function(a,b,c,d){a=fl(a,b,c,d);return new nl(a)};wl.prototype.Ol=function(a,b,c,d,e){zl(this,a,a.a,a.Vc.ec,a.Vc.xc,a.Vc.wc,a.Vc.Fc,b,c,d,e)};
function zl(a,b,c,d,e,f,g,h,k,l,m){if(c.b&&c.a)c.d?h<c.c?zl(a,b,c.b,d,e,c.c,g,h,k,l,m):zl(a,b,c.a,c.c,e,f,g,h,k,l,m):k<c.c?zl(a,b,c.b,d,e,f,c.c,h,k,l,m):zl(a,b,c.a,d,c.c,f,g,h,k,l,m);else{c.e||(c.e=[]);for(var n=c.e,r=0;r<n.length;r++)if(null==n[r]){n[r]=new kl(h,k,l,m);break}r>=n.length&&n.push(new kl(h,k,l,m));Al(a,b,c,d,e,f,g)}}function Bl(a,b,c,d,e,f,g,h){var k=b.a;c=fl(c,d,e,f);Cl(a,b,k,b.Vc.ec,b.Vc.xc,b.Vc.wc,b.Vc.Fc,c,g,h)}
function Cl(a,b,c,d,e,f,g,h,k,l){c.b&&c.a?c.d?h.wc<c.c?Cl(a,b,c.b,d,e,c.c,g,h,k,l):h.ec>=c.c?Cl(a,b,c.a,c.c,e,f,g,h,k,l):Dl(a,b,c,d,e,f,g,h,k,l):h.Fc<c.c?Cl(a,b,c.b,d,e,f,c.c,h,k,l):h.xc>=c.c?Cl(a,b,c.a,d,c.c,f,g,h,k,l):Dl(a,b,c,d,e,f,g,h,k,l):Dl(a,b,c,d,e,f,g,h,k,l)}function Dl(a,b,c,d,e,f,g,h,k,l){c.g||(c.g=[]);for(var m=c.g,n=0;n<m.length;n++)if(null==m[n]){m[n]=new ll(h,k,l);break}n>=m.length&&m.push(new ll(h,k,l));Al(a,b,c,d,e,f,g)}
function Al(a,b,c,d,e,f,g){var h=0,k=c.g;if(k)for(var l=k.length-1;0<l;l--)k[l]&&h++;if(h>a.a||c.e&&c.e.length>a.b){var l=c.d?N(e,g,0.5):N(d,f,0.5),k=h=!1,m=c.e;if(m){for(var n=0;n<m.length;n++){var r=m[n];r&&((c.d?r.x:r.y)<c.c?(c.b||(c.b=new ml(l,!c.d)),c.b.e||(c.b.e=[]),c.b.e.push(r),h=!0):(c.a||(c.a=new ml(l,!c.d)),c.a.e||(c.a.e=[]),c.a.e.push(r),k=!0))}m.length=0}if(m=c.g){for(n=m.length-1;0<=n;n--)if(r=m[n])(c.d?r.Vc.wc:r.Vc.Fc)<c.c?(c.b||(c.b=new ml(l,!c.d)),c.b.g||(c.b.g=[]),c.b.g.push(r),
m[n]=null,h=!0):(c.d?r.Vc.ec:r.Vc.xc)>=c.c&&(c.a||(c.a=new ml(l,!c.d)),c.a.g||(c.a.g=[]),c.a.g.push(r),m[n]=null,k=!0);for(l=m.length-1;0<=l&&!(r=m[l]);l--)m.length=l}c.d?(h&&c.b&&Al(a,b,c.b,d,e,c.c,g),k&&c.a&&Al(a,b,c.a,c.c,e,f,g)):(h&&c.b&&Al(a,b,c.b,d,e,f,c.c),k&&c.a&&Al(a,b,c.a,d,c.c,f,g))}};function El(a,b){this.D=a;this.ha=[];this.id=b;this.uc=-1;this.pf=!1}function Fl(a,b){for(var c=a.ha,d=c.length-1;0<=d;d--){var e=c[d];if(e.J===b||e.W===b)return e}return null}El.prototype.bj=function(a){this.ha.push(a)};function Gl(a,b,c){this.J=a;this.W=b;this.id=c;this.ub=null;this.distance=Number.MAX_VALUE;this.uc=-1;this.pf=!1}function Hl(a,b){return a.J===b?a.W:a.J}
function Il(a){this.Cc=[];this.ha=[];this.a=null;this.Ya=a;this.min=P.create(Number.MAX_VALUE,Number.MAX_VALUE);this.max=P.create(Number.MIN_VALUE,Number.MIN_VALUE);this.Xc=P.create(Number.MAX_VALUE,Number.MAX_VALUE);this.e=this.j=this.zf=0;this.c=[];this.g=!1;this.d=new wl;this.b=this.d.create(this.Ya.Zb[0],this.Ya.Zb[1],this.Ya.Nb[0],this.Ya.Nb[1])}var Jl=170*u,Uc=P.create(),Kl=P.create();P.create();function Ll(a,b){var c=-1;pl(a.b,b[0],b[1],function(a,b){return c=b});return c}
function Ml(a,b,c){var d=Ll(a,b);if(0<=d)return d;if(c&&(c=Nl(a,b),0<=c))return c;c=a.j++;d=P.A(b);d=new El(d,c);a.Cc.push(d);a.b&&a.d.Ol(a.b,b[0],b[1],d,c);return c}function Nl(a,b){var c={},d=Math.min(0.2,0.2),e=d*d,d=ul(a.b,b[0],b[1],b[0],b[1],d,function(d){var g=P.Io(d.J.D,d.W.D,b,c);if(c.split&&P.X(g,b)<e)return Ol(a,d,b)});return E(d)?-1:d}
function Pl(a,b,c){var d={},e=a.Cc[b].D,f=a.Cc[c].D;b=Math.min(0.2,0.2);var g=b*b;a=sl(a.b,e[0],e[1],f[0],f[1],b,function(a,b){var c=P.Io(e,f,a.D,d);if(d.split&&P.X(c,a.D)<g)return b});return E(a)?null:a}
function Ql(a,b,c){var d=b.D,e=c.D,f=null,g=Math.min(0.2,0.2),h=a.e;ul(a.b,d[0],d[1],e[0],e[1],g,function(g){if(!(g.id>=h)&&b!==g.J&&b!==g.W&&c!==g.J&&c!==g.W){var l=g.J.D,m=g.W.D;if(1==P.Km(d[0],d[1],e[0],e[1],l[0],l[1],m[0],m[1],Kl)){var l=Ll(a,Kl),m=!0,n=g.J.id!=l&&g.W.id!=l;if(f)for(var r=f.length-1;0<=r;r--)if(f[r].Nn==l&&(m=!1),1E-6>P.distance(Kl,f[r].mp)){l=Ll(a,Kl);break}r=null;if(n||m)r=P.A(Kl);n&&(l=Ol(a,g,r));m&&(f||(f=[]),f.push({Nn:l,mp:r,distance:Number.MAX_VALUE}))}}});return f}
function Rl(a,b,c,d){var e=Math.min(b,c);b=Math.max(b,c);if(d&&(c=Pl(a,e,b),null!=c)){Rl(a,e,c,d);Rl(a,c,b,d);return}c=a.Cc[e];var f=a.Cc[b];if(!Fl(c,f)){if(d&&(d=Ql(a,c,f))){for(f=d.length-1;0<=f;f--)d[f].distance=P.X(c.D,d[f].mp);d.sort(function(a,b){return b.distance-a.distance});c=d[d.length-1].Nn;for(f=d.length-2;0<=f;f--)Rl(a,e,c,!1),e=c,c=d[f].Nn;Rl(a,e,c,!1);Rl(a,c,b,!1);return}e=new Gl(c,f,a.e++);c.bj(e);f.bj(e);a.a&&0<a.a.length?(a.ha[a.a[a.a.length-1]]=e,a.a.length--):a.ha.push(e);a.b&&
Bl(a.d,a.b,c.D[0],c.D[1],f.D[0],f.D[1],e,e.id)}}function Ol(a,b,c){var d=b.J.id,e=b.W.id;Sl(a,b);Ll(a,c);b=Ml(a,c,!1);Rl(a,d,b,!1);Rl(a,b,e,!1);return b}Il.prototype.Lh=function(a,b,c){a=Ml(this,a,!0);b=Ml(this,b,!0);c=Ml(this,c,!0);if(a!=b||a!=c)a==b?Rl(this,a,c,!0):a==c||b==c?Rl(this,a,b,!0):(Rl(this,a,b,!0),Rl(this,b,c,!0),Rl(this,c,a,!0))};Il.prototype.bj=function(a,b){var c=Ml(this,a,!0),d=Ml(this,b,!0);c!=d&&Rl(this,c,d,!0)};
Il.prototype.compact=function(a){for(var b=this.Cc,c=b.length-1;0<=c;c--){var d=b[c].D;this.min[0]=this.min[0]<d[0]?this.min[0]:d[0];this.min[1]=this.min[1]<d[1]?this.min[1]:d[1];this.max[0]=this.max[0]>d[0]?this.max[0]:d[0];this.max[1]=this.max[1]>d[1]?this.max[1]:d[1]}this.Xc=P.ma(this.min,this.max,0.5);this.zf=P.distance(this.Xc,this.max);if(a){a=this.ha;for(b=a.length-1;0<=b;b--)(c=a[b])&&0>c.uc&&Sl(this,c);a=this.Cc;c=this.ha;for(b=a.length-1;0<=b;b--)a[b].uc=-1;this.Xc=P.ma(this.min,this.max,
0.5);this.zf=P.distance(this.Xc,this.max);for(b=c.length-1;0<=b;b--)(d=c[b])&&0<=d.uc&&(d.J.uc=d.uc,d.W.uc=d.uc);c=[];for(b=a.length-1;0<=b;b--)d=a[b],0<=d.uc&&0<d.ha.length&&c.push(d);this.Cc=c}this.b=this.d=this.a=this.c=null};function Tl(a,b,c){E(a.c[b.id])&&(a.c[b.id]=[]);a.c[b.id][c.id]=!0}
function Ul(a,b,c,d){var e=b.J.id==c.id?b.W:b.J,f=P.create(0,0),e=P.sub(e.D,c.D),g=null,h=null,k=c.ha;if(1==k.length){var l=Hl(b,c);if(E(a.c[c.id])||!a.c[c.id][l.id])g=b,h=l}else{h=[];for(g=k.length-1;0<=g;g--){var m=k[g];m!==b&&(l=Hl(m,c),f=P.Gf(l.D,c.D,f),h.push({pb:P.Op(e,f),qr:m,Zc:l}))}1<h.length&&h.sort(function(a,b){return a.pb-b.pb});g=h[0].qr;h=h[0].Zc;if(E(a.c[c.id])?0:a.c[c.id][h.id])h=g=null}d.oe=g;d.Tk=c;d.Zc=h}var Vl=-1E4;
function Wl(a,b,c,d,e){b.uc=c;d.push(b);for(var f=b.ha,g=f.length-1;0<=g;g--){var h=f[g];0<=h.uc||(e.push(h),h.uc=c,h=Hl(h,b),0<=h.uc||Wl(a,h,c,d,e))}}function Xl(a){a=a.Cc;for(var b=a.length-1;0<=b;b--){var c=a[b];if(0>c.uc)return c}return null}
function Yl(a){for(var b=[],c=Xl(a),d=0;c;){d++;var e=[],f=[];Wl(a,c,d,e,f);b.push({Cc:e,ha:f,ln:[]});c=Xl(a)}d=[];c=[];e=-1;for(e=b.length-1;0<=e;e--){var g=b[e],f=g.Cc,g=g.ln;if(0<f.length){var h=[],k;k=Number.MAX_VALUE;for(var l=-1,m=f.length-1;0<=m;m--){var n=f[m];n.D[0]<k&&(k=n.D[0],l=m)}k=l;if(0<=k&&(l=f[k],Vl=Math.min(Vl,l.D[0]-10),k=a,m={oe:null,Tk:null,Zc:null},0<f.length)){for(var f=l,n=m,r=f.ha,s=null,t=null,v=P.create(0,0),w=Number.MAX_VALUE,x=r.length-1;0<=x;x--){var y=r[x],A=Hl(y,f);
P.Gf(A.D,f.D,v);var C=P.Op([-1,0],v);C<w&&(w=C,s=y,t=A)}n.oe=s;n.Tk=f;n.Zc=t;if(m.oe)for(l.pf=!0,m.Zc.pf=!0,h.push(l),h.push(m.Zc),Tl(k,m.Tk,m.Zc),m.oe.pf=!0,g.push(m.oe),Ul(k,m.oe,m.Zc,m);m.oe;)if(m.oe.pf||(m.oe.pf=!0,g.push(m.oe)),m.Zc)Tl(k,m.Tk,m.Zc),m.Zc.pf||(m.Zc.pf=!0,h.push(m.Zc)),Ul(k,m.oe,m.Zc,m);else break}}}for(e=b.length-1;0<=e;e--)if(g=b[e],f=g.Cc,g=g.ln,0!=f.length){k=!1;for(l=b.length-1;0<=l;l--)if(e!=l){m=b[l];if(h=0!=m.ha.length){h=f[0];m=m.ln;r=0;for(n=m.length-1;0<=n;n--)if(s=m[n])h.id==
s.J.id||h.id==s.W.id?s=0:(t=h.D,v=s.J.D,s=s.W.D,s=1==P.Km(Vl,t[1]-10,t[0],t[1],v[0],v[1],s[0],s[1])?1:0),r=r+s;h=1==r%2}if(h){k=!0;break}}if(!k){l=g.length;for(k=0;k<l;k++)d.push(g[k]);g=f.length;for(k=0;k<g;k++)c.push(f[k])}}if(0<d.length){a.ha=d;for(b=c.length-1;0<=b;b--)for(d=c[b].ha.length-1;0<=d;d--)c[b].ha[d].pf||c[b].ha.splice(d,1);a.Cc=c}else ja()}
function Zl(a,b){var c=a.Cc,d,e,f=b.ha,g=a.ha;for(d=f.length-1;0<=d;d--){var h=f[d],k=Hl(h,b);1==k.ha.length?(e=c.indexOf(k),c.splice(e,1)):(e=k.ha.indexOf(h),0<=e&&k.ha.splice(e,1));e=g.indexOf(h);0<=e&&(g[e]=null,a.a||(a.a=[]),a.a.push(e),a.b&&(e=a.b,k=h,h=fl(h.J.D[0],h.J.D[1],h.W.D[0],h.W.D[1]),vl(e,e.a,h,k)))}e=c.indexOf(b);0<=e&&c.splice(e,1);a.b&&(c=a.b,ql(c,c.a,b.D[0],b.D[1],b))}function $l(a,b){var c;1==a.ha.length?a.ha.length=0:(c=a.ha.indexOf(b),0<=c&&a.ha.splice(c,1))}
function Sl(a,b){var c,d=a.ha;$l(b.J,b);$l(b.W,b);c=d.indexOf(b);0<=c&&(d[c]=null,a.a||(a.a=[]),a.a.push(c));c=a.b;d=fl(b.J.D[0],b.J.D[1],b.W.D[0],b.W.D[1]);vl(c,c.a,d,b);b.J=null;b.W=null}function am(a,b,c,d){var e=new Gl(b,c,a.e++);e.uc=d;b.bj(e);c.bj(e);a.a&&0<a.a.length?(a.ha[a.a[a.a.length-1]]=e,a.a.length--):(a.ha.push(e),a.b&&Bl(a.d,a.b,b.D[0],b.D[1],c.D[0],c.D[1],e,e.id))}
function bm(a){var b=a.Cc;a.g=!0;a.d=null;a.b=null;for(var c=b.length-1;0<=c;c--){var d=b[c];if(2==d.ha.length){var e=d.ha,f=e[0],g=e[1],e=f.J===d?f.W:f.J,h=d,d=g.J===d?g.W:g.J,g=e.D,k=h.D,l=d.D;0.3>P.distance(g,k)||0.3>P.distance(k,l)||Math.abs(P.Zk(P.sub(g,k),P.sub(l,k)))<Jl||0.25<P.Pg(g,l,k)||(Zl(a,h),am(a,e,d,f.uc))}}if(a.a&&0<a.a.length)for(a.a.sort(function(a,b){return a-b});0<a.a.length;)a.ha.splice(a.a[a.a.length-1],1),a.a.length--;a.a=null}
function cm(){this.Qh=this.W=this.J=null;this.weight=0;this.distance=-1;this.viewingAngle=0;this.distanceFactor=1;this.vb=this.qh=this.Gc=this.aa=this.j=this.zb=this.ab=this.b=this.a=this.d=this.c=null}cm.prototype.nd=function(){};function dm(a){this.Wf=a;this.Mj=null}dm.prototype.hb=function(){};function em(a,b,c,d,e,f,g,h,k){this.oa=a;this.ja=b;this.yc=c;this.yb=d;this.Ue=e;this.Qe=f;this.Wf=g;this.vb=h;this.xe=k}function fm(){this.Tb=[];this.hp=!1}fm.prototype.clear=function(){this.Tb=[];this.hp=!1};function gm(a,b){for(var c=[],d=a.Tb,e=0;e<d.length;e++){var f=d[e];if(f.Wf==b)if(0<c.length){var g=c[c.length-1];f.vb==g.vb&&0.01>P.distance(g.ja,f.oa)?(g.yb=f.yb,g.ja=f.ja,g.Qe=f.Qe):c.push(f)}else c.push(f)}return c}var hm=P.create(0,0),im=P.create(0,0);
function jm(a,b,c,d){for(var e=Math.atan2(b[1],b[0]);0>e;)e+=jc;for(var f=Math.atan2(c[1],c[0]);0>f;)f+=jc;var g=f-e;0>g&&(g=-g);var h;g<oc?e>f?(g=e,h=f,e=b,f=c):(g=f,h=e,e=c,f=b):e<f?(g=e,h=f,e=b,f=c):(g=f,h=e,e=c,f=b);if(g<h)if(d)0===g&&(g=pc);else return g=P.create(Number.MAX_VALUE,Number.MAX_VALUE),P.Oe(0,0,-1E5,0,e[0],e[1],f[0],f[1],g),jm(a,b,g,!0)&&jm(a,g,c,!0);a=a.Tb;for(b=0;b<a.length;b++)if(c=a[b],!(c.yb<=h)){d=c.yc;0==b&&0<d&&(d-=jc);if(0<b&&c.yc>=g)break;if(h>=d&&g<=c.yb){d=P.se(c.ja,c.oa,
e);if(0<d)return!1;c=P.se(c.ja,c.oa,f);if(0<c)return!1}else if(h<=d&&g>c.yb){d=hm;var k=im;P.Oe(0,0,c.oa[0],c.oa[1],e[0],e[1],f[0],f[1],d);P.Oe(0,0,c.ja[0],c.ja[1],e[0],e[1],f[0],f[1],k);d=P.length(d);k=P.length(k);k=c.Qe-k;if(0>c.Ue-d||0>k)return!1}else if(h>d&&h<c.yb&&g>=c.yb){k=hm;P.Oe(0,0,c.ja[0],c.ja[1],e[0],e[1],f[0],f[1],k);k=P.length(k);if(c.Qe<k)return!1;c=P.se(c.ja,c.oa,f);if(0<c)return!1}else if(h<=d&&g>d&&g<=c.yb){d=hm;P.Oe(0,0,c.oa[0],c.oa[1],e[0],e[1],f[0],f[1],d);d=P.length(d);if(c.Ue<
d)return!1;d=P.se(c.ja,c.oa,e);if(0<d)return!1}}return!0}function km(a,b,c){c*=c;for(var d=0;d<a.length;d++){var e=a[d],e=P.Ta(e.oa,e.ja,b);if(P.X(e,b)<c)return!0}return!1}function lm(a,b){for(var c=Number.MAX_VALUE,d=0;d<a.length;d++){var e=a[d],e=P.Ta(e.oa,e.ja,b),e=P.X(e,b);e<c&&(c=e)}return c<Number.MAX_VALUE?Math.sqrt(c):Number.MAX_VALUE}function mm(a,b,c,d,e){this.J=a;this.W=b;this.buildingId=c;this.span=d;this.vb=e}function nm(){}var om=null;nm.deleteInstance=function(){om&&(om=null)};
function pm(){var a=P.create(2E3*Math.cos(0),2E3*Math.sin(0)),b=P.create(2E3*Math.cos(hc),2E3*Math.sin(hc)),c=P.create(2E3*Math.cos(fc),2E3*Math.sin(fc)),d=P.create(2E3*Math.cos(3*hc),2E3*Math.sin(3*hc)),e=P.create(2E3*Math.cos(jc),2E3*Math.sin(jc)),f=new fm,g=f.Tb;g.push(new em(a,b,0,hc,2E3,2E3,null,1,-1));g.push(new em(b,c,hc,fc,2E3,2E3,null,2,-1));g.push(new em(c,d,fc,3*hc,2E3,2E3,null,3,-1));g.push(new em(d,e,3*hc,jc,2E3,2E3,null,4,-1));return f}
function qm(a,b,c,d){a=a.Tb;var e=a[b];if(c>e.yc&&c<e.yb){var f=P.create(Number.MAX_VALUE,Number.MAX_VALUE);P.Oe(e.ja[0],e.ja[1],e.oa[0],e.oa[1],0,0,d[0],d[1],f);d=P.length(f);var g=new em(e.oa,f,e.yc,c,e.Ue,d,e.Wf,e.vb,e.xe);a.splice(b,0,g);e.yc=c;e.Ue=d;e.oa=f;return!0}return!1}
function rm(a,b,c,d,e,f,g,h,k){for(var l=Math.atan2(c[1],c[0]);0>l;)l+=jc;for(var m=Math.atan2(d[1],d[0]);0>m;)m+=jc;if(!vc(l,m,1E-6)){var n=b.Tb,r=0,s=2*n.length,t=m-l;0>t&&(t=-t);t<oc?l>m?(t=l,l=c,c=d):(t=m,m=l,l=d):l<m?(t=l,l=c,c=d):(t=m,m=l,l=d);if(t<m)if(h)0===t&&(t=pc);else{n=P.create(Number.MAX_VALUE,Number.MAX_VALUE);P.Oe(0,0,-1E5,0,l[0],l[1],c[0],c[1],n);rm(a,b,l,n,e,f,g,!0,k);rm(a,b,n,c,e,f,g,!0,k);return}var v;for(a=0;a<n.length;a++){r++;if(r>s)break;k=n[a];if(!(k.yb<=m)){if(k.yc>=t)break;
d=P.se(k.ja,k.oa,l);v=P.se(k.ja,k.oa,c);if(!(0<d&&0<v)){h=P.create(Number.MAX_VALUE,Number.MAX_VALUE);if(0>d||0>v){d=P.Oe(k.ja[0],k.ja[1],k.oa[0],k.oa[1],l[0],l[1],c[0],c[1],h);if(2===d)continue;v=P.distance(k.ja,h);var w=P.distance(k.oa,h);if(0.001<v&&0.001<w&&1===d){for(d=Math.atan2(h[1],h[0]);0>d;)d+=jc;v=P.length(h);w=new em(k.oa,h,k.yc,d,k.Ue,v,k.Wf,k.vb,k.xe);n.splice(a,0,w);k.yc=d;k.Ue=v;k.oa=h;a--;continue}}if(qm(b,a,m,c))a--;else if(qm(b,a,t,l))a--;else{h=P.create(Number.MAX_VALUE,Number.MAX_VALUE);
d=P.create(Number.MAX_VALUE,Number.MAX_VALUE);P.Oe(0,0,k.oa[0],k.oa[1],l[0],l[1],c[0],c[1],h);P.Oe(0,0,k.ja[0],k.ja[1],l[0],l[1],c[0],c[1],d);v=P.length(h);var w=P.length(d),x=k.Ue-v,y=k.Qe-w;if(!(0>=x&&0>=y)){if(!(0<=x&&0<=y)){if(0>x&&-x>y)continue;if(0>y&&-y>x)continue}k.oa=h;k.Ue=v;k.ja=d;k.Qe=w;k.Wf=e;k.vb=f;k.xe=g}}}}}}}
function sm(a){for(var b=a.Tb,c=1;c<b.length;c++){var d=b[c-1],e=b[c];!E(d.vb)&&d.vb==e.vb&&e.yb>e.yc&&0.01>P.distance(d.ja,e.oa)&&(d.yb=e.yb,d.ja=e.ja,d.Qe=e.Qe,b.splice(c,1),c--)}1<b.length&&(d=b[b.length-1],e=b[0],!E(d.vb)&&d.vb==e.vb&&0.01>P.distance(e.oa,d.ja)&&(a.hp=!0,e.yc=d.yc,e.oa=d.oa,e.Ue=d.Ue,d.ja=e.ja,d.yb=e.yb+jc,d.Qe=e.Qe))};function tm(){this.c={};this.b=Dd(void 0);this.e=Dd(void 0);this.a=null;this.g=0;this.d=1;this.j=128;new Me({position:new Le(7,3,0),normal:new Le(7,3,12)})}var um=null,vm=pa();vm.isEnabled=!1;tm.prototype.kb=vm;var wm=Math.cos(6*u),xm=0.5*u,ym=P.create(0,0),Vc=z.create(0,0);z.create(0,0);z.create(0,0);var zm=z.create(),Am=z.create(),Bm=z.create();function Cm(a,b,c,d,e,f,g){this.zj=a;this.maxDistance=b;this.sp=b*b;this.a=c;this.distanceScale=d;this.minPixelWidth=e;this.maxPixelWidth=f;this.xp=g}
function Rj(){um||(um=new tm);return um}tm.deleteInstance=function(){um&&(um=null)};function Dm(a,b,c){var d=c.r.ib();a.b=Kj(d);a.e=hj(d);Em(a);b.forEach(function(a,b){b.la||Fm(b)});qa(b.size());Gm(a,c,b)}function Em(a){a.c={};a.a=null}
function Fm(a){if(a&&!a.Ie){var b=new dm(a);a.Ie=b;var c=new Il(a.Ya);a.bg(function(a,b,f){z.sub(b,a,zm);z.sub(f,a,Am);z.pa(zm,Am,Bm);var g=z.jb(Bm);1E-12>g||(g=Math.sqrt(g),g=1/g,Bm[0]*=g,Bm[1]*=g,Bm[2]*=g,0.1>Math.abs(Bm[0])&&0.1>Math.abs(Bm[1])||c.Lh(a,b,f))});Yl(c);bm(c);c.compact(!0);b.Mj=c}}tm.prototype.clear=function(){this.c={};this.a=null};
function Gm(a,b,c){if(!a.a){var d=b.f.N();a.j=b.f.Ea.Pb().height;a.g=wc(d.cg());a.d=2*Math.tan(0.5*a.g)/a.j;om||(om=new nm);d=om;a.a=pm();var e=[];c.forEach(function(c,d){if(!d.la){Hm(a,d,b);var f=a.c[d.buildingId];if(f)for(var f=f.vr,g=f.length,n=0;n<g;n++){for(var r=f[n],s=r.J,t=r.W,r=r.id,v=Math.atan2(s[1],s[0]);0>v;)v+=jc;for(var w=Math.atan2(t[1],t[0]);0>w;)w+=jc;e.push(new mm(s,t,d.buildingId,v>w?v-w:w-v,r))}}});e.sort(function(a,b){return b.span-a.span});for(var f=0;f<e.length;f++){var g=e[f];
rm(d,a.a,g.J,g.W,g.buildingId,f,g.vb,!1)}sm(a.a);qa(c.size())}}function Im(a,b,c){return tc(void 0!==a?a:c,0,b)}tm.prototype.fj=function(a){return a.ta&&null!=this.a?0<gm(this.a,a.buildingId).length:!1};
function Qj(a,b,c,d,e,f,g,h,k){d=new Cm(c,Im(e,1E3,300),Im(f,1,wm),Im(g,1,Jf.distanceFactor),Im(h,1E4,5),Im(k,1E4,1E3),d);if(b.ta)if(null==a.a)c=null;else if(e=gm(a.a,b.buildingId),0==e.length)c=null;else if(c=0,(b=Jm(a,b,a.a,e,d))&&0!=b.length){d=[];for(c=0;c<b.length;c++){e=b[c];g=f=new cm;h=e.W;k=e.Qh;var l=e.weight,m=e.distance,n=e.viewingAngle,r=e.distanceFactor,s=e.pixelFactor,t=e.xe;g.J=e.J;g.W=h;g.Qh=k;g.weight=l;g.distance=m;g.viewingAngle=n;g.distanceFactor=r;g.pixelFactor=s;g.vb=t;d.push(f)}c=
d}else c=null;else c=null;return c&&0!=c.length&&a.b?c[0]:null}function Sj(a,b,c,d){var e=z.I(a.b,Km(b.J)),f=z.I(a.b,Km(b.W)),g=z.I(a.e,e),h=z.I(a.e,f);g[2]=Math.max(g[2],h[2]);h[2]=g[2];g=z.create(g[0],g[1],g[2]+c);h=z.create(h[0],h[1],h[2]+c);c=z.create(g[0],g[1],g[2]+d);d=z.create(h[0],h[1],h[2]+d);g=z.I(a.b,g);h=z.I(a.b,h);c=z.I(a.b,c);a=z.I(a.b,d);z.sub(h,g,e);z.sub(a,g,f);b.c=e;b.d=f;b.a=e;b.b=f;b.ab=g;b.zb=h;b.j=c;b.aa=a;b.qh=z.normalize(z.pa(b.a,b.b))}
function Hm(a,b,c){if(b.ta&&!a.c[b.buildingId]&&b.Ie){var d=Ra(b.ta),d=hj(d);c=c.r.ib();c=z.I(d,c);if(d=b.Ie.Mj){var e=P.sub(d.Xc,c);if(!(300<P.length(e)-d.zf)){for(var f=d.Cc,g=d.ha,h=[],k=[],l=f.length-1;0<=l;l--){var m=f[l];300>P.distance(m.D,c)&&h.push(m)}for(l=g.length-1;0<=l;l--)if(h=g[l])h.ub=P.Ta(h.J.D,h.W.D,c),h.distance=P.distance(c,h.ub),300<h.distance||k.push(h);if(!(1>k.length)){k.sort(function(a,b){return b.distance-a.distance});f=Lm(d,f,c);g=[];g.push([ym,f.Fr.Mn]);g.push([ym,f.as.Mn]);
h=[];for(l=0;l<k.length;l++){var m=k[l],n=P.sub(m.J.D,c),r=P.sub(m.W.D,c);h.push({J:n,W:r,id:m.id})}a.c[b.buildingId]={Xc:e,zf:d.zf,vr:h,a:f,ps:g}}}}}}
function Lm(a,b,c){var d=Number.MAX_VALUE,e=-Number.MAX_VALUE,f=Number.MAX_VALUE,g=-Number.MAX_VALUE,h=null,k=null;a=P.sub(a.Xc,c);a=Math.atan2(a[1],a[0]);for(var l=b.length-1;0<=l;l--){P.Gf(b[l].D,c,Vc);for(var m=Math.atan2(Vc[1],Vc[0]),n=m-a;n>fc;)n-=jc;for(;n<-fc;)n+=jc;0>m&&(m=jc+m);n<d&&(d=n,h=P.A(Vc),f=m);n>e&&(e=n,k=P.A(Vc),g=m)}return{as:{pb:d,Mn:h},Fr:{pb:e,Mn:k},Gt:f,Ft:g,Ot:e-d>fc}}
function Mm(a){var b=Number.MAX_VALUE,c=-Number.MAX_VALUE,d=a.length,e=!1;0<d&&a[0].yc>a[0].yb&&(e=!0);if(e)for(g=a[0],c=g.yb,b=g.yc,f=1;f<d;f++)g=a[f],e=g.yb,g=g.yc,g>e||(e<fc&&e>c&&(c=e),g>fc&&g<b&&(b=g));else for(var f=0;f<d;f++)var g=a[f],b=g.yc<b?g.yc:b,c=g.yb>c?g.yb:c;a=Math.sin(b);d=Math.cos(b);b=Math.sin(c);c=Math.cos(c);a=P.create(1E3*d,1E3*a);c=P.create(1E3*c,1E3*b);return[[ym,a],[ym,c]]}
function Jm(a,b,c,d,e){var f,g,h,k,l=d.length;if(0!=l){var m=[];if(a.c[b.buildingId]){var n=Mm(d),r=null,s=null,t=null,v={};for(k=0;k<l;k++){h=d[k];var w=P.Ta(h.ja,h.oa,ym,v);g=h.ja;f=h.oa;var x=P.ma(g,f,0.5);Nm(a,!1,!1,!1,g,f,x,w,null,c,d,e,m,6*h.xe,v);var y=P.jb(x),y=Om(a,e,Math.sqrt(y))*e.zj,A=P.jb(w);if(null==r||A<r)r=A,s=P.A(w),t=y;P.distance(g,f)>y||(g=P.normalize(P.sub(f,g)),f=P.scale(g,0.5*y),g=P.sub(x,f),f=P.add(x,f),w=P.Ta(g,f,ym),Nm(a,!0,!1,!1,g,f,x,w,n,c,d,e,m,6*h.xe+1))}v=null;for(k=
0;k<l;k++)h=d[k],Pm(a,c,d,b,d[k].ja,n,e,m,6*h.xe+2),Pm(a,c,d,b,d[k].oa,n,e,m,6*h.xe+3);s&&(g=P.normalize(s),g=P.pa(g),f=P.scale(g,0.5*t),g=P.sub(s,f),f=P.add(s,f),Nm(a,!0,!1,!0,g,f,s,s,n,c,d,e,m,6*h.xe+4));b=a=0;h=c=Number.MIN_VALUE;for(a=0;a<m.length;a++)k=m[a],k.distance>h&&(h=k.distance);h+=10;for(a=0;a<m.length;a++){k=m[a];if(k.Co||k.Wo)l=lm(d,k.J),l+=lm(d,k.Xc),l+=lm(d,k.W),k.Vl=l;Qm(k,e.zj,h);e.xp&&k.xe==e.xp&&(k.weight*=1.5);b=Math.min(b,k.weight);c=Math.max(c,k.weight)}if(0<c&&b!=c)for(a=
0;a<m.length;a++)k=m[a],k.rn=(k.weight-b)/(c-b);else for(a=0;a<m.length;a++)k=m[a],k.rn=k.weight;m.sort(function(a,b){return b.rn-a.rn});return m}}}
function Qm(a,b,c){var d=0,e=a.Qh,f=P.sub(a.W,a.J),e=Math.abs(Math.abs(P.Zk(e,f))-hc)/hc,g=1*(1-e),f=P.distance(a.W,a.J),h=Math.min(f,1.1*b),h=(1-e)*h*0.01,k=null,k=P.sub(a.Xc,a.Qh);1E-6>P.jb(k)?k=a.distance:(k=P.normalize(k),b=P.add(a.Qh,P.scale(k,0.5*b)),k=P.length(b));c=1-Math.max(0,Math.min(1,k/c));d+=g+h+(0.9*c+c*c*0.5);c=-1;0<a.Vl&&(c=1-0.5*Math.max(0,Math.min(1,a.Vl/f)),d*=c);a.Wo&&(d*=0.9);a.Co&&(d*=0.9);a.weight=d;a.viewingAngle=e;a.distance=k}
function Om(a,b,c){return Rm(a,b.zj,c,b.distanceScale,b.minPixelWidth,b.maxPixelWidth)}function Rm(a,b,c,d,e,f){d=1+Math.max(0,d*(c-0));a=b*d/c/a.d;b=1;a<e?b=e/a:a>f&&(b=f/a);return d*b}
function Nm(a,b,c,d,e,f,g,h,k,l,m,n,r,s,t){var v,w=P.jb(h);if(!(w>n.sp)){var w=Math.sqrt(w),x=Om(a,n,w);v=x*n.zj;var y,A;0<P.se(e,f,ym)?(y=f,A=e):(y=e,A=f);e=y;f=A;var C=P.distance(e,f);if(C>v-0.01){var B;B=n.a;var I=P.gl(P.normalize(P.sub(f,e)),P.normalize(h));Math.abs(I)<B?(B=Math.atan2(e[1],e[0]),I=Math.atan2(f[1],f[0]),0>I&&(I+=2*fc),0>B&&(B+=2*fc),B-=I,B>oc?B=-(pc-B):B<-oc&&(B=pc+B),B=Math.abs(B)>xm):B=!1;if(B){if(!b&&!c&&C>1.2*v&&t){B=P.create();var I=P.create(),G=P.normalize(P.sub(f,e)),D=
v/C;0>t.Hb-0.5*D?(P.Mo(e,B),P.jk(e,G,v,I)):1<t.Hb+0.5*D?(P.Mo(f,I),P.jk(f,G,-v,B)):(P.jk(h,G,-0.5*v,B),P.jk(h,G,0.5*v,I));if(1>n.a&&!Sm(B,I,n.a))return}else if(1>n.a&&!Sm(e,f,n.a))return;if(b||c){n=e;t=f;n=Math.atan2(A[1]-y[1],A[0]-y[0]);t=Math.sin(n);n=Math.cos(n);t*=0.1;v=0.1*n;n=P.create(y[0]+t,y[1]-v);t=P.create(A[0]+t,A[1]-v);v=P.distance(n,t);v=0.05/v;n=P.scale(n,1-0.1/P.length(n));t=P.scale(t,1-0.1/P.length(t));if(!jm(l,n,t))return;if(k){v=P.distance(y,A);if(0.1>v)return;v=0.05/v;l=P.ma(y,
A,v);a:{y=P.ma(A,y,v);A=k.length;for(n=0;n<A;n++)if(v=k[n],t=v[0],v=v[1],1==P.Dr(t[0],t[1],v[0],v[1],l[0],l[1],y[0],y[1])){k=!0;break a}k=!1}if(k)return}if(d&&(d=Math.max(1,C/4),g||(g=P.ma(e,f,0.5)),!km(m,g,d)||!km(m,e,d)||!km(m,f,d)))return}g||(g=P.ma(e,f,0.5));r.push({Wo:b,Co:c,J:e,W:f,Xc:g,Qh:h,distance:w,Vl:0,distanceFactor:x,pixelFactor:a.d,xe:s})}}}}
function Pm(a,b,c,d,e,f,g,h,k){var l={},m;if(d=a.c[d.buildingId]){var n=0.1*0.1;f=f?f:d.ps;d=P.jb(e);if(!(d>g.sp)){d=Om(a,g,Math.sqrt(d))*g.zj;var r=d*d,s=d*d,t=[],v=function(a){a=P.sub(a,e);return P.Zk(e,a)},w=function(a){var b=P.X(e,a);!(b<n)&&b<s&&(b=P.Ta(e,a,ym,l),300<P.length(b)||t.push({D:a,im:!1,pb:v(a)}))};w(c[0].oa);w(c[0].ja);for(m=1;m<c.length;m++)w(c[m].ja);for(m=0;m<c.length;m++){var w=c[m],x=P.pp(w.ja,w.oa,e,d);if(x&&0<x.length)for(var y=0;y<x.length;y++){var A=x[y];P.X(e,A)<n||(w=P.Ta(e,
A,ym,l),300<P.length(w)||t.push({D:A,im:!0,pb:v(A)}))}}t.sort(function(a,b){return a.pb-b.pb});0<t.length&&(m=t[0],x=e,y=m.D,y=P.add(x,P.scale(P.normalize(P.sub(y,x)),d)),A=!m.im,w=P.Ta(x,y,ym,l),Nm(a,!0,A,!0,x,y,null,w,f,b,c,g,h,k),x=m.D,y=P.add(x,P.scale(P.normalize(P.sub(e,x)),d)),w=P.Ta(x,y,ym,l),Nm(a,!0,A,!0,x,y,null,w,f,b,c,g,h,k),1<t.length&&(m=t[t.length-1],y=m.D,P.distance(y,x)<r&&(y=P.add(x,P.scale(P.normalize(P.sub(y,x)),d)),w=P.Ta(x,y,ym,l),Nm(a,!0,!m.im,!0,x,y,null,w,f,b,c,g,h,k))))}}}
function Sm(a,b,c){var d=P.ma(a,b,0.5);a=P.normalize(P.sub(b,a));d=P.gl(a,P.normalize(d));return Math.abs(d)<c}function Km(a){return z.create(a[0],a[1],J(void 0)?0:void 0)};function Tm(a){this.a=new Kf;this.f=a.f}Tm.prototype=Object.create(Jf.prototype);p=Tm.prototype;p.kb=Lf;p.t=function(){this.clear()};p.Gd=function(){};p.ah=function(){Em(Rj())};p.clear=function(){this.Md()};p.Md=function(){Jf.prototype.Md.call(this)};p.om=function(){var a=[],b=new Kf,c=null;for(c in this.a.a){var d=this.a.get(c);b.get(d.jd.buildingId)||(a.push(d.jd.buildingId),b.set(d.jd.buildingId,d.jd.buildingId))}return a};
function Um(a,b){var c=[],d=null;for(d in a.a.a){var e=a.a.get(d);e.jd.buildingId==b&&c.push(e)}return c}p.nm=function(a){var b=this.f.k;if(!b)return null;(a=b.Xf.get(a))?(b=Rj(),a.ta?null==b.a?a=-1:(a=gm(b.a,a.buildingId),a=0==a.length?-1:lm(a,ym)):a=-1):a=-1;return a};p.fj=function(a){var b=this.f.k;return b?(a=b.Xf.get(a))?Rj().fj(a):!1:!1};p.jj=function(a,b,c,d,e,f,g,h){var k=this.f.k;if(!k)return null;a=k.Xf.get(a);if(!a)return null;(b=Qj(Rj(),a,b,c,d,e,f,g,h))&&Sj(Rj(),b,0.3,0.3);return b};
p.Tj=function(a){this.Ud(a)};function Vm(a){this.a=new Kf;this.f=a;this.Wc=new Tm(this);this.b=new tj(this);this.e=z.create();this.d=R();this.c=null}Vm.prototype=Object.create(Jf.prototype);var Wm=pa();Wm.isEnabled=!1;Vm.prototype.kb=Wm;var Fk=2;p=Vm.prototype;p.t=function(){this.clear();this.Wc.t();this.b.t()};p.clear=function(){this.Md()};function Xm(a,b){a.c=b}p.Bo=function(a,b,c,d,e,f,g,h,k,l,m,n,r,s){a=new Ve(a,b,c,d,e,f,g,h,k,l,m,n,r,s);this.ik(a)};p.Tj=function(a,b,c){var d=Ym(this,a);d&&d.Tj(a,b,c)};
p.mg=function(a){var b=Ym(this,a);b&&b.mg(a);this.a.remove(a.id)};p.Md=function(){this.a=new Kf;this.Wc.Md();this.b.Md()};
function Zm(a,b){var c=Fk,d=null,e=null,f=void 0!=c&&null!=c&&0<c?c*c:null,g=b.forEach(function(b,g){if(g){var l=z.X(g.Xp,a);if(l<g.ih)if(g.Ie&&g.Ie.Mj){var l=z.I(g.Xg(),a),m;m=g.Ie.Mj;if(l[0]<m.min[0]||l[1]<m.min[1]||l[0]>m.max[0]||l[1]>m.max[1])m=!1;else{var n=0;m=m.ha;for(var r=m.length-1;0<=r;r--){var s=m[r];if(s)var t=s.J.D,s=s.W.D,s=1==P.Km(Vl,l[1]-10,l[0],l[1],t[0],t[1],s[0],s[1])?1:0,n=n+s}m=1==n%2}if(m)return g;if(null!=f){r=g.Ie.Mj;if(l[0]+c<r.min[0]||l[1]+c<r.min[1]||l[0]-c>r.max[0]||l[1]-
c>r.max[1])l=null;else{m=null;r=r.ha;for(n=r.length-1;0<=n;n--)if(s=r[n])if(s=P.Pg(s.J.D,s.W.D,l),null==m||m>s)m=s;l=m}null!=l&&l<f&&(null==d||l<d)&&(d=l,e=g)}}else{if(l=g.sd)l=g.sd,m=!1,m=z.I(xe(l),a),(r=l.nd().hb())&&(r=r.Ug())&&(m[2]=N(r.Zb[2],r.Nb[2],0.5)),m=fe(m[0],m[1],m[2],1,0,0),l=m=1==l.No(m)%2;if(l)return g}}});return!J(g)&&g instanceof Object?g:!J(e)&&e instanceof Object?e:null}
p.Gd=function(a){if(!this.f.k.r)return!1;var b=a.Xf;this.oh();if(0<this.a.size()){Dm(Rj(),b,a);for(var c in this.a.a){var d=this.a.get(c);if(d&&d instanceof Ve){var e=d.jd;if(!d.Nm){d.Nm=!0;var e=d.Me,f=Ej(this.f.k.r)[2];d.Te=Fj([e[0],e[1],f]);d.buildingId?(e=b.get(d.buildingId),e=!J(e)&&e instanceof Object?e:null):e=Zm(d.Te,b);d.o&&e&&(d.jd=e)}d.e||null==e?(Mf(this.Wc,d),this.b.ik(d)):(Mf(this.b,d),this.Wc.ik(d),this.Wc.Ud(d.Sa),d.jd=e)}}this.Wc.Gd(a);this.b.Gd(a);this.c&&this.c(a)}return!0};
p.ah=function(a){this.Wc.ah(a);this.b.ah(a)};p.oh=function(){if(this.f.k.r){var a=Jj(this.f.Ca.S);this.e=Fj(a);this.d=hj(this.e);if(a=this.f.k.Ia)a=a.eb(),Kj(a)}};p.uf=function(){this.f.k.r&&this.b.uf()};p.Hn=function(){this.a.forEach(function(a,b){b.Sa.distance=-1});this.b.Hn()};function Ym(a,b){a.Ud(b);return a.Wc.Ud(b)?a.Wc:a.b.Ud(b)?a.b:null}p.om=function(){return this.Wc.om()};p.lm=function(){return this.a};p.nm=function(a){return this.Wc.nm(a)};p.fj=function(a){return this.Wc.fj(a)};
p.jj=function(a,b,c,d,e,f,g,h){return this.f.k&&this.f.k.r?this.Wc.jj(a,b,c,d,e,f,g,h):null};p.lh=function(a,b){var c=Ym(this,a);c&&c.lh(a,b)};p.li=function(a,b){var c=Ym(this,a);c&&c.li(a,b)};p.Kh=function(a,b){var c=Ym(this,a);c&&c.Kh(a,b)};p.Uh=function(a,b){var c=Ym(this,a);c&&c.Uh(a,b)};p.bi=function(a){var b=Ym(this,a);b&&b.bi(a)};p.Oh=function(a,b){var c=Ym(this,a);c&&c.Oh(a,b)};function T(){this.a=null;this.e=[];this.b=[];this.c=null;this.o=!0;this.g=this.j=this.v=null;this.Kb=new Me({position:new Le(7,3,0),normal:new Le(7,3,12)});this.aa=new Me({position:new Le(7,3,0),texcoord:new Le(7,3,12),normal:new Le(7,3,20)})}da("H.PanoramaMarkerManager",T);var $m=pa();$m.isEnabled=!1;T.prototype.kb=$m;T.closestPointThresholdSqr=25;T.viewDiffThreshold=0.1;T.maxDisplayScaleChangeThreshold=0.95;var an=1/0.95;T.AnchorType={vq:-1,Fs:0,Xs:1,ys:2};var bn=1;
T.prototype.xa=function(a){this.a=a;a=this.a.f.ca;this.uf();var b=this;Xm(a,function(){b.Va()})};T.prototype.setCityScene=T.prototype.xa;T.prototype.clear=function(){this.e=[];for(var a=0;a<this.b.length;a++)this.b[a].clear();this.b=[];this.a&&this.a.f&&(a=this.a.f.ca)&&a.Md();this.g=null;this.a.f.u()};T.prototype.clear=T.prototype.clear;T.prototype.Ac=function(){this.clear();this.a=this.c=null};T.prototype.shutdown=T.prototype.Ac;T.prototype.tb=function(){for(var a=0;a<this.b.length;a++)cn(this.b[a])};
T.prototype.clearMarkerSurfaceModels=T.prototype.tb;T.prototype.Qc=function(){return this.c};T.prototype.getClientHandler=T.prototype.Qc;T.prototype.rh=function(a){this.c=a};T.prototype.setClientHandler=T.prototype.rh;function dn(a){if(a.a&&a.a.f&&a.a.f.k&&a.a.f.k.r){var b=a.a.f.k.r.ib(),c=a.a.f.N(),d=c.K.S;null!=a.j&&z.$f(a.j,d)?a.o=!1:(a.o=!0,a.j=z.A(d));a.v=b;a.d=hj(a.v);a.a.f.Ea.Pb();c.cg();if(b=a.a.f.k.Ia)b=b.eb(),a.g=Kj(b)}}
T.prototype.uf=function(){dn(this);if(this.o){for(var a=0;a<this.b.length;a++){var b=this.b[a];if(b.c&&b.c.Qa()){var c=this.a.f.N().K.S,d=z.distance(c,b.c.S),e=b.H.Dc[0],d=en(b,d),f=b;if(f.ab&&f.c){c=z.distance(c,f.c.S);f.R=c;for(var g=f.a.dg()-1;0<=g;)f.a.Zg(g).R=c,g--}e=Math.abs(e/d);0.95>e||e>an||(1==b.n?ve(b.H,[-d,1,d]):ve(b.H,[d,1,d]))}}this.a&&this.a.f&&(a=this.a.f.ca)&&a.uf()}};
T.prototype.ic=function(a,b,c){nk(a,1);nk(b,2);c&&sk(c,"object","settings");var d=uk(b);b=vk(b);return new U(a,d,b,null,c)};T.prototype.createMarker=T.prototype.ic;T.prototype.Zl=function(a,b,c,d,e,f,g,h,k,l){return new fn(a,b,c,d,e,f,g,h,k,l)};T.prototype.createMarkerImage=T.prototype.Zl;T.prototype.hc=function(a,b,c,d,e,f,g,h,k){return new fn(a,null,b,c,d,e,f,g,h,k)};T.prototype.createHtmlMarkerImage=T.prototype.hc;
T.prototype.wg=function(a){gn(a);if(this.n(a)||!this.c)return!1;this.e.push(a);var b=this.a.f.ca,c=this,d=a.j(),e=a.c();null!=e&&(e*=u);b.Bo([a.latitude,a.longitude,null],d,a,0,"",a.n(),a.o(),a.p(),a.g(),e,a.d(),a.a?a.a.a:null,function(a,b,d,e){return hn(c,a,b,d,e)},function(){return jn(c.c,a.lf)});return!0};T.prototype.registerMarker=T.prototype.wg;T.prototype.Ph=function(){this.a.f.Gd()};T.prototype.updateMarkers=T.prototype.Ph;
function hn(a,b,c,d,e){if(!b)return null;var f=jn(a.c,b.lf);kn(a.c,b,function(a,e){d(b,c,new yj(e.Ec,e.width,e.height,e.Ql,e.Rl,e.Xb,e.zd,e.Ld,e.Kd,f))},function(){e(b,c,c)})}T.prototype.n=function(a){return 0<=this.e.indexOf(a)};T.prototype.hasMarker=T.prototype.n;function ln(a,b){for(var c=0;c<a.e.length;c++)if(a.e[c].lf==b.Sa.lf)return a.e[c];return null}
T.prototype.Jh=function(a){var b=null;nk(a,1);a instanceof U||a instanceof mn||kk(typeof a,typeof U,"",1);b=a instanceof mn?a.qb():a;if(!(b&&b instanceof U))return!1;if(a=b.e())b.b(),1>a.b.length&&this.p(a);a=this.e.indexOf(b);return 0<=a?(this.e.splice(a,1),this.a.f.ca.mg(b),!0):!1};T.prototype.unregisterMarker=T.prototype.Jh;T.prototype.p=function(a){var b=this.b.indexOf(a);0<=b&&(a.clear(),this.b.splice(b,1))};T.prototype.removeMarkerSurface=T.prototype.p;T.prototype.Sc=function(){return this.e.length};
T.prototype.getNumMarkers=T.prototype.Sc;T.prototype.lm=function(){return this.e.slice(0)};T.prototype.getAllMarkers=T.prototype.lm;T.prototype.Rc=function(){return this.b.length};T.prototype.getNumMarkerSurfaces=T.prototype.Rc;T.prototype.H=function(){return this.b.slice(0)};T.prototype.getAllMarkerSurfaces=T.prototype.H;
T.prototype.In=function(a){if(a instanceof nn||a instanceof mn){var b=a.a();if(!b||a instanceof mn&&!b.rh(a)||a instanceof nn&&!b.Jh(a))return!1;var c=b.s.c(a);if(!c)return!1;b.sk();on(this.c,a,c.w,c.h,function(a,e){var f=b.cc();f&&f.Df(0,e,c.x,c.y)},function(){})}else this.a.f.ca.Tj(a,-1,!0);return!0};T.prototype.updateMarkerImage=T.prototype.In;T.prototype.s=function(){this.a&&this.a.f&&this.a.f.u()};T.prototype.requestUpdate=T.prototype.s;T.prototype.cd=function(a){return this.a.f.ca.nm(a.buildingId)};
T.prototype.getSurfaceDistance=T.prototype.cd;T.prototype.Td=function(a){return this.a.f.ca.fj(a.buildingId)};T.prototype.isBuildingVisible=T.prototype.Td;T.prototype.dd=function(a,b,c,d,e,f,g){return(a=this.a.f.ca.jj(a.buildingId,b,a.selectedFace?a.selectedFace.vb:void 0,c,d,e,f,g))?(b=z.distance(a.ab,a.zb),c=new pn(a,b,a.distance,a.viewingAngle,c,a.distanceFactor,a.pixelFactor,f,g),c.distanceScale=e,c.distanceFactor=a.distanceFactor,c):null};T.prototype.getSurfaceInfo=T.prototype.dd;
T.prototype.cp=function(a,b,c,d,e,f){if(a=this.a.f.ca.jj(a.buildingId,b,a.selectedFace?a.selectedFace.vb:void 0,c,1,d,e,f)){var g=z.distance(a.ab,a.zb);c=new pn(a,g,a.distance,a.viewingAngle,c,a.distanceFactor,a.pixelFactor,e,f);a=1+Math.max(0,d*(c.distance-0));b=b*a/c.distance/c.pixelFactor;g=1;b<e?g=e/b:b>f&&(g=f/b);c.distanceScale=d;c.distanceFactor=a*g;return c}return null};T.prototype.getSurfaceInfoForIconStrip=T.prototype.cp;
T.prototype.Bd=function(a,b,c,d,e,f){if(a=this.a.f.ca.jj(a.buildingId,0.1,a.selectedFace?a.selectedFace.vb:void 0,c,1,0,0,Number.MAX_VALUE)){var g=z.distance(a.ab,a.zb);c=new pn(a,g,a.distance,a.viewingAngle,c,a.distanceFactor,a.pixelFactor,e,f);a=1+Math.max(0,d*(c.distance-0));b=b*a/c.distance/c.pixelFactor;g=1;b<e?g=e/b:b>f&&(g=f/b);c.distanceScale=d;c.distanceFactor=a*g;return c}return null};T.prototype.getSurfaceInfoForBorderIconStrip=T.prototype.Bd;
T.prototype.M=function(a){for(var b=0;b<this.b.length;b++)if(this.b[b].buildingId==a)return this.b[b];return null};T.prototype.getMarkerSurfaceForBuilding=T.prototype.M;T.prototype.Vo=function(a){for(var b=0;b<this.b.length;b++)this.b[b].dd(a)};T.prototype.forceOpacityOnAllMarkerSurfaces=T.prototype.Vo;
T.prototype.Va=function(a){var b=this;dn(this);var c=this.a.f.k.eh,d=this.a.f.ca;d.Hn();for(var e=0;e<this.b.length;e++){var f=this.b[e];f.va=!1}var g=void 0!=a?a:!1;a=d.om();for(e=0;e<a.length;e++){var h=a[e],k=Um(d.Wc,h),l=!1,m=!1,n=!1,r=!1,s=!1,t=!1,v=!1,w=!1,x=!1,w=0,w=null,f=this.M(h);if(k&&0<k.length){w=null;f?w=f.xa():(f=new W(this,h),l=!0);for(h=0;h<k.length;h++){var y=ln(this,k[h]);y&&!f.Bd(y)&&(n=!0,y=new mn(y),f.Td(y),g=!0)}if(w)for(var A=0;A<w.length;A++){for(var C=w[A],B=!1,h=0;h<k.length;h++)if(y=
ln(this,k[h]),y===C.qb()){B=!0;break}B||(f.yi(C),g=!0)}qn(this.c,f)?(f.selectedFace&&f.ub?(m=f.Qc,r=f.selectedFace.vb!=f.Sc,w=null!=f.Va&&25<z.X(f.ub,f.Va),s=2==f.n&&w,f.H&&(w=f.H.Dc[0],k=en(f,f.selectedFace.distance),w=Math.abs(w/k),x=0.95>w||w>an),t=f.Rc!=f.n,f.tb&&f.Kb&&(v=0.1<1-z.L(f.Kb,f.tb)),f.va=!0):(f.Sc=null,f.Va=null,f.tb=null,f.nk=-1,f.Rc=-1,f.distance=-1),m||n||r||s||t||x||f.hc&&v?(cn(f),f.distance=f.selectedFace.distance,rn(this.c,f,function(a,c,d,e){c&&d&&e&&(b.a.f.k&&a&&a.selectedFace&&
sn(b,a,a.Xj,c),g=!0)},function(){}),f.Sc=f.selectedFace.vb,f.Rc=f.n,f.nk=f.distance,f.Va=f.ub,f.tb=f.Kb,l&&this.b.push(f)):(f.dd(1),f.c&&c.add(f.c))):f.clear()}else f&&(f.va=!1)}c=this.H();for(e=0;e<c.length;e++)f=c[e],f.va||(cn(f),this.p(f),g=!0);d.lm().forEach(function(a,b){b.Sa.distance=b.Sa.Re?b.Sa.Re.rd?b.Sa.Re.rd.distance:-1:b.R});g&&this.s();return g};T.prototype.updateMarkerView=T.prototype.Va;T.prototype.Nh=function(a){dn(this);cn(a);qn(this.c,a)&&this.va(a)};
T.prototype.updateMarkerSurface=T.prototype.Nh;T.prototype.va=function(a,b){var c=this;rn(this.c,a,function(a,e,f,g){e&&f&&g&&(b&&b(a),c.a.f.k&&a&&a.selectedFace&&sn(c,a,a.Xj,e))},function(){});this.a.f.u()};T.prototype.updateMarkerSurfaceContent=T.prototype.va;function tn(a,b){var c=Nj(a.a.f,b);return c&&a.g?(c[2]+=0,c=z.I(a.g,c,c)):null}
function sn(a,b,c,d){if(b.zb&&b.ab&&b.j&&b.Ab){var e=new ie,f=new ie,g=null,h=1==b.n;if(b.anchor){var k=tn(a,b.anchor);k?(k=z.sub(k,b.anchor),k=b.ic-z.length(k)):k=b.ic-3;se(f,[0,0,k]);k=z.distance(b.ab,b.anchor);se(e,b.anchor);g=h?[(k-b.Xb)/b.M,0,0]:[-k/b.M,0,0]}else se(e,b.ab);var k=e.S,l=Ha(k),m=Ja(k),n=z.pa(l,m);z.pa(n,l,m);var r=R(),s=Yc();Ed(m,n,l,r);md(r,s);k.splice(3,0,s[0],s[1],s[2],s[3]);k.splice(7,0,l[0],l[1],l[2]);te(e,k);var m=a.a.f.k,t=new qf(a.Kb),v=b.M,k=b.Xb/v,n=b.zd/v,w=[k,0,0],
x=[0,0,n],r=[0,-1,0],y=[k,0,0],A=[k,0,n],C=[0,0,n],s=S(t,[0,0,0],void 0,r),y=S(t,y,void 0,r),A=S(t,A,void 0,r),C=S(t,C,void 0,r);wf(t,s,y,A,C);if(!(0>=t.c)){s=[0,0,0,0];c=un(m.f.lb,c?c:[0,0,0,0]);y=t.hb();c=new Be(new pd(m.f.mb,y),c);h?ve(f,[-v,1,v]):ve(f,[v,1,v]);je(c,ah);c.Y=b;e.add(f);f.add(c);g&&se(c,g);b.c=e;b.H=f;b.a=c;g=a.a.f.ya.S;b.hc&&b.anchor?(y=z.normalize(z.sub(g,b.anchor)),y=z.normalize(z.pa(y,l)),y=z.tf(a.d,y),y=Math.atan2(y[0],-y[1])):(y=z.tf(a.d,b.Ab),y=Math.atan2(y[1],y[0]));y=Ka([0,
0,1],y);ue(f,y);m.eh.add(e);f=b.s;e=f.b();if(0<e.length){var B=z.scale(r,0.05),I=1/f.width,G=1/f.height,D=z.create(),L=z.create(),O=z.create(),f=function(a,b){z.add(z.scale(w,I*a,D),z.scale(x,G*b,L),O);return z.add(O,B)},l=function(a,b,c,d){return[(a.x+c*a.w)/b.width,(a.y+d*a.h)/b.height]},v=new qf(a.aa);sf(v);t=(y=b.cc())?vn(m.f.lb):un(m.f.lb,s);bj(t.tc(),!1);y&&(Pb(d.width==y.pd()),Pb(d.height==y.md()),y.re(0,d,{he:!1}),t.za(0,y));for(var s=null,M=0;M<e.length;M++){var Z=z.X(b.ab,g),s=z.X(b.zb,
g),Z=Math.max(0.01,Math.sqrt(Math.min(Z,s))),V=e[M],C=V.c,Q=V.b;vf(v,V.a);s=S(v,f(Q.x,Q.y),l(C,d,0,1),r);y=S(v,f(Q.x+Q.w,Q.y),l(C,d,1,1),r);A=S(v,f(Q.x+Q.w,Q.y+Q.h),l(C,d,1,0),r);C=S(v,f(Q.x,Q.y+Q.h),l(C,d,0,0),r);wf(v,s,y,A,C);var ga=V.a.je().Gm;if(ga){var fa=new qf(a.aa);sf(fa);var Ia=wn(m.f.lb);bj(Ia.tc(),!1);vf(fa,V.a);s=S(fa,f(0,0),[0,1],r);y=S(fa,f(Q.w,0),[1,1],r);A=S(fa,f(Q.w,Q.h),[1,0],r);C=S(fa,f(0,Q.h),[0,0],r);wf(fa,s,y,A,C);s=fa.hb();s.b=!0;s=new Be(new pd(m.f.mb,s),Ia);ga.yq=Q.w;ga.xq=
Q.h;ga.rl=k*I*Q.w;ga.Aq=n*G*Q.h;ga.zq=90;s.Gm=ga;se(s,f(Q.x,Q.y));je(s,xg);s.R=Z;c.add(s)}}if(0>=v.c)return;a=v.hb();a.b=!0;a=new Be(new pd(m.f.mb,a),t);je(a,bh);h&&(se(a,[k,0,0]),y=fc,y=Ka([0,0,1],y),ue(a,y));c.add(a);a.R=Z}b.vd(b.Qa?1:0);c.G(b.Qa)}}}function xn(a,b){return!E(b)&&null!=b&&b instanceof U&&a.n(b)}T.prototype.lh=function(a,b){if(xn(this,a)&&this.a&&this.a.f){var c=this.a.f.ca;c&&c.lh(a,b)}};T.prototype.showMarker=T.prototype.lh;
T.prototype.li=function(a,b){if(xn(this,a)&&this.a&&this.a.f){var c=this.a.f.ca;c&&c.li(a,b)}};T.prototype.hideMarker=T.prototype.li;T.prototype.Kh=function(a,b){if(xn(this,a)&&this.a&&this.a.f){var c=this.a.f.ca;c&&c.Kh(a,b)}};T.prototype.activateMarker=T.prototype.Kh;T.prototype.Uh=function(a,b){if(xn(this,a)&&this.a&&this.a.f){var c=this.a.f.ca;c&&c.Uh(a,b)}};T.prototype.deactivateMarker=T.prototype.Uh;T.prototype.bi=function(a){if(xn(this,a)&&this.a&&this.a.f){var b=this.a.f.ca;b&&b.bi(a)}};
T.prototype.freezeMarker=T.prototype.bi;T.prototype.Oh=function(a,b){if(xn(this,a)&&this.a&&this.a.f){var c=this.a.f.ca;c&&c.Oh(a,b)}};T.prototype.bringMarkerToFront=T.prototype.Oh;function gn(a){nk(a,1);a instanceof U||kk(typeof a,typeof U,"",1)}function yn(a,b,c,d){this.x=a;this.y=b;this.w=c;this.h=d}T.LayoutRect=yn;yn.prototype.offset=function(a,b){return new yn(this.x+a,this.y+b,this.w,this.h)};yn.prototype.offset=yn.prototype.offset;
function zn(a,b,c,d,e,f){this.s=a;this.buildingId=b;this.e=void 0!=c?c:An;this.p=void 0!=d?d:Bn;this.ag=void 0!=e?e:Cn;this.Dj=void 0!=f?f:Dn;this.d=En;this.a=this.b=this.c=null}T.MarkerProperties=zn;var An=!0;zn.defaultAllowedInBuilding=An;var Cn=!0;zn.defaultFadingEnabled=Cn;var Dn=!0;zn.defaultOcclusionEnabled=Dn;var Bn=!0;zn.defaultAllowedToAlignToBuilding=Bn;var En=!1;zn.defaultPositionIsFixed=En;zn.prototype.H=function(a){this.d=a};zn.prototype.setPositionIsFixed=zn.prototype.H;
zn.prototype.n=function(a){this.c=a};zn.prototype.setFixedRotation=zn.prototype.n;zn.prototype.j=function(){return this.b};zn.prototype.getHeightOverGround=zn.prototype.j;zn.prototype.o=function(a){this.b=a};zn.prototype.setHeightOverGround=zn.prototype.o;zn.prototype.v=function(a){this.a=a};zn.prototype.setGroundAngle=zn.prototype.v;zn.prototype.g=function(){return this.a};zn.prototype.getGroundAngle=zn.prototype.g;
function fn(a,b,c,d,e,f,g,h,k,l){this.Ec=a;this.canvas=b;this.width=c;this.height=d;this.Ql=e;this.Rl=f;this.Xb=g;this.zd=h;this.Ld=k;this.Kd=l;this.opacity=1}T.MarkerImage=fn;fn.prototype.a=function(){return this.Ec instanceof HTMLElement};fn.prototype.isHtmlImage=fn.prototype.a;function Fn(a,b,c){this.a=a;this.c=b;this.b=c}T.MarkerRenderInfo=Fn;function Gn(){}T.ClientDataHolder=Gn;Gn.prototype.je=function(){};Gn.prototype.getClientObject=Gn.prototype.je;
T.isClientDataHolder=function(a){return null!=a&&void 0!=a.je};function U(a,b,c,d,e){this.id=bn++;this.Re=null;this.a=void 0!=e?e:null;this.lf=a;this.latitude=b;this.longitude=c;this.altitude=d;this.distance=-1;this.Qa=!0}T.Marker=U;U.prototype.b=function(){this.Re&&this.Re.b()};U.prototype.detach=U.prototype.b;U.prototype.s=function(){return this.lf};U.prototype.getClientMarker=U.prototype.s;U.prototype.je=function(){return this.lf};U.prototype.getClientObject=U.prototype.je;U.prototype.v=function(){return this.Re};
U.prototype.getMarkerSurfaceMarker=U.prototype.v;U.prototype.e=function(){return this.Re?this.Re.a():null};U.prototype.getMarkerSurface=U.prototype.e;U.prototype.H=function(){return null!=this.Re};U.prototype.isSurfaceMarker=U.prototype.H;U.prototype.j=function(){return this.a?this.a.buildingId:null};U.prototype.getBuildingId=U.prototype.j;U.prototype.n=function(){return this.a?this.a.e:!1};U.prototype.isAllowedInBuilding=U.prototype.n;U.prototype.o=function(){return this.a?this.a.p:!0};
U.prototype.isAllowedToAlignToBuilding=U.prototype.o;U.prototype.p=function(){return this.a?this.a.ag:!0};U.prototype.isFading=U.prototype.p;U.prototype.di=function(){return this.a?this.a.s:Ze};U.prototype.getBubbleType=U.prototype.di;U.prototype.g=function(){return this.a?this.a.d:En};U.prototype.isPositionFixed=U.prototype.g;U.prototype.c=function(){return this.a?this.a.c:null};U.prototype.getFixedRotation=U.prototype.c;U.prototype.d=function(){return this.a?this.a.b:null};
U.prototype.getHeightOverGround=U.prototype.d;var Ze=-1,Tj=0,ug=1;T.MarkerBubbleType={vq:Ze,NONE:Tj,Ns:ug,Is:2};var Uj=2;T.MarkerBubbleState={hq:1,OPEN:Uj,qs:3};
function W(a,b){this.ca=a;this.buildingId=b;this.s=this.selectedFace=null;this.b=[];this.g=new Kf;this.p=this.Ka=this.a=this.H=this.c=this.Xj=null;this.distance=-1;this.viewingAngle=0;this.distanceScale=1;this.Xb=0;this.zd=1;this.ic=2;this.M=1;this.wg=null;this.va=this.Qa=!0;this.opacity=1;this.tb=this.Va=this.ub=this.Sc=this.ie=null;this.Rc=this.n=this.nk=-1;this.Qc=!1;this.anchor=this.Kb=this.Ab=this.aa=this.j=this.zb=this.ab=null;this.hc=!1;this.e=this.d=this.o=null;this.R=-1}T.MarkerSurface=W;
W.fadeInDuration=100;W.fadeOutDuration=100;W.isSurfaceObject=function(a){return a instanceof mn||a instanceof nn};W.prototype.clear=function(){this.o&&(this.o.stop(),this.o=null);this.s=this.selectedFace=this.buildingId=null;Hn(this);this.Xj=null;this.za(null);this.v();this.d&&this.cd();this.c&&(pe(this.c),this.c=null);this.p&&(pe(this.p),this.p=null)};W.prototype.clear=W.prototype.clear;
function Hn(a){if(0<a.b.length){for(var b=a.xa(),c=0;c<b.length;c++){var d=b[c];d&&a.yi(d)}a.b=[]}a.g.forEach(function(a,b){b.We(null)});a.g.clear()}function cn(a){a.c&&(pe(a.c),a.c=null)}W.prototype.gn=function(){return this.s};W.prototype.getLayoutManager=W.prototype.gn;W.prototype.Fk=function(a,b,c,d,e){this.s=new In(a,b);e?this.Ka=this.ca.a.f.Vb.createTexture(c,d,jh):this.za(null);return this.s};W.prototype.setupLayoutManager=W.prototype.Fk;W.prototype.Ym=function(){return this.n};
W.prototype.getAnchorPosition=W.prototype.Ym;W.prototype.Bd=function(a){for(var b=this.b,c=this.b.length-1;0<=c;){if(a==b[c].qb())return!0;c--}return!1};W.prototype.hasMarker=W.prototype.Bd;W.prototype.rh=function(a){return 0<=this.b.indexOf(a)};W.prototype.hasSurfaceMarker=W.prototype.rh;W.prototype.Td=function(a){a.a()!=this&&(a.rd&&a.rd.yi(a),this.b.push(a),a.We(this))};W.prototype.addSurfaceMarker=W.prototype.Td;
W.prototype.yi=function(a){var b=this.b.indexOf(a);0<=b&&(a.We(null),this.b.splice(b,1),this.Ph())};W.prototype.removeSurfaceMarker=W.prototype.yi;W.prototype.xa=function(){return this.b.slice(0)};W.prototype.getSurfaceMarkers=W.prototype.xa;W.prototype.hn=function(){return this.b.length};W.prototype.getNumSurfaceMarkers=W.prototype.hn;W.prototype.Gn=function(a){for(var b=this.b,c=this.b.length-1;0<=c;){var d=b[c];d.d(!1);c--}for(c=a.length-1;0<=c;)d=a[c],d.d(!0),c--};
W.prototype.setActiveMarkerSet=W.prototype.Gn;W.prototype.Wm=function(){for(var a=[],b=this.b,c=this.b.length-1;0<=c;){var d=b[c];d.c&&a.push(d);c--}return a};W.prototype.getActiveMarkerSet=W.prototype.Wm;W.prototype.Un=function(a){for(var b=this.b,c=this.b.length-1,d=void 0;0<=c;){d=a(b[c]);if(void 0!=d)return d;c--}};W.prototype.visitSurfaceMarkers=W.prototype.Un;W.prototype.Jh=function(a){return!!this.g.forEach(function(b,c){if(c==a)return!0})};W.prototype.hasSurfaceUIObject=W.prototype.Jh;
W.prototype.pn=function(a){return this.g.get(a)};W.prototype.getSurfaceUIObject=W.prototype.pn;W.prototype.zn=function(){var a=[];this.g.forEach(function(b){a.push(b)});return a};W.prototype.getSurfaceUIObjectKeys=W.prototype.zn;W.prototype.kl=function(a){this.g.forEach(a)};W.prototype.visitSurfaceUIObjects=W.prototype.kl;W.prototype.Ln=function(a,b){b.a()!=this&&(b.a()&&b.a().rk(a),this.g.set(a,b),b.We(this))};W.prototype.setSurfaceUIObject=W.prototype.Ln;
W.prototype.rk=function(a){var b=this.g.get(a);b&&(this.g.remove(a),b.We(null))};W.prototype.removeSurfaceUIObject=W.prototype.rk;W.prototype.Rm=function(a){this.height=a};W.prototype.setHeight=W.prototype.Rm;W.prototype.Ek=function(a){this.Xj=a};W.prototype.setBgColor=W.prototype.Ek;
W.prototype.uk=function(a,b,c,d,e,f,g,h){var k;if(k=b)if(k=a)a:{if(a.a.f.k&&b.selectedFace){k=b.selectedFace;Sj(Rj(),k,e,d);if(null==k.ab||null==k.zb||null==k.j||null==k.qh){k=!1;break a}this.ab=k.ab;this.zb=k.zb;this.j=k.j;this.aa=k.aa;this.Ab=k.qh;var l={},m=a.a.f.Ca.S;if(this.ub=a=z.Ta(k.ab,k.zb,m,l)){var n,r,s,t;s=z.distance(k.ab,k.zb);var v=z.sub(k.j,k.ab),m=z.normalize(z.sub(m,a));f?(r=z.normalize(z.pa(m,v)),0>z.L(r,k.qh)?(z.vp(r,r),l=a,n=z.cb(a,r,c),s=l,t=0):(n=a,l=z.cb(a,r,c),s=n,t=1)):(t=
2,r=z.normalize(z.sub(k.zb,k.ab)),n=c/s,s=a,0>l.Hb-0.5*n?(l=k.ab,n=z.cb(l,r,c)):1<l.Hb+0.5*n?(n=k.zb,l=z.cb(n,r,-c)):(l=z.cb(a,r,-0.5*c),n=z.cb(a,r,0.5*c)));this.ab=l;this.zb=n;this.j=z.add(l,v);this.aa=z.add(n,v);this.Ab=k.qh;this.Kb=m;this.anchor=s;this.n=t;this.hc=f;k=!0;break a}}k=!1}k?(this.height=d,this.Xb=c,this.zd=d,this.M=b.distanceFactor,this.selectedFace=b.selectedFace,this.wg=g,this.ic=e,this.distanceScale=b.distanceScale,this.maxDistance=b.maxDistance,this.minPixelWidth=b.minPixelWidth,
this.maxPixelWidth=b.maxPixelWidth,this.Qc=void 0!=h?h:!1):this.selectedFace=null};W.prototype.selectSurfaceInfo=W.prototype.uk;W.prototype.Zm=function(){return this.wg};W.prototype.getClientLayout=W.prototype.Zm;W.prototype.Ph=function(){this.Qc=!0};W.prototype.invalidateLayout=W.prototype.Ph;function en(a,b){if(0>=a.Xb)return null;var c=a.Xb/a.M;return Rm(Rj(),c,b,a.distanceScale,a.minPixelWidth,a.maxPixelWidth)}W.prototype.cc=function(){return this.Ka};W.prototype.za=function(a){this.Ka=a};
function Jn(a,b,c){var d=a.ca,e=d.a.f;return new Eb(d.a.f.l.i.Cj,a.a,function(d,g){var h=tc(d/100,0,1),h=N(b,c,h),h=Ca(h);a.vd(h);a.a&&e.u();return 100<d?(g.stop(),a.o=null,!1):!0})}W.prototype.eg=function(){return this.Qa};W.prototype.getVisibility=W.prototype.eg;W.prototype.G=function(a){if(a!=this.Qa&&(this.Qa=a,this.a)){this.a.G(this.Qa);var b=this.a.opacity;Mc(b)||(b=0);this.o&&this.o.stop();var c=null;(this.o=c=a?Jn(this,b,1):Jn(this,b,0))&&c.start()}};W.prototype.setVisibility=W.prototype.G;
W.prototype.vd=function(a){this.opacity=a;if(this.a){this.a.opacity=a;for(var b=0;b<this.a.ea.length;b++)this.a.ea[b].opacity=a}};W.prototype.setOpacity=W.prototype.vd;W.prototype.dd=function(a){this.ie=a;if(this.a){this.a.ie=a;for(var b=0;b<this.a.ea.length;b++)this.a.ea[b].ie=a}};W.prototype.setForcedOpacity=W.prototype.dd;W.prototype.Sm=function(){this.ie=null;if(this.a){this.a.ie=null;for(var a=0;a<this.a.ea.length;a++)this.a.ea[a].ie=null}};W.prototype.clearForcedOpacity=W.prototype.Sm;
W.prototype.sk=function(){this.p&&this.p!==this.c&&pe(this.p);this.p=this.c};W.prototype.saveCurrentModel=W.prototype.sk;W.prototype.On=function(a,b){this.v();var c;if(c=a)a:{c=this.b;for(var d=this.b.length-1;0<=d;){if(a==c[d].qb()){c=c[d];break a}d--}c=null}return c?(this.d&&(this.v(),this.cd()),this.d=b,!0):!1};W.prototype.setVideoMarker=W.prototype.On;W.prototype.cd=function(){this.d=null;this.v()};W.prototype.removeVideo=W.prototype.cd;
W.prototype.Jk=function(){if(this.d&&this.a&&this.Ka){this.Ka.re(0,this.d,{he:!1});var a=this.ca.a.f;if(a)return a.u(),!0}return!1};W.prototype.updateVideoFrame=W.prototype.Jk;W.prototype.Rn=function(){this.d&&(this.e||(this.e=Kn(this)),this.e&&!this.e.qa&&(this.e.start(),this.ca.s()))};W.prototype.startPlayback=W.prototype.Rn;W.prototype.v=function(){this.e&&(this.e&&this.e.qa&&this.e.stop(),this.e=null)};W.prototype.stopPlayback=W.prototype.v;W.prototype.cn=function(){return this.d};
W.prototype.getCurrentVideo=W.prototype.cn;W.prototype.Nh=function(){return!!this.d};W.prototype.hasVideo=W.prototype.Nh;W.prototype.Tn=function(){var a=null!=this.d.error&&0<this.d.error.code;return this.d&&!this.d.paused&&this.d.currentTime<this.d.duration&&!a};W.prototype.videoIsRunning=W.prototype.Tn;function Kn(a){return new Eb(a.ca.a.f.l.i.Cj,a.a,function(){if(a.Nh()&&a.a&&a.Ka)a.Jk();else return a.v(),!1;return!0})}
function pn(a,b,c,d,e,f,g,h,k){this.selectedFace=a;this.width=b;this.distance=c;this.viewingAngle=d;this.maxDistance=e;this.distanceFactor=f;this.pixelFactor=g;this.minPixelWidth=void 0!=h&&null!=h?h:0;this.maxPixelWidth=void 0!=k&&null!=k?k:1E4;this.distanceScale=1}W.SurfaceInfo=pn;function In(a,b){this.Kj(a,b)}W.LayoutManager=In;In.prototype.Kj=function(a,b){this.width=a;this.height=b;this.markerRenderInfos=[]};In.prototype.setup=In.prototype.Kj;
In.prototype.a=function(a,b,c){this.markerRenderInfos.push(new Fn(a,b,c))};In.prototype.addSurfaceObject=In.prototype.a;In.prototype.b=function(){return this.markerRenderInfos};In.prototype.getMarkerRenderInfos=In.prototype.b;In.prototype.c=function(a){for(var b=0;b<this.markerRenderInfos.length;b++){var c=this.markerRenderInfos[b];if(c.a==a)return c.c}return null};In.prototype.getSrcRect=In.prototype.c;
In.prototype.d=function(a){for(var b=0;b<this.markerRenderInfos.length;b++){var c=this.markerRenderInfos[b];if(c.a==a)return c.b}return null};In.prototype.getDestRect=In.prototype.d;function Pn(){}W.SurfaceObject=Pn;Pn.prototype.b=function(){};Pn.prototype.detach=Pn.prototype.b;Pn.prototype.a=function(){};Pn.prototype.getMarkerSurface=Pn.prototype.a;Pn.prototype.We=function(){};Pn.prototype.setMarkerSurface=Pn.prototype.We;Pn.prototype.je=function(){};Pn.prototype.getClientObject=Pn.prototype.je;
function nn(a){this.rd=null;this.clientObject=a}W.UIObject=nn;nn.prototype.b=function(){this.rd&&this.rd.yi(this)};nn.prototype.detach=nn.prototype.b;nn.prototype.a=function(){return this.rd};nn.prototype.getMarkerSurface=nn.prototype.a;nn.prototype.We=function(a){this.rd=a};nn.prototype.setMarkerSurface=nn.prototype.We;nn.prototype.je=function(){return this.clientObject};nn.prototype.getClientObject=nn.prototype.je;nn.prototype.e=function(){return this.clientObject};nn.prototype.getUIObject=nn.prototype.e;
function mn(a){this.rd=null;this.marker=a;this.marker.Re=this;this.c=!1}W.Marker=mn;mn.prototype.b=function(){this.rd&&this.rd.yi(this)};mn.prototype.detach=mn.prototype.b;mn.prototype.a=function(){return this.rd};mn.prototype.getMarkerSurface=mn.prototype.a;mn.prototype.We=function(a){this.rd=a};mn.prototype.setMarkerSurface=mn.prototype.We;mn.prototype.je=function(){return this.marker?this.marker.lf:null};mn.prototype.getClientObject=mn.prototype.je;mn.prototype.qb=function(){return this.marker};
mn.prototype.getMarker=mn.prototype.qb;mn.prototype.e=function(){return this.c};mn.prototype.isOnSurface=mn.prototype.e;mn.prototype.d=function(a){this.c=a};mn.prototype.setIsOnSurface=mn.prototype.d;function kn(a,b,c,d){try{a.renderMarker(b,c,d)}catch(e){}}function qn(a,b){try{return a.selectMarkerSurface(b)}catch(c){}}function rn(a,b,c,d){try{a.setupMarkerSurface(b,c,d)}catch(e){}}function on(a,b,c,d,e,f){try{a.updateMarkerInSurface(b,c,d,e,f)}catch(g){}}
function jn(a,b){try{return a.computeGraphicsHash(b)}catch(c){}};function Qn(){}T.ClientHandler=Qn;Qn.prototype.Ac=function(){};Qn.prototype.shutdown=Qn.prototype.Ac;Qn.prototype.Fp=function(){};Qn.prototype.renderMarker=Qn.prototype.Fp;Qn.prototype.Jp=function(){};Qn.prototype.selectMarkerSurface=Qn.prototype.Jp;Qn.prototype.Xn=function(){};Qn.prototype.setupMarkerSurface=Qn.prototype.Xn;Qn.prototype.Vp=function(){};Qn.prototype.updateMarkerInSurface=Qn.prototype.Vp;Qn.prototype.Ko=function(){};Qn.prototype.computeGraphicsHash=Qn.prototype.Ko;function Rn(a){this.ca=a}T.SimpleClientHandler=Rn;Rn.distanceScale=0.01;Rn.prototype.Ac=function(){this.ca=null};Rn.prototype.shutdown=Rn.prototype.Ac;p=Rn.prototype;p.vh=function(a,b){var c=document.createElement("canvas"),d=c.getContext("2d");c.width=a;c.height=b;d.clearRect(0,0,a,b);return c.getContext("2d")};
function Sn(a,b){var c=a.vh(64,64);c.save();c.strokeStyle="rgb(255, 0, 0)";c.fillStyle="rgb(100, 0, 100)";c.strokeRect(0,0,64,64);c.fillRect(2,2,60,60);c.fillStyle="rgb(255, 0, 0)";c.font='18pt "sans serif"';c.fillText("ERR",1,27);c.fillStyle="rgb(0,0,0)";c.restore();c=c.getImageData(0,0,64,64);b&&Tn(c);return a.ca.Zl(c,null,64,64,32,63,1,1,50,2E3)}
function Un(a,b,c,d){var e=0.5*c.width,f=c.height-1;0<b.di()&&(f=e=0);b=a.vh(c.width,c.height);b.save();b.clearRect(0,0,c.width,c.height);b.drawImage(c,0,0,c.width,c.height,0,0,c.width,c.height);b.restore();b=b.getImageData(0,0,c.width,c.height);d&&Tn(b);return a.ca.Zl(b,null,c.width,c.height,e,f,1,1,50,2E3)}function Tn(a){a=a.data;for(var b=0;b<a.length;b+=4)a[b]+=40,a[b+1]+=40,a[b+2]+=40}
p.Fp=function(a,b){var c=a.lf,d=this.ca,e=this;if(c.iconImage){var f=Un(this,a,c.iconImage,c.hilighted);b(c,f)}else c.iconImageFailure?(f=Sn(this,c.hilighted),b(c,f)):c.iconUrl&&(c.iconImageLoading=!0,Vn(Wn(),c.iconUrl,function(f,h){c.iconImageLoading=!1;if(h.Ub()){c.iconImage=f;var k=Un(e,a,c.iconImage,c.hilighted);b(c,k);c.showOnCreate&&d.lh(a,"number"===typeof c.showAnimTime?c.showAnimTime:void 0)}else c.iconImageFailure=!0,k=Sn(e,c.hilighted),b(c,k)}))};
function Xn(a,b,c,d,e){var f=b.marker.lf;a.save();a.clearRect(c.x,c.y,c.w,c.h);f.lp&&Yn(b,f,d,e);f.mi?a.drawImage(f.mi,0,0,f.mi.width,f.mi.height,c.x,c.y,c.w,c.h):f.Hm?(a.fillStyle="rgb(100, 0, 100)",a.fillRect(c.x,c.y,c.w,c.h),a.fillStyle="rgb(255, 255, 255)",a.font='18pt "sans serif"',a.fillText("ERR",c.x+8,c.y+15)):(a.fillStyle="rgb(100, 100, 100)",a.fillRect(c.x,c.y,c.w,c.h),a.strokeStyle="rgb(255, 255, 255)",a.strokeRect(c.x,c.y,c.w,c.h));f.Jt&&(b=a.getImageData(c.x,c.y,c.w,c.h),Tn(b),a.putImageData(b,
0,0));a.restore()}function Yn(a,b,c,d){if(b.lp&&!b.mi&&!b.kp&&!b.Hm){var e=Wn(),f=!0;b.kp=!0;Vn(e,b.lp,function(e,h){b.kp=!1;h.Ub()?(b.mi=e,b.Hm=!1,f||c(a)):(b.mi=null,b.Hm=!0,f||d(a))});f=!1}}p.Jp=function(a){var b=this.ca,c=b.cp(a,1,150,Rn.distanceScale,50,2E3);return c?(a.uk(b,c,1*c.distanceFactor,1*c.distanceFactor,3,!1,{}),!0):!1};
p.Xn=function(a,b,c){var d=a.xa();if(0!=d.length&&d[0]){var e=this,f=1,g=1,h=c=1,g=f=64,h=c=72;a.Ek([0.3,0.3,0.3,0.5]);var k=a.Fk(c,h,f,g,!0),l=document.createElement("canvas");l.width=f;l.height=g;l=l.getContext("2d");l.clearRect(0,0,f,g);var m=new yn(0,0,64,64),n=new yn(4,4,64,64),d=d[0];Xn(l,d,m,function(a){e.ca.In(a)},function(a){e.ca.In(a)});k.a(d,m,n);d=l.getImageData(0,0,f,g);a.G(!0);b(a,d,c,h)}else c(a)};p.Vp=function(a,b,c,d,e){e(a)};p.Ko=function(a){return a.ID.toString()+a.hilighted.toString()};function Zn(a,b){a.Eb=this.p;q.call(this,a);this.a=this.g=this.c=0;this.q=b;this.e=b.N()}ha(Zn,q);Zn.prototype.p=function(){};Zn.prototype.t=function(){this.e=this.q=null;q.prototype.t.call(this)};function $n(a,b){Zn.call(this,a,b)}ha($n,Zn);$n.prototype.Mc=function(a,b){this.g=a||0;this.c=b||this.e.ia();this.a=this.g-this.c};$n.prototype.p=function(a){this.e.Cb(this.c+a*this.a);this.q.u()};function ao(a,b){Zn.call(this,a,b)}ha(ao,Zn);
ao.prototype.Mc=function(a,b){this.g=a||0;this.c=b||this.e.fa();this.a=this.g-this.c;180<this.a?this.a=-(360-this.a):-180>this.a&&(this.a=360+this.a)};ao.prototype.p=function(a){this.e.sb(this.c+a*this.a);this.q.u()};function bo(a,b){Zn.call(this,a,b)}ha(bo,Zn);bo.prototype.Mc=function(a,b){this.g=a||115;this.c=b||this.e.ka();this.a=this.g-this.c};bo.prototype.p=function(a){this.e.Ja(this.c+a*this.a);this.q.u()};function co(a,b){Zn.call(this,a,b);this.c=[0,0,0];this.g=[0,0,0];this.a=[0,0,0]}
ha(co,Zn);co.prototype.Mc=function(a,b){this.c=b||this.e.Ua().get();this.g=a;this.a=z.sub(this.g,this.c)};co.prototype.p=function(a){a=z.add(this.c,z.scale(this.a,a));Xa(this.e,Ga([a[0],a[1],a[2]]));this.q.u()};function eo(a,b,c){var d=a.l.l;this.q=a;this.p=b;this.o=c;this.d=new $n({duration:500,rc:Ba},a);this.n=new ao({duration:500,rc:Ba},a);this.c=new bo({duration:500,rc:Ba},a);this.e=new co({duration:500,rc:Aa},a);this.s=new co({duration:500,rc:Ba},a);this.v=new ua({i:[this.d,this.c,this.s]});this.j=new ua({i:[this.d,this.n,this.c,this.e],td:this.Cq.bind(this),Sb:this.ao.bind(this)});this.g=new zb({i:[this.e,this.v],td:this.Bq.bind(this),Sb:this.$n.bind(this)});d.add(this.j);d.add(this.g);this.a=this.b=
null}p=eo.prototype;p.kd=function(a,b){this.b=null;b&&(this.b=b);if(ib)(a||0===a)&&this.q.N().sb(a),this.ao();else{this.d.Mc(-90);a||0===a||(a=this.q.N().fa());this.n.Mc(a);this.c.Mc();var c=Ej(this.q.k.r);this.e.Mc([c[0],c[1],c[2]+52],c);this.j.start()}};
p.gb=function(a,b){var c=Ej(this.q.k.r);if(!c)return!1;this.a=null;b&&(this.a=b);(a||0===a)&&this.q.N().sb(a);if(ib)this.$n();else{this.d.Mc(0,-90);this.c.Mc();var d=[c[0],c[1],c[2]+15];this.e.Mc(d,[c[0],c[1],c[2]+52]);this.s.Mc(c,d);this.q.N().Cb(-90);this.g.start()}};p.Cq=function(){this.q.k.Lc(!0);this.p()};p.ao=function(){this.o();this.b&&(Tc(this.b),this.b=null)};p.Bq=function(){this.q.k.Lc(!0);this.p()};p.$n=function(){this.q.k.Lc(!1);this.o();this.a&&(Tc(this.a),this.a=null)};
p.Ac=function(){for(var a in this)this.hasOwnProperty(a)&&(this[a]=null);return!0};function fo(a,b,c){var d=c||[];c=a.prototype;var e=void 0,f=Array.isArray(d)&&0<d.length,e=function(a){var b=!1;f&&(b=b||0<=d.indexOf(a));b=(b=(b=b||4>a.length)||0==a.indexOf("_"))||a.lastIndexOf("_")==a.length-1;return!b},g=new go;ho(io(),g);jo(c,b,e);jo(a,"<static> "+b,e);a.Rp=function(){var a=ko(g.b,arguments,"<constructor> "+b,void 0);g.log(a,0)};a.Sp=function(){lo(g,arguments,"<constructor> "+b)};a.ms=function(){lo(g,arguments,"<constructor> "+b)}}
function jo(a,b,c){a:if(io(),a){if("function"===typeof a){mo(a,b,c);a=no(a,b);break a}if("object"===typeof a){a=mo(a,b,c);break a}throw Error("invalid args");}return a}function oo(a){this.b=a||new po}function lo(a,b,c,d){var e=a.b;c=c||"<unnamed>";var f=[];f.push("\u2190");var g="";d&&(g=g+d+".");g+=c;g+=" returned ";f.push(g);f.push(qo(e,b));a.log(f,1)}oo.prototype.log=function(a){window.console.log.apply(window.console,a)};function ro(){this.b=!0;this.a=new oo}
ro.prototype.enable=function(a){this.b=a};function ho(a,b){a.a=b}function no(a,b,c){function d(){return so.call(this,a,arguments,b,c)}if(a&&"function"===typeof a.ns)return a;d.ns=a;return d}function mo(a,b,c){for(var d in a){var e=a[d];if("function"===typeof e){var f=!0;c&&(f=c(d,e));f&&(a[d]=no(e,d,b?b:void 0))}}return a}function io(){to||(to=new ro);return to}
function so(a,b,c,d){var e=io(),f=e.a;if(e.b&&f){var e=f,g=ko(e.b,b,c,d);e.log(g,0);try{var h=a.apply(this,b);lo(f,h,c,d);return h}catch(k){var h=k,e=d,g=c||"<unnamed>",l=[];l.push("\u2217");e&&l.push(e+".");l.push(g);l.push("thrown");l.push(String(h));f.log(l,1);throw k;}}else return a.apply(this,arguments)}var to=null;function po(){}
function ko(a,b,c,d){var e=[],f="";d&&(f=f+d+".");f+=c||"<unnamed>";f+="(";e.push(f);if(0<b.length)for(e=e.concat(uo(a,b[0])),c=1,d=b.length;c<d;++c)e.push(","),e=e.concat(uo(a,b[c]));e.push(")");return e}function uo(a,b){var c=[];c.push(qo(a,b));return c}
function qo(a,b){var c="";if(Array.isArray(b)){c+="[";if(0<b.length)for(var c=c+qo(a,b[0]),d=1,e=b.length;d<e;++d)c+=", ",c+=qo(a,b[d]);return c+"]"}if(Oc(b)){var f;a:{d=b.toString();e=d.indexOf("(");if(0<=e){e+=1;f=d.indexOf(")",e);if(0>f)throw Error("invalid function");d=d.substr(e,f-e);if(d=d.replace(/\s+/g,"")){f=d.split(",");break a}}else throw Error("invalid function");f=[]}c+="function(";if(0<f.length)for(c+=f[0],d=1,e=f.length;d<e;++d)c+=", ",c+=f[d];return c+=")"}return Nc(b)?(c+='"',c+=
b,c+='"'):Mc(b)?(d=Math.pow(10,4),c+=Math.round(b*d)/d):a.a(b)}po.prototype.a=function(a){return String(a)};function vo(){}vo.prototype=Object.create(po.prototype);vo.prototype.a=function(a){return a};function go(a,b){oo.call(this);this.a=a||window.console;this.c=new Date;if(!Oc(this.a.log))throw Error("invalid console");this.d=window.console.groupCollapsed||window.console.group;this.b=b||new vo}go.prototype=Object.create(oo.prototype);
go.prototype.log=function(a,b){a[0]=Sc(new Date-this.c,8)+": "+a[0];E(b)?this.a.log.apply(this.a,a):0==b?this.d.apply(this.a,a):(this.a.log.apply(this.a,a),this.a.groupEnd())};Object.create(oo.prototype);Object.create(oo.prototype);function wo(a){this.type="povanimation";this.target=null;this.state=a}function xo(a){this.type="statechanged";this.target=null;this.state=a}function yo(a,b){this.type="povchanged";this.target=null;this.flags=a;this.isFinal=b};function zo(a,b,c,d){return{position:a,heading:b||0,pitch:c||0,distance:d||0}};function Ao(a,b,c,d,e,f,g,h,k,l){this.Rb=a;this.index=b;this.id=c;this.origin=d;this.b=e;this.ta=new Bo(e);this.uj=g;this.ve=h;this.jf=k;this.distance=l;return this}Ao.prototype.ib=function(){return Ra(this.ta)};Ao.prototype.eb=function(){return Ra(this.ta)};function Ej(a){return a.ta.get()}function Co(a,b){this.Rb=a;this.index=Array(b);this.id=Array(b);this.origin=Array(b);this.Me=Array(b);this.Ve=Array(b);this.a=Array(b);this.b=Array(b);this.ve=Array(b);this.jf=Array(b)}p=Co.prototype;
p.set=function(a,b,c,d,e,f,g,h){this.index[a]=a;this.id[a]=b;this.origin[a]=c;this.Me[a]=d;this.Ve[a]=e;this.a[a]=[d[0]*u,d[1]*u,d[2]];this.b[a]=f;this.ve[a]=g;this.jf[a]=h};p.yk=function(a){for(var b=0,c=this.id.length,d=-1;b<c;b++)if(this.id[b]==a){d=b;break}return 0>d?null:new Ao(this.Rb,this.index[d],this.id[d],this.origin[d],this.Me[d],0,this.b[d],this.ve[d],this.jf[d])};p.ib=function(){return this.Ve};
p.xk=function(a,b,c){b=b||500;c=c||0;a=[a[0]*u,a[1]*u];for(var d=0,e=this.index.length,f=this.a,g=[];d<e;d++){var h=Do(f[d],a);h>=c&&h<=b&&(h=new Ao(this.Rb,this.index[d],this.id[d],this.origin[d],this.Me[d],0,this.b[d],this.ve[d],this.jf[d],h),g.push(h))}return g};p.vj=function(a,b){for(var c=[a[0]*u,a[1]*u],d=0,e=this.index.length,f=this.a;d<e;d++)if(Do(f[d],c)<=b)return!0;return!1};
p.pm=function(a,b,c,d){var e=0,f=this.index.length,g=[],h=this.a;for(a=[a[0]*u,a[1]*u,a[2]];e<f;e++){var k,l=h[e],m=a;k=d;var n=Do(l,m);2<l.length&&2<m.length&&!E(l[2])&&!E(m[2])&&0!=l[2]&&0!=m[2]&&(l=Math.abs(m[2]-l[2]),n=Math.sqrt(n*n+(E(k)?1:k)*l*l));k=n;k>=c&&k<=b&&(k=new Ao(this.Rb,this.index[e],this.id[e],this.origin[e],this.Me[e],0,this.b[e],this.ve[e],this.jf[e],k),g.push(k))}return g};function Eo(a){var b={};b.id=a.id;b.position=Wj(Ej(a));b.uj=a.uj;return b};function Fo(){if("crossOrigin"in new Image)return!0;if(0==(navigator.vendor||"unknown").indexOf("Apple Computer")){var a=navigator.userAgent,b=a.indexOf("Version");if(-1<b)return 6<=parseFloat(a.substring(b+7+1))}return!1}da("H.PanoramaUtil.checkCORSTextureSupport",Fo);var Go=void 0;
function Ho(){if(void 0!==Go)return Go?!0:!1;a:{var a=null,b=["webgl","experimental-webgl","moz-webgl","webkit-3d"],c=document.createElement("canvas");try{for(var d=0,e=b.length;d<e&&!(a=c.getContext(b[d]));d++);}catch(f){Go=!1;break a}Go=null===a||void 0===a?!1:!0}return Go?!0:!1}da("H.PanoramaUtil.checkWebGl",Ho);da("H.PanoramaUtil.getLibraryVersion",function(){return"1.0.3.0"});da("H.PanoramaUtil.getLibraryRevision",function(){return"daa8704f24b4f4c93aab5bf9a234bc286aee10f0"});
da("H.PanoramaUtil.getLibraryBuildTime",function(){return"2014-07-10_16-38-44"});da("H.PanoramaUtil.prefetchImages",function(a){pk(a);Io(a)});da("H.PanoramaUtil.prefetchPanorama",function(a){nk(a,1);a=a.uj;pk(a);Io(a)});da("H.PanoramaUtil.getRequestStatistic",function(){return Jo});function Ko(a,b){this.Hp=a;this.m=[];this.a=[];this.Y=b}Ko.prototype.clear=function(){this.m=[];this.a=[]};Ko.prototype.Ol=function(a,b){this.m.push(a);this.a.push(b)};function Lo(){this.kb=Mo;this.Di=this.color=null;this.width=1;this.Tb=[];this.Y=null}var Mo=pa();function No(a,b){var c=new Ko(a,b);a.Tb.push(c);return c}function Oo(a,b,c){a.color=b?b:null;a.Di=c?c:null}Lo.prototype.clear=function(){this.Tb=[]};function Po(a){this.tb={};this.cn=a}Po.prototype.M=function(a,b,c){if(b){var d=this.tb;a=Qo(a,c);if(!d[a])d[a]=[];else if(0<=d[a].indexOf(b))return;d[a].push(b)}};Po.prototype.Rc=function(a,b,c){var d=this.tb;a=Qo(a,c);d[a]&&(b=d[a].indexOf(b),0>b||d[a].splice(b,1))};Po.prototype.dispatchEvent=function(a,b){var c=a.type;if(!c)return!1;var d=this.tb,c=Qo(c,!1);if(!d[c])return!1;a.target=this;b||this.cn?d[c].forEach(function(b){b(a)}):d[c].forEach(function(b){Tc(function(){b(a)})});return!0};
function Qo(a,b){return(a+(b?"_capture":"_bubble")).toLowerCase()};var Ro={b:0,d:1,LOADING:3,c:4,ERROR:5,a:6},So=0;function To(a,b){this.b=a;this.d=b;this.a=0;this.ga=++So;this.e=!1}p=To.prototype;p.toString=function(){return"DataRequestProxy: id="+this.ga+" status="+this.a};p.lj=function(){return this.b};p.Om=function(){return!0};p.Ne=function(){return this.b.Ne()};p.xb=function(){return this.b.xb()};p.mj=function(){return this.b.mj()};p.Np=function(){};p.Da=function(){return this.ga};p.ii=function(){return this.a};
p.cancel=function(){var a=this.lj().ra;void 0===a||1!=this.a&&3!=this.a||(a.kk(this),this.a=6)};p.Ub=function(){return 4==this.a};p.ad=function(a){this.e=!0;this.lj().ad(a)};p.Bj=function(){this.a=1};p.Pk=function(){this.a=3};p.kg=function(a){this.a=4;this.d(a,this)};p.ti=function(a){this.a=Ro.ERROR;this.c=a;this.d(a,this)};function Uo(a,b,c){this.ga=++So;this.b=a;this.d=b;this.a=0;this.ra=c;this.$b=[]}p=Uo.prototype;p.Ne=function(){return this.d};p.xb=function(){return this.b};p.mj=function(){return this.c};
p.Np=function(a){this.c=a};p.Da=function(){return this.ga};p.ii=function(){return this.a};p.toString=function(){return"DataRequestImpl: id="+this.ga+" status="+this.a+" "+this.b};p.Ub=function(){return 4==this.a};p.cancel=function(){void 0===this.ra||1!=this.a&&3!=this.a||(this.ra.kk(this),this.a=6)};p.Bj=function(){this.a=1;for(var a=0;a<this.$b.length;a++)this.$b[a].Bj()};p.Pk=function(){this.a=3;for(var a=0;a<this.$b.length;a++)this.$b[a].Pk()};p.kg=function(a){this.a=4;for(var b=0;b<this.$b.length;b++)this.$b[b].kg(a)};
p.ti=function(a){this.a=Ro.ERROR;this.c=a;for(var b=0;b<this.$b.length;b++)this.$b[b].ti(a)};p.lj=function(){return null};p.Om=function(){return!1};p.ad=function(a){var b=this.ra;if(b){for(var c=!0,d=0;d<this.$b.length;d++)if(!this.$b[d].e){c=!1;break}c&&b.ad(a)}};function Vo(a,b){this.a={};this.b=0;this.c=b;this.d=a}var Wo=pa();Wo.isEnabled=!1;var Xo=[];Vo.prototype.kb=Wo;var Jo={total:{requests:0,failed:0,canceled:0,succeeded:0,timeOut:0},image:{requests:0,succeeded:0,failed:0,canceled:0,timeOut:0},xmlHttp:{requests:0,succeeded:0,failed:0,canceled:0,timeOut:0}};function Yo(a){return a}Vo.prototype.U=function(){for(;this.b<this.d;){var a=this.c();if(a)switch(a.Hr=this,a.Ne()){case 2:Zo(this,a);break;case 0:case 1:case 4:case 5:$o(this,a)}else break}};
Vo.prototype.kk=function(a){if(a.Om()){var b=a.lj();b.$b.splice(b.$b.indexOf(a),1);0==b.$b.length&&(ap(this,b),Jo.total.canceled++)}else ap(this,a),Jo.total.canceled++};function ap(a,b){var c=b.Ne(),d=a.a[b.Da()].Cr;if(3==b.status)switch(c){case 2:Jo.image.canceled++;d.onload=d.onerror=null;a.ad(d);break;case 0:case 1:case 4:case 5:Jo.xmlHttp.canceled++,d.onreadystatechange=null,d.abort()}else switch(c){case 2:Jo.image.canceled++,d.onload=d.onerror=null,a.ad(d)}bp(a,b)}
Vo.prototype.ad=function(a){a.removeAttribute("src");Xo.push(a)};
function Zo(a,b){var c=!1,d=Yo(b.xb()),e=0==Xo.length?new Image:Xo.pop();0!=d.indexOf("data:")&&(e.crossOrigin="");e.onload=e.onerror=function(d){e.onload=e.onerror=null;bp(a,b);(c="load"===d.type)?(b.kg(e),Jo.total.succeeded++,Jo.image.succeeded++):(a.ad(e),b.ti("cannot load image"),Jo.image.failed++)};b.Pk();cp(a,b,e);e.src=d;c||(e.complete?(console.log(e.src),e.onload=e.onerror=null,bp(a,b),b.kg(e)):(Jo.total.requests++,Jo.image.requests++))}
function $o(a,b){var c=new XMLHttpRequest;c.open("GET",Yo(b.xb()),!0);switch(b.Ne()){case 2:case 1:c.responseType="arraybuffer";break;case 5:c.responseType="blob";break;case 4:c.overrideMimeType("text/xml")}var d=!1;c.onreadystatechange=function(){if(4==c.readyState&&!d)if(d=!0,bp(a,b),200<=c.status&&300>c.status||304===c.status)if(204==c.status)b.Np("no content"),b.kg(null),Jo.xmlHttp.failed++,Jo.total.failed++;else switch(Jo.xmlHttp.succeeded++,Jo.total.succeeded++,b.Ne()){case 2:case 1:case 5:b.kg(c.response);
break;case 4:b.kg(c.responseXML);break;default:b.kg(c.responseText)}else""==c.statusText?b.ti(c.status+" cannot load data"):b.ti(c.status+" "+c.statusText),Jo.xmlHttp.failed++,Jo.total.failed++,408==c.status&&(Jo.xmlHttp.timeOut++,Jo.total.timeOut++)};b.Pk();cp(a,b,c);Jo.total.requests++;Jo.xmlHttp.requests++;try{b.Qp&&(c.timeout=b.Qp),c.send(null)}catch(e){d||bp(a,b),b.ti(e.name+" "+e.message),Jo.xmlHttp.failed++,Jo.total.failed++}}function cp(a,b,c){a.b++;a.a[b.Da()]={Cr:c,Th:b}}
function bp(a,b){a.b--;delete a.a[b.Da()];b.Hr=void 0;a.U()};function dp(a){this.a=[];this.c=Fo();this.d=this.e.bind(this);this.b=new Vo(a,this.d)}var ep=null,fp=pa();fp.isEnabled=!1;dp.prototype.kb=fp;function Wn(){ep||(ep=new dp(18));return ep}dp.prototype.ad=function(a){this.b.ad(a)};dp.prototype.t=function(){this.clear();ep=this.b=this.d=null};dp.deleteInstance=function(){ep&&(ep.t(),ep=null)};dp.prototype.e=function(){return 0<this.a.length?this.a.shift():null};dp.prototype.clear=function(){for(;0<this.a.length;)this.a.pop().cancel()};
function Vn(a,b,c){if(!a.c){var d=c;c=function(a,b){var c;if(b.Ub()){var e=window.URL.createObjectURL(a);c=0==Xo.length?new Image:Xo.pop();c.onload=c.onerror=function(){c.onload=c.onerror=null;d(c,b);window.URL.revokeObjectURL(e)};c.src=e}}}var e=gp(a,b,2);if(e)return hp(e,c);b=a.c?new Uo(b,2,a):new Uo(b,5,a);a.a.push(b);b.Bj();c=hp(b,c);a.b.U();return c}function ip(a,b,c){var d=gp(a,b,0);d?hp(d,c):(b=new Uo(b,0,a),a.a.push(b),b.Bj(),hp(b,c),a.b.U())}
function jp(a,b,c,d){var e=gp(a,b,1);e?hp(e,c):(b=new Uo(b,1,a),b.Qp=d||void 0,a.a.push(b),b.Bj(),hp(b,c),a.b.U())}dp.prototype.kk=function(a){if(1!=a.ii())this.b&&this.b.kk(a);else if(a.Om()){var b=a.lj(),c=this.a.indexOf(b);0<=c&&(b.$b.splice(b.$b.indexOf(a),1),0==b.$b.length&&this.a.splice(c,1))}else c=this.a.indexOf(a),0<=c&&this.a.splice(c,1)};function hp(a,b){var c=new To(a,b);a.$b.push(c);c.a=a.a;return c}
function gp(a,b,c){for(var d=0;d<a.a.length;d++){var e=a.a[d];if(e.xb()==b&&e.Ne()==c)return e}if(a.b)a:{a=a.b;for(var f in a.a)if(d=a.a[f].Th,d.xb()==b&&d.Ne()==c){b=d;break a}b=null}else b=null;return b};function Oe(){}p=Oe.prototype;p.Da=function(){};p.Vg=function(){};p.Am=function(){};p.oj=function(){};p.Ck=function(){};p.$l=function(){};p.Ob=function(){};p.Je=function(){};p.nf=function(){};p.createTexture=function(){};p.Yf=function(){};function kp(a,b,c){var d=z.create();if(a instanceof kp)Be.call(this,a),this.width=a.width,this.height=a.height,this.depth=a.depth,this.min=z.A(a.min),this.max=z.A(a.max);else if(a instanceof lp){b=b||Qb;if(Ub(b.size))this.depth=this.height=this.width=b.size,this.min=z.create(),this.max=z.create(),mp(this.width,this.height,this.depth,this.min,this.max),z.set(0,0,0,d);else if(Ub(b.width)&&Ub(b.height)&&Ub(b.depth))this.width=b.width,this.height=b.height,this.depth=b.depth,this.min=z.create(),this.max=
z.create(),mp(this.width,this.height,this.depth,this.min,this.max),z.set(0,0,0,d);else if(Wc(b.min)&&Wc(b.max)){var e=b.min[0],f=b.min[1],g=b.min[2],h=b.max[0],k=b.max[1],l=b.max[2];this.width=h-e;this.height=k-f;this.depth=l-g;this.min=z.create();this.max=z.create();mp(this.width,this.height,this.depth,this.min,this.max);z.set(0.5*(e+h),0.5*(f+k),0.5*(g+l),d)}g=this.width;h=this.height;k=this.depth;e=b.Uo;null==np&&(np=new Me({position:new Le(7,3,0),texcoord:new Le(7,2,12),normal:new Le(7,3,20)}));
var f=new qf(np),g=0.5*g,h=0.5*h,k=0.5*k,l=e?-1:1,m,n,r,s;m=tf(f,-g,-h,-k,0,0,-l,0,0);n=tf(f,-g,-h,+k,1,0,-l,0,0);r=tf(f,-g,+h,+k,1,1,-l,0,0);s=tf(f,-g,+h,-k,0,1,-l,0,0);e?wf(f,s,r,n,m):wf(f,m,n,r,s);m=tf(f,g,-h,+k,0,0,l,0,0);n=tf(f,g,-h,-k,1,0,l,0,0);r=tf(f,g,+h,-k,1,1,l,0,0);s=tf(f,g,+h,+k,0,1,l,0,0);e?wf(f,s,r,n,m):wf(f,m,n,r,s);m=tf(f,+g,-h,-k,0,0,0,0,l);n=tf(f,-g,-h,-k,1,0,0,0,l);r=tf(f,-g,+h,-k,1,1,0,0,l);s=tf(f,+g,+h,-k,0,1,0,0,l);e?wf(f,s,r,n,m):wf(f,m,n,r,s);m=tf(f,-g,-h,+k,0,0,0,0,-l);n=
tf(f,+g,-h,+k,1,0,0,0,-l);r=tf(f,+g,+h,+k,1,1,0,0,-l);s=tf(f,-g,+h,+k,0,1,0,0,-l);e?wf(f,s,r,n,m):wf(f,m,n,r,s);m=tf(f,-g,-h,-k,0,0,0,-l,0);n=tf(f,+g,-h,-k,1,0,0,-l,0);r=tf(f,+g,-h,+k,1,1,0,-l,0);s=tf(f,-g,-h,+k,0,1,0,-l,0);e?wf(f,s,r,n,m):wf(f,m,n,r,s);m=tf(f,-g,+h,+k,0,0,0,l,0);n=tf(f,+g,+h,+k,1,0,0,l,0);r=tf(f,+g,+h,-k,1,1,0,l,0);s=tf(f,-g,+h,-k,0,1,0,l,0);e?wf(f,s,r,n,m):wf(f,m,n,r,s);e=f.hb();a=new pd(a,e);Be.call(this,a,c);b.name&&this.fb(b.name);se(this,d)}}
function mp(a,b,c,d,e){a=0.5*a;b=0.5*b;c=0.5*c;z.set(-a,-b,-c,d);z.set(+a,+b,+c,e)}kp.prototype=Object.create(Be.prototype);kp.prototype.le=function(a){return 0<=jf(a,this.min,this.max)};kp.prototype.nl=function(a){return jf(a,this.min,this.max)};kp.prototype.sc=function(){this.a||(this.a=new hf(this.min,this.max));return this.a};var np=null;var op=[1,3,0,2,5,4];
function pp(a,b,c){if(a instanceof pp)kp.call(this,a);else if(a instanceof Oe){var d=b||Qb;b=K(d.size,1E3);a=a.oj();d={name:d.name,width:b,height:b,depth:b,Uo:!0};this.cf=0;this.ed=3;var e={},f=0.5*b;e[1]={origin:z.create(+f,+f,+f),Xh:z.create(0,-1,0),Yh:z.create(0,0,-1),min:P.create(+b,+b),max:P.create(0,0),face:1};e[3]={origin:z.create(-f,-f,+f),Xh:z.create(0,1,0),Yh:z.create(0,0,-1),min:P.create(0,+b),max:P.create(+b,0),face:3};e[0]={origin:z.create(-f,+f,+f),Xh:z.create(1,0,0),Yh:z.create(0,0,
-1),min:P.create(0,+b),max:P.create(+b,0),face:0};e[2]={origin:z.create(+f,-f,+f),Xh:z.create(-1,0,0),Yh:z.create(0,0,-1),min:P.create(+b,+b),max:P.create(0,0),face:2};e[5]={origin:z.create(-f,-f,+f),Xh:z.create(1,0,0),Yh:z.create(0,1,0),min:P.create(0,0),max:P.create(+b,+b),face:5};e[4]={origin:z.create(-f,+f,-f),Xh:z.create(1,0,0),Yh:z.create(0,-1,0),min:P.create(0,+b),max:P.create(+b,0),face:4};this.b=e;this.da=b;kp.call(this,a,d,c);this.fb("panoramaCube");je(this,Mg)}}pp.prototype=Object.create(kp.prototype);
pp.prototype.od=function(){return this.da};pp.prototype.sg=function(a,b){var c=this.b,d;for(d in c)qp(this,a,c[d].face,0,0,0,b)};
function qp(a,b,c,d,e,f,g){if(!(d<a.cf||d>a.ed)){var h=1<<d;if(!(0>e||e>=h||0>f||f>=h)){var k=a.b[c],l=k.Xh,m=k.Yh,n=1/h,r=(k.max[0]-k.min[0])*n,s=(k.max[1]-k.min[1])*n,h=k.min[0]*n+e*Math.abs(r),n=k.min[1]*n+f*Math.abs(s),r=h+r,s=n+s,t=z.A(k.origin);z.cb(t,l,h,t);z.cb(t,m,n,t);k=z.A(k.origin);z.cb(k,l,r,k);z.cb(k,m,s,k);!rp(b,t,k)&&g(c,d,e,f)&&(d+=1,e*=2,f*=2,l=e+1,m=f+1,qp(a,b,c,d,e,f,g),qp(a,b,c,d,l,f,g),qp(a,b,c,d,e,m,g),qp(a,b,c,d,l,m,g))}}}
function rp(a,b,c){return ee(a,function(a){if(0>Rd(a,b[0],b[1],b[2],c[0],c[1],c[2]))return!0})};function sp(){}var Tk="",Uk="",Vk=!1,Wk={};function tp(a,b,c,d,e){var f=new sp;f.dataType=a;f.me=b;f.a=[c,d];void 0!=e&&(f.a[2]=e);switch(a){case 8:case 9:case 10:case 6:f.F=up(b,c,d,256);break;case 4:a=1<<b;d=Math.floor((d/360+0.5)*a);c=Math.floor((Math.log(Math.tan((90+c)*ic))*gc+1)*a*0.5);f.F=[b,d,a-1-c];break;case 0:case 1:case 2:case 5:a=1<<b,d=Math.floor((d/360+0.5)*a),c=Math.floor((Math.log(Math.tan((90+c)*ic))*gc+1)*a*0.5),f.F=[b,d,c]}return f}
function vp(a,b){var c=new sp;c.dataType=a;c.me=b[0];c.F=b;return c}function wp(a){"/"!=a.substr(-1)&&(a+="/");xp=a}var bl="http://sli.data.here.com/metacells/",xp="http://1.pano.maps.api.here.com/maptile/2.1/rcdistonlytile/newest/normal.day/";function yp(a,b){var c="?";Tk.length&&Uk.length&&(a+=c+"app_id="+Tk+"&app_code="+Uk,c="&");if(b)for(var d in Wk)a+=c+d+"="+Wk[d];return a=Vk?a.replace("http://","https://"):a.replace("https://","http://")}var Gk=!0;
function zp(a,b){if(!Gk)return b;if(0==b.indexOf("http://1.")||0==b.indexOf("https://1.")){var c=b.substr(0,b.indexOf("//")+2);b=b.substr(b.indexOf(".")+1);c=4>a.F[0]?c+"1.":8>a.F[0]?c+"2.":12>a.F[0]?c+"3.":c+"4.";b=c+b}return b}
sp.prototype.xb=function(){switch(this.dataType){case 4:var a="http://1.3dac.maps.data.here.com/data/sl/"+Ap(this.F[0],this.F[1],this.F[2])+"road-geometry-"+this.F[0]+"-"+Zb(this.F[1],5)+"-"+Zb(this.F[2],5)+".csgz";return yp(a,!1);case 0:return"http://maps3d.svc.nokia.com/data4/"+Ap(this.F[0],this.F[2],this.F[1])+"map_"+this.F[0]+"_"+this.F[2]+"_"+this.F[1]+".n3m";case 5:return a=Bp(17,this.a[0],this.a[1]),a=bl+a.substr(0,2)+"/"+a.substr(2,3)+"/"+a.substr(5,3)+"/"+a+"bin.cstgz",yp(a,!0);case 8:return a=
zp(this,"http://1.sli.data.here.com/cov-img/"),a=a+Cp(this.F[0],this.F[1],this.F[2])+"cov_z"+this.F[0]+"_c"+this.F[1]+"_r"+this.F[2]+".png",yp(a,!0);case 9:return a="http://navteq-maps-stg.ovi.com.edgesuite.net/cov-img/"+Cp(this.F[0],this.F[1],this.F[2])+"cov_z"+this.F[0]+"_c"+this.F[1]+"_r"+this.F[2]+".png";case 10:return a="http://navteq-maps-dev.ovi.com.edgesuite.net/cov-img/"+Cp(this.F[0],this.F[1],this.F[2])+"cov_z"+this.F[0]+"_c"+this.F[1]+"_r"+this.F[2]+".png";case 6:return a=zp(this,xp),a=
a+this.F[0]+"/"+this.F[1]+"/"+this.F[2]+"/256/png",yp(a,!1);default:return null}};function Ap(a,b,c){var d,e=Math.floor((302*a+1E3)/1E3);b=b.toString();b="0000000000".slice(0,e-b.length)+b;c=c.toString();c="0000000000".slice(0,e-c.length)+c;for(d=0;d<e-2;d+=2)a+="/",a+=b.charAt(d),a+=b.charAt(d+1),a+=c.charAt(d),a+=c.charAt(d+1);for(;d<e-1;d++)a+="/",a+=b.charAt(d),a+=c.charAt(d);return a+"/"}
function Cp(a,b,c){b=Zb(b.toString(),6);c=Zb(c.toString(),6);return Zb(a.toString(),2)+"/"+b.substr(0,3)+"/"+c.substr(0,3)+"/"+b.substr(3,2)+"/"+c.substr(3,2)+"/"}function up(a,b,c,d){d=d||256;var e=d<<18;c=Math.floor((c/360+0.5)*e);b=Math.floor((Math.log(Math.tan((90+b)*ic))*gc+1)*e*0.5);var f=18-a,g=c>>f,e=e-1-b>>f;return[a,Math.floor(g/d),Math.floor(e/d),g%d,e%d,c,b]}function Dp(a,b){return up(a,b[0],b[1],void 0)}
function Ep(a,b,c){a=1<<a;c=jc*c/a-fc;c=2*Math.atan(Math.exp(c));return[180*c/fc-90,jc*b/a*180/fc-180]}function Fp(a,b,c){a=1<<a;c=jc*(a-1-c)/a-fc;c=2*Math.atan(Math.exp(c));return[180*c/fc-90,jc*b/a*180/fc-180]}function Gp(a){return[rc*a[1]-90,rc*a[0]-180,0.001*(a[2]||0)]}function Bp(a,b,c){var d=1<<a;a=32-a;b=[qc*(b+90)>>>0,qc*(c+180)>>>0];return(d*((b[0]>>>a)+d)+(b[1]>>>a)).toString(10)}function Hp(a){return Ip([rc*(a[0]<<14)-90,rc*(a[1]<<14)-180,0])};function Jp(a,b,c){Po.call(this,!0);this.io=c||!1;this.zg=[];this.cf=a;this.ed=b;this.ko=new dp(24);this.Ch="";this.Qi=this.Bl();this.Ig={};this.fk=!0;this.ek=0;this.ar=this.a(this.cf);this.no=!1}var Kp;function Lp(a,b,c,d,e){var f=cl;a=a.split("/").slice(-6).join("/");0==f.toLowerCase().indexOf("metacell")&&(f="http://",Gk&&(f+=(0==c?1:d%2*2+e%2+2)+"."),f+="sli.data.here.com");f=""+f+"/";f+=a;f+="_r"+(c+8);f+="_f"+b;f+="_x"+d;f+="_y"+e;f+=".jpg";return f=yp(f,!0)}
function Io(a){Kp||(Kp=new kh(25));if(!Kp.get(a)){Kp.set(a,1);var b=Wn();op.forEach(function(c){c=Lp(a,c,0,0,0);Vn(b,c,function(){})})}}ca(Jp.prototype,Po.prototype);
ca(Jp.prototype,{d:function(){return this.Ch},e:function(){return this.cf},b:function(){return this.ed},cancel:function(){this.ko.clear();this.Qi=this.Bl()},c:function(a){this.Ch=a;this.Qi=this.Bl();this.fk=!0;this.ek=0;this.Ig={};for(var b in this.zg)a=this.zg[b],a.Th.ad(a.Im);this.zg.length=0;var c=this,d=this.cf,e=1<<d;op.forEach(function(a){for(var b=0;b<e;++b)for(var h=0;h<e;++h)c.qp(a,d,h,b)})},qp:function(a,b,c,d){var e=this.Ri(a,b,c,d);if(this.Ch&&!this.Rq(e)){var f=this,g=this.Ch,h=this.Qi,
k=Lp(g,a,b,c,d);this.Xq(e);this.Sq(k,function(e,k){k.Ub()||(e=null);if(!f.no)if(h!==f.Qi&&k.Ub())k.ad(e);else{var n={type:"TileReady",location:g,rp:h,status:e&&e.width&&e.height?!0:!1,face:a,me:b,x:c,y:d,Im:e,Th:k};f.io&&b==f.cf?f.zg.push(n):(f.yo(a,b,c,d),f.dispatchEvent(n));f.Oq(n)}})}},ad:function(a){a.Th.ad(a.Im)},g:function(a,b,c,d){return 0<=this.dp(a,b,c,d)},dp:function(a,b,c,d){a=this.Ri(a,b,c,d);a=this.Ig[a];return void 0!==a?a:-Infinity},Oq:function(a){if(!(a.me>this.cf)){var b=a.rp;if(!(b!==
this.Qi||this.no||(this.fk=this.fk&&a.status,this.ek+=1,this.ek<this.ar))){if(this.io){for(var c in this.zg)a=this.zg[c],this.yo(a.face,a.me,a.x,a.y),this.dispatchEvent(a);this.zg.length=0}this.dispatchEvent({type:"LocationReady",location:location,rp:b,status:this.fk})}}},yo:function(a,b,c,d){var e=this.Ri(a,b,c,d);this.Ig[e]=b;for(var f=Array(4);b>this.cf;){var g=b-1;c>>=1;d>>=1;for(var h=c<<1,k=d<<1,l=0;2>l;++l)for(var m=0;2>m;++m)e=this.Ri(a,b,h+m,k+l),f[m+2*l]=this.Ig[e];b=f[0];for(m=1;4>m;++m)if(b!=
f[m])return;if(void 0===b)break;e=this.Ri(a,g,c,d);this.Ig[e]=b;b=g}},Rq:function(a){return-1<=this.Ig[a]},Xq:function(a){this.Ig[a]=-1},Sq:function(a,b,c){return Vn(this.ko,a,function(a,e){b(a,e,c)})},a:function(a){return 6*(1<<(a<<1))},Ri:function(a,b,c,d){a=""+a+Sc(b,2);a+=Sc(c,2);return a+=Sc(d,2)},Bl:function(){return++Mp}});var Mp=0,cl="metacell";function Np(a){this.e=a;this.a=this.c=this.d=this.b=null}function Op(a,b,c){if(a.b){if(a.a){var d=a.c;a.a=null;a.c=null;window.setTimeout(function(){d()},0)}a.a=c;a.c=b}else a.b=c,a.d=b,a.d.apply(a.e,a.b)}function Pp(a){a.a?(a.b=a.a,a.d=a.c,a.a=null,a.c=null,window.setTimeout(function(){a.d.apply(a.e,a.b)},0)):(a.b=null,a.d=null)};function Qp(a,b){var c={};b=b||0;var d=Rp(a);if(50493!=d.jc())return{error:"No CS3D header"};if(256!=d.jc())return{error:"Expecting version number 1.00"};var e=d.Ad(),f=d.Ad();c.Wj=[f>>>0,e>>>1,0];var g=d.jc(),h=d.jc(),k=d.jc();c.primitiveType=d.Ib();e=d.Ib();f=d.Jb();g&&(c.Mk={});for(var l=0;l<g;l++){var m=d.Jb(),n=d.$e();c.Mk[n]=d.ql(m-n.length-1)}l=new ArrayBuffer(24);g=new Uint8Array(l);m=new Float32Array(l);for(l=0;l<k;l++){d.$e();var n=d.Ib(),r=Array(n),s;for(s=0;s<8*n;s++)g[s^3]=d.Ib();for(s=
0;s<n;s++)r[s]=d.Ib();if(3!=n){var t=7;for(s=0;s<n;s++)t+=h*r[s];d.T+=t>>3}else{s=4*n+b;n=s/4;t=new ArrayBuffer(h*s);s=new Float32Array(t);new Uint8Array(t);for(var t=0,v=r[0],w=r[1],x=r[2],y=m[0],A=m[3],C=v?(A-y)/((1<<v)-1):0,B=m[1],I=m[4],G=w?(I-B)/((1<<w)-1):0,D=m[2],L=m[5],O=x?(L-D)/((1<<x)-1):0,r=0;r<h;r++)s[t]=y+C*d.cj(v),s[t+1]=B+G*d.cj(w),s[t+2]=D+O*d.cj(x),t+=n;c.Ir=[y,B,D,A,I,L];c.O=s}d.ui&&d.T++;d.ui=0}h=null;h=new Uint16Array(f);for(l=0;l<f;l++)h[l]=d.cj(e);c.Oa=h;if(d.T>a.byteLength)return{error:"CD3D read past eof"};
c.Mk.visibility&&(c.Ie=c.Mk.visibility,delete c.Mk.visibility);return c}
function Sp(a){function b(a){var b=a.Jb()-1,c=a.Jb(),d=a.T;if(0>=b)0!=c&&(a.T+=c);else{a.T+=2*b;for(var c=a.$e(),e=[c],f=0;f<b;f++){var g=a.sh(d++),h=a.sh(d++),c=h?c.slice(0,g)+a.$e()+c.slice(-h):c.slice(0,g)+a.$e();e.push(c)}return e}}var c={},d=Rp(a),e={256:function(){},258:function(){c.Vn=b(d)},272:function(){},273:function(){h=d.Ib();k=d.Jb()},274:function(){for(var a=c.Do,b=c.Fo,e=0;e<k;e++)a.push(d.Zj()),b.push(h)},275:function(){for(var a=c.Eo,b=0;b<k;b++)a.push(d.jc())},288:function(){g=d.Jb()},
289:function(){for(var a=0;a<g;a++)c.Bb.push({id:d.Zj(),Jm:null,items:[],Wp:[]})},290:function(){for(var a=0;a<g;a++)c.Bb[a].Wj=[d.Ad(),d.Ad(),d.Jb()]},291:function(){var a=c.Bb,b=d.Jb()-1,e=d.Jb(),f=d.T;if(0>=b)0!=e&&(d.T+=e);else{d.T+=2*b;var e=(b+1)/a.length,g=d.$e();a[0].Jm=g;for(var h=0,k=0;k<b;k++){var l=d.sh(f++),m=d.sh(f++),g=m?g.slice(0,l)+d.$e()+g.slice(-m):g.slice(0,l)+d.$e();0==k%e&&(a[h++].Jm=g)}}},292:function(){for(var a=d.Ib(),b=0;b<g;b++){var e=c.Bb[b],f=d.T+a-1;e.items=[];d.T+=a;
for(var h=0;h<a;h++)for(var k=d.sh(f-h),l=h<<3;k;)k&1&&e.items.push(l),k>>=1,l++}},293:function(){var a=d.Wn(),b=d.Wn(),e=d.Jb(),f=d.Ib(),b=(b-a)/((1<<f)-1);d.ui=e*f&7;for(var h=0;h<g;h++){for(var k=c.Bb[h],l=k.items.length,m=[],n=0;n<l;n++){var B=a+d.cj(f)*b;m.push(100*B+0.5>>0);e--}k.Wp=m}if(e)return!1},294:function(){for(var a=0;a<g;a++)c.Bb[a].$p=d.Jb()},295:function(){for(var a=d.Jb(),b=0;b<g;b++)c.Bb[b].$p=a}},f={512:function(){},513:function(){var a=m>>3;c.ds=Array(a);for(var b=0;b<a;b++){var e=
d.Ad(),f=d.Ad();e&2147483648&&(f^=4294967295,f+=1,e^=4294967295);c.ds[b]=f+4294967296*e}},514:function(){c.fu=b(d)},515:function(){var a=d.Ib(),b=(m-1)/a>>0;c.Nj=Array(b);if(1==a)for(var e=0;e<b;e++)c.Nj[e]=d.Ib();if(2==a)for(e=0;e<b;e++)c.Nj[e]=d.jc();if(1>a||2<a)return!1},517:function(){for(var a=c.Nj.length,b=0;b<a;b++){for(var e=c.Nj[b],f=[],g=0;g<e;g++)f.push([d.Ad(),d.Ad()>>>0]);c.Vr[b]=f}delete c.Nj}},g=0,h=0,k=0;if("\u0089NSB\r\n\u001a\n"!=d.ql(8))return null;var l=d.jc();d.Jb();var m=d.Jb(),
n;(l={50624:function(a){a.up=d.Ib();a.hr=d.Zj();a.Do=[];a.Fo=[];a.Eo=[];a.Bb=[];return e},54720:function(a){a.up=d.Ib();a.Su=d.Ib();a.Ku=d.Ad();a.Lu=d.Ad();a.Vr=[];return f}}[l])&&(n=l(c));if(!n)return null;do{if(65535==(l=d.jc()))break;d.Jb();m=d.Jb();if(l=n[l]){if(!1===l())return null}else d.T+=m}while(d.T<a.length);return c}
function Rp(a){var b=!1;function c(a,b){for(var c=0;c<a.length;c++){var d=65536*a[c]+b,e=d/1E5>>0;a[c]=d-1E5*e;b=e}b&&a.push(b)}function d(a){for(var b=""+a.pop();0<a.length;)var c="0000000000"+a.pop(),b=b+c.slice(-5);return b}var e={};b||(b=!1);e.T=0;e.ui=0;e.Gu=0;a instanceof ArrayBuffer&&(a=new Uint8Array(a));a instanceof Uint8Array?(e.Ib=function(){return e.Ke[e.T++]},e.sh=function(a){return e.Ke[a]},e.Zp=function(){return String.fromCharCode(e.Ke[e.T++])},e.$e=function(){for(var a="",b;b=e.Ib();)a+=
String.fromCharCode(b);return a},e.ql=function(a){for(var b="";a--;)b+=String.fromCharCode(e.Ib());return b}):(e.Ib=function(){return e.Ke.charCodeAt(e.T++)&255},e.sh=function(a){return e.Ke.charCodeAt(a)&255},e.Zp=function(){return e.Ke[e.T++]},e.$e=function(){for(var a=e.T;e.Ke.charCodeAt(e.T++););return e.Ke.slice(a,e.T-1)},e.ql=function(a){var b=e.Ke.slice(e.T,e.T+a);e.T+=a;return b});e.cj=function(a){var b=((f[e.T++]<<8|f[e.T++])<<16|f[e.T++]<<8|f[e.T++])>>>0>>>32-e.ui-a&(1<<a)-1;a+=e.ui;e.ui=
a&7;e.T+=(a>>3)-4;return b};e.Ke=a;e.mq=a.length;e.xt=function(){return e.T>=e.mq};if(b)e.jc=function(){return e.Ib()|e.Ib()<<8},e.Jb=function(){return e.jc()|e.jc()<<16},e.Zj=function(){var a,b=[];for(a=0;3>a;a++)b.push(e.jc());var f=[e.jc()];for(a=0;3>a;a++)c(f,b.pop());return d(f)};else{var f=e.Ke;e.jc=function(){return f[e.T++]<<8|f[e.T++]};e.Jb=function(){return(f[e.T++]<<8|f[e.T++])<<16|f[e.T++]<<8|f[e.T++]};e.Ad=function(){return((f[e.T++]<<8|f[e.T++])<<16|f[e.T++]<<8|f[e.T++])>>>0};e.Zj=function(){for(var a=
[e.jc()],b=0;3>b;b++)c(a,e.jc());return d(a)}}e.Ad=function(){return e.Jb()>>>0};e.Wn=function(){var a=e.Ad(),b=a>>23&255,c=a&8388607;b&&(c|=8388608);a&2147483648&&(c=-c);return Math.pow(2,b-128-22)*c};return e};/*
 archive.js

 Provides base functionality for unarchiving.

 Licensed under the MIT License

 Copyright(c) 2011 Google Inc.
*/
/*
 io.js

 Provides readers for bit/byte streams (reading) and a byte buffer (writing).

 Licensed under the MIT License

 Copyright(c) 2011 Google Inc.
 Copyright(c) 2011 antimatter15
*/
var Tp;Tp=function(a,b,c){this.Wl=new Uint8Array(a,b||0,c||a.byteLength);this.yf=0};p=Tp.prototype;p.Tr=function(){for(var a=0,b=this.yf+4-1;b>=this.yf;)a<<=8,a|=this.Wl[b],--b;return a};p.Sr=function(a){0>=a||"number"!=typeof a||(this.yf+=a)};p.Uk=function(a){this.Sr(a)};p.Ur=function(a){if(0>=a||"number"!=typeof a)return 0;var b="",c=this.yf;for(a=this.yf+a;c<a;++c)b+=String.fromCharCode(this.Wl[c]);return b};p.Zr=function(a){var b=this.Ur(a);this.yf+=a;return b};/*
 untar.js

 Copyright(c) 2011 Google Inc.

 Reference Documentation:

 TAR format: http://www.gnu.org/software/automake/manual/tar/Standard.html
*/
var Up;
(function(){function a(a){this.$a=!1;this.name=b(a,100);b(a,8);b(a,8);b(a,8);this.size=parseInt(b(a,12),8);b(a,12);b(a,8);this.Dn=b(a,1);b(a,100);this.c=b(a,6);if("ustar"==this.c){if(b(a,2),b(a,32),b(a,32),b(a,8),b(a,8),this.a=b(a,155),this.a.length&&(this.name=this.a+this.name),a.Uk(12),this.b=this.name,this.Sg=null,0==this.Dn||"x"==this.Dn){this.Sg=new Uint8Array(a.Wl.buffer,a.yf,this.size);0<this.name.length&&0<this.size&&this.Sg&&this.Sg.buffer&&(this.$a=!0);a.Uk(this.size);var d=512-this.size%512;
0<d&&512>d&&a.Uk(d)}}else a.Uk(255)}function b(a,b){var e=a.Zr(b),f=e.indexOf(String.fromCharCode(0));return-1!=f?e.substr(0,f):e}Up=function(b){b=new Tp(b,0,b.byteLength);for(var d=null;0!=b.Tr();){var e=new a(b);if(e&&e.$a)d||(d={}),d[e.b]=e;else break}return d}})();function Vp(a){this.id=a.hr;this.a=a.up;na();this.Bb=null;var b,c;this.Bb=new Co(this,a.Bb.length);b=0;for(c=a.Bb.length;b<c;b++){var d=a.Bb[b],e=d.id,f=d.Jm.split("/");f.pop();var f=f.join("/")+"/"+e,g=Gp(d.Wj),h=[],k=[],l;l=d.items.length;for(var m=0;m<l;m++){var n,r;n=d.items[m];r=d.Wp[m];var s=a.Do[n],t=a.Fo[n];n=a.Eo[n];if(a.Vn)switch(t){case 0:k.push({URL:a.Vn[n],If:s,wq:r});break;case 1:h.push({URL:a.Vn[n],Ii:s,wq:r})}else ia()}d=Fj(g);this.Bb.set(b,e,d,g,d,f,h,k)}return this}
Vp.prototype.xk=function(a,b,c){return this.Bb.xk(a,b,c)};Vp.prototype.vj=function(a,b){return this.Bb.vj(a,b)};Vp.prototype.yk=function(a){return this.Bb.yk(a)};function Wp(a,b){a.sort(function(a,d){return z.distance(a.eb(),b)-z.distance(d.eb(),b)})}Vp.prototype.pm=function(a,b,c,d){return this.Bb.pm(a,void 0!=b?b:500,void 0!=c?c:0,d)};function Xp(a){this.c=Wn();this.a=new kh(Ck);this.e=new kh(20);this.b=new kh(Yp);this.d=a}var Ck=20,Ak=!0,Yp=25,Bk=200,Dk=1,Ek=2,Zp=pa();Zp.isEnabled=!1;Xp.prototype.kb=Zp;Xp.prototype.t=function(){this.c.clear();this.clear();this.c=this.b=this.a=null};Xp.prototype.clear=function(){this.a.clear();this.b.clear()};function $p(a,b){var c,d=a.a.keys,e=d.length;for(c=0;c<e;c++){var f=a.a.a[d[c]],g=f.value.yk(b);if(g)return a.a.fl(f),g}return null}
function aq(a,b,c,d,e,f,g,h){null===c&&(c=b);c=bq(a,c,f);cq(a,c,function(a){for(var c=[],m=0;m<a.length;m++){var n=a[m];if(n.$a&&(n=n.Rb)){var r=null;if(r=E(b[2])?n.xk(b,f,g):n.pm(b,f,g,1.01))for(n=0;n<r.length;n++)c.push(r[n])}}if(0<c.length){if(J(h))c.sort(function(a,b){return a.distance-b.distance});else{for(a=dq(h,b);0>a;)a+=360;for(;360<=a;)a-=360;for(n=0;n<c.length;n++){var m=c[n],r=dq(h,Ej(m)),s=Math.abs(a-r);180<s&&(s=360-s);m.gt=r;m.ct=s;m.Kp=0.1*m.distance+0.01*m.distance*m.distance+0.5*
s}c.sort(function(a,b){return a.Kp-b.Kp})}d(c.slice(0,e))}else d(Rb)})}function dq(a,b){var c=a[0]*u,d=b[0]*u,e=(b[1]-a[1])*u,f=Math.sin(e)*Math.cos(d),c=Math.cos(c)*Math.sin(d)-Math.sin(c)*Math.cos(d)*Math.cos(e);return(Math.atan2(f,c)*kc+360)%360}function eq(a,b,c,d,e){var f=Fj(b),g=bq(a,b,50),h=[],k;for(k in g){var l=g[k],m=a.a.get(k);if(null!=m&&(l.Rb=m,l.$a=!0,l=m.xk(b,d,c)))for(m=0;m<l.length;m++)h.push(l[m])}Wp(h,f);return e&&0<e&&h.length>e?h.slice(0,e):h}
Xp.prototype.vj=function(a,b){var c=!1,d=fq(a);nh(this.a,function(e,f){var g=parseInt(f.id,10),h=Math.floor(g/262144)-262144,h=[h,g-262144*(h+262144)],g=Hp(h),h=Hp([h[0]+1,h[1]+1]),h=z.ma(g,h,0.5),h=fq(h),g=Do(fq(g),h);if(!(Do(d,h)-g>b)&&(c=f.vj(a,b)))return!0});return c};function gq(a,b,c){b=bq(a,b,c?c:50);c=[];for(var d=0;d<b.length;d++){var e=a.a.get(b[d].hh);null!=e&&c.push(e)}return c}
function hq(a,b,c,d){if(b.$a)d(b,b.Rb);else{var e=b.url;jp(a.c,e,function(f,g){if(g.Ub())if(f){var h=Up(f),k=null,l=Ak,m,n=0;for(m in h){var r,s=l;if(!l)for(r=0;r<c.length;r++){var t=c[r];t.$a||m!=t.hh+".nsb"||(s=!0)}if(s&&(r=h[m],"0"==r.Dn&&r.$a)){s=a.a.get(m.substr(0,m.length-4));s||(r=Sp(r.Sg),s=new Vp(r),s.Bb?a.a.set(s.id,s):a.b.set(e,e));n++;for(r=0;r<c.length;r++)t=c[r],t.$a||m!=t.hh+".nsb"||(t.Rb=s,t.$a=!0);m==b.hh+".nsb"&&(k=s)}}k?d(b,k):d(b,null)}else a.b.set(e,e),d(b,null);else g.ii()==
Ro.ERROR&&a.b.set(e,e),d(b,null)},3E4)}}
function bq(a,b,c,d){var e;e=[qc*(b[0]+90)>>>0,qc*(b[1]+180)>>>0];e=[e[0]>>>14,e[1]>>>14];b=fq(b);var f=[],g,h=E(d)?Dk:d,k=-h;for(g=k;g<=h;g++)for(d=k;d<=h;d++){var l=[e[0]+d,e[1]+g],m=Hp(l),l=Hp([l[0]+1,l[1]+1]),l=z.ma(m,l,0.5),n=fq(l),m=Do(fq(m),n);if(!(Do(b,n)-m>c)){var m=a,n=tp(5,17,l[0],l[1]),r=Bp(18,n.a[0],n.a[1]),m=m.a.get(r),m={Pl:n,hh:r,a:l,url:n.xb(),Rb:m,$a:null!=m};a.d?(n=m.Pl.F,l=Ep(n[0],n[1],n[2]),n=Ep(n[0],n[1]+1,n[2]-1),l=a.d(l[0],l[1],n[0],n[1])):l=!0;l&&f.push(m)}}return f}
function cq(a,b,c){b&&0!=b.length?iq(a,b,c):c(Rb)}
function iq(a,b,c){var d=!1,e=0,f=0,g=0,h,k={},l={};for(h=0;h<b.length;h++){var m=b[h];void 0!=k[m.url]?k[m.url].push(m):k[m.url]=[m]}var n=null;for(n in k){var r=k[n];if(void 0!=a.b.a[n])for(g++,h=0;h<r.length;h++)m=r[h],m.$a=!1,m.Rb="ERROR";else for(h=0;h<r.length;h++){var m=r[h],s=a.a.get(m.hh);null!=s&&(f++,m.Rb=s,m.$a=!0);null==m.Rb&&void 0==l[n]&&(e++,l[n]=m)}}if(0==e)d=!0,c(b);else for(e in e=null,l)hq(a,l[e],b,function(e,f){if(!f||"ERROR"==f||!f.id)for(e.$a=!1,e.Rb="ERROR",h=0;h<b.length;h++)b[h].url==
e.url&&(b[h].$a=!1,b[h].Rb="ERROR");for(var g,k=g=0;k<b.length;k++)null==a.a.get(b[k].hh)&&"ERROR"!=b[k].Rb&&g++;na();0!=g||d||(d=!0,c(b))})}function jq(a,b){var c=Bk,d=Ek;if(!(1>c)){for(var c=bq(a,b,c,d),d=new Kf,e=c.length-1;0<=e;e--){var f=c[e];void 0!=a.b.a[f.url]||a.a.get(f.hh)?c.splice(e,1):d.set(f.url,1)}d.forEach(function(b){a.e.get(b)||jp(a.c,b,function(c,d){d.Ub()?c?a.e.set(b,1):a.b.set(b,b):d.ii()==Ro.ERROR&&a.b.set(b,b)})})}};var kq=1/298.257223563*(2-1/298.257223563);function Do(a,b){return 6371E3*Math.acos(tc(Math.sin(a[0])*Math.sin(b[0])+Math.cos(a[0])*Math.cos(b[0])*Math.cos(b[1]-a[1]),-1,1))}function lq(a,b,c){return 6371E3*Math.acos(tc(Math.sin(a)*Math.sin(c[0])+Math.cos(a)*Math.cos(c[0])*Math.cos(c[1]-b),-1,1))}function mq(a,b,c,d){a=lq(a,b,d);2<d.length&&!E(c)&&!E(d[2])&&0!=c&&0!=d[2]&&(c=Math.abs(d[2]-c),a=Math.sqrt(a*a+(E(1.01)?1:1.01)*c*c));return a}function fq(a){return[a[0]*u,a[1]*u]}
function Ip(a){for(;-90>a[0];)a[0]+=180;for(;90<a[0];)a[0]-=180;for(;-180>a[1];)a[1]+=360;for(;180<a[1];)a[1]-=360;return a}function Ga(a,b){b=b||z.create();if(a[0]||a[1]||a[2]){var c=a[1]*u,d=a[0]*u,e=Math.sin(d),d=Math.cos(d),f=6378137/Math.sqrt(1-kq*e*e);b[0]=(f+a[2])*d*Math.cos(c);b[1]=(f+a[2])*d*Math.sin(c);b[2]=(f*(1-kq)+a[2])*e}else b[0]=0,b[1]=0,b[2]=0;return b}
function Ha(a){var b;b=b||z.create();if(a[0]||a[1]||a[2]){var c=1.00336409*a[2],d=Math.sqrt(a[0]*a[0]+a[1]*a[1]+c*c);if(0===d)return b=[0,0,0];d=1/d;b[0]=a[0]*d;b[1]=a[1]*d;b[2]=c*d}else b[0]=0,b[1]=0,b[2]=1;return b}function nq(a){a=Jj(a);return Fj(a).slice(3,7)}
function Fj(a){var b;b=b||z.create();var c=a[1]*u,d=a[0]*u,e=Math.sin(d),f=Math.cos(d),g=Math.cos(c),h=Math.sin(c),c=f*g,d=f*h,k=e*g,l=e*h,m=6378137/Math.sqrt(1-kq*e*e),n=z.create(-c,-d,-e),g=z.create(-h,g,0),f=z.create(-k,-l,f),f=R(f[0],g[0],n[0],0,f[1],g[1],n[1],0,f[2],g[2],n[2],0,1,1,1,1),f=md(f);a=a[2]||0;$c(f,ld(0*u,180*u,90*u),f);b[0]=(m+a)*c;b[1]=(m+a)*d;b[2]=(m*(1-kq)+a)*e;b[3]=f[0];b[4]=f[1];b[5]=f[2];b[6]=f[3];return b}
function Ja(a){var b;b=b||z.create(0,1,0);if(a[0]||a[1]||a[2]){if(3===a.length){var c=nq(a);a=a.concat(c)}a=a.slice(3,7);c=R();z.create(0,1,0);Oa(a,c);z.I(c,b,b)}else b[0]=0,b[1]=1,b[2]=0;return b}function Kj(a){var b=a.slice(3,7),c=R();Oa(b,c);b=R();Hd(a[0],a[1],a[2],b);a=R();xd(b,c,a);return a}function hj(a){var b=a.slice(3,7),c=R();Oa(b,c);b=Cd(c);if(null===b)return[];var d=R();Hd(-a[0],-a[1],-a[2],d);xd(b,d,c);return c}
function Jj(a){var b,c=a[0],d=a[1],e=a[2];b=b||[];if(c||d||e){a=Math.sqrt(c*c+d*d);var f=Math.atan(e/(a*Math.sqrt(1-kq))),c=Math.atan2(d,c),d=Math.sin(f),e=Math.atan((e+6378137*Math.pow(d,3)*kq/Math.sqrt(1-kq))/(a-6378137*kq*Math.pow(Math.cos(f),3))),f=Math.sin(e);a=a/Math.cos(e)-6378137/Math.sqrt(1-kq*f*f);b[0]=e*kc;b[1]=c*kc;b[2]=a}else b[0]=0,b[1]=0,b[2]=0;return b};function oq(a,b){this.Xc=a;this.zf=b}function pq(a){this.kb=a;this.a=[]}function qq(a,b,c,d){b=b*u;c=c*u;var e;a:{e=d+0;for(var f=a.a.length;0<=--f;){var g=a.a[f],h=e;if(lq(b,c,g.Xc)+h<g.zf){e=!0;break a}}e=!1}e||(d=new oq([b,c],d+0),15<=a.a.length&&a.a.splice(0,1),a.a.push(d))}function rq(a,b,c,d){b=b*u;c=c*u;for(var e=a.a.length;0<=--e;){var f=a.a[e],g=f,h=d;if(lq(b,c,g.Xc)+g.zf<h)return!0;g=d;if(lq(b,c,f.Xc)+g<f.zf)return!1}};function sq(a,b,c,d,e,f,g){this.url=a;this.Sh=b;this.b=c;this.a=d;this.ni=e;this.fg=f;this.Ec=g;this.tp=0}function tq(){this.n=Wn();this.a=null;this.j=new kh(uq);this.d=new kh(vq);this.o=this.b=null;this.g=this.e=0;this.c=8}var wq,uq=13,vq=25,xq=uq-2,yq=pa();yq.isEnabled=!1;tq.prototype.kb=yq;function zq(){wq||(wq=new tq);return wq}tq.deleteInstance=function(){wq&&(wq.clear(),wq=null)};
function Aq(a,b){switch(b){case 1:a.c=6;break;case 2:a.c=8;break;case 3:a.c=9;break;case 4:a.c=10;break;default:a.c=6}a.clear()}
function Bq(a,b,c,d){if(null==a.a||b){var e=tp(a.c,0,0,0),f=e.xb();Vn(a.n,f,function(b,h){h.Ub()?(a.a=Cq(a,f,e,b),a.a?c&&"function"===typeof c&&window.setTimeout(function(){c(a.a)},0):d&&"function"===typeof d&&d("invalid coverage file file: "+f)):d&&"function"===typeof d&&d("could not load coverage file file: "+f)})}else c&&"function"===typeof c&&window.setTimeout(function(){c(a.a)},0)}
function Dq(a,b,c,d,e,f){a.g=0;Eq(a,0,[b,c],d,function(a,b){var c=!E(b)&&4<=b;void 0==a?e(!1,void 0,c):e(a<=d,a,c)},!0,null,-1,f?4:12)}tq.prototype.clear=function(){this.j.clear();this.d.clear()};function Fq(a,b){for(var c=[4,8,12],d=0;d<c.length;d++){var e=c[d],f=null,g=null;0==e&&null!=a.a?f=a.a:(g=tp(a.c,e,b[0],b[1]),f=g.xb(),f=a.j.get(f));g=g.xb();f||void 0!=a.d.get(g)||Vn(a.n,g,function(a,b){b.Ub();b.xb()})}}
function Gq(a,b,c,d){a.e=0;a.g=0;if(null!=a.a)Hq(a,a.a,b,b,c,d,function(b,e,h,k,l){a.e++;Iq(a,b,e,c,h,d,k,l);a.e--});else{var e=Dp(0,b);Iq(a,b,b,c,e,d,!0)}}
function Cq(a,b,c,d){var e;e=d.width;var f=d.height;!a.b||e==a.b.width&&f==a.b.height||(document.removeChild(a.b),a.b=null,a.o=null);if(!a.b){a.b=document.createElement("canvas");a.o=a.b.getContext("2d");var g=a.b.webkitBackingStorePixelRatio||1;1!=g&&E(a.o.webkitGetImageDataHD)&&(g=1);a.b.width=e/g;a.b.height=f/g}e=a.o;f=e.webkitBackingStorePixelRatio||1;1!=f&&E(e.webkitGetImageDataHD)&&(f=1);e.clearRect(0,0,d.width,d.height);e.fillStyle="rgba(0,0,0,0)";e.fillRect(0,0,d.width/f,d.height/f);e.drawImage(d,
0,0,d.width/f,d.height/f);if((e=1==f?e.getImageData(0,0,d.width,d.height):e.webkitGetImageDataHD(0,0,d.width,d.height))&&e.data&&0==e.data[3])return null;d=new sq(b,c,Fp(c.F[0],c.F[1],c.F[2]),Fp(c.F[0],c.F[1]+1,c.F[2]-1),d.width,d.height,e);0==c.me?a.a=d:a.j.set(b,d);a=d.ni;b=d.fg;e=fq(d.b);f=fq(d.a);c=Do(e,[f[0],e[1]]);e=Do(e,[e[0],f[1]]);a=10*Math.min(c/a,e/b);d.tp=a;return d}
function Eq(a,b,c,d,e,f,g,h,k){Pb(20>a.g++);if(20<a.g)e(null);else{var l=null,m=null,n=null;0==b&&null!=a.a?(l=a.a,m=a.a.Sh,n=a.a.url):(m=tp(a.c,b,c[0],c[1]),n=m.xb(),l=a.j.get(n));var r=function(l){l=Jq(l,c);var n=Math.min(b+4,k);m.me>=n?1677721>l?e(l,m.me):e(g,h):f?1677721>l?Eq(a,n,c,d,e,f,l,m.me,k):e(g,h):e(l,m.me)};l?r(l):void 0!=a.d.get(n)?0<b?e(g,h):e(null):Vn(a.n,n,function(f,l){if(l.Ub()){var v=Cq(a,n,m,f);v?r(v):(l.xb(),a.d.set(n,n),e(g,h))}else l.xb(),l.ii()==Ro.ERROR&&a.d.set(n,n),0<b?
Eq(a,b-1,c,d,e,!1,g,b,k):e(g)})}}
function Iq(a,b,c,d,e,f,g,h){a.g++;if(20<a.g)f(null);else{var k=e[0],l=vp(a.c,e),m=l.xb();if(void 0!=a.d.get(m))g&&0<k?(e=Dp(k-1,c),Iq(a,b,c,d,e,f,g,h)):f(h);else{var n=function(b,c,e,g,h){a.e++;Iq(a,b,c,d,e,f,g,h);a.e--};(e=a.j.get(m))?Hq(a,e,b,c,d,f,n):Vn(a.n,m,function(e,s){if(s.Ub()){var t=Cq(a,m,l,e);t?Hq(a,t,b,c,d,f,n):(a.d.set(m,m),g&&0<k?(t=Dp(k-1,c),Iq(a,b,c,d,t,f,g,h)):f(h))}else s.xb(),s.ii()==Ro.ERROR&&a.d.set(m,m),g&&0<k?(t=Dp(k-1,c),Iq(a,b,c,d,t,f,g,h)):f(h)})}}}
function Kq(a,b,c){var d=18-a.Sh.F[0];b=(256*a.Sh.F[1]+b+(E(void 0)?0.5:void 0))*(1<<d);a=jc*(67108863-(256*a.Sh.F[2]+c+(E(void 0)?0.5:void 0))*(1<<d))/67108864-fc;a=2*Math.atan(Math.exp(a));return[180*a/fc-90,jc*b/67108864*180/fc-180]}function Jq(a,b){var c=Dp(a.Sh.F[0],b);return Lq(a.Ec,c[3],c[4])}function Lq(a,b,c){b=4*(b+c*a.width);return 0.1*(16777215-((a.data[b+0]<<16)+(a.data[b+1]<<8)+a.data[b+2]))}var Mq=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]];
function Nq(a,b){var c=a[0],d=Math.floor(67108864*(b[1]/360+0.5)),e=Math.floor(33554432*(Math.log(Math.tan((90+b[0])*ic))*gc+1)),c=18-c;return[(d>>c)-256*a[1],(67108863-e>>c)-256*a[2]]}
function Hq(a,b,c,d,e,f,g){var h=b.Sh,k=b.ni,l=b.fg,m=h.me,n=Nq(h.F,c),r=tc(n[0],0,255),s=tc(n[1],0,255),t=!1,v=Lq(b.Ec,r,s);if((1677721<v||n[0]!=r||n[1]!=s)&&1677721<v){for(var n=!1,v=Nq(h.F,d),t=tc(v[0],0,255),w=tc(v[1],0,255);!n&&(r!=t||s!=w);)t<r?r--:t>r&&r++,w<s?s--:w>s&&s++,v=Lq(b.Ec,r,s),1677721>v&&(n=!0);t=!n}t&&(n=Nq(h.F,d),r=tc(n[0],0,255),s=tc(n[1],0,255));v=0;n=fq(c);t=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]];do{var x=w=0,y=0,A=Lq(b.Ec,r,s);if(A>e+b.tp){f(null);break}if(0==A){var C=
null,C=0==v?d:Kq(b,r,s);12>m?(a=Math.min(m+4,12),b=1<<18-m,m=256<<18-m,f=256<<18-a,h=[a,Math.floor((h.F[1]*m+r*b)/f),Math.floor((h.F[2]*m+s*b)/f)],g(c,C,h,!1,C)):f(C);break}var B,I,G,D=0,L=0,O=0,M=0,Z=Mq;for(B=0;B<Z.length;B++){I=Z[B][0];G=Z[B][1];var V=r+I,Q=s+G;if(!(0>V||0>Q||V>=k||Q>=l)){V=Lq(b.Ec,V,Q);if(0==V)t[w][0]=I,t[w][1]=G,w++;else if(1677721<V)continue;V=V-A;V>x?(x=V,D=-I,L=-G):V<y&&(y=V,O=I,M=G)}}var ga;if(0<w)if(1<w)for(x=Number.MAX_VALUE,B=0;B<w;B++)V=r+t[B][0],Q=s+t[B][1],V=Do(n,fq(Kq(b,
V,Q))),V<x&&(ga=t[B][0],C=t[B][1],x=V);else ga=t[0][0],C=t[0][1];else x>-y?(ga=D,C=L):(ga=O,C=M);if(0!=ga||0!=C){if(r+=ga,s+=C,0>r||0>s||r>=k||s>=l){ga=0>r?-1:r>=k?1:0;C=0>s?-1:s>=l?1:0;d=h.F[1]+ga;h=h.F[2]+C;C=1<<m;0>d&&(d=C-d);d>=C&&(d=d-C);0>h&&(h=C-h);h>=C&&(h=h-C);h=[m,d,h];C=Kq(b,r,s);g&&a.e<xq?g(c,C,h,!1,C):f(C);break}}else{f(null);break}v++}while(1)};function Oq(){this.a=new Xp(function(a,b,c,d){var e=zq();if(Xk)a=!0;else if(null==e.a)a=void 0;else{var f=0.65*Do(fq([a,b]),fq([c,d]));a=Jq(e.a,[N(a,c,0.5),N(b,d,0.5)])<=f}return!0===a||void 0===a});this.b=zq();this.d=new Np(this);this.e=new Np(this);this.c=new pq(this.kb)}var Pq=pa();Pq.isEnabled=!1;Oq.prototype.kb=Pq;var Xk=!1;Oq.useCoverageOptimizerResult=!0;da("pano.DistanceFieldLocationManager.useCoverageOptimizerResult",Oq.useCoverageOptimizerResult);
Oq.prototype.t=function(){this.clear();this.a.t();this.a=null};Oq.prototype.clear=function(){this.a.clear()};Oq.prototype.isUsingPssService=function(){return!1};p=Oq.prototype;p.dn=function(a){return $p(this.a,a)};p.Zo=function(a,b,c,d,e){d=d||sc(0,99);this.Gj(a,function(a){E(a)?b(void 0):null==a||0==a.length?b(null):b(a[0])},1,d,0,!Xk&&(e||100<d),c);e&&Fq(this.b,a)};
p.Gj=function(a,b,c,d,e,f,g){var h=c||1,k=e||0,l=this;Op(this.d,function(a,c){E(a)?b(void 0):Qq(a,c,function(d){if(!1===d)window.setTimeout(function(){Pp(l.d);b(Rb)},0);else{var e=!Xk&&(f||100<c);l.Bh(a,null,function(c){if(Oq.useCoverageOptimizerResult&&c&&0<c.length){var d=Ej(c[0]);qq(l.c,a[0],a[1],Do(fq(a),fq(d)))}window.setTimeout(function(){Pp(l.d);b(c);e&&Fq(l.b,a)},0)},h,c,k,!e,e,g)}})},[a,d||500])};
p.Bh=function(a,b,c,d,e,f,g,h,k){function l(){n=!0;Gq(m.b,a,e,function(b){null==b?c(Rb):(Do(fq(a),fq(b)),m.Bh(a,b,c,d,e,f,!0,!1,k))})}var m=this,n=!1;g?(null===b&&(b=a),aq(this.a,a,b,function(a){0<a.length?c(a):h&&!n?l():c(Rb)},d,e,f,k)):l()};p.zp=function(a,b,c,d){return eq(this.a,a,b,c,d)};p.en=function(a,b){return gq(this.a,a,b)};p.Bp=function(a,b,c){Xk?c&&"function"===typeof c&&c():Bq(zq(),a,function(){b&&"function"===typeof b&&b()},function(){c&&"function"===typeof c&&c()})};
p.Ap=function(a,b,c,d,e){var f=this;e=[a,b,c,e];var g=void 0;if(Oq.useCoverageOptimizerResult&&(g=rq(this.c,a,b,c),!0===g||!1===g)){window.setTimeout(function(){d(!0===g)},0);return}this.a.vj([a,b],c)?window.setTimeout(function(){d(!0)},0):Op(this.e,function(a,b,c,e){E(a)?d(void 0):Dq(zq(),a,b,c,function(c,e){!E(e)&&qq(f.c,a,b,e);window.setTimeout(function(){Pp(f.e);d(c)},0)},e)},e)};function Qq(a,b,c){if(Xk)c&&c(!0);else{var d=zq();a=null==d.a?void 0:Jq(d.a,a)<=b;c&&c(a)}}
p.Cp=function(a){a&&jq(this.a,a)};function Rq(){}var Sq=pa();Sq.isEnabled=!1;Rq.prototype.kb=Sq;var Tq=null,Uq="http:aivmpss001.dv.ber01.locn.s.nokia.com/1/";function Vq(){Tq||(Tq=new Rq);return Tq}da("pano.PssService.getInstance",Vq);Rq.deleteInstance=function(){Tq&&(Tq.clear(),Tq=null)};da("pano.PssService.deleteInstance",Rq.deleteInstance);Rq.prototype.clear=function(){};da("pano.PssService.overwriteBaseUrl",function(a){"/"!=a.substr(-1)&&(a+="/");Uq=a;Tq&&Tq.clear()});
function Wq(a,b,c,d,e,f,g){ip(Wn(),Uq+b+"/"+c+"/"+d+"/?l="+(E(g)?1:g)+"&f="+(E(-1)?0:-1),function(a,b){if(b.Ub()&&a){var c=window.JSON.parse(a),d;if(d=c instanceof Array){var n=E(g)?1:g;d=E(-1)?0:-1;var n=null!=c&&c.length<=n,r;for(r in c){var s=c[r],n=n&&Nc(s.id);if(0==d||1==d){if(s.geo)for(var t=0;3>t;t++)var v=s.geo[t],n=n&&!isNaN(v)&&Mc(v);else n=!1;n=n&&Nc(s.baseUrl);Pc(s.cameraOrientation);s.cameraOrientation?(t=parseFloat(s.cameraOrientation.heading),v=parseFloat(s.cameraOrientation.attitude),
s=parseFloat(s.cameraOrientation.bank),n=(n=(n=n&&!isNaN(t)&&Mc(t))&&!isNaN(v)&&Mc(v))&&!isNaN(s)&&Mc(s)):n=!1}}d=n}d?e(c):f()}else f()})};function Xq(){this.a=new Xp;this.c=new Np(this);this.b=new pq(this.kb)}var Yq=pa();Yq.isEnabled=!1;Xq.prototype.kb=Yq;Xq.useCoverageOptimizerResult=!0;da("pano.PssLocationManager.useCoverageOptimizerResult",Xq.useCoverageOptimizerResult);Xq.prototype.t=function(){this.clear();this.a.t();this.a=null};Xq.prototype.clear=function(){this.a.clear()};Xq.prototype.isUsingPssService=function(){return!0};p=Xq.prototype;p.dn=function(a){return $p(this.a,a)};
p.Zo=function(a,b,c,d,e){d=d||sc(0,99);this.Gj(a,function(a){E(a)?b(void 0):null==a||0==a.length?b(null):b(a[0])},15,d,0,e||100<d,c)};function Zq(a,b){for(var c=[b[0]*u,b[1]*u,b[2]],d=0,e=a.length;d<e;d++){var f=a[d];f.distance=mq(f.km[0]*u,f.km[1]*u,f.km[2],c)}a.sort(function(a,b){return a.distance-b.distance})}
p.Gj=function(a,b,c,d,e,f,g){var h=c||1;c=d||500;var k=this;Op(this.c,function(a,c,d,e,f){E(a)?b(void 0):this.Bh(a,null,function(c){if(Xq.useCoverageOptimizerResult&&c&&0<c.length){var d=Ej(c[0]);qq(k.b,a[0],a[1],Do(fq(a),fq(d)))}window.setTimeout(function(){Pp(k.c);b(c)},0)},h,c,d,e,f)},[a,c,e||0,!f&&100>=c,g])};
p.Bh=function(a,b,c,d,e,f,g,h){function k(){m=!0;Wq(Vq(),a[0],a[1],e,function(b){b&&1<b.length&&!E(a[2])&&Zq(b,a);b&&0<b.length?(b=b[0].km,null==b?c(Rb):(Do(fq(a),fq(b)),l.Bh(a,b,c,d,e,f,!0,h))):c(Rb)},function(){c(Rb)},d)}var l=this,m=!1;g?(null===b&&(b=a),aq(this.a,a,b,function(a){0<a.length?c(a):(ja(),m?c(Rb):k())},d,e,f,h)):k()};p.zp=function(a,b,c,d){return eq(this.a,a,b,c,d)};p.en=function(a,b){return gq(this.a,a,b)};
p.Bp=function(a,b){b&&"function"===typeof b&&window.setTimeout(function(){b()},0)};p.Ap=function(a,b,c,d){var e=void 0;if(Xq.useCoverageOptimizerResult&&(e=rq(this.b,a,b,c),!0===e||!1===e)){window.setTimeout(function(){d(!0===e)},0);return}$q(this,[a,b],c,d)};
function $q(a,b,c,d){Op(a.c,function(b,c,g,h){E(b)?d(void 0):this.Bh(b,null,function(c){var f=null!=c&&0<c.length,g=null;c&&0<c.length&&(g=Do(b,c[0].ta.get()),Xq.useCoverageOptimizerResult&&qq(a.b,b[0],b[1],g),Xq.useCoverageOptimizerResult&&qq(a.b,b[0],b[1],g));window.setTimeout(function(){Pp(a.c);d(f)},0)},1,c,g,h,void 0)},[b,c,0,100>=c,void 0])}p.Cp=function(a){a&&jq(this.a,a)};function ar(){}var br;ar.usePssService=!1;da("pano.LocationManagerFactory.usePssService",ar.usePssService);function cr(){br||(ar.usePssService?br=new Xq:br=new Oq);return br}ar.deleteInstance=function(){br&&(br.t(),br=null)};da("pano.LocationManagerFactory.deleteInstance",ar.deleteInstance);ar.prototype.isUsingPssService=function(){return ar.usePssService};da("pano.LocationManagerFactory.prototype.isUsingPssService",ar.prototype.isUsingPssService);function Nd(a){a instanceof Nd?this.A(a):(this.xa=dr(),this.a=this.b=0,this.p=15,this.v=!0,this.o=this.n=65535,this.g=0,this.d=65535,this.j=0,this.e=65535,this.H=1,this.va=!1,this.M=this.aa=0,this.c=[0,0,0,0],this.s=[0,1],bj(this,!0),er(this),fr(this,!0),this.a=ac(this.a,9,2,0),gr(this),this.a=ac(this.a,6,1,1),gr(this),ej(this,7,0,65535),dj(this,1))}Nd.prototype.Db=function(){return new this.constructor(this)};
Nd.prototype.A=function(a){this.xa=a.xa;this.b=a.b;this.a=a.a;this.p=a.p;this.v=a.v;this.n=a.n;this.o=a.o;this.g=a.g;this.d=a.d;this.j=a.j;this.e=a.e;this.H=a.H;this.va=a.va;this.aa=a.aa;this.M=a.M;this.c=Yb(a.c);this.s=Yb(a.s)};function bj(a,b){a.b=ac(a.b,31,1,b?1:0);gr(a)}function er(a){a.b=ac(a.b,30,3,2);gr(a)}function cj(a,b){a.b=ac(a.b,24,1,b?1:0);gr(a)}
function ej(a,b,c,d){var e=K(c,0),f=K(d,65535);a.b=ac(a.b,23,3,b);a.g=e;a.d=f;gr(a);c=K(c,0);d=K(d,65535);a.b=ac(a.b,11,3,b);a.j=c;a.e=d;gr(a)}function dj(a,b){a.b=ac(a.b,20,9,72|b&7);gr(a);a.b=ac(a.b,8,9,72|b&7);gr(a)}function dh(a,b){a.a=ac(a.a,31,1,b?1:0);gr(a)}function aj(a,b,c,d,e){d=K(d,b);e=K(e,c);a.a=ac(a.a,30,4,b);a.a=ac(a.a,26,4,c);a.a=ac(a.a,22,4,d);a.a=ac(a.a,18,4,e);gr(a)}function fr(a,b){a.a=ac(a.a,10,1,b?1:0);gr(a)}function $i(a,b,c){a.c[0]=b;a.c[1]=0;a.c[2]=0;a.c[3]=c;gr(a)}
function gr(a){a.xa=dr()}var dr=function(){var a=1;return function(){return a++}}();function Hi(a,b,c){a=Oj(a.ea,b,c,!0,!1,null,!1).distance;return c&&0<c?a<c:a<Number.MAX_VALUE}function hr(a,b,c,d,e,f,g){if(!e||!e.length)return null;a=ir(d,new jr(a,b));d=kr(d,a);c=c.Wg().rj(d);return(e=Oj(e,c,null,!1,f,null,g))&&e.object?{point:e.Bm,xj:e.xj,object:e.object,Ab:e.Ab,distance:e.distance,oc:e.oc}:null}
function Oj(a,b,c,d,e,f,g){var h,k=fe(),l=z.create(),m=z.create(),n=z.create(),r=z.create(),s=Number.MAX_VALUE,t=null,v=void 0,w=void 0;g&&(v={});for(var x=0;x<a.length;x++){var y=a[x];if(!e||y.Qa()){nf(xe(y),b,k);if(c&&0<c&&(h=y.sc())&&h instanceof kf){var A=c+h.qj();if(z.distance(h.wk(),k)>A)continue}if((h=y.fr)&&!h.Yl(k)&&(h=jf(k,h.Zb,h.Nb),0>h||0<c&&h>c))continue;h=y.$h(k,r,v);if(0<h){var A=of(k,h),C=we(y),C=z.I(C,A),B=z.distance(mf(b),C);y.R&&0>y.R&&(B=0);if(f){z.normalize(r,r);var I=z.tf(we(y),
r),I={xj:A,Bm:C,object:y,distance:B,Ab:I};g&&(I.oc={J:v.J,W:v.W,Ye:v.Ye,Gi:v.Gi,tg:v.tg,ug:v.ug,Nc:v.Nc,Oc:v.Oc});f.push(I)}B<s&&(t=y,z.A(r,n),z.A(A,l),z.A(C,m),s=B,g&&(w=v,v={}));if(d&&(0>=c||h<=c))break}}}if(f&&0<f.length)return f.sort(function(a,b){return a.object.R&&0>a.object.R?-1:a.distance-b.distance}),f[0];t&&(z.normalize(n,n),z.tf(we(t),n,n));I={xj:l,Bm:m,object:t,distance:s,Ab:n};g&&(I.oc=w);return I};function lr(a){this.a=a;this.canvas=a.f.c.kj()}var X={BUILDING:0,PLACE:1,TERRAIN:2,PANORAMA:3,ROAD:4,ROUTE:5},Zk=!0;
function mr(a,b,c,d,e){var f=[];d=d||!1;var g=null;e||(g=[X.PLACE,X.TERRAIN,X.BUILDING,X.PANORAMA,X.ROUTE],Zk&&g.push(X.ROAD));e=e||g;for(g=0;g<e.length;g++)f=f.concat(nr(a,e[g]));a.a.f.$g().update();return(b=hr(b,c,a.a.f.Ca,a.a.f.Ea,f,d,!0))?(c=or(b.object),c.point=b.point,c.Ab=b.Ab,c.Pn=void 0,b.object&&b.object.Y?c.Y=b.object.Y:b.oc&&b.oc.Oc&&(c.Y=b.oc.Oc.Y),Zk&&c.type===X.ROAD&&b.oc&&b.oc.Oc&&b.oc.Oc.Y&&(f=b.oc.Oc.Y.start,e=b.oc.Oc.Y.end,f&&e&&a.a.f.Ca&&(d=a.a.f.Ca.S,a=we(a.a.f.k.bd),f=z.I(a,
f),a=z.I(a,e),c.Pn=xh(f,a,d,b.point))),c):null}function pr(a,b){var c=a.a.a.d,d=c.a.cursor;d&&(c.b=b,b!==d.Qa()&&qr(c,!0))}function nr(a,b){switch(b){case X.PLACE:return rr(a.a.f);case X.PANORAMA:return[];case X.BUILDING:return sr(a.a.f);case X.TERRAIN:return tr(a.a.f);case X.ROAD:return ur(a.a.f);case X.ROUTE:return vr(a.a.f);default:return[]}}
function or(a){var b=X.TERRAIN,c=a.getName();a.sa===xg||a.sa===wg||a.sa===bh||a.sa===wr?b=X.PLACE:a.sa===Yg?b=X.PANORAMA:a.sa===Lg.BUILDING||a.sa===Ng?b=X.BUILDING:a.sa===Lg.TERRAIN?b=X.TERRAIN:a.sa===Wg||a.sa===Xg?b=X.ROAD:a.sa===Lg.ROUTE&&(b=X.ROUTE);return{type:b,id:c}};function xr(){this.e=new sa(function(a,c){return a||c});this.d=0;this.b=!1;this.a=null;yr(this,0);var a=this;this.c=function(b){b&&b==a.d||(a.d=b,a.b&&(b=a.e.call({target:a,timestamp:b}),void 0===b&&(b=!0),b?(b=a.c,a.b=!0,a.a.call(window,b)):a.stop()))}}function zr(a){var b=new xr;b.e.qc(a);return b}xr.prototype.start=function(){if(this.b)return this;var a=this.c;this.b=!0;this.a.call(window,a);return this};xr.prototype.stop=function(){this.b=!1;return this};
function yr(a,b){b||(a.a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame);if(b||!a.a){var c=Ar(),d=0,e=null,f=function(){var a=Ar();e(a-c);d=Ar()-a},g=1E3/b;a.a=function(a){e=a;window.setTimeout(f,Dc(0,g-d))}}}var Ar=window.performance?function(){return window.performance.now()}:function(){return Date.now()};Object.create(Be.prototype);Object.create(Be.prototype);z.create(0,0,0);var Br={pr:function(a){a.save();a.translate(0,0);a.beginPath();a.moveTo(0,0);a.lineTo(256,0);a.lineTo(256,256);a.lineTo(0,256);a.closePath();a.clip();a.translate(0,0);a.translate(0,0);a.scale(1,1);a.translate(0,0);a.strokeStyle="rgba(0,0,0,0)";a.lineCap="butt";a.lineJoin="miter";a.miterLimit=4;a.save();a.save();a.fillStyle="#ffffff";a.globalAlpha=0.5;a.beginPath();a.moveTo(2.5,2.5);a.lineTo(253.5,2.5);a.quadraticCurveTo(253.5,2.5,253.5,2.5);a.lineTo(253.5,253.5);a.quadraticCurveTo(253.5,253.5,253.5,
253.5);a.lineTo(2.5,253.5);a.quadraticCurveTo(2.5,253.5,2.5,253.5);a.lineTo(2.5,2.5);a.quadraticCurveTo(2.5,2.5,2.5,2.5);a.closePath();a.fill();a.stroke();a.restore();a.save();a.fillStyle="#ffffff";a.beginPath();a.moveTo(251,5);a.lineTo(251,251);a.lineTo(5,251);a.lineTo(5,5);a.lineTo(251,5);a.moveTo(256,0);a.lineTo(0,0);a.lineTo(0,256);a.lineTo(256,256);a.lineTo(256,0);a.lineTo(256,0);a.closePath();a.fill();a.stroke();a.restore();a.restore();a.restore()},or:function(a){a.save();a.translate(0,0);a.beginPath();
a.moveTo(0,0);a.lineTo(256,0);a.lineTo(256,256);a.lineTo(0,256);a.closePath();a.clip();a.translate(0,0);a.translate(0,0);a.scale(1,1);a.translate(0,0);a.strokeStyle="rgba(0,0,0,0)";a.lineCap="butt";a.lineJoin="miter";a.miterLimit=4;a.save();a.save();a.fillStyle="#ffffff";a.globalAlpha=0.5;a.beginPath();a.moveTo(128,253.5);a.bezierCurveTo(58.8,253.5,2.5010000000000048,197.199,2.5010000000000048,127.999);a.bezierCurveTo(2.501,58.798,58.8,2.5,128,2.5);a.bezierCurveTo(197.2,2.5,253.499,58.798,253.499,
127.999);a.bezierCurveTo(253.499,197.199,197.2,253.5,128,253.5);a.closePath();a.fill();a.stroke();a.restore();a.save();a.fillStyle="#ffffff";a.beginPath();a.moveTo(128,5);a.bezierCurveTo(160.85399999999998,5,191.74099999999999,17.794,214.973,41.025);a.bezierCurveTo(238.205,64.256,250.99900000000002,95.145,250.99900000000002,127.99799999999999);a.bezierCurveTo(250.99900000000002,160.85299999999998,238.205,191.73999999999998,214.973,214.97199999999998);a.bezierCurveTo(191.741,238.205,160.854,251,128,
251);a.bezierCurveTo(95.146,251,64.25800000000001,238.205,41.025999999999996,214.973);a.bezierCurveTo(17.794999999999995,191.74300000000002,5.000999999999998,160.854,5.000999999999998,127.99900000000001);a.bezierCurveTo(5.000999999999998,95.14500000000001,17.794999999999998,64.257,41.025999999999996,41.02600000000001);a.bezierCurveTo(64.25699999999999,17.795000000000016,95.146,5,128,5);a.moveTo(128,0);a.bezierCurveTo(57.308,0,0.001,57.307,0.001,127.999);a.bezierCurveTo(0.001,198.691,57.308,256,128,
256);a.bezierCurveTo(198.69,256,255.999,198.691,255.999,127.999);a.bezierCurveTo(255.999,57.307,198.69,0,128,0);a.lineTo(128,0);a.closePath();a.fill();a.stroke();a.restore();a.restore();a.restore()},nr:function(a){a.save();a.beginPath();a.moveTo(0,0);a.lineTo(256,0);a.lineTo(256,256);a.lineTo(0,256);a.closePath();a.clip();a.translate(0,0);a.translate(0,0);a.scale(1,1);a.translate(0,0);a.strokeStyle="rgba(0,0,0,0)";a.lineCap="butt";a.lineJoin="miter";a.miterLimit=4;a.save();a.restore();a.save();a.transform(0,
1,-1,0,245.993,-10.007);a.save();a.fillStyle="#ffffff";a.globalAlpha=0.5;a.beginPath();a.moveTo(68.862,204.919);a.lineTo(13.863,204.919);a.lineTo(128,32.863);a.lineTo(251.137,204.919);a.lineTo(187.138,204.919);a.lineTo(128,122.29);a.lineTo(68.862,204.919);a.closePath();a.fill();a.stroke();a.restore();a.save();a.fillStyle="#ffffff";a.beginPath();a.moveTo(128,37.159);a.lineTo(246.273,202.41899999999998);a.lineTo(188.422,202.41899999999998);a.lineTo(132.066,123.67499999999998);a.lineTo(128,117.99399999999999);
a.lineTo(123.934,123.67499999999998);a.lineTo(67.577,202.41899999999998);a.lineTo(18.727,202.41899999999998);a.lineTo(128,37.159);a.moveTo(128,28.567);a.lineTo(9,207.419);a.lineTo(70.147,207.419);a.lineTo(128,126.585);a.lineTo(185.853,207.419);a.lineTo(256,207.419);a.lineTo(128,28.567);a.lineTo(128,28.567);a.closePath();a.fill();a.stroke();a.restore();a.restore();a.restore()}};function Cr(){this.a=[]}function Dr(a){a.C=new Cr}function Er(a,b){var c;a:{c=0;for(var d=a.a.length;c<d;c++)if(a.a[c].$m===b)break a;c=-1}-1!==c&&a.a.splice(c,1)}Cr.prototype.U=function(a){for(var b=Array.prototype.slice.call(arguments),c=b.shift(),d=this.a,e=0,f=d.length;e<f;++e)for(var g=d[e],h=g.yn,k=0,l=h.length;k<l;++k){var m=h[k];c===m.type&&m.Eb.apply(g.$m,b)}};
function Fr(a,b,c,d){var e;b:{e=0;for(var f=a.a.length;e<f;e++)if(a.a[e].$m===b){e=a.a[e];break b}e=null}null!=e?a=e:(e={$m:b,yn:[]},a.a.push(e),a=e);-1===a.yn.indexOf(c)&&a.yn.push({type:c,Eb:d})}Cr.prototype.jh=function(){this.a=[]};function jr(a,b,c){this.x=a;this.y=b;this.z=K(c,0)}jr.prototype.constructor=jr;jr.prototype.Db=function(){return new jr(this.x,this.y,this.z)};jr.prototype.A=function(a){this.x=a.x;this.y=a.y;this.z=a.z};jr.prototype.toString=function(){return window.JSON.stringify(this)};function Pe(a,b,c,d){this.x=a||0;this.y=b||0;this.width=c||0;this.height=d||0}Pe.prototype.Db=function(){return new Pe(this.x,this.y,this.width,this.height)};Pe.prototype.A=function(a){this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height};Pe.prototype.set=function(a,b,c,d){this.x=a||0;this.y=b||0;this.width=c||0;this.height=d||0};Pe.prototype.toString=function(){return window.JSON.stringify(this)};var Gr=0;function Hr(a){this.id=a.gc||Gr++;this.Gb=a.Gb||null;this.Ic=a.Ic||null;this.wb=a.wb||{}}function Ir(a){this.id=a.gc||Gr++;this.a=a.hs||[];this.wb=a.wb||{}}Ir.prototype.Gb=function(a,b){for(var c=0,d=this.a.length;c<d;c++)this.a[c].start(b)};Ir.prototype.Ic=function(){for(var a=0,b=this.a.length;a<b;a++)this.a[a].end()};Ir.prototype.handleEvent=function(a){for(var b=0,c=this.a.length;b<c;b++)this.a[b].handleEvent.apply(this.a[b],arguments)};
function Jr(a){var b=Array.prototype.slice.call(arguments);this.d={};for(var c=0,d=b.length;c<d;c++)this.d[b[c].id]=b[c],this.d[b[c].id].Ga=this;this.g=b[0].id;this.a=null;this.b=this.c=!1}
Jr.prototype.e=function(a){var b=Array.prototype.slice.call(arguments),c=b.shift();this.c=!0;try{this.a&&this.a.Ic&&"function"===typeof this.a.Ic&&this.a.Ic.apply(this.a,arguments);var d=this.a?this.a.id:void 0;(this.a=this.d[c])&&this.a.Gb&&"function"===typeof this.a.Gb&&this.a.Gb.apply(this.a,[d].concat(b))}catch(e){throw this.c=!1,e;}this.c=!1};Jr.prototype.start=function(a){this.a=null;this.e(this.g,a)};Jr.prototype.end=function(){this.e()};
Jr.prototype.handleEvent=function(a){var b=Array.prototype.slice.call(arguments);if(this.b||this.c){var c=this;window.setTimeout(function(){c.handleEvent.apply(c,b)},0)}else{this.b=!0;try{var d=b.shift(),e=null;this.a&&(this.a.wb&&d in this.a.wb?e=this.a.wb[d].apply(this.a,b):this.a.handleEvent&&this.a.handleEvent.apply(this.a,arguments));e&&e in this.d&&this.e.apply(this,[e].concat(b))}catch(f){throw this.b=!1,f;}this.b=!1}};function Kr(a){var b=a.f,c=new Hr({gc:"initState",Gb:function(b){a.C.U("stateChanged",b,"initState")},Ic:function(){a.C.U("initialized",a)},wb:{CHANGE_PANORAMA_TO_GEO:function(a,c,d,f,g,h){e.a=h;Lr(b,a,f,c,d);return r.id},CHANGE_PANORAMA:function(){Za(b);return s.id},SHUTDOWN:function(){return h.id},FORCE_EXIT:function(a){if(a)return h.id}}}),d=new Hr({gc:"navigateState",Gb:function(c){a.C.U("stateChanged",c,"navigateState");a.Ga.handleEvent("ENABLE_CAMERA_INTERACTION");Mr(b.Z);b.k.fe=!0},Ic:function(){a.Ga.handleEvent("DISABLE_CAMERA_INTERACTION")},
wb:{CHANGE_PANORAMA:function(a){if(a!==b.k.r.id)return Za(b),s.id},CHANGE_PANORAMA_TO_GEO:function(a,c,d,e){Lr(b,a,e,c,d);return r.id},CHANGE_LOOK_AT:function(a,c,d){Lr(b,void 0,a,c,d);return m.id},CHANGE_FOV:function(){return l.id},FADED_IN:function(){a.pause()},FADED_OUT:function(){b.l.i.qf.start()},RELOAD:function(){Za(b);Lr(b,b.Cd);return s.id},DEACTIVATE:function(){return k.id},SHUTDOWN:function(){return h.id},EXIT:function(){return f.id},FORCE_EXIT:function(){return g.id}}}),e=new Hr({gc:"enterState",
Gb:function(c,d,f,g,h){a.C.U("stateChanged",c,"enterState");b.l.i.gb.Mc(g,h);b.l.i.gb.start();a.C.U("enterAnimationStarted");!1!==f&&!1!==e.a&&b.l.i.gb.pause();e.a=void 0;b.Dp&&b.l.i.gb.finish()},Ic:function(){a.C.U("panoramaChanged",b.k.r)},wb:{CHANGE_LOOK_AT:function(a,c,d){Lr(b,void 0,a,c,d)},START_ANIMATION:function(c,d){b.l.i.gb.Mc(c,d);b.l.i.gb.start();a.C.U("enterAnimationStarted");e.a=void 0},ENTER_ANIMATION_FINISHED:function(){a.C.U("enterAnimationFinished");a.C.U("moveToEnd");return e.c?
(e.c=!1,k.id):d.id},SHUTDOWN:function(){return h.id},FORCE_EXIT:function(){b.l.i.gb.pause();return g.id},DEACTIVATE:function(){e.c=!0;b.l.i.gb.finish()}}}),f=new Hr({gc:"interspaceState",Gb:function(c){a.C.U("stateChanged",c,"interspaceState");b.l.i.pc.start()},wb:{BOUNCE_ANIMATION_FINISHED:function(){if(z.$f(b.ya.S,b.k.r.ib().slice(0,3)))return d.id},TRANSLATION_ANIMATION_FINISHED:function(){return d.id},EXIT:function(){if(!b.l.i.pc.qa())return b.l.i.pc.pause(),g.id},FORCE_EXIT:function(){b.l.i.pc.pause();
return g.id},ENTER:function(){b.l.i.pc.wh=1;b.l.i.pc.Ee===q.STATE.Jf?b.l.i.pc.Af():b.l.i.pc.Ee===q.STATE.Sd&&b.l.i.pc.finish()},SHUTDOWN:function(){b.l.i.pc.pause();return h.id},DEACTIVATE:function(){b.l.i.pc.cancel();return k.id}}}),g=new Hr({gc:"exitState",Gb:function(c,d,e,f,h){g.Ac=d;a.C.U("stateChanged",c,"exitState");b.l.i.kd.Mc(f,h);b.l.i.kd.start();!1===e||d||b.l.i.kd.pause()},wb:{START_ANIMATION:function(){b.l.i.kd.qa()||b.l.i.kd.Af()},EXIT_ANIMATION_FINISHED:function(){a.C.U("exitAnimationFinished");
b.l.i.gb.ge=1;if(g.Ac)return h.id},CHANGE_PANORAMA_TO_GEO:function(a,c,d,f,g,h){Lr(b,a,f,c,d);e.a=h;b.gg=!0;b.l.i.gb.gm=!0;b.l.i.gb.te=b.am;b.l.i.gb.ge=1;b.l.i.kd.pause();return r.id},CHANGE_LOOK_AT:function(a,c,d){Lr(b,void 0,a,c,d);b.l.i.gb.te=b.am;b.l.i.gb.ge=1;b.l.i.kd.pause();return e.id},CHANGE_FOV:function(){return l.id},ENTER:function(){b.l.i.gb.te=b.am;b.l.i.gb.ge=1;b.l.i.kd.pause();return e.id},SHUTDOWN:function(){return h.id},FORCE_EXIT:function(a){if(a)return h.id},DEACTIVATE:function(){b.l.i.kd.cancel();
return k.id}}}),h=new Hr({gc:"offState",Gb:function(b){a.C.U("stateChanged",b,"offState");a.t(!1)}}),k=new Hr({gc:"idleState",Gb:function(c){a.C.U("stateChanged",c,"idleState");b.l.i.fh.start()},wb:{REACTIVATE:function(){a.Af();b.l.i.fh.cancel();b.l.i.vi.start()},ALL_FADED_IN:function(){return d.id},ALL_FADED_OUT:function(){a.pause()},SHUTDOWN:function(){return h.id},EXIT:function(){b.l.i.fh.cancel();b.l.i.vi.start();return f.id},FORCE_EXIT:function(){b.l.i.fh.cancel();b.l.i.vi.start();return g.id}}}),
l=new Hr({gc:"fovChangeState",Gb:function(c,d,e,f){a.C.U("stateChanged",c,"fovChangeState");Lr(b,void 0,void 0,e,f);b.l.i.rb.Od(gb.ld);b.l.i.ld.Fl=d*u;b.l.i.ai.start()},Ic:function(){b.l.i.rb.Od(gb.rb);a.C.U("lookAtChangeFinished")},wb:{FOV_ANIMATION_FINISHED:function(){if(!b.l.i.rb.qa())return d.id},LOOK_AT_ANIMATION_FINISHED:function(){if(!b.l.i.ld.qa())return d.id},CHANGE_PANORAMA_TO_GEO:function(a,c,d,f,g,h){Lr(b,a,f,c,d);e.a=h;b.l.i.ai.pause();return r.id},CHANGE_LOOK_AT:function(a,c,d){Lr(b,
void 0,a,c,d);return m.id},CHANGE_FOV:function(){b.l.i.ai.pause();return l.id},DEACTIVATE:function(){b.l.i.ai.cancel();return k.id},SHUTDOWN:function(){return h.id},EXIT:function(){b.l.i.ai.cancel();return f.id},FORCE_EXIT:function(){b.l.i.ai.cancel();return g.id}}}),m=new Hr({gc:"rotateState",Gb:function(c){a.C.U("stateChanged",c,"rotateState");b.l.i.rb.start()},Ic:function(){a.C.U("lookAtChangeFinished")},wb:{LOOK_AT_ANIMATION_FINISHED:function(){a.C.U("moveToEnd");return d.id},CHANGE_PANORAMA_TO_GEO:function(a,
c,d,f,g,h){Lr(b,a,f,c,d);e.a=h;b.l.i.rb.pause();return r.id},CHANGE_LOOK_AT:function(a,c,d){Lr(b,void 0,a,c,d);b.l.i.rb.pause();return m.id},CHANGE_FOV:function(){return l.id},DEACTIVATE:function(){b.l.i.rb.cancel();return k.id},SHUTDOWN:function(){return h.id},EXIT:function(){b.l.i.rb.cancel();return f.id},FORCE_EXIT:function(){b.l.i.rb.cancel();return g.id}}}),n=new Hr({gc:"transitionState",Gb:function(c){a.C.U("stateChanged",c,"transitionState");b.Z.fe=!0;b.k.dc.G(!0);b.Z.dc.G(!1);hb(b)?(a.pj().Vo(1),
b.l.i.Rj.start()):b.l.i.Sj.start()},Ic:function(){b.ca.oh();Ua(b.k);Ya(b.k);b.k.dc.G(!0);b.k.Gd();b.Z.dc.G(!1);Wa(b.k,b.Hd);b.k.Pd(b.xi);b.k.Bf(b.lg);b.cursor.G(!0);b.gh.G(!0);b.Z.clear();a.C.U("panoramaChanged",b.k.r)},wb:{TRANSITION_FINISHED:function(){a.C.U("moveToEnd");return d.id},CHANGE_PANORAMA_TO_GEO:function(){b.l.i.Rj.Rg(3);b.l.i.Sj.Rg(3)},CHANGE_LOOK_AT:function(){},CHANGE_FOV:function(){return l.id},FADED_OUT:function(){b.l.i.qf.start()},DEACTIVATE:function(){b.l.i.Rj.cancel();b.l.i.Sj.cancel();
return k.id},EXIT:function(){b.l.i.Rj.cancel();b.l.i.Sj.cancel();return f.id},FORCE_EXIT:function(){b.l.i.Rj.cancel();b.l.i.Sj.cancel();return g.id},SHUTDOWN:function(){return h.id}}}),r=new Hr({gc:"loadingMetacellState",Gb:function(c,d,e,f,g,h){a.C.U("stateChanged",c,"loadingMetacellState");a.C.U("isProcessing",!0);b.k.fe=!1;c=b.Zd;d=(d=Ta(c))?d.get():void 0;void 0===this.b&&(this.b=0);this.b++;cr().Zo(c.Ua(!0).get(),function(b){var c=b.b;return function(d){c===b.b&&(d?a.Ga.handleEvent("PANORAMA_AVAILABLE",
d.id,d.Rb):a.Ga.handleEvent("NO_PANORAMA_AVAILABLE"))}}(this),d,h||500)},Ic:function(){a.C.U("isProcessing",!1)},wb:{PANORAMA_AVAILABLE:function(c,e){a.C.U("panoramaAvailable",!0);if(e){var f=e.yk(c);return a.f.k.r&&a.f.k.r.id==f.id?(a.C.U("panoramaLoaded",f),b.l.i.fc.cancel(),b.k.fe=!0,m.id):s.id}ia();b.k.fe=!0;return d.id},NO_PANORAMA_AVAILABLE:function(){a.C.U("panoramaAvailable",!1);ia();b.l.i.fc.cancel();if(b.gg)return c.id;b.k.fe=!0;return d.id},CHANGE_PANORAMA_TO_GEO:function(a,c,d,f,g,h){Lr(b,
a,f,c,d);e.a=h;b.l.i.fc.cancel();return r.id},CHANGE_LOOK_AT:function(a,c,d){b.l.i.fc.cancel();Lr(b,void 0,a,c,d)},CHANGE_FOV:function(){return l.id},DEACTIVATE:function(){Nr();b.l.i.fc.cancel();return k.id},EXIT:function(){if(!b.gg)return b.l.i.fc.cancel(),f.id},FORCE_EXIT:function(){b.l.i.fc.cancel();return g.id},SHUTDOWN:function(){return h.id}}}),s=new Hr({gc:"loadingPanoramaState",Gb:function(c,d){a.C.U("stateChanged",c,"loadingPanoramaState");a.C.U("isProcessing",!0);a:{var e=cr().dn(d);if(!e)if(b.k.r)e=
b.k.r;else{b.Za.Ga.handleEvent("PANORAMA_NOT_FOUND");break a}b.Zd.wd(e.ta,!!Ta(b.Zd));var f=Or(b);Pr(f,e);Qr(f,!0);Rr(f,!0);!b.l.i.fc.qa()&&!b.gg&&b.vo&&hb(b)&&b.l.i.fc.start();f.rg.c(e.uj);f.fe=!0;Qr(f,!1);Rr(f,!1);f.Vm()}},Ic:function(){a.C.U("isProcessing",!1)},wb:{PANORAMA_LOADED:function(c){a.C.U("panoramaLoaded",c);return b.gg?(b.gg=!1,e.id):n.id},PANORAMA_NOT_FOUND:function(){a.C.U("panoramaLoaded",!1);Mr(Or(b));b.k.fe=!0;b.l.i.fc.cancel();return b.gg?(Pr(b.k,null),c.id):d.id},CHANGE_PANORAMA_TO_GEO:function(a,
c,d,f,g,h){Lr(b,a,f,c,d);e.a=h;b.l.i.fc.cancel();Mr(Or(b));Or(b).clear();return r.id},CHANGE_LOOK_AT:function(a,c,d){b.l.i.fc.cancel();Lr(b,void 0,a,c,d)},CHANGE_FOV:function(){b.l.i.fc.cancel();return l.id},DEACTIVATE:function(){b.l.i.fc.cancel();Nr();return k.id},EXIT:function(){if(!b.gg)return b.l.i.fc.cancel(),f.id},FORCE_EXIT:function(){b.l.i.fc.cancel();return g.id},SHUTDOWN:function(){return h.id}}}),t=new Ir({gc:"parallelStateMachines",hs:[new Jr(c,d,k,h,g,f,e,r,s,m,l,n),new Jr(Sr(),Tr(a.navigation),
Ur(a.navigation))]});return new Jr(t)};function Bo(a,b){this.b=this.a=null;a instanceof Bo?this.set(a.get()):a instanceof Array&&this.set(a,b)}Bo.prototype.set=function(a,b){1===b?(this.a=Jj(a),this.b=7===a.length?a.slice(0,7):Fj(this.a)):2===a.length||void 0===a[2]?(this.a=a.slice(0,2),this.b=Fj(this.a.concat([0]))):(this.a=a.slice(0,3),this.b=Fj(this.a));return this};Bo.prototype.get=function(a){return 1===a?this.b:this.a};function Ra(a){return a.get(1)}function tb(a){return a.b?Ha(a.b):null}function Vr(a,b){return Wr(a,b)}
Bo.prototype.normalize=function(){var a=Ip(this.get()||[]);this.set(a);return this};Bo.prototype.$a=function(){return!(isNaN(this.a[0])||isNaN(this.a[1])||2<this.a.length&&isNaN(this.a[2]))};function Wr(a,b){return a&&b&&Ra(a)&&Ra(b)?2===a.get().length||2===b.get().length?1E-5>=P.distance(a.get()||[],b.get()||[]):1>=z.distance(Ra(a)||[],Ra(b)||[]):!1};function Xr(a){this.b=this.a=null;this.e=this.d=this.c=0;this.j=Yr;this.g={Cn:{min:Zr,max:$r},ld:{min:as,max:bs}};a&&this.set(a)}var cs={HEADING:"heading",uq:"tilt",eq:"fov"};p=Xr.prototype;
p.set=function(a,b,c,d,e,f){this.b=this.a=null;this.e=this.d=this.c=0;this.j=Yr;a instanceof Xr?(this.g=Rc(a.g),c=b=null,a.Ua()&&a.Ua().get()&&(b=new Bo(a.Ua())),Ta(a)&&Ta(a).get()&&(c=new Bo(Ta(a))),this.set(b,c,a.fa(),a.ia(),ds(a),a.ka())):(f&&this.Ja(f),a&&a.get()&&this.wd(new Bo(a)),b&&b.get()&&es(this,new Bo(b),!0),a&&b?this.e=null:("number"===typeof c&&this.sb(c,!!b),"number"===typeof d&&this.Cb(d,!!b),"number"===typeof e&&fs(this,e,!!b)));return this};
p.wd=function(a,b){b&&!Wr(a,this.b)?(this.b=Ta(this,!0),this.e=this.d=this.c=null):(this.c=this.fa(!0),this.d=this.ia(!0),this.b=null);this.a=a};function es(a,b,c){c&&!Wr(b,a.a)?(a.a=a.Ua(!0),a.c=null,a.d=null,a.e=null):(a.c=a.fa(!0),a.d=a.ia(!0),a.a=null);a.b=b}p.sb=function(a,b){this.b&&this.a&&(this.e=ds(this,!0));this.d=this.ia(!0);b?(this.b=Ta(this,!0),this.a=null):(this.a=this.Ua(!0),this.b=null);a=gs(this,cs.HEADING,a);this.c=hs(a)};
p.Cb=function(a,b){this.b&&this.a&&(this.e=ds(this,!0));this.c=this.fa(!0);b?(this.b=Ta(this,!0),this.a=null):(this.a=this.Ua(!0),this.b=null);a=gs(this,"tilt",a);this.d=0.001*Math.round(a/0.001)};function fs(a,b,c){a.c=a.fa(!0);a.d=a.ia(!0);c?(a.b=Ta(a,!0),a.a=null):(a.a=a.Ua(!0),a.b=null);a.e=b}p.Ja=function(a){this.j=a=gs(this,"fov",a)};function is(a,b,c,d){a.g[b]||(a.g[b]={min:0,max:0});a.g[b].min=c;a.g[b].max=d;a["_"+b]=gs(a,b,a["_"+b])}
p.Ua=function(a){return!this.a&&this.$a()?a&&Ra(this.b)?jb(this.b.get(1),(this.c||0)-180,-this.d||0,this.e||0):null:this.a};function Ta(a,b){return!a.b&&a.$a()?b&&a.a.$a()&&Ra(a.a)?jb(Ra(a.a),a.c||0,a.d||0,a.e||0):null:a.b}p.fa=function(a){if(a&&this.a&&this.b){a=this.a;a=(a.b?Ja(a.b):null)||[];var b=z.create(0,1,0),c=tb(this.a)||[],d=Ra(this.b)||[],e=Ra(this.a)||[];z.sub(d,e,b);z.normalize(b,b);if(1E-5>Math.abs(Math.abs(z.L(c,b))-1))return 0;a=xc(Math.atan2(z.L(c,z.pa(b,a)),z.L(b,a)));return a=hs(a)}return this.c};
p.ia=function(a){if(a&&this.a&&this.b){a=tb(this.a)||[];var b=z.create(0,1,0),c=Ra(this.b)||[],d=Ra(this.a)||[];z.sub(d,c,b);z.normalize(b,b);a=xc(Math.acos(tc(z.L(b,a),-1,1)));return a=0.001*Math.round((a-90)/0.001)}return this.d};function ds(a,b){return b&&!a.e?a.a&&a.b?z.distance(Ra(a.a)||[],Ra(a.b)||[]):0:a.e}p.ka=function(){return this.j};p.$a=function(){return!!this.a&&!!this.b||(!!this.a||!!this.b)&&"number"===typeof this.c&&"number"===typeof this.d};
function gs(a,b,c){c=c||0;return a.g[b]?Fc(c,a.g[b].min,a.g[b].max):c}function jb(a,b,c,d){a=new Bo(a,1);d=void 0===d?50:d;if(0===d)return a;var e=(a.b?Ja(a.b):null)||[],f=tb(a)||[];b=Oa(Ka(f,(360-b)*u));b=z.normalize(z.I(b,e));f=z.normalize(z.pa(f,b));c=Ka(f,-c*u);c=Oa(c);c=z.normalize(z.I(c,b));a=z.add(Ra(a)||[],z.scale(c,d));d=new Bo;d.set(a,1);return d}function hs(a){a=a%360;0>a&&(a+=360);360===a&&(a=0);return 0.001*Math.round(a/0.001)}var Zr=-90,$r=90,as=40,bs=150;function js(a,b){return a<b};function ks(a){this.a=[];this.b=a||js}p=ks.prototype;p.size=function(){return this.a.length};p.push=function(a){var b=this.a;b.push(a);a=this.b;for(var c=b.length-1;0<c;){var d=c-1>>1;if(a(b[c],b[d])){var e=b[d];b[d]=b[c];b[c]=e;c=d}else break}};p.top=function(){var a=this.a;if(0===a.length)throw Error("underflow");return a[0]};
p.pop=function(){var a=this.a;if(0===a.length)throw Error("underflow");var b=a[0],c=a.pop();if(0<a.length){a[0]=c;for(var c=this.b,d=0,e=1<a.length?a.length-2>>1:0;d<=e;){var f=(d<<1)+1,g=(d<<1)+2,h=d;f<a.length&&c(a[f],a[d])&&(h=f);g<a.length&&c(a[g],a[h])&&(h=g);if(h!=d)f=a[h],a[h]=a[d],a[d]=f,d=h;else break}}return b};p.valid=function(){for(var a=this.a,b=this.b,c=1,d=a.length;c<d;++c)if(b(a[c],a[c-1>>1]))return!1;return!0};var ls={};function ms(){var a=ns;this.b=new ks(a);this.a=new ks(a);this.e=0;this.d=this.c=!1}function os(){ps||(ps=new ms);return ps}ms.deleteInstance=function(){ps&&(ps.pause(!0),ps.b=null,ps=ps.a=null)};ms.prototype.pause=function(a){a!==this.d&&((this.d=a)?this.c&&(clearTimeout(this.e),this.e=0,this.c=!1):qs(this))};ms.prototype.paused=function(){return this.d};
function qs(a){a.paused()||a.c||!a.b.a.length&&!a.a.a.length||(a.e=setTimeout(function(){a.c=!1;if(a.paused()||!a.b.a.length&&!a.a.a.length)return!1;var b;b=rs(a.b,a.a);b||(b=a.a,a.a=a.b,a.b=b,b=rs(a.b,a.a));if(b)try{b.a=2;var c=b.e();ls===c?(b.paused()||(b.a=1),a.a.push(b)):b.a=4}catch(d){b.a=4,b.c=d}b&&4===b.state()&&b.d();qs(a)},1),a.c=!0)}function rs(a,b){for(;a.a.length;){var c=a.pop(),d=c.state();if(1===d)return c;3===d&&b.push(c)}return null}function ns(a,b){return a.b()<b.b()}var ps=null;function fj(a,b,c){if(a instanceof fj)Be.call(this,a),this.width=a.width,this.height=a.height,this.$k=a.$k,this.al=a.al;else if(a instanceof lp){b=b||Qb;Ub(b.width)&&Ub(b.height)&&(this.width=b.width,this.height=b.height,this.$k=K(b.$k,1),this.al=K(b.al,1));this.Fn=K(b.Fn,0);this.Kn=K(b.Kn,0);this.En=K(b.En,1);this.Jn=K(b.Jn,1);var d,e=this.width,f=this.height;d=this.$k;var g=this.al,h=b.Uo,k=this.Fn,l=this.Kn,m=this.En,n=this.Jn;null==ss&&(ss=new Me({position:new Le(7,3,0),texcoord:new Le(7,2,12),
normal:new Le(7,3,20)}));for(var r=new qf(ss),s=0.5*e,t=0.5*f,v=m-k,w=n-l,x=h?-1:1,n=0;n<=g;++n)for(m=0;m<=d;++m){var y=m/d,A=n/g;tf(r,-s+e*y,-t+f*A,0,k+v*y,l+w*A,0,0,x)}e=d+1;for(n=0;n<g;++n)for(m=0;m<d;++m)f=m+0+e*(n+0),k=m+1+e*(n+0),l=m+1+e*(n+1),s=m+0+e*(n+1),h?wf(r,s,l,k,f):wf(r,f,k,l,s);d=r.hb();a=new pd(a,d);Be.call(this,a,c);b.name&&this.fb(b.name)}}var ss=null;fj.prototype=Object.create(Be.prototype);function ts(a){this.j=a;this.K=this.j.N();this.v=this.s=this.c=this.g=this.e=0;this.H=new us(0,0,0,0,0);this.p=[];this.o=!1;this.yp=new sa;this.M=function(){this.yp.call()}.bind(this);this.Ej=new sa;this.n=function(){this.Ej.call()}.bind(this);this.d=vs(this,this.n,this.M);this.b=ws(this,this.n);this.a=null}ts.prototype.t=function(){this.b=this.d=this.n=this.M=this.K=this.j=null};ts.prototype.N=function(){return this.K};
function xs(a,b,c,d){var e=a.H;a:{var f=a.p,g;if(f.length&&(g=f[f.length-1],g.Sk==b)){g.set(b,c,d,0,0);ys(g,a.K);b=g;break a}3>f.length?(g=new us(b,c,d,0,0),f.push(g)):(g=f.shift(),f.push(g),g.set(b,c,d,0,0));ys(g,a.K);b=g}a.s=b.ff-e.ff;a.v=b.gf-e.gf;a.o=!0}ts.prototype.update=function(){if(this.o){var a=this.g-this.v,b=this.c-0,c=this.K;c.sb(this.e-this.s);c.Cb(a);c.Ja(b);this.o=!1}};function vs(a,b,c){b=new zs(a.j,b,c);a.j.l.l.add(b);return b}
function ws(a,b){var c=new As(a.j,b);a.j.l.l.add(c);return c}function us(a,b,c,d,e){this.set(a,b,c,d,e)}us.prototype.set=function(a,b,c,d,e){this.Sk=a;this.a=b;this.b=c;this.vg=d;this.ye=e;this.gf=this.ff=0};function ys(a,b){var c;c=b.d.Ea;var d=b.K,e=new jr(a.a,a.b),e=ir(c,e),e=kr(c,e);c={x:Math.atan2(ab(d.Yb,d.ac,0.5*(e[0]+1)),d.Yd),y:Math.atan2(ab(d.kc,d.nc,0.5*(e[1]+1)),d.Yd)};a.ff=c.x*Bc;a.gf=c.y*Bc}function Bs(a,b,c,d,e,f,g,h){this.set(a,b,c,d,e,f,g,h)}
Bs.prototype.set=function(a,b,c,d,e,f,g,h){this.ff=e;this.gf=f;this.a=h};function zs(a,b,c){q.call(this,{td:this.tb,Sb:b,Eb:this.Va});this.va=c;this.M=a;this.K=this.M.N();this.p=this.v=this.s=this.a=0;var d=this;this.Fj.qc(function(){d.Ee===q.STATE.Sd&&b.call(this)})}ha(zs,q);zs.prototype.t=function(){q.prototype.t.call(this);this.K=this.M=this.va=null};
function Cs(a,b,c,d){a.s=b;a.v=c;a.p=d;a.a=0.995;b=1E-6>xb(b)?0:Lc(xb(1E-6/b),a.a);c=1E-6>xb(c)?0:Lc(xb(1E-6/c),a.a);d=1E-6>xb(d)?0:Lc(xb(1E-6/d),a.a);a.Od(Dc(d,Dc(b,c)));q.prototype.start.call(a)}zs.prototype.tb=function(){var a=this.K;this.e=a.fa();this.g=a.ia();this.c=a.ka();this.va();this.M.u()};
zs.prototype.Va=function(a){var b=a*this.duration,c=Ds(this.s,this.a,b),d=Ds(this.v,this.a,b),b=Ds(this.p,this.a,b),d=this.g-d,b=this.c-b,e=this.K;e.sb(this.e-c)||(this.e=e.fa(),this.s=0);e.Cb(d)||(this.g=e.ia(),this.v=0);e.Ja(b)||(this.c=e.ka(),this.p=0);0.4<Ds(1,this.a,a)&&(this.p=this.v=this.s=0);this.s||this.v||this.p||this.stop();this.M.u()};function Ds(a,b,c){return a*(Math.pow(b,c)-1)/Math.log(b)}
function As(a,b){q.call(this,{duration:Infinity,td:this.Va,Sb:b,Eb:this.va});this.v=a;this.K=this.v.N();this.a=this.s=this.p=this.M=0}As.prototype=Object.create(q.prototype);As.prototype.t=function(){q.prototype.t.call(this);this.K=this.v=null};As.prototype.Va=function(){this.M=Date.now();this.v.u()};
As.prototype.va=function(){var a=Date.now(),b=a-this.M;this.M=a;a=this.K;this.e=a.fa();this.g=a.ia();this.c=a.ka();var c=this.g-this.s*b,d=this.c-this.a*b;a.sb(this.e-this.p*b)||(this.p=0);a.Cb(c)||(this.s=0);a.Ja(d)||(this.a=0);this.p||this.s||this.a||this.stop();this.v.u()};function Es(a){this.c=a.Za;this.a=a;this.d=!0;this.e=P.create(0,0);this.b=!0;this.a.N().$c.qc(this.j.bind(this))}Es.prototype.t=function(){this.a.N()&&this.a.N().$c&&this.a.N().$c.disconnect();this.c=this.a=null};var Fs=Zk?[X.PLACE,X.BUILDING,X.TERRAIN,X.ROAD]:[X.PLACE,X.BUILDING,X.TERRAIN];Es.prototype.j=function(){this.d=!0;this.a.u()};
Es.prototype.update=function(){if(this.d&&this.c.n&&this.b){var a=Gs(this),b=Hs,c=this.a.cursor,d=this.a.Ca;if(this.b&&c&&d&&a.object){var e=c.qb(),f=c.Jd,g=a.object,h=a.point,b=a.Ab,k=d.S,l=z.distance(k,h),m=1+0*l,l=1+0*l;c.G(this.b);se(c,h);ve(c.qb(),[m,m,m]);ve(c.Jd,[l,l,l]);var l=Lg.BUILDING,n=Ng,r=g.sa,m=R(),g=Yc();if(l===r||n===r)h=Ha(h),k=z.pa(h,b),z.pa(b,k,h),Ed(k,h,b,m),md(m,g),a=we(d),h=z.create(a[8],a[9],a[10]),b=z.pa(b,h),b=z.L(ub(d),b),b=Math.acos(b),b>-nc&&b<nc?(f.d=3,f.ob(),b=Is):(f.d=
1,f.ob(),b=Js),f.g=2,f.ob();else if(!Zk||Wg!==r&&Xg!==r)!Zk||bh!==r&&xg!==r&&wg!==r&&wr!==r?(h=Ja(h),k=z.pa(b,h),z.pa(k,b,h),Ed(h,k,b,m),md(m,g),f.d=2,f.ob(),f.g=1,f.ob(),b=Ks):b=Ls;else if(a.info&&a.info.Oc&&a.info.Oc.Y)if(l=a.info.Oc.Y.start,n=a.info.Oc.Y.end,l&&n){a=we(this.a.k.bd);l=z.I(a,l);a=z.I(a,n);if(h=xh(l,a,k,h))k=z.pa(b,h),z.pa(k,b,h),Ed(h,k,b,m),md(m,g);f.d=2;f.ob();f.g=1;f.ob();b=Ms.ROAD}else b=Ls;else b=Ls;ze(e,g);ze(f,ye(d))}else b=Ls;c&&(d=b,d!==c.c&&(c.c=d,c.an.call({target:c,state:d})));
d=this.c;c=this.e;if(c=mr(d.b,c[0],c[1],!0,Fs))e=Jj(c.point),d.C.U("cursorChanged",e),d.o=e;if(c){if(d=X.BUILDING,f=e=Jj(c.point),b=cr().zp(f,1,50),e=null,g=Number.MAX_VALUE,b&&0<b.length&&(e=b[0],f=Ga(f),g=z.distance(f,e.eb())),e={distance:g,r:e},e.r){f=!0;if(10>e.distance||c.type===d)g=e.r.eb(),e=d=!0,f=this.a.gh,b=this.a.Ca,(g=Gj(this.a,g,!0))?(se(f,g),ze(f.qb(),g.slice(3,7)),m=c.point,k=h=1,c.type!==X.BUILDING?(c=z.distance(m,g),k=h=Math.min(1,(10-c)/10),h*=1+0*c,k*=1+0*c):e=!1,ve(f.qb(),[h,h,
h]),ve(f.Jd,[k,k,k]),ze(f.Jd,ye(b))):d=!1,g&&d&&f.G(d),f=!e;f&&Ns(this)}}else Ns(this);this.d=!1}};function qr(a,b){if(b||a.b)a.d=!0,a.a.u()}function Gs(a){var b=a.e;return Os(a.a,b[0],b[1],function(a){var b=a.sa;return b!=ah&&b<=Yg&&a.Qa()})}
Es.prototype.g=function(a){switch(1){case 1:var b=a.target,c=b.qb(),d=b.Jd,e=this.a.gh,f=e.qb(),e=e.Jd,g=this.c;c.G(!0);d.G(!1);f.G(!1);e.G(!1);switch(a.state){case Hs:case Ls:b.G(!1);c.G(!1);break;case Ks:case Ps:b.G(!0);c.za(g.d.cursor_ground);break;case Js:case Is:b.G(!0);c.za(g.d.cursor_wall);break;case Ms.ROAD:Zk&&(b.G(!0),c.za(g.d.cursor_road))}}};function Ns(a){var b=a.a.gh;b&&!1!==b.Qa()&&qr(a)};function Qs(a){this.e=a;this.a=new ts(a);this.d=new Es(a);this.g=this.update.bind(this);this.e.aa.qc(this.g);this.c=this.b=!1}Qs.prototype.t=function(){this.e.aa.disconnect(this.g);this.a.t();this.d.t();this.d=this.a=this.e=this.g=null};Qs.prototype.update=function(){this.a.update();this.d.update()};
function Rs(a,b,c,d){if(a.c){a=a.a;var e=a.K;a.e=e.fa();a.g=e.ia();a.c=e.ka();a.a=new Bs(0,0,0,0,c,b,0,d);b=a.a.ff;c=a.a.gf;d=a.a.a;5E-4>xb(b)&&5E-4>xb(c)&&5E-4>xb(d)||(a=a.b,a.p=b,a.s=c,a.a=d,q.prototype.start.call(a))}};function Ss(a){this.f=a.f;this.a=a.Ga;this.b=null;this.c=!1}Ss.prototype.t=function(){this.c=!0;this.b=this.a=this.f=null};function Sr(){return new Hr({gc:"noCameraState",wb:{ENABLE_CAMERA_INTERACTION:function(){return"panoramaCameraState"},CHANGE_TO_THIRD_PERSON:function(){return"freeCameraState"}}})}
function Tr(a){var b=a.f;return new Hr({gc:"panoramaCameraState",Gb:function(){ma();b.Ca=b.ya;b.k.Lc(!1);b.Z.Lc(!1);b.Z.Xe(!1);b.u()},Ic:function(){if(!a.c){var c=a.b;c&&(c=c.a,c.d.stop(),c.b.stop());b.k.Lc(b.wi);b.Z.Lc(b.wi);b.Z.Pd(!0);b.u()}},wb:{CHANGE_TO_THIRD_PERSON:function(){return"freeCameraState"},TOGGLE_CAMERA:function(){return"freeCameraState"},TILT:function(a,d){!1===d&&(a=b.N().ia()+a);b.N().Cb(a)},HEADING:function(a,d){!1===d&&(a=b.N().fa()-a);b.N().sb(a)},DISABLE_CAMERA_INTERACTION:function(){return"noCameraState"}}})}
function Ur(a){var b=a.f;return new Hr({gc:"freeCameraState",Gb:function(){ma();b.Ca=b.b;b.k.Lc(b.wi);b.Z.Lc(!0);b.Z.Xe(b.vf);b.u()},Ic:function(){},wb:{CHANGE_TO_PANORAMA_CAMERA:function(){return"panoramaCameraState"},TOGGLE_CAMERA:function(){return"panoramaCameraState"},TILT:function(a){b.b.Cn(a*u);b.u()},HEADING:function(a){b.b.Or(a*u);b.u()},ROLL:function(a){b.b.Gp(a*u);b.u()},MOVE_FORWARD:function(a){var d=Rf(b.b);b.b.translate(z.scale(d,a));b.u()},MOVE_HORIZONTALLY:function(a){var d=Qf(b.b);
b.b.translate(z.scale(d,a));b.u()},MOVE_VERTICALLY:function(a){var d=ub(b.b);b.b.translate(z.scale(d,a));b.u()},SET_TO_PANORAMA:function(){se(b.b,z.A(b.ya.S));ue(b.b,Zc(b.ya.Ak()));b.u()},DISABLE_CAMERA_INTERACTION:function(){return"noCameraState"}}})}Ss.prototype.sb=function(a,b){this.a.handleEvent("HEADING",a,!0,b)};Ss.prototype.Cb=function(a){this.a.handleEvent("TILT",a,!0)};function ph(a,b,c){this.a=[];this.b=[];this.c=a;this.d=b;this.e=c}ph.prototype.qc=function(a,b){if(a){var c=b||null,d=this.b;this.a.push(a);d.push(c);(d=this.d)&&d(a,c)}};ph.prototype.disconnect=function(a,b){if(a)for(var c=b||null,d=this.a,e=this.b,f=0;f<d.length;)if(d[f]===a&&e[f]===c){d.splice(f,1);e.splice(f,1);var g=this.e;g&&g(a,c)}else++f;else this.a.length=0,this.b.length=0};
ph.prototype.call=function(a){var b=this.a.slice(),c=this.b.slice(),d=this.c;if(d){for(var e=[],f=0,g=b.length;f<g;++f)e.push(b[f].apply(c[f],arguments));return 0===e.length?void 0:e.reduce(d)}f=0;for(g=b.length;f<g;++f)e=b[f].apply(c[f],arguments);return e};function ui(){this.font=this.name=null;this.size=0;this.outlineColor=this.color=null;this.outlineWidth=0;this.shadowColor=null;this.Ff=0;this.b=this.a=!1};function Ts(){this.c=this.b=null;this.g={};this.j={};this.d="undefined";this.a=0;this.e=this.o=250;this.n=null}var Us=null,Vs="undefined",Ws={},Xs={},Ys=[];function Zs(){null==Us&&(Us=new Ts,Dr(Us));return Us}Ts.deleteInstance=function(){Us&&(Us=null)};Ts.prototype.t=function(){$s(this);this.c=this.b=null;this.g={};this.j={};this.C.jh();this.d=this.C=null;Ws={};Xs={};Ys=[];Vs=null};
function at(a){var b="";void 0!=a.a&&a.a&&(b+="small-caps ");void 0!=a.b&&a.b&&(b+="italic ");return b+=a.size+"pt "+a.font+", Arial, Helvetica, sans-serif"}function bt(a){var b=Us;Vs=a;na();b.d=a;"failed"===b.d&&$s(b);b.C.U(a)}function ct(a){a.b||(a.b=document.createElement("canvas"),a.c=a.b.getContext("2d"),a.b.width=20,a.b.height=20)}
Ts.prototype.measureText=function(a,b){"loaded"===Vs||la();var c=0,d=a+b.font+b.size+b.a+b.b;void 0!=this.j[d]?c=this.j[d]:(ct(this),this.c.font=at(b),c=this.c.measureText(a).width,0===c&&ja(),c=c+2*b.outlineWidth+2*b.Ff,this.j[d]=c);var e,d=at(b);void 0!=this.g[d]?e=this.g[d]:(e=b.size+2*b.outlineWidth+2*b.Ff,this.g[d]=e);return{width:c,height:1.25*e}};
function dt(a,b,c){if(void 0!==Xs[b]){if(!0===Xs[b])return!0;if(void 0!==c&&!c)return!1}ct(a);if(!a.c)return!1;a.c.clearRect(0,0,a.b.width,a.b.height);a.c.font='12pt "'+b+'"';a.c.fillStyle="rgb(255, 255, 255)";a.c.fillText(".",10,10);a=a.c.getImageData(0,0,a.b.width,a.b.height).data;c=!0;var d,e;d=0;for(e=a.length;d<e;d+=4)if(0!==a[d]){c=!1;break}if(c)return na(),Xs[b]=!1;na();return Xs[b]=!0}
function et(a){var b=!1;null!==a.n&&(b=3E4<(new Date).getTime()-a.n);na();var c=0;if(b)ja(),a.d="failed",0!==a.a&&$s(a);else{Ys=[];b=null;for(b in Ws){var d=Ws[b];"loading"===d?Ys.push(b):"loaded"===d&&(dt(a,b,!0)?(d="loaded",Ws[b]=d,a.C.U(d,b)):Ys.push(b));!1===Xs[b]&&c++}0===c&&0===Ys.length?$s(a):0!==a.a?ft(a):gt(a)}}function gt(a){0===a.a&&(0!==a.a&&(window.clearTimeout(a.a),a.a=0),"loading"===a.d||"loaded"===a.d)&&(a.n=(new Date).getTime(),a.e=a.o,na(),ft(a))}
function ft(a){0!==a.a&&(window.clearTimeout(a.a),a.a=0);if("loading"===a.d||"loaded"===a.d)na(),a.a=window.setTimeout(function(){et(a);a.e*=1.1},a.e)}function $s(a){if(0!==a.a){na();0!==a.a&&(window.clearTimeout(a.a),a.a=0);na();na();na();var b=null;for(b in Ys)a.C.U("failed",Ys[b])}else la()};var ht={Yn:0,POSITION:1,HEADING:2,uq:4,Ys:8,eq:16,zs:32};function it(a){this.$c=new sa;this.c=new sa;this.d=a;this.K=a.ya;a={};a[4]={min:Zr,max:$r};a[16]={min:as,max:bs};this.b=a;this.a=!1}function jt(a,b,c,d){var e=a.b;e[b]=e[b]||{};switch(b){case ht.HEADING:case 4:case 8:case 16:e[b].min=0!==c?c:void 0;e[b].max=360!==d?d:void 0;break;default:e[b].min=c,e[b].max=d}if(void 0!==c||void 0!==d)c=kt(a,b),lt(a,b,c)}p=it.prototype;p.Ua=function(){return new Bo(this.K.S,1)};
function Xa(a,b){se(a.K,b);a.$c.call()}function Va(a,b,c,d){d&&se(a.K,d);a.K.rb(b,c);a.$c.call()}p.fa=function(){return kt(this,ht.HEADING)};p.sb=function(a){return lt(this,ht.HEADING,a)};p.ia=function(){return kt(this,4)};p.Cb=function(a){return lt(this,4,a)};p.ka=function(){return kt(this,16)};p.cg=function(){return kt(this,32)};p.Ja=function(a){return lt(this,16,a)};
function kt(a,b){var c;switch(b){case ht.HEADING:c=mt(a);break;case 4:c=nt(a);break;case 8:c=ot(a);break;case 16:c=a.K.ka()*Bc;break;case 32:c=a.K.cg()*Bc}return 0.001*Math.round(c/0.001)}
function lt(a,b,c){var d=kt(a,b);var e=a.b[b];if(e){var f=e.min,e=e.max;a.a=!1;"number"===typeof c&&(void 0!==f&&c<f?(a.a=!0,a.c.call(b,c,f),c=f):void 0!==e&&c>e&&(a.a=!0,a.c.call(b,c,e),c=e))}if("number"===typeof c&&d!==c){switch(b){case ht.HEADING:b=c;b=(mt(a)-b)*Ac;1E-6<=xb(b)&&a.K.rotateAxisAngle(Ha(a.K.S),b);break;case 4:b=c;d=nt(a);b=(b-d)*Ac;1E-6<=xb(b)&&a.K.Cn(b);break;case 8:b=ot(a);1E-6<xb(b)&&a.K.Gp(b);break;case 16:a.K.Ja(c*Ac)}a.$c.call()}return!a.a}
function nt(a){var b=Ha(a.K.S),c=Rf(a.K);a=ub(a.K);c=z.L(b,c);c=Math.acos(Fc(c,-1,1))*Bc;b=z.L(b,a);b=Math.acos(Fc(b,-1,1))*Bc;return 90>=c?90>=b?b:90+c:90>=b?90-c:-b}function mt(a){var b=Ha(a.K.S),c=Rf(a.K),d=z.create(),e=z.L(c,b);0.7<e?c=z.vp(ub(a.K)):-0.7>e&&(c=ub(a.K));z.scale(b,z.L(c,b),d);z.sub(c,d,d);z.normalize(d,d);a=Ja(a.K.S);b=Math.atan2(z.L(b,z.pa(d,a)),z.L(d,a))*Bc;0>b&&(b+=360);return b%360}
function ot(a){var b=0,c=Ha(a.K.S),d=Rf(a.K),d=z.pa(c,d),e=z.length(d);1E-6<=e&&(z.scale(d,1/e,d),a=ub(a.K),c=z.L(c,a),d=z.L(d,a),b=Math.atan2(c,d));return(b-hc)*kc};function pt(){this.on=[]}pt.prototype.clear=function(){this.on=[]};function qt(a){this.height=a;this.ta=this.a=null;this.b=0}p=qt.prototype;p.clear=function(){this.b=0};p.ue=function(a,b,c,d){this.b++;d&&(d.Id=[0],d.ua=[this.height],d.minHeight=d.maxHeight=this.height);return this.height};p.mh=function(a,b,c,d){this.b++;d.ua=[this.height];d.Id=[0];d.minHeight=this.height;return d.maxHeight=this.height};p.kf=function(){return!0};p.Xk=function(){};p.Hj=function(){return this.height};p.qi=function(){return 1};p.Qb=function(){return!1};function rt(){}p=rt.prototype;p.Na=function(){};p.Da=function(){};p.Fb=function(){};p.pl=function(){};p.od=function(){};function st(){}p=st.prototype;p.Na=function(){};p.Da=function(){};p.Fb=function(){};p.Yj=function(){};p.od=function(){};p.ml=function(){};function lp(){}p=lp.prototype;p.Pa=function(){};p.Je=function(){};p.pk=function(){};p.nf=function(){};p.dm=function(){};var tt=function(){var a=0;return function(b,c,d){var e=b.Pa().getContext();this.B=e;this.ga=a++;this.ra=b;this.da=c;this.Jg=d;this.Lf=e.createBuffer();this.nb=!1}}();tt.prototype=Object.create(rt.prototype);p=tt.prototype;p.Na=function(){this.ra.pk(this)};p.Da=function(){return this.ga};p.Fb=function(){return this.da};
p.pl=function(a){var b=K(b,0),c=a.byteLength;b+c>this.da&&F("buffer overflow");var d=this.B;this.ra.Pa().Lg(this);this.nb?d.bufferSubData(d.ARRAY_BUFFER,b,a):(0===b&&c===this.da?d.bufferData(d.ARRAY_BUFFER,a,this.Jg):(d.bufferData(d.ARRAY_BUFFER,this.da,this.Jg),d.bufferSubData(d.ARRAY_BUFFER,b,a)),this.nb=!0)};p.od=function(){return this.da};
var ut=function(){var a=0;return function(b,c,d){var e=b.Pa().getContext();this.B=e;this.ga=a++;this.ra=b;this.da=c;this.Jg=d;this.Lf=e.createBuffer();this.nb=!1}}();ut.prototype=Object.create(st.prototype);p=ut.prototype;p.Na=function(){this.ra.dm(this)};p.Da=function(){return this.ga};p.Fb=function(){return this.da};
p.Yj=function(a,b){var c=K(b,0),d=a.byteLength;c+d>this.da&&F("buffer overflow");var e=this.B;this.ra.Pa().Kg(this);this.nb?e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,c,a):(0===c&&d===this.da?e.bufferData(e.ELEMENT_ARRAY_BUFFER,a,this.Jg):(e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.da,this.Jg),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,c,a)),this.nb=!0)};p.od=function(){return this.da};p.ml=function(){return this.Jg};function vt(a){this.B=a.getContext();this.ba=a;this.a={hl:0,Gk:0,jg:0}}vt.prototype=Object.create(lp.prototype);
p=vt.prototype;p.Pa=function(){return this.ba};p.Je=function(a,b){var c=wt(this.B,K(b,rd)),d=0,e=null;"number"===typeof a?d=a:0<=a.byteLength&&(d=a.byteLength,e=a);c=new tt(this,d,c);e&&c.pl(e);e=this.a;e.hl+=1;e.jg+=c.Fb();return c};p.nf=function(a,b){var c=wt(this.B,K(b,rd)),d=0,e=null;"number"===typeof a?d=a:0<=a.byteLength&&(d=a.byteLength,e=a);c=new ut(this,d,c);e&&c.Yj(e);e=this.a;e.Gk+=1;e.jg+=c.Fb();return c};
p.pk=function(a){this.B.deleteBuffer(a.Lf);a.Lf=null;var b=this.a;b.hl-=1;b.jg-=a.Fb()};p.dm=function(a){this.B.deleteBuffer(a.Lf);a.Lf=null;var b=this.a;b.Gk-=1;b.jg-=a.Fb()};p.Lg=function(a){this.ba.Lg(a)};p.Kg=function(a){this.ba.Kg(a)};function wt(a,b){switch(b){case rd:return a.STATIC_DRAW;case 2:return a.DYNAMIC_DRAW;case 3:return a.STREAM_DRAW;default:return 0}};function xt(){}p=xt.prototype;p.sm=function(){};p.zm=function(){};p.qm=function(){};p.mm=function(){};p.rm=function(){};p.Bk=function(){};p.wm=function(){};p.xm=function(){};p.um=function(){};p.ym=function(){};p.vm=function(){};p.gi=function(){};p.nj=function(){};p.fi=function(){};p.Fm=function(){};p.Em=function(){};p.Cm=function(){};p.ei=function(){};p.toString=function(){};function yt(a){this.B=a=a.getContext();this.zh=null;var b=this.B,c=[];c.push(b.getParameter(b.RENDERER));c.push(b.getParameter(b.VENDOR));c.push(b.getParameter(b.VERSION));c.push(b.getParameter(b.SHADING_LANGUAGE_VERSION));b=this.dk().join("\n");c.push(b);this.jo=c.join("\n");c=this.B;c=c.getParameter(c.MAX_VIEWPORT_DIMS);this.uo=new Pe(0,0,c[0],c[1]);this.c=a.getParameter(a.RED_BITS);this.b=a.getParameter(a.GREEN_BITS);this.a=a.getParameter(a.BLUE_BITS);this.co=this.c+this.b+this.a;this.bo=a.getParameter(a.ALPHA_BITS);
this.eo=a.getParameter(a.DEPTH_BITS);this.fo=a.getParameter(a.STENCIL_BITS);this.so=a.getParameter(a.MAX_VERTEX_ATTRIBS);this.to=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS);this.po=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS);this.El=parseInt(a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),10);this.qo=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);this.ro=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);this.Dd=a.getParameter(a.MAX_TEXTURE_SIZE);this.Fh=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);
this.mo=0<this.El;a=this.B;(c=this.xl("WEBGL_compressed_texture"))?(a.getExtension(c),a=0<a.getParameter(a.COMPRESSED_TEXTURE_FORMATS).length):a=!1;this.lo=a;a=this.B;c=this.xl("EXT_texture_filter_anisotropic");this.yl=!1;this.Ui=0;c?(c=a.getExtension(c),this.yl=null!=c,this.Ui=null!=c?a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,a=c):a=null;this.th=a;a=[];a.push(this.sm()+"\n");a.push("colorBits: "+this.qm());a.push("alphaBits: "+this.mm());a.push("depthBits: "+this.rm());a.push("stencilBits: "+
this.Bk());a.push("maxViewportBounds: "+this.zm().toString());a.push("maxVertexAttribs: "+this.wm());a.push("maxVertexShaderParams: "+this.xm());a.push("maxPixelShaderParams: "+this.um());a.push("maxVertexShaderTextureUnits: "+this.ym());a.push("maxPixelShaderTextureUnits: "+this.vm());a.push("maxTextureUnits: "+this.gi());a.push("maxTextureSize: "+this.nj());a.push("maxCubeTextureSize: "+this.fi());a.push("hasVertexShaderTextureAccess: "+this.Fm());a.push("hasTextureCompression: "+this.Em());a.push("hasAnisotropicFiltering: "+
this.Cm());a.push("maxAnisotropicValue: "+this.ei());this.zo=a.join("\n")}yt.prototype=Object.create(xt.prototype);p=yt.prototype;p.sm=function(){return this.jo};p.zm=function(){return this.uo};p.qm=function(){return this.co};p.mm=function(){return this.bo};p.rm=function(){return this.eo};p.Bk=function(){return this.fo};p.wm=function(){return this.so};p.xm=function(){return this.to};p.um=function(){return this.po};p.ym=function(){return this.El};p.vm=function(){return this.qo};p.gi=function(){return this.ro};
p.nj=function(){return this.Dd};p.fi=function(){return this.Fh};p.Fm=function(){return this.mo};p.Em=function(){return this.lo};p.Cm=function(){return this.yl};p.ei=function(){return this.Ui};p.toString=function(){return this.zo};p.xl=function(a){for(var b=this.dk(),c=0,d=b.length;c<d;++c){var e=b[c];if(0<e.indexOf(a))return e}return null};p.dk=function(){var a=this.B;this.zh||(this.zh=a.getSupportedExtensions());return this.zh};function zt(){}p=zt.prototype;p.Na=function(){};p.Da=function(){};p.Fb=function(){};p.pd=function(){};p.md=function(){};p.Cf=function(){};p.re=function(){};p.Df=function(){};p.ci=function(){};p.sn=function(){};var Bt=function(){var a=0;return function(b,c,d,e,f){e=K(e,jh);var g=b.Pa().getContext();this.B=g;this.ga=a++;this.ra=b;this.Ge=c;this.Vd=d;this.ck=c;this.bk=d;this.Of=e;this.gd=f?f.gd:new gh;this.Xa=f?f.Xa:g.createTexture();this.nb=f?f.nb:[0];this.Rf=f?!1:!0;this.ed=Kc(sc(this.ck,this.bk))|0;this.Ag=!1;this.Cf(this.gd);At&&(this.La=document.createElement("canvas"),this.lc=this.La.getContext("2d"),this.La.width=c,this.La.height=d)}}();Bt.prototype=Object.create(zt.prototype);p=Bt.prototype;p.Na=function(){this.ra.ok(this)};
p.Da=function(){return this.ga};p.Fb=function(){var a=0;this.Rf&&(a=Ct(this.Of),a*=this.Ge*this.Vd,this.Ag&&(a+=a/3));return a};p.pd=function(){return this.Ge};p.md=function(){return this.Vd};p.Cf=function(a){this.gd.A(a);var b=this.B;this.Kf();Dt(b,b.TEXTURE_2D,a)};p.sn=function(a){this.gd.Mh=a;a=this.B;if(this.gd.Mh&&this.ra&&this.ra.th){var b=this.gd;0<b.Mh&&a.texParameterf(a.TEXTURE_2D,this.ra.th.TEXTURE_MAX_ANISOTROPY_EXT,b.Mh)}};p.re=function(a,b,c){this.Df(a,b,0,0,c)};
p.Df=function(a,b,c,d,e){this.Xi(a,b,c,d,Et(b),Ft(b),Gt(b),e)};p.ci=function(){var a=this.B;this.Kf();a.generateMipmap(a.TEXTURE_2D);this.Ag=!0};
p.Xi=function(a,b,c,d,e,f,g,h){b&&e&&f&&"undefined"!==typeof g||F("invalid args");var k=this.B,l=this.Ge>>a|0,m=this.Vd>>a|0;(0>c||0>d||c+e>l||d+f>m)&&F("invalid args");At&&(b instanceof ImageData?this.lc.putImageData(b,c,d):this.lc.drawImage(b,c,d,e,f),l=this.La,this.La=document.createElement("canvas"),this.La.width=l.width,this.La.height=l.height,this.lc=this.La.getContext("2d"),this.lc.save(),this.lc.scale(1,-1),this.lc.drawImage(l,0,-l.height),this.lc.restore());l=k.TEXTURE_2D;g=Ht(k,g);g=m=It(k,
this.Of);var n=0!==(this.nb[0]&1<<a),r=null;this.Kf();Jt(k,h);n||(h=this.ck>>a|0,n=this.bk>>a|0,0==c&&0==d&&h===e&&n===f&&(r=b),Kt(k,l,a,r,h,n,g,m),this.nb[0]|=1<<a);r||Lt(k,l,a,c,d,b,e,f,g)};p.Kf=function(){this.ra.Pa().bindTexture(0,this)};var Mt={Us:1,Ks:2,Vs:3,Ls:4,Ws:5,Ms:6};function Nt(){}p=Nt.prototype;p.Na=function(){};p.Da=function(){};p.Fb=function(){};p.od=function(){};p.Cf=function(){};p.re=function(){};p.Df=function(){};p.ci=function(){};p.clear=function(){};var Ot=function(){var a=0;return function(b,c,d){d=K(d,jh);var e=b.Pa().getContext();this.B=e;this.ga=a++;this.ra=b;this.da=c;this.Of=d;this.gd=new gh;this.Xa=e.createTexture();this.nb=Array(6);this.Rf=!0;this.ed=Kc(c)|0;this.Ag=!1;this.Cf(this.gd)}}();Ot.prototype=Object.create(Nt.prototype);p=Ot.prototype;p.Na=function(){this.ra.cm(this)};p.Da=function(){return this.ga};p.Fb=function(){var a=Ct(this.Of),a=6*this.da*this.da*a;this.Ag&&(a+=a/3);return a};p.od=function(){return this.da};
p.Cf=function(a){this.gd.A(a);var b=this.B;this.Kf();Dt(b,b.TEXTURE_CUBE_MAP,a)};p.re=function(a,b,c,d){this.Df(a,b,c,0,0,d)};p.Df=function(a,b,c,d,e,f){this.Xi(a,b,c,d,e,Et(c),Ft(c),Gt(c),f)};p.clear=function(){this.Kf();var a=It(this.B,this.Of),b=this.da,c;for(c in Mt){var d=Ot.a(this.B,Mt[c]);Kt(this.B,d,0,null,b,b,a,a);this.nb[Ot.b(Mt[c])]|=1}};p.ci=function(){var a=this.B;this.Kf();a.generateMipmap(a.TEXTURE_CUBE_MAP);this.Ag=!0};
p.Xi=function(a,b,c,d,e,f,g,h,k){c&&f&&g&&!J(h)||F("invalid args");var l=this.B,m=this.da,n=m>>b|0;(0>d||0>e||d+f>n||e+g>n)&&F("invalid args");n=Ot.a(l,a);a=Ot.b(a);h=Ht(l,h);var r=It(l,this.Of);h=r;var s=0!==(this.nb[a]&1<<b),t=null;this.Kf();Jt(l,k);s||(0==d&&0==e&&f===m&&g===m&&(t=c),Kt(l,n,b,t,m,m,h,r),this.nb[a]|=1<<b);t||Lt(l,n,b,d,e,c,f,g,h)};
Ot.a=function(a,b){switch(b){case 1:return a.TEXTURE_CUBE_MAP_POSITIVE_X;case 2:return a.TEXTURE_CUBE_MAP_NEGATIVE_X;case 3:return a.TEXTURE_CUBE_MAP_POSITIVE_Y;case 4:return a.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 5:return a.TEXTURE_CUBE_MAP_POSITIVE_Z;case 6:return a.TEXTURE_CUBE_MAP_NEGATIVE_Z;default:return 0}};Ot.b=function(a){return a-1};Ot.prototype.Kf=function(){this.ra.Pa().bindTexture(0,this)};var jh=5;function Ct(a){switch(a){case 1:case 2:return 1;case 3:return 2;case 4:return 3;case jh:return 4;default:return 0}}var hh=2;function Gt(a){return a instanceof HTMLImageElement?jh:a instanceof HTMLCanvasElement?jh:a instanceof HTMLVideoElement?jh:a instanceof ImageData?jh:0}
function Et(a){return a instanceof HTMLImageElement?parseInt(a.width,10):a instanceof HTMLCanvasElement?parseInt(a.width,10):a instanceof HTMLVideoElement?parseInt(a.width,10):a instanceof ImageData?parseInt(a.width,10):0}function Ft(a){return a instanceof HTMLImageElement?parseInt(a.height,10):a instanceof HTMLCanvasElement?parseInt(a.height,10):a instanceof HTMLVideoElement?parseInt(a.height,10):a instanceof ImageData?parseInt(a.height,10):0}
function gh(a){a instanceof gh?this.A(a):(this.a=this.b=hh,this.d=this.c=1,this.Mh=0)}gh.prototype.Db=function(){return new this.constructor(this)};gh.prototype.A=function(a){this.b=a.b;this.a=a.a;this.c=a.c;this.d=a.d;this.Mh=a.Mh};function Pt(){}p=Pt.prototype;p.Pa=function(){};p.createTexture=function(){};p.ok=function(){};p.Yf=function(){};p.cm=function(){};function Qt(a){this.B=a.getContext();this.ba=a;a=a.Vg();this.Dd=a.nj();this.Fh=a.fi();this.Ui=a.ei();this.th=a.th;this.a={yd:0,of:0}}Qt.prototype=Object.create(Pt.prototype);p=Qt.prototype;p.Pa=function(){return this.ba};p.createTexture=function(a,b,c){(a>this.Dd||b>this.Dd)&&F("invalid args");a=new Bt(this,a,b,c);this.a.yd+=1;return a};p.Oo=function(a,b,c,d){(a>this.Dd||b>this.Dd)&&F("invalid args");a=new Bt(this,a,b,c,d);this.a.yd+=1;return a};
p.ok=function(a){var b=this.B;a.Rf&&(b.deleteTexture(a.Xa),a.Xa=null,this.a.yd-=1)};p.Yf=function(a,b){a>this.Fh&&F("invalid args");var c=new Ot(this,a,b);this.a.of+=1;return c};p.cm=function(a){var b=this.B;a.Rf&&(b.deleteTexture(a.Xa),a.Xa=null,this.a.of-=1)};function Rt(a,b){switch(b){case a.ALPHA:case a.LUMINANCE:return 1;case a.LUMINANCE_ALPHA:return 2;case a.RGB:return 3;case a.RGBA:return 4;default:return 0}}
function Jt(a,b){var c=b||{he:!1,Yr:!1};E(c.Lo)&&(c.Lo=!0);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,c.he?1:0);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.Yr?1:0);a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,c.Lo?a.BROWSER_DEFAULT_WEBGL:a.NONE)}
function Dt(a,b,c){var d=St(a,c.b),e;a:switch(c.a){case 1:e=a.NEAREST;break a;case hh:e=a.LINEAR;break a;default:e=0}var f=Tt(a,c.c);c=Tt(a,c.d);a.texParameteri(b,a.TEXTURE_MIN_FILTER,d);a.texParameteri(b,a.TEXTURE_MAG_FILTER,e);a.texParameteri(b,a.TEXTURE_WRAP_S,f);a.texParameteri(b,a.TEXTURE_WRAP_T,c)}
function Kt(a,b,c,d,e,f,g,h){var k=a.UNSIGNED_BYTE;if(d)if(d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement||d instanceof ImageData)a.texImage2D(b,c,h,g,k,d);else{if(Vb(d)&&0<d.length&&Ub(d.byteLength)){var l=Rt(a,g);d.byteLength<e*f*l&&F("buffer too small");a.texImage2D(b,c,h,e,f,0,g,k,d)}}else a.texImage2D(b,c,h,e,f,0,g,k,null)}
function Lt(a,b,c,d,e,f,g,h,k){var l=a.UNSIGNED_BYTE;if(f instanceof HTMLImageElement||f instanceof HTMLCanvasElement||f instanceof HTMLVideoElement||f instanceof ImageData)a.texSubImage2D(b,c,d,e,k,l,f);else if(0<f.byteLength){var m=Rt(a,k);f.byteLength<g*h*m&&F("buffer too small");a.texSubImage2D(b,c,d,e,g,h,k,l,f)}}function Ht(a,b){switch(b){case 1:return a.ALPHA;case 2:return a.LUMINANCE;case 3:return a.LUMINANCE_ALPHA;case 4:return a.RGB;case jh:return a.RGBA;default:return 0}}
function It(a,b){switch(b){case 1:return a.ALPHA;case 2:return a.LUMINANCE;case 3:return a.LUMINANCE_ALPHA;case 4:return a.RGB;case jh:return a.RGBA;default:return 0}}function St(a,b){switch(b){case 1:return a.NEAREST;case hh:return a.LINEAR;case 3:return a.NEAREST_MIPMAP_NEAREST;case 4:return a.LINEAR_MIPMAP_NEAREST;case 5:return a.NEAREST_MIPMAP_LINEAR;case 6:return a.LINEAR_MIPMAP_LINEAR;default:return 0}}
function Tt(a,b){switch(b){case 1:return a.CLAMP_TO_EDGE;case 2:return a.REPEAT;case 3:return a.MIRRORED_REPEAT;default:return 0}};var Ut=function(){function a(){this.a=[]}a.prototype.kr=function(a){var c=this.a[a.Ne()];c||F("Unknown render device type");return new c(a)};a.prototype.Ep=function(a,c){this.a[a]=c};return new a}();function Vt(){}Vt.prototype.Pa=function(){};Vt.prototype.Ob=function(){};Vt.prototype.em=function(){};function Wt(a,b,c){this.name=a;this.type=b;this.size=c;this.ga=null}function Xt(a,b,c){this.name=a;this.type=b;this.size=c;this.ga=null}function Md(){}p=Md.prototype;p.Na=function(){};p.Da=function(){};p.Fb=function(){};p.Xo=function(){};p.bp=function(){};p.Lp=function(){};p.Mp=function(){};p.Yo=function(){};p.ap=function(){};var Zt=function(){var a=0;return function(b,c,d,e){var f=b.Pa().getContext();this.B=f;this.ga=a++;this.ra=b;this.Il={};this.$j={};this.er=c;this.Wq=d;this.$i=f.createShader(f.VERTEX_SHADER);Yt(this,this.$i,this.er);this.Wi=f.createShader(f.FRAGMENT_SHADER);Yt(this,this.Wi,this.Wq);this.fd=f.createProgram();f.attachShader(this.fd,this.$i);f.attachShader(this.fd,this.Wi);b=this.fd;c=this.B;c.linkProgram(b);c.getProgramParameter(b,c.LINK_STATUS)||F("Program Linking Error\n"+c.getProgramInfoLog(b));b=
this.B;c=b.getProgramParameter(this.fd,b.ACTIVE_ATTRIBUTES);d={};for(f=0;f<c;++f){var g=b.getActiveAttrib(this.fd,f),h=g.name,k=Zt.a(b,g.type),g=new Xt(h,k,g.size);g.ga=b.getAttribLocation(this.fd,h);d[h]=g}this.Jl=d;b=this.B;c=b.getProgramParameter(this.fd,b.ACTIVE_UNIFORMS);d={};for(f=0;f<c;++f)g=b.getActiveUniform(this.fd,f),h=g.name,k=Zt.b(b,g.type),g=new Wt(h,k,g.size),g.ga=b.getUniformLocation(this.fd,h),d[h]=g;this.Gg=d;for(var l in this.Jl)this.$j[l]={};e&&this.Mp(e)}}();Zt.prototype=Object.create(Md.prototype);
p=Zt.prototype;p.Na=function(){this.ra.em(this)};p.Da=function(){return this.ga};p.Fb=function(){return 0};p.Xo=function(a){return this.Il[a]};p.bp=function(a){return this.$j[a]};p.Lp=function(a,b){var c=this.Jl[b];if(c){var d=this.Il[a];d!==c&&(d&&(d=this.$j[d.name],d[a]&&delete d[a]),this.Il[a]=c,d=this.$j[b],d[a]=!0)}};p.Mp=function(a){for(var b in a)this.Lp(b,a[b])};p.Yo=function(){return this.Jl};p.ap=function(){return this.Gg};
function Yt(a,b,c){a=a.B;a.shaderSource(b,c);a.compileShader(b);if(!a.getShaderParameter(b,a.COMPILE_STATUS)){b=a.getShaderInfoLog(b);c=c.replace(/\r/g,"");c=c.replace(/\t/g,"  ");c=c.split("\n");a=0;for(var d=c.length;a<d;++a)c[a]=a+1+" "+c[a];F("Shader Compilation Error\n"+b+"\nSource:\n"+c.join("\n"))}}Zt.a=function(a,b){switch(b){case a.FLOAT:return 9;case a.FLOAT_VEC2:return 10;case a.FLOAT_VEC3:return 11;case a.FLOAT_VEC4:return 12;default:return 0}};
Zt.b=function(a,b){switch(b){case a.BOOL:return 1;case a.BOOL_VEC2:return 2;case a.BOOL_VEC3:return 3;case a.BOOL_VEC4:return 4;case a.INT:return 5;case a.INT_VEC2:return 6;case a.INT_VEC3:return 7;case a.INT_VEC4:return 8;case a.FLOAT:return 9;case a.FLOAT_VEC2:return 10;case a.FLOAT_VEC3:return 11;case a.FLOAT_VEC4:return 12;case a.FLOAT_MAT2:return 13;case a.FLOAT_MAT3:return 14;case a.FLOAT_MAT4:return 15;case a.SAMPLER_2D:return 16;case a.SAMPLER_CUBE:return 17;default:return 0}};function $t(a){this.B=a.getContext();this.ba=a;this.a={Ef:0}}$t.prototype=Object.create(Vt.prototype);$t.prototype.Pa=function(){return this.ba};$t.prototype.Ob=function(a,b,c){a=new Zt(this,a,b,c);this.a.Ef+=1;return a};$t.prototype.em=function(a){var b=this.B;b.deleteProgram(a.fd);b.deleteShader(a.$i);b.deleteShader(a.Wi);a.fd=null;a.$i=null;a.Wi=null;this.a.Ef-=1};var au=function(){var a=0;return function(b){this.B=this.vh(b.kj());this.ga=a++;this.uh={};this.Ki=new yt(this);this.ef=this.wl();this.Kl=new $t(this);this.Dg=new vt(this);this.Hg=new Qt(this);b=this.Ki.gi();this.sl=this.vl=this.Ji=null;this.ul=Array(b);this.tl=null}}();au.prototype=Object.create(Oe.prototype);p=au.prototype;p.Da=function(){return this.ga};p.Vg=function(){return this.Ki};p.Am=function(){return this.uh};p.oj=function(){return this.Dg};p.Ck=function(){return this.Hg};p.$l=function(){return new bu(this)};
p.Ob=function(a,b,c){return this.Kl.Ob(a,b,c)};p.Je=function(a,b){return this.Dg.Je(a,b)};p.nf=function(a,b){return this.Dg.nf(a,b)};p.createTexture=function(a,b,c){return this.Hg.createTexture(a,b,c)};p.Yf=function(a,b){return this.Hg.Yf(a,b)};p.getContext=function(){return this.B};p.Lg=function(a){if(a!==this.vl){var b=this.B;b.bindBuffer(b.ARRAY_BUFFER,a.Lf);this.vl=a}};p.Kg=function(a){if(a!==this.sl){var b=this.B;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a.Lf);this.sl=a}};
p.bindTexture=function(a,b){var c=this.B;if(b!==this.ul[a]||b!==this.tl)this.tl=this.ul[a]=b,c.activeTexture(c.TEXTURE0+a),b instanceof Bt?c.bindTexture(c.TEXTURE_2D,b.Xa):b instanceof Ot?c.bindTexture(c.TEXTURE_CUBE_MAP,b.Xa):null===b&&(c.bindTexture(c.TEXTURE_2D,null),c.bindTexture(c.TEXTURE_CUBE_MAP,null))};
p.vh=function(a){for(var b=null,c=["webgl","experimental-webgl","moz-webgl","webkit-3d"],d=0,e=c.length;d<e;++d){var f=c[d];try{if(b=a.getContext(f,{stencil:!0}))break}catch(g){}}b||F("unable to create WebGL context");if("WebGLDebugUtils"in window)var h=window.WebGLDebugUtils.glEnumToString,b=(0,window.WebGLDebugUtils.makeDebugContext)(b,function(a,b){window.console.warn(h(a)+" in "+b)});b.enable(b.DEPTH_TEST);b.depthFunc(b.LEQUAL);b.enable(b.CULL_FACE);b.cullFace(b.BACK);return b};
p.wl=function(){var a=new Nd;bj(a,!0);er(a);fr(a,!0);a.a=ac(a.a,9,2,0);gr(a);a.a=ac(a.a,7,1,0);gr(a);a.a=ac(a.a,6,1,1);gr(a);cj(a,!1);ej(a,7,0,65535);dj(a,1);dh(a,!1);aj(a,1,0);var b=K(void 0,0);a.a=ac(a.a,14,2,0);a.a=ac(a.a,12,2,b);gr(a);$i(a,0,0);a.H=1;gr(a);b=K(0,0);a.M=0;a.aa=b;gr(a);a.p=15;gr(a);a.v=!0;gr(a);b=K(void 0,65535);a.n=65535;gr(a);a.o=b;gr(a);return a};Ut.Ep("webgl",au);function bu(a){this.B=a.getContext();this.ba=a;this.e=a.Vg();a=this.e.gi();this.a=Array(a);for(var b=0;b<a;++b)this.a[b]=null;this.c=0;this.d=new Float32Array(16);this.j=new Float32Array(9);this.g=this.d}bu.prototype=Object.create(od.prototype);p=bu.prototype;p.Pa=function(){return this.ba};p.tc=function(){return this.ba.ef};
p.pg=function(a){var b=this.B,c=this.tc();if(c.xa!==a.xa){if((c.b&4026531840)!==(a.b&4026531840)){var d=0!==$b(a.b,31,1);0!==$b(c.b,31,1)!==d&&(d?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST));d=$b(a.b,30,3);$b(c.b,30,3)!==d&&b.depthFunc(cu(b,d))}if(this.e.Bk()&&((c.b&33554431)!==(a.b&33554431)||c.n!==a.n||c.o!==a.o||c.g!==a.g||c.d!==a.d||c.j!==a.j||c.e!==a.e)){var e,f,d=0!==$b(a.b,24,1);0!==$b(c.b,24,1)!==d&&(d?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST));d=$b(a.b,23,3);e=a.g;f=a.d;$b(c.b,
23,3)===d&&c.g===e&&c.d===f||b.stencilFuncSeparate(b.BACK,du(b,d),e,f);d=$b(a.b,11,3);e=a.j;f=a.e;$b(c.b,11,3)===d&&c.j===e&&c.e===f||b.stencilFuncSeparate(b.FRONT,du(b,d),e,f);(c.b&2093056)!==(a.b&2093056)&&(d=$b(a.b,20,3),e=$b(a.b,17,3),f=$b(a.b,14,3),b.stencilOpSeparate(b.BACK,eu(b,d),eu(b,e),eu(b,f)));(c.b&511)!==(a.b&511)&&(d=$b(a.b,8,3),e=$b(a.b,5,3),f=$b(a.b,2,3),b.stencilOpSeparate(b.FRONT,eu(b,d),eu(b,e),eu(b,f)))}if((c.a&4294965248)!==(a.a&4294965248)||c.c[0]!==a.c[0]||c.c[1]!==a.c[1]||
c.c[2]!==a.c[2]||c.c[3]!==a.c[3]){d=0!==$b(a.a,31,1);0!==$b(c.a,31,1)!==d&&(d?b.enable(b.BLEND):b.disable(b.BLEND));d=$b(a.a,30,4);e=$b(a.a,26,4);f=$b(a.a,22,4);var g=$b(a.a,18,4);$b(c.a,30,4)===d&&$b(c.a,26,4)===e&&$b(c.a,22,4)===f&&$b(c.a,18,4)===g||b.blendFuncSeparate(fu(b,d),fu(b,e),fu(b,f),fu(b,g));d=$b(a.a,14,2);e=$b(a.a,12,2);$b(c.a,14,2)===d&&$b(c.a,12,2)===e||b.blendEquationSeparate(gu(b,d),gu(b,e));d=a.c;vc(d,c.c)||hu||b.blendColor(d[0],d[1],d[2],d[3])}d=0!==$b(a.a,10,1);0!==$b(c.a,10,1)!==
d&&(d?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE));d=$b(a.a,9,2);$b(c.a,9,2)!==d&&b.cullFace(iu(b,d));d=$b(a.a,7,1);$b(c.a,7,1)!==d&&b.frontFace(ju(b,d));d=0!==$b(a.a,6,1);0!==$b(c.a,6,1)!==d&&(d?b.enable(b.DITHER):b.disable(b.DITHER));d=a.H;c.H!==d&&b.lineWidth(d);d=a.va;c.va!=d&&(d?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL));d&&(d=a.M,e=a.aa,c.M===d&&c.aa===e||b.polygonOffset(e,d));d=a.p;c.p!==d&&b.colorMask(!!(d&1),!!(d&2),!!(d&4),!!(d&8));d=a.v;c.v!==d&&b.depthMask(d);d=
a.n;e=a.o;if(c.n!==d||c.o!==e)b.stencilMaskSeparate(b.BACK,d),b.stencilMaskSeparate(b.FRONT,e);d=a.s[0];e=a.s[1];c.s[0]===d&&c.s[1]===e||b.depthRange(d,e);c.A(a)}};p.ol=function(){return this.ba.Ji};
p.vn=function(a,b){b=b||{};var c=this.ba;a!==c.Ji&&(c.B.useProgram(a.fd),c.Ji=a);var c=this.B,d=a.ap(),e;for(e in d){var f=d[e],g=f.ga,f=f.type,h=b[e];if(!J(h))switch(f){case 1:case 5:case 16:case 17:c.uniform1i(g,h);break;case 9:c.uniform1f(g,h);break;case 2:case 6:c.uniform2i(g,h[0],h[1]);break;case 3:case 7:c.uniform3i(g,h[0],h[1],h[2]);break;case 4:case 8:c.uniform4i(g,h[0],h[1],h[2],h[3]);break;case 10:c.uniform2f(g,h[0],h[1]);break;case 11:c.uniform3f(g,h[0],h[1],h[2]);break;case 12:c.uniform4f(g,
h[0],h[1],h[2],h[3]);break;case 13:h instanceof Float32Array?c.uniformMatrix2fv(g,!1,h):(f=this.g,f[0]=h[0],f[2]=h[2],f[1]=h[1],f[3]=h[3],c.uniformMatrix2fv(g,!1,f));break;case 14:h instanceof Float32Array?c.uniformMatrix3fv(g,!1,h):(f=this.j,f[0]=h[0],f[3]=h[3],f[6]=h[6],f[1]=h[1],f[4]=h[4],f[7]=h[7],f[2]=h[2],f[5]=h[5],f[8]=h[8],c.uniformMatrix3fv(g,!1,f));break;case 15:h instanceof Float32Array?c.uniformMatrix4fv(g,!1,h):(f=this.d,f[0]=h[0],f[4]=h[4],f[8]=h[8],f[12]=h[12],f[1]=h[1],f[5]=h[5],f[9]=
h[9],f[13]=h[13],f[2]=h[2],f[6]=h[6],f[10]=h[10],f[14]=h[14],f[3]=h[3],f[7]=h[7],f[11]=h[11],f[15]=h[15],c.uniformMatrix4fv(g,!1,f))}}};p.cc=function(a){(0>a||a>=this.a.length)&&F("texture unit out of range");return this.a[a]};p.za=function(a,b){(0>a||a>=this.a.length)&&F("texture unit out of range");this.c=Dc(this.c,a);this.a[a]=b};p.Wk=function(a,b,c,d){this.B.clearColor(a,b,c,d)};
p.clear=function(a){var b=this.B,c=0;E(a)?c=b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT|b.STENCIL_BUFFER_BIT:(a&1&&(c|=b.COLOR_BUFFER_BIT),a&2&&(c|=b.DEPTH_BUFFER_BIT),a&4&&(c|=b.STENCIL_BUFFER_BIT));b.clear(c)};p.Bi=function(a,b,c,d){this.B.viewport(a,b,c,d)};p.Yk=function(a){var b=this.B;a?b.enable(b.SCISSOR_TEST):b.disable(b.SCISSOR_TEST)};p.un=function(a,b,c,d){this.B.scissor(a,b,c,d)};
p.na=function(a,b,c,d,e){var f=this.B,g=this.ol();g||F("no shader program bound");var h=g.Yo(),k=b.j,l=k.b,m=k.a.length,n;for(n in h){var h=g.bp(n),r=!1,s=!1,t;for(t in h)r=!0,l[t]&&(s=!0);r||F("missing role for attrib '"+n+"'");s||F("missing vertex attrib for shader attrib '"+n+"'")}for(n=0;n<m;++n)for(t in l=k.a[n],h=b.a[n],this.ba.Lg(h),l)if(r=g.Xo(t))h=l[t],r=r.ga||0,s=ku(f,h.type),f.vertexAttribPointer(r,h.size,s,h.normalize,h.xn,h.offset),f.enableVertexAttribArray(r);b=this.ba;f=0;for(g=this.c;f<=
g;++f)b.bindTexture(f,this.a[f]);c?(b=this.B,a=lu(b,a),f=b.UNSIGNED_SHORT,d*=2,this.ba.Kg(c),b.drawElements(a,e,f,d)):(c=this.B,a=lu(c,a),c.drawArrays(a,d,e))};function ku(a,b){switch(b){case 1:return a.BYTE;case 2:return a.UNSIGNED_BYTE;case 3:return a.SHORT;case 4:return a.UNSIGNED_SHORT;case 7:return a.FLOAT;default:return 0}}
function cu(a,b){switch(b){case 0:return a.NEVER;case 1:return a.LESS;case 2:return a.LEQUAL;case 3:return a.EQUAL;case 4:return a.NOTEQUAL;case 5:return a.GEQUAL;case 6:return a.GREATER;case 7:return a.ALWAYS;default:return 0}}
function fu(a,b){switch(b){case 0:return a.ONE;case 1:return a.ONE;case 2:return a.SRC_COLOR;case 3:return a.ONE_MINUS_SRC_COLOR;case 4:return a.DST_COLOR;case 5:return a.ONE_MINUS_DST_COLOR;case 6:return a.SRC_ALPHA;case 7:return a.ONE_MINUS_SRC_ALPHA;case 8:return a.DST_ALPHA;case 9:return a.ONE_MINUS_DST_ALPHA;case 10:return a.CONSTANT_COLOR;case 11:return a.ONE_MINUS_CONSTANT_COLOR;case 12:return hu?a.ONE:a.CONSTANT_ALPHA;case 13:return a.ONE_MINUS_CONSTANT_ALPHA;case 14:return a.SRC_ALPHA_SATURATE;
default:return 0}}function gu(a,b){switch(b){case 0:return a.FUNC_ADD;case 1:return a.FUNC_SUBTRACT;case 2:return a.FUNC_REVERSE_SUBTRACT;default:return 0}}function du(a,b){switch(b){case 0:return a.NEVER;case 1:return a.LESS;case 2:return a.LEQUAL;case 3:return a.EQUAL;case 4:return a.NOTEQUAL;case 5:return a.GEQUAL;case 6:return a.GREATER;case 7:return a.ALWAYS;default:return 0}}
function eu(a,b){switch(b){case 1:return a.KEEP;case 0:return a.ZERO;case 2:return a.REPLACE;case 3:return a.INCR;case 4:return a.DECR;case 5:return a.INVERT;case 6:return a.INCR_WRAP;case 7:return a.DECR_WRAP;default:return 0}}function ju(a,b){switch(b){case 0:return a.CCW;case 1:return a.CW;default:return 0}}function iu(a,b){switch(b){case 0:return a.BACK;case 1:return a.FRONT;case 2:return a.FRONT_AND_BACK;default:return 0}}
function lu(a,b){switch(b){case 1:return a.POINTS;case 2:return a.LINES;case 3:return a.LINE_STRIP;case nd.TRIANGLE:return a.TRIANGLES;case 6:return a.TRIANGLE_FAN;case 5:return a.TRIANGLE_STRIP;default:return 0}};function mu(){this.a={}}mu.prototype.b=["Webkit","Moz","ms","O"];function nu(a,b,c){var d=ou,e=d.a[b];if(e)a.style[e]=c;else if(void 0!==a.style[b])a.style[b]=c,d.uh(b,b);else for(var e=0,f=d.b.length,g;e<f;e++)if(g=d.b[e]+(b.charAt(0).toUpperCase()+b.slice(1)),void 0!==a.style[g]){a.style[g]=c;d.uh(b,g);break}}mu.prototype.uh=function(a,b){this.a[a]=b};var ou=new mu;function pu(){this.b=E(20)?-1:20;this.a=[]};function qu(a){a.getContext()}qu.prototype=Object.create(xt.prototype);p=qu.prototype;p.sm=function(){return this.jo};p.zm=function(){return this.uo};p.qm=function(){return this.co};p.mm=function(){return this.bo};p.rm=function(){return this.eo};p.Bk=function(){return this.fo};p.wm=function(){return this.so};p.xm=function(){return this.to};p.um=function(){return this.po};p.ym=function(){return this.El};p.vm=function(){return this.qo};p.gi=function(){return this.ro};p.nj=function(){return this.Dd};
p.fi=function(){return this.Fh};p.Fm=function(){return this.mo};p.Em=function(){return this.lo};p.Cm=function(){return this.yl};p.ei=function(){return this.Ui};p.toString=function(){return this.zo};p.xl=function(a){for(var b=this.dk(),c=0,d=b.length;c<d;++c){var e=b[c];if(0<e.indexOf(a))return e}return null};p.dk=function(){var a=this.B;this.zh||(this.zh=a.getSupportedExtensions());return this.zh};function ru(){}ru.prototype=Object.create(Md.prototype);function su(a){this.B=a.getContext();this.ba=a;this.a={Ef:0}}su.prototype=Object.create(Vt.prototype);su.prototype.Pa=function(){return this.ba};su.prototype.Ob=function(){var a=new ru;this.a.Ef+=1;return a};su.prototype.em=function(a){a.fd=null;a.$i=null;a.Wi=null;this.a.Ef-=1};var tu=function(){var a=0;return function(b,c,d,e,f){e=K(e,jh);this.B=b.Pa().getContext();this.ga=a++;this.ra=b;this.Ge=c;this.Vd=d;this.ck=c;this.bk=d;this.he=!0;this.Of=e;this.gd=f?f.gd:new gh;this.La=document.createElement("canvas");this.lc=this.La.getContext("2d");this.La.width=c;this.La.height=d;this.nb=f?f.nb:[0];this.Rf=f?!1:!0;this.ed=Kc(sc(this.ck,this.bk))|0;this.Ag=!1;this.Cf(this.gd)}}();tu.prototype=Object.create(zt.prototype);p=tu.prototype;p.Na=function(){this.lc=this.La=null;this.ra.ok(this)};
p.Da=function(){return this.ga};p.Fb=function(){var a=0;this.Rf&&(a=Ct(this.Of),a*=this.Ge*this.Vd,this.Ag&&(a+=a/3));return a};p.pd=function(){return this.Ge};p.md=function(){return this.Vd};p.Cf=function(a){E(a.he)||(this.he=a.he)};p.sn=function(){};p.re=function(a,b,c){this.Df(a,b,0,0,c)};p.Df=function(a,b,c,d,e){this.Xi(a,b,c,d,Et(b),Ft(b),Gt(b),e)};p.ci=function(){};
p.Xi=function(a,b,c,d,e,f,g){b&&e&&f&&"undefined"!==typeof g||F("invalid args");a=0;g=this.Ge>>a|0;var h=this.Vd>>a|0;(0>c||0>d||c+e>g||d+f>h)&&F("invalid args");b instanceof ImageData?this.lc.putImageData(b,c,d):this.lc.drawImage(b,c,d,e,f);this.he&&(b=this.La,this.La=document.createElement("canvas"),this.La.width=b.width,this.La.height=b.height,this.lc=this.La.getContext("2d"),this.lc.save(),this.lc.scale(1,-1),this.lc.drawImage(b,0,-b.height),this.lc.restore());this.nb[0]|=1<<a};function uu(){}uu.prototype=Object.create(Nt.prototype);function vu(a){this.B=a.getContext();this.ba=a;a=a.Vg();this.Dd=a.nj();this.Fh=a.fi();this.Ui=a.ei();this.th=a.th;this.a={yd:0,of:0}}vu.prototype=Object.create(Pt.prototype);p=vu.prototype;p.Pa=function(){return this.ba};p.createTexture=function(a,b,c){(a>this.Dd||b>this.Dd)&&F("invalid args");a=new tu(this,a,b,c);this.a.yd+=1;return a};p.Oo=function(a,b){(a>this.Dd||b>this.Dd)&&F("invalid args");F("NOT IMPLEMENTED");this.a.yd+=1};
p.ok=function(a){a.Rf&&(a.Xa=null,this.a.yd-=1)};p.Yf=function(a){F("NOT IMPLEMENTED");a>this.Fh&&F("invalid args");a=new uu;this.a.of+=1;return a};p.cm=function(a){a.Rf&&(a.Xa=null,this.a.of-=1)};var wu=function(){var a=0;return function(b,c,d){this.B=b.Pa().getContext();this.ga=a++;this.ra=b;this.da=c;this.Jg=d;this.Lf=void 0;this.nb=!1}}();wu.prototype=Object.create(rt.prototype);p=wu.prototype;p.Na=function(){this.ra.pk(this)};p.Da=function(){return this.ga};p.Fb=function(){return this.da};p.pl=function(){};p.od=function(){return this.da};Object.create(st.prototype);function xu(a){this.B=a.getContext();this.ba=a}xu.prototype=Object.create(lp.prototype);p=xu.prototype;p.Pa=function(){return this.ba};
p.Je=function(){};p.nf=function(){};p.pk=function(){};p.dm=function(){};p.Lg=function(a){this.ba.Lg(a)};p.Kg=function(a){this.ba.Kg(a)};var yu=function(){var a=0;return function(b){this.B=this.vh(b.kj());this.ga=a++;this.uh={};this.Ki=new qu(this);this.ef=this.wl();this.Kl=new su(this);this.Dg=new xu(this);this.Hg=new vu(this);b=this.Ki.gi();this.sl=this.vl=this.Ji=null;this.ul=Array(b);this.tl=null}}();yu.prototype=Object.create(Oe.prototype);p=yu.prototype;p.Da=function(){return this.ga};p.Vg=function(){return this.Ki};p.Am=function(){return this.uh};p.oj=function(){return this.Dg};p.Ck=function(){return this.Hg};p.$l=function(){return new zu(this)};
p.Ob=function(a,b,c){return this.Kl.Ob(a,b,c)};p.Je=function(a,b){return this.Dg.Je(a,b)};p.nf=function(a,b){return this.Dg.nf(a,b)};p.createTexture=function(a,b,c){return this.Hg.createTexture(a,b,c)};p.Yf=function(a,b){return this.Hg.Yf(a,b)};p.getContext=function(){return this.B};p.Lg=function(){};p.Kg=function(){};p.bindTexture=function(){};p.vh=function(a){return a.getContext("2d")};p.wl=function(){};Ut.Ep("software",yu);function zu(a){this.a={};this.ba=a;this.c=-1;this.b="";this.Vd=this.Ge=-1;this.d=new pu}zu.prototype=Object.create(od.prototype);p=zu.prototype;p.Pa=function(){return this.ba};p.tc=function(){return this.ba.ef};p.pg=function(){};p.ol=function(){return this.ba.Ji};p.vn=function(){};p.cc=function(){};p.za=function(){};p.Wk=function(){};p.clear=function(){};p.Bi=function(){};p.Yk=function(){};p.un=function(){};function Au(a,b,c,d,e){this.Lm=!0;this.Pp=a;this.hj=b;this.ij=c;this.el=d;this.dl=e}
function Bu(a,b){for(var c in a.a)a.a[c].Lm=!1;c=b.f;a.Vd=c.md();a.Ge=c.pd();a.n=Math.floor(Cu/2)-Math.ceil(1/(window.devicePixelRatio||1));var d;d=c.K.cg();d=0.5/Math.tan(d*Ac/2)*a.Vd;d!==a.c?(a.c=d,a.b=a.c.toFixed(2)+"px",d=!0):d=!1;d&&(c.Po&&nu(c.Po,"perspective",a.b),nu(c.Qk,"perspective",a.b))}
function Du(a,b){for(var c in a.a){var d=a.a[c];if(!d.Lm){var e=d.ij,f;f=a.d;0>f.b||f.a.length<f.b?(f.a.push(e),f=!0):f=!1;f?e.style.display="none":b.Qk.removeChild(e);d.hj&&0<e.childNodes.length&&e.removeChild(d.hj);delete a.a[c]}}}
function Eu(a,b,c,d,e){var f=b.Da(),g=b.Gm,h=d.f.Qk,k=a.a[f],l=0,m=0,n=null;d=null;if(k){k.Lm=!0;if(!g){(r=b.Ha.cc(0))||b.cc&&(r=b.cc());if(!r)return;k.Pp!=r.Da()&&(k.Pp=r.Da(),k.ij.removeChild(k.hj),k.hj=r.La,k.ij.appendChild(k.hj),k.el=r.pd(),k.dl=r.md())}l=k.el;m=k.dl;k.ij.style.display="block"}else{n=a.d.a.pop();n||(n=document.createElement("div"),n.style.position="absolute",n.style.pointerEvents="none");n.setAttribute("name","ObjectId: "+f);if(g)l=m=16,g.setAttribute("name","HTML ObjectId: "+
f),n.appendChild(g),k=new Au(-1,g,n,l,m);else{var r=b.Ha.cc(0);r||b.cc&&(r=b.cc());if(!r)return;n.appendChild(r.La);l=r.pd();m=r.md();k=new Au(r.Da(),r.La,n,l,m)}a.a[f]=k;h.appendChild(n)}n=k.ij;c=xd(c.sf,c.rf);k=h=f=0.015625;g?(f=g.rl/g.yq,k=g.Aq/g.xq,b instanceof Ne&&(d=Math.max(g.rl,g.rl),f/=d,k/=d),d=g.zq,g.Zn&&"function"===typeof g.Zn&&g.Zn(g,b.R)):(g=n.style,g.top=(0.5*-m).toFixed(2)+"px",g.left=(0.5*-l).toFixed(2)+"px",f=h=k=1,c[12]*=e,c[13]*=e,c[14]*=e);b.R&&(n.style.zIndex=-Math.floor(20*
b.R));a="translateZ("+a.b+")   scale3d(1,-1,1) ";b=[];e=0;for(g=c.length;e<g;e++)b.push(c[e].toFixed(10));a=a+("matrix3d("+b.join(",")+")")+" scale3d("+f+","+h+","+k+") ";d&&(a+="rotateX("+d+"deg)");nu(n,"transform",a)};function Fu(a,b){this.e=new ph;this.ga=++Gu;this.La=a;this.d=b||"webgl";this.ba=Ut.kr(this);this.a=[];this.c=0;this.b=new Pe(0,0,0,0)}var Gu=0;p=Fu.prototype;p.kj=function(){return this.La};p.Ne=function(){return this.d};p.Pa=function(){return this.ba};p.Pb=function(){return this.b};function Hu(a,b){a.b=Rc(b);var c=window.devicePixelRatio||1,d=Math.round(b.width*c),c=Math.round(b.height*c),e=a.La;if(e.width!=d||e.height!=c)e.width=d,e.height=c,a.e.call({target:a})}
function Iu(a){return a.a.filter(function(a){return a.Qa()})}function Ju(a,b){return a.a.filter(function(a){a=a.Pb();a=a instanceof jr?a.x>=b.x&&a.x<b.x+b.width&&a.y>=b.y&&a.y<b.y+b.height:a instanceof Pe?a.x+a.width>=b.x&&a.x<b.x+b.width&&a.y+a.height>=b.y&&a.y<b.y+b.height:void 0;return a})}function Ku(a){var b=0;a.a.forEach(function(a){b=Math.max(b,a.Ml)});return b}p.Ik=function(){var a=!1;this.a.forEach(function(b){a|=b.Ik()});return a};
function Lu(a){var b=Iu(a);b.forEach(function(b){b.Ik()&&(b=b.Pb(),Ju(a,b).forEach(function(a){a.a=!0}))});b.sort(Mu);b.forEach(function(b){if(b.Ik()){var d=b.Pb();d.y=a.Pb().height-d.y-d.height;var e=d.x,f=d.y,g=window.devicePixelRatio||1,h=Math.round(d.width*g),d=Math.round(d.height*g);if(!ib){var k=b.df;k.Yk(!0);k.un(e,f,h,d);k.Bi(e,f,h,d)}b.a=!1;b.c.call({target:b});ib||k.Yk(!1)}});a.c++;if(b=window.N3)if(b=b.HOOK)b=b.onRedraw,"function"===typeof b&&b(a.ga,a.c)}
function Mu(a,b){return a.Ml-b.Ml};function Nu(a,b,c){this.Uj=!1;this.width=a;this.height=b;this.Ka=c}function Ou(){this.Wh=[];this.canvas=null}function Pu(a,b){this.d=a;this.a={};this.b=void 0===b?!1:b;this.c=function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))}}
Pu.prototype={cc:function(a,b){var c;if(0>=a||null>=b)c=null;else{c=Qu(this,a);var d=Ru(this,b),e=this.a[d];void 0==e&&(e=this.a[d]={});var f=null,g=null;if(void 0==e[c])e[c]=new Ou;else for(var h=e[c].Wh,g=0;g<h.length;g++)if(!h[g].Uj){f=h[g];break}null==f&&(f=this.d.createTexture(c,d),f=new Nu(c,d,f),e[c].Wh.push(f));f.Uj=!0;c=f}return c},kn:function(){var a=0,b=null,c=null;for(b in this.a){var d=this.a[b];for(c in d){var e=d[c].Wh;e.forEach(function(b){b.Uj||(b.Ka.Na(),b.Ka=null,a++)});d[c].Wh=
e.filter(function(a){return a.Uj})}}na()},jh:function(){var a=null,b=null;for(a in this.a){var c=this.a[a];for(b in c)c[b].Wh.forEach(function(a){null!=a.Ka&&a.Ka.Na()});this.a={}}}};function Ru(a,b){if(a.b){var c=b%4;return 0<c?b+4-c:b}return a.c(b)}function Qu(a,b){if(a.b){var c=b%8;return 0<c?b+8-c:b}return a.c(b)};function Su(a){this.Vb=a}Su.prototype={createTexture:function(a,b){return this.Vb.createTexture(a,b)}};function Tu(a){this.Vb=a;this.a=this.b=null}
Tu.prototype={Xl:function(){this.a&&this.a.jh()},kn:function(){this.a&&this.a.kn()},measureText:function(a,b){var c=Us.measureText(a,b);c.width+=6;c.height+=6;return{width:c.width,height:c.height}},create:function(a,b,c){if(dt(Us,b.font)){var d=this.measureText(a,b),e=Qu(this.a,d.width),f=Ru(this.a,d.height),g,h=this.a;if(0>=e||null>=f)g=null;else{g=Qu(h,e);var k=Ru(h,f),l=h.a[k];void 0==l&&(l=h.a[k]={});h=l[g];void 0==h&&(l[g]=new Ou,h=l[g]);if(null==h.canvas){var l=h,m=document.createElement("canvas");
m.width=g;m.height=k;l.canvas=m}g=h.canvas}k=g.getContext("2d");k.font=at(b);k.clearRect(0,0,e,f);0<b.outlineWidth&&(0<b.Ff&&null!==b.shadowColor?(k.shadowColor="rgba("+255*b.shadowColor[0]+","+255*b.shadowColor[1]+","+255*b.shadowColor[2]+",1)",k.shadowOffsetX=0,k.shadowOffsetY=0,k.shadowBlur=b.Ff):(k.shadowColor="rgba(0, 0, 0, 0)",k.shadowBlur=0),k.lineWidth=b.outlineWidth,k.strokeStyle="rgba("+parseInt(255*b.outlineColor[0],10)+","+parseInt(255*b.outlineColor[1],10)+","+parseInt(255*b.outlineColor[2],
10)+","+b.outlineColor[3]+")",k.strokeText(a,3+b.outlineWidth+b.Ff,b.size+b.outlineWidth+b.Ff+2+3));k.fillStyle="rgba("+parseInt(255*b.color[0],10)+","+parseInt(255*b.color[1],10)+","+parseInt(255*b.color[2],10)+","+b.color[3]+")";k.fillText(a,3+b.outlineWidth+b.Ff,b.size+b.outlineWidth+b.Ff+2+3);b={canvas:g,ee:k,width:d.width,height:d.height}}else la(),b=null;if(!b)return!1;d=this.a.cc(b.width,b.height);e=d.Ka;this.a.b?e.re(0,b.canvas,{he:!0}):(f=new gh,f.b=6,f.a=hh,e.Cf(f),e.re(0,b.canvas,{he:!0}),
e.ci());c.text=a;c.Ka=e;c.ls=d;c.width=b.width;c.height=b.height;c.el=b.canvas.width;c.dl=b.canvas.height;return!0},remove:function(a){if(null!=a&&void 0!=a.Ka&&null!=a.Ka){var b=this.a,c=a.ls;if(null!=c){var d;var e=c.width,f=Ru(b,c.height);d=null;void 0==b.a[f]?d=null:(d=b.a[f],b=Qu(b,e),d=d[b]);null!=d&&0<=d.Wh.indexOf(c)&&(c.Uj=!1)}a.Ka=null}}};function Uu(a){this.id=a;this.Ia=this.data=this.Kk=this.oi=this.pi=this.Lk=null}
var Vu={Aa:null,Mg:3,ke:function(){Vu.Aa||(Vu.Aa=new Wu(Vu.bs,Vu.cs,Vu.Mg),Vu.Aa.Vm=function(a,b,c){var d=Vu.Aa;a=tp(4,14,a,b,c);b=a.xb();d.a.Jj(1,!1);null===d.a.get(b)&&(c=new Uu(b),c.Pl=a,d.a.set(b,c));Xu(d,[b],!1)},Dr(Vu.Aa));return Vu.Aa},deleteInstance:function(){Vu.Aa&&(Vu.Aa.clear(),Vu.Aa=null)},bs:function(a){return new Uu(a)},cs:function(a,b,c,d){ip(Wn(),b.id,function(a,f){if(f.Ub()&&a)try{var g=window.JSON.parse(a);b.Ia=new Yu;var h=b.Pl;ma();var k=b.Ia,l=h.F;k.clear();k.g=l;var m=g.roadElement,
n=g.label,r=g.roadElementName,s=g.attributeSet,t=g.attributes,v=g.formOfWay,w=l[0],x=l[1],y=l[2];k.a=[[0,0],[0,0]];k.a[0]=Fp(w,x,y);k.a[1]=Fp(w,x+1,y-1);k.Ah=P.ma(k.a[0],k.a[1],0.5);k.Tf=Fj(k.Ah);k.Nf=hj(k.Tf);g=[[0,0,0],[0,0,0],[0,0,0],[0,0,0]];Ga([k.a[0][0],k.a[0][1],0],g[0]);Ga([k.a[1][0],k.a[0][1],0],g[1]);Ga([k.a[0][0],k.a[1][1],0],g[2]);Ga([k.a[1][0],k.a[1][1],0],g[3]);k.j=z.sub(g[1],g[0]);k.n=z.sub(g[2],g[0]);var A=z.length(k.j),C=z.length(k.n),g=-0.5*A,h=-0.5*C,B,I=m.length,l=1/16384,w=[];
if(0<I){var G=new Zu(0,null);k.bb[G.Ra]=G}for(B=0;B<I;B++){var D=Number.MAX_VALUE,L=Number.MAX_VALUE,O=-Number.MAX_VALUE,M=-Number.MAX_VALUE,x=[],Z,V=m[B],Q=V.length,ga=Number.MAX_VALUE,fa=Number.MAX_VALUE,Ia,za;for(Z=0;Z<Q;Z+=2)ga=V[Z],fa=V[Z+1],Ia=g+l*ga*A,za=h+l*(16383-fa)*C,D=Ia<D?Ia:D,L=za<L?za:L,O=Ia>O?Ia:O,M=za>M?za:M,x.push([ga,fa]);if(1<x.length){var zf=k.bb.length,y=null,Tb=-1,ad;for(ad in r[B]){var bd=n[r[B][ad]];0<bd.length&&(y=y||{},y[ad]=bd)}var Tb=r[B]._,kb=null;if(-1===r[B])G=new Zu(zf,
y),k.bb[G.Ra]=G,kb=$u(k,G,k.ng++,x,D,L,O,M);else{var lc=-1;void 0!=Tb&&(lc=w[Tb]);0<=lc?kb=$u(k,k.bb[lc],k.ng++,x,D,L,O,M):(G=new Zu(zf,y),k.bb[G.Ra]=G,kb=$u(k,G,k.ng++,x,D,L,O,M),0<=Tb&&(w[Tb]=k.bb.length-1))}y&&null!=y&&(kb.labels=y);v&&(kb.Tg=v[B],kb.attributes=s[t[B]])}}av(k);c(b.id,a)}catch(cd){d(b.id,cd.toString())}else d(b.id,f.mj())})}};function bv(a,b){this.df=a;this.ba=a.Pa();this.ed=this.p(b);this.ze=this.s(this.ba,this.ed);this.hk=this.d(this.ba);this.wo=this.c(this.ba);this.xo=this.e(this.ba)}
ca(bv.prototype,{Ac:function(){delete this.df;delete this.ba;delete this.ze;delete this.hk;delete this.wo;delete this.xo},n:function(){return this.ze},b:function(){return this.ed},a:function(a,b,c,d,e){var f=this.ze;a=this.Lq(a);b=this.ze.od()>>b;c*=b;d*=b;var g=e.width,h=e.height;b===g&&b===h?f.Df(a,0,e,c,d):(f=this.ba.Ck().createTexture(g,h,4),f.re(0,e),this.hk.za(0,f),Od(this.hk,"u_texunit0",0),this.hk.Kj(this.df),this.Dq(a),this.df.Bi(c,d,b,b),this.df.na(nd.TRIANGLE,this.xo,null,0,6),this.br(),
f.Na())},p:function(a){a=void 0!==a?a:3;var b=Kc(this.ba.Vg().fi())-8;return b<a?b:a},s:function(a,b){var c=a.Yf(1<<b+8,4);c.clear();return c},Lq:function(a){switch(a){case 1:return 1;case 3:return 2;case 0:return 5;case 2:return 6;case 5:return 3;case 4:return 4;default:return 1}},Dq:function(a){var b=this.ba.getContext();a=Ot.a(b,a);b.bindFramebuffer(b.FRAMEBUFFER,this.wo);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,a,this.ze.Xa,0)},br:function(){var a=this.ba.getContext();a.bindFramebuffer(a.FRAMEBUFFER,
null)},d:function(a){a=a.Ob("precision highp float;\nattribute vec2 a_position;\nvarying vec2 v_texcoord;\nvoid main() {\n  gl_Position = vec4(a_position, 0, 1);\n  v_texcoord = vec2(a_position.x + 1.0, a_position.y + 1.0) * 0.5;\n}","precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texunit0;\nvoid main() {\n  gl_FragColor = texture2D(u_texunit0, v_texcoord);\n}",{position:"a_position"});a=new Ld(a,{u_texunit0:0});a.fb("rttMaterial");return a},c:function(a){return a.getContext().createFramebuffer()},
e:function(a){var b=new Me({position:new Le(7,2,0)}),c=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]);a=a.Je(c);b=new sd(b);td(b,a);return b}});var al={};function cv(a,b){this.buildingId=a;this.c=b;this.Ya=this.sd=this.Gc=this.ta=null;this.la=!1;this.Ie=this.a=null;this.Rh=!1;this.Xp=this.b=null;this.ih=-1}
function dv(a,b){if(a.la)return!1;if(a.Gc||a.a)return!0;var c=Qp(b,12);a.a=c;if(!c)return a.la=!0,!1;for(var d=Infinity,e=Infinity,f=Infinity,g=-Infinity,h=-Infinity,k=-Infinity,l=c.O.length/6-1;0<=l;l--)var m=6*l,n=c.O[m],r=c.O[m+1],m=c.O[m+2],d=d<n?d:n,e=e<r?e:r,s=m-ev,f=f<s?f:s,g=sc(g,n),h=sc(h,r),k=sc(k,m);d=z.create(d,e,f);g=z.create(g,h,k);a.Ya=new hf(d,g);a.ta=new Bo(Gp(c.Wj));c=Ra(a.ta);g=c.slice(3,7);h=a.Ya.wk();k=R();Oa(g,k);k[12]=c[0];k[13]=c[1];k[14]=c[2];a.Xp=z.I(k,h);a.ih=a.Ya.qj();
a.ih*=a.ih;return!0}cv.prototype.Xg=function(){if(this.b)return this.b;var a=Ra(this.ta),b=a.slice(3,7),c=R();Oa(b,c);Bd(c,c);var b=a[0],d=a[1],a=a[2];c[12]=-(c[0]*b+c[4]*d+c[8]*a);c[13]=-(c[1]*b+c[5]*d+c[9]*a);c[14]=-(c[2]*b+c[6]*d+c[10]*a);return this.b=c};
cv.prototype.bg=function(a){this.Rh&&fv(this);if(!this.a)return!1;for(var b=this.a,c=b.Oa.length,d=z.create(),e=z.create(),f=z.create(),g=0;g<c;g+=3){var h=6*b.Oa[g+0],k=6*b.Oa[g+1],l=6*b.Oa[g+2];d[0]=b.O[h];d[1]=b.O[h+1];d[2]=b.O[h+2];e[0]=b.O[k];e[1]=b.O[k+1];e[2]=b.O[k+2];f[0]=b.O[l];f[1]=b.O[l+1];f[2]=b.O[l+2];a(d,e,f)}return!0};
cv.prototype.nd=function(a){if(this.Gc)return this.Gc;this.Rh&&fv(this);if(!this.a||!a)return null;for(var b=this.a,c=b.O.length/6,d=[],e=[],f=z.create(),g=b.Ir[2],h=b.Oa.length,k=0;k<h;k+=3){var l=6*b.Oa[k+0],m=6*b.Oa[k+1],n=6*b.Oa[k+2];gv&&(1>=Math.abs(b.O[l+2]-g)&&(b.O[l+2]-=ev),1>=Math.abs(b.O[m+2]-g)&&(b.O[m+2]-=ev),1>=Math.abs(b.O[n+2]-g)&&(b.O[n+2]-=ev));d[0]=b.O[l]-b.O[m];d[1]=b.O[l+1]-b.O[m+1];d[2]=b.O[l+2]-b.O[m+2];e[0]=b.O[l]-b.O[n];e[1]=b.O[l+1]-b.O[n+1];e[2]=b.O[l+2]-b.O[n+2];z.pa(d,
e,f);1E-6<=z.length(f)&&z.normalize(f,f);b.O[l+3+0]=f[0];b.O[l+3+1]=f[1];b.O[l+3+2]=f[2];b.O[m+3+0]=f[0];b.O[m+3+1]=f[1];b.O[m+3+2]=f[2];b.O[n+3+0]=f[0];b.O[n+3+1]=f[1];b.O[n+3+2]=f[2]}d=new Me({position:new Le(7,3,0),normal:new Le(7,3,12)});b=new qd(d,c,new Uint8Array(b.O.buffer),b.Oa);return this.Gc=new pd(a,b)};cv.prototype.compact=function(){this.Rh?la():this.c?(this.Rh=!0,this.sd=this.Gc=this.a=null):la()};
function fv(a){a.Rh=!1;var b;a:{b=a.c;var c=a.buildingId;if(b.la)b=null;else{if(!b.a&&(b.a=Up(b.data),!b.a)){b.la=!0;b=null;break a}b=(b=b.a[c+".cs3d"])?b.Sg:null}}a.a=Qp(b,12)}function hv(a){this.id=a;this.la=!1;this.a=this.data=this.Kk=this.oi=this.pi=this.Lk=null;this.b={}}var gv=!0,ev=5;
function iv(a,b){if(a.la)return null;var c=a.b[b];if(c)return c.la?null:c;if(!a.a&&(a.a=Up(a.data),!a.a))return a.la=!0,null;var d=a.a[b+".cs3d"];if(!d)return null;c=new cv(b,a);a.b[b]=c;return dv(c,d.Sg)?c:null}hv.prototype.Um=function(){this.la=!1};hv.prototype.Tm=function(){this.la=!0};al.Mg=15;al.Aa=null;al.ke=function(){al.Aa||(al.Aa=new Wu(al.Fq,al.Gq,al.Mg),Dr(al.Aa));return al.Aa};al.deleteInstance=function(){al.Aa&&(al.Aa.t(),al.Aa=null)};al.Fq=function(a){return new hv(a)};
al.Gq=function(a,b,c,d){a=b.id.replace(".zip",".cs3d.cstgz");"http://navteq-maps.ovi.com.edgesuite.net/"!==al.xg&&(a=a.split("/").slice(-3).join("/"),a=al.xg+a);Gk&&(a=a.replace("://sli.data.here.com","://6.sli.data.here.com"));a=yp(a,!0);na();jp(Wn(),a,function(a,f){f.Ub()&&a?c(b.id,a):d(b.id,f.mj())})};al.xg="http://sli.data.here.com/";al.bn=function(a){"/"!=a.substr(-1)&&(a+="/");al.xg=a;al.Aa&&$k.Aa.clear()};al.Ro=function(){};function jv(){this.a=new kh(kv,function(a,b){b.compact(void 0)})}
var kv=25;p=jv.prototype;p.clear=function(){this.a.clear()};p.t=function(){this.a.clear();this.a=null};p.get=function(a){return this.a.get(a)};p.set=function(a,b){this.a.set(a,b)};p.fl=function(a){this.a.get(a)};p.Jj=function(a,b){this.a.Jj(a,b)};p.Ro=function(){};function lv(){this.b=0;this.a=[];this.c=null}p=lv.prototype;p.clear=function(){this.b=0;this.a.length=0;this.c=null};p.ue=function(a,b,c){var d;this.b++;d=this.Hj(a,b);if(null===d)for(var e=1;e<c;){d=a;var f=b,g=e;this.b+=4;for(var h=0,k=0,l=void 0,m=void 0,m=-1;2>m;m+=2)for(l=-1;2>l;l+=2){var n=this.Hj(d+l*g,f+m*g);null!==n&&(h+=n,k++)}d=0<k?h/k:null;if(null!=d)break;e*=2}return d};
p.mh=function(a,b,c,d){var e;this.b++;e=this.Ij(a,b,d);if(null===e)for(var f=1;f<c;){e=a;var g=b,h=f,k=d;this.b+=4;for(var l=0,m=0,n=void 0,r=void 0,r=-1;2>r;r+=2)for(n=-1;2>n;n+=2){var s=this.Ij(e+n*h,g+r*h,k);null!==s&&(l+=s,m++)}e=0<m?l/m:null;if(null!=e)break;f*=2}return e};p.kf=function(){var a,b=this.a.length;for(a=0;a<b;a++)if(!this.a[a].kf())return!1;return!0};function mv(a,b){a.clear();a.a.splice(0,a.a.length);b.forEach(function(b,d){!d||d.la?ma():a.a.push(d.Fi)});a.c=null}
p.Xk=function(a){a=hj(a);var b,c=this.a.length;for(b=0;b<c;b++)this.a[b].Xk(a)};p.Hj=function(a,b){var c,d=this.a.length;for(c=0;c<d;c++){var e=this.a[c].Hj(a,b);if(null!==e)return e}return null};p.Ij=function(a,b,c){if(this.c){var d=this.c.Ij(a,b,c);if(null!==d)return d}var e,f=this.a.length;for(e=0;e<f;e++)if(this.c!==this.a[e]&&(d=this.a[e].Ij(a,b,c),null!==d))return this.c=this.a[e],d;return null};
p.qi=function(a,b){var c=Number.MAX_VALUE,d,e=this.a.length;for(d=0;d<e;d++){var f=this.a[d].qi(a,b);f<c&&(c=f)}return c};p.Qb=function(){var a=!1,b,c=this.a.length;for(b=0;b<c;b++)if(this.a[b].Qb){a=!0;break}return a};function Yu(){this.g=null;this.bb=[];this.b={};this.$=[];this.e={};this.d=1;this.P=[];this.c=[];this.ng=0;this.Ya=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE];this.Ah=[0,0,0,0,0,0,0];this.Tf=[0,0,0,0,0,0,0];this.Nf=R()}var rj=2,sj=3,nv=pa();function ov(a,b){var c=0.5*(a.wc-a.ec),d=0.5*(a.Fc-a.xc);return b.qi(a.ec+c,a.xc+d)>c*c+d*d?(a.Qb=!1,!0):!1}
function pv(a,b){function c(a){a.ua=0<a.ua.length?[]:a.ua;a.Id=0<a.Id.length?[]:a.Id;a.minHeight=void 0;a.maxHeight=void 0;a.Og=void 0}function d(){return{ua:[],Id:[],minHeight:void 0,maxHeight:void 0,Og:void 0}}for(var e,f=a.$,g=f.length,h=0,k=[],l=d(),m=0;m<g;m++){var n=f[m],r=n.m;if(!(2>r.length||ov(n,b))){var s=r.length,t,v=void 0;for(t=0;t<s;t++){var w=r[t],x=n.Qb?b.ue(w[0],w[1],8):b.mh(w[0],w[1],8,l);w[2]=x;n.Qb||(n.Qb=1<l.ua.length);c(l)}for(t=1;t<s;){var x=r[t-1],v=r[t],w=P.distance(x,v),
w=Math.floor(w/2+1),y=(v[0]-x[0])/w,A=(v[1]-x[1])/w,C=0;2<v.length&&2<x.length&&(C=(v[2]-x[2])/w);var B=x[0],I=x[1],G=x[2],D;for(D=1;D<w;D++){x=n.Qb?b.ue(B,I,8):b.mh(B,I,8,l);if(null!==x){1<l.ua.length&&(n.Qb=!0);c(l);var L=Math.abs(G-x);if(n.Qb&&1<D||0.25<L)h++,r.splice(t,0,[B,I,x]),G=x,2<v.length&&(C=(v[2]-G)/w),t++,s++}B+=y;I+=A;G+=C}t++}if(n.Qb)for(t=0,v={zc:n,ri:{}},n.Aj=v,k.push(v);t<r.length;)w=n.m[t],x=b.mh(w[0],w[1],8,l),null!==x&&null!=l.ua&&1<l.ua.length?(l.x=w[0],l.y=w[1],l.vu=x,v.ri[t]=
l,l=d()):c(l),t++;else n.P[0]&&(n.P[0].height=n.m[0][2]),n.P[1]&&(n.P[1].height=n.m[n.m.length-1][2]);qv(n)}}for(e=0;e<g;e++)if(n=f[e],!(2>n.m.length||(s=n.m.length,n.qd=!Vi(n.m),n.qd)))for(t=0;t<s;t++)w=n.m[t];for(e=k.length-1;0<=e;e--){n=k[e];t=n.zc.m;g=n.ri;s=[];t=t.length;n.zc.ki=!1;for(var O in g){h=g[O];for(l=h.ua.length-1;0<=l;l--)m=h.Id[l],void 0==s[m]&&(s[m]=0),s[m]++,0!=m&&void 0!=h.Og&&Math.abs(h.ua[l]-h.Og)<rj&&(h.dh=!0,n.zc.ki=!0);t--}s[0]=t;n.zc.Dm=0<t}for(O=0;0<k.length&&O<k.length;){n=
k[O];if(n.zc.Dm){t=n.zc.m;g=n.ri;h=-1;s=t.length;for(t=0;t<s;t++)void 0==g[t]&&(h=t);0<=h&&(s=function(a){return!a.ki},rv(f,s,!1,{},n.zc,h,-1,!0,void 0,null),rv(f,s,!1,{},n.zc,h,1,!0,void 0,null),k.splice(O,1),O--)}O++}for(O=0;0<k.length&&O<k.length;){n=k[O];t=n.zc.m;g=n.ri;if(!n.zc.Er&&n.zc.ki){s=-1;for(e in g)if(g[e].dh){s=parseInt(e,10);t[s][3]=t[s][2]=g[e].maxHeight;break}0<=s&&(rv(f,null,!0,{},n.zc,s,-1,!0,void 0,null),rv(f,null,!0,{},n.zc,s,1,!0,void 0,null),k.splice(O,1),O--)}O++}for(O=0;0<
k.length&&O<k.length;){n=k[O];n=n.zc;if(!n.Dm){g=n.m;h=!1;s=g.length;for(t=0;t<s;t++)if(g[t][3]){h=!0;break}if(h){O++;continue}t=function(a,b,c){var d=[],f=c.length;for(e=0;e<f;e++){var g=c[e];if(a.V!=g.V){var h=sv(g,b);if(0<=h){for(var k=g.m[h][2],l=d.length-1;0<=l;l--)if(2>xb(k-d[l].height)){h=-1;break}0<=h&&d.push({zc:g,nu:h,height:k})}}}return d};s=t(n,n.m[0],f);t=t(n,n.m[n.m.length-1],f);g=[];h=!1;1==s.length?(h=0,l=1,n.m[h][2]=s[0].height,rv(f,null,!1,g,n,h,l,!1,null,null),h=!0):1==t.length&&
(h=n.m.length-1,l=-1,n.m[h][2]=t[0].height,rv(f,null,!1,g,n,h,l,!1,null,null),h=!0);if(h){k.splice(O,1);continue}}O++}return f}
function rv(a,b,c,d,e,f,g,h,k,l){if(void 0==d[e.V]&&(d[e.V]=!0,e.Er=!0,e.Aj)){var m=e.m,n=e.Aj.ri,r=m[f],s=0<g?m.length:-1;for(f+=g;f!=s;f+=g){var t=m[f];if(void 0==t[3]){var v=n[f];if(v)if(v.dh){for(var w=[],x=0;x<v.ua.length;x++){var y=v.ua[x];0>r[2]+sj-y||w.push(y)}0<w.length&&(1<w.length&&w.sort(function(a,b){return b-a}),t[3]=t[2]=w[0])}else{w=P.distance(r,t);1E-4>w&&(w=1E-4);for(var A=[],x=0;x<v.ua.length;x++)y=v.ua[x],A.push({Oj:Math.abs(y-r[2])/w,height:y});A.sort(function(a,b){return a.Oj-
b.Oj});t[3]=t[2]=A[0].height}r=t}}h&&tv(a,b,c,d,e,g,k,l)}}
function tv(a,b,c,d,e,f,g,h){var k=e.Ra,l=1==f?e.m.length-1:0;if(e.Aj.ri[l]){var m=e.m[l][2],n=null,r=0>f?e.P[0]:e.P[1];if(r)for(f=0;f<r.$.length;f++){var s=r.$[f];if((!b||b(s))&&s&&s!=e&&s.Ra==k&&s.Aj&&!s.ki){var t=sv(s,e.m[l]);if(!(0>t)){var n=s,v=0==t?0:s.m.length-1,t=0==t?1:-1;void 0==s.m[v][3]&&(s.m[v][3]=s.m[v][2]=m,rv(a,b,c,d,s,v,t,!0,g,h))}}}if(!n)if(t=function(a){return b&&!b(a)?!1:a!=e&&a.Aj&&!a.ki},k=function(e,f,k,l){e=E(l)?sv(f,e.m[k]):l;0>e||(k=0==e?0:f.m.length-1,void 0==f.m[k][3]&&
(f.m[k][3]=f.m[k][2]=m,rv(a,b,c,d,f,k,0==e?1:-1,!0,g,h)))},r=a.length,c)for(f=0;f<r;f++)s=a[f],t(s)&&k(e,s,l);else{v=-1;for(f=0;f<r;f++)if(s=a[f],e!==s&&(t=sv(s,e.m[l]),0<=t)){if(n){n=null;break}n=s;v=t}n&&k(e,n,l,v)}}}function Zu(a,b){this.Ra=a;this.labels=b;this.og=[]}Zu.prototype.tm=function(a){if(!this.labels)return"";if(this.labels[a])return this.labels[a];if(this.labels._)return this.labels._;ia();return""};
function uv(a,b,c,d,e,f,g,h){this.Ra=a;this.V=b;this.m=c;this.P=d;this.ec=e;this.xc=f;this.wc=g;this.Fc=h;this.attributes=this.Tg=this.labels=null;this.qd=!0;this.Dm=this.ki=this.Qb=!1}uv.prototype.tm=function(a){if(!this.labels)return"";if(this.labels[a])return this.labels[a];if(this.labels._)return this.labels._;ia();return""};
function vv(a,b){var c=new uv(a.Ra,a.V,a.m,a.P,a.ec,a.xc,a.wc,a.Fc);c.labels=a.labels;c.Tg=a.Tg;c.attributes=a.attributes;c.qd=a.qd;if(b){var d=a.m,e=[];e.length=d.length;var f,g=e.length;for(f=0;f<g;f++)e[f]=d[f].slice();c.m=e}return c}function sv(a,b){return 0.1>P.X(a.m[0],b)?0:0.1>P.X(a.m[a.m.length-1],b)?1:-1}function wv(a,b,c){this.id=a;this.Wr=b;this.Xr=c;this.height=null;this.Yc=this.Pe=!1;this.$=[];this.bb=[]}wv.prototype={};
function Ui(a,b,c){var d=0;for(a=a.$;d<a.length;d++)a[d]===b&&(a[d]=c)}Yu.prototype.kb=nv;Yu.prototype.clear=function(){this.bb=[];this.b={};this.$=[];this.d=1;this.P=[];this.c=[];this.ng=0;this.Ya=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE];this.Tf=[0,0,0,0,0,0,0]};Yu.prototype.eb=function(){return this.Tf};function $u(a,b,c,d,e,f,g,h){c=new uv(b.Ra,c,d,[null,null],e,f,g,h);a.$.push(c);a.e[c.V]=c;b.og.push(c.V);return c}
function xv(a,b,c){a=a.c[c];if(!a)return null;b=a[b];return void 0!==b?b:null}function yv(a,b){var c;for(c=0;c<a.bb.length;c++)if(a.bb[c]==b)return!0;return!1}function av(a){var b,c=Number.MAX_VALUE,d=Number.MAX_VALUE,e=-Number.MAX_VALUE,f=-Number.MAX_VALUE;for(b=0;b<a.$.length;b++)var g=a.$[b],c=Math.min(c,g.ec),d=Math.min(d,g.xc),e=Math.max(e,g.wc),f=Math.max(f,g.Fc);a.Ya=[c,d,e,f]}
function qv(a){a=a.m;if(!(2>a.length)){var b=a.length-1,c=1,d,e,f,g=a[0],h=a[1],c=g[0];d=g[1];e=h[0];f=h[1];var k=Math.atan2(f-d,e-c);g.pb=k;g.mf=null;for(c=1;c<=b;c++)g=a[c],e=g[0],f=g[1],d=h=0,c<b?(h=a[c+1],d=Math.atan2(h[1]-f,h[0]-e),e=P.normalize(P.sub(g,a[c-1])),f=P.normalize(P.sub(h,g)),h=Math.acos(P.gl(e,f)),e=P.Up(f,-e[1],e[0]),h*=0===e?0:0>e?-1:1,g.pb=d,g.mf=h):(g.pb=k,g.mf=null),k=d}}function Ki(a,b){for(var c=[],d=a.e,e=0;e<b.length;e++)void 0!==d[b[e]]&&c.push(d[b[e]]);return c}
function zv(a,b){var c,d=b.m.length,e=Math.round(b.m[0][0]),f=Math.round(b.m[0][1]);c=Math.round(b.m[d-1][0]);d=Math.round(b.m[d-1][1]);if(e==c&&f==d)return!0;e=xv(a,e,f);f=xv(a,c,d);if(null==e||null==f)return!1;for(c=0;c<e.$.length;c++)if(d=e.$[c],d.V!=b.V&&d.Ra==b.Ra){var g;for(g=0;g<f.$.length;g++)if(d.V==f.$[g].V)return!0}return!1}
function Av(a,b,c,d,e){var f;a.clear();a.Ah=b.Ah;a.bb=b.bb;a.ng=b.ng;var g=b.$.length,h=0;d=Math.max(1,d);var k=0;if(0<g){var l=new Zu(0,null);a.bb[l.Ra]=l}a.g=b.g;a.a=b.a;a.Nf=b.Nf;var m=z.I(a.Nf,c),n=m[0]-d,r=m[0]+d,s=m[1]-d,t=m[1]+d,v,w;for(c=0;c<g;c++){var x=b.$[c];e&&e(x)||(0<d&&(x.ec>r||x.xc>t||x.wc<n||x.Fc<s)?k++:(x=vv(x,!0),a.e[x.V]=x,a.$.push(x)))}av(a);var y;e=[0,0,0];k=[0,0,0];n=[0,0,0];a.Tf=b.Tf;a.Nf=b.Nf;g=a.$.length;b=1/16384;var r=a.a[0][0],s=a.a[1][0]-r,t=a.a[0][1],A=a.a[1][1]-t;for(c=
0;c<g;c++){x=a.$[c];f=x.m;v=f.length;for(l=0;l<v;l++)y=f[l][0],w=f[l][1],y=b*y,w=b*(16383-w),e[0]=r+s*w,e[1]=t+A*y,Ga(e,k),z.I(a.Nf,k,n),f[l]=[n[0],n[1]];wh(f,m,d);l=1<f.length&&zv(a,x);if(0==f.length||l)a.e[x.V]=void 0,a.$.splice(c,1),c--,g--;else if(v=f.length,x.labels)for(void 0===a.b[x.Ra]&&(l=new Zu(x.Ra,x.labels),a.b[x.Ra]=l),a.b[x.Ra].og.push(x.V),y=[0,v-1],l=0;2>l;l++){var C=x.m[y[l]];v=C[0];w=C[1];var B=Math.round(v),I=Math.round(w);f=null;var G=a.c[I];G?(f=G[B],f||(f=G[B]=new wv(a.d++,v,
w),a.P.push(f))):(a.c[I]=G=[],f=G[B]=new wv(a.d++,v,w),a.P.push(f));f.$.push(x);yv(f,x.Ra)||f.bb.push(x.Ra);x.P[l]=f;C[0]=f.Wr;C[1]=f.Xr}else h++}for(g=0;g<a.P.length;g++)f=a.P[g],f.Pe=1===f.$.length,f.Yc=1===f.bb.length&&2===f.$.length;for(g=0;g<a.P.length;g++){d=a.P[g];for(h=0;h<d.bb.length;h++);for(h=0;h<d.$.length;h++);}a:for(a=a.P,g=g=0;g<a.length;g++)for(h=a[g],d=0;d<h.$.length;d++)for(c=0;c<h.$.length;c++)if(d!=c&&h.$[d].V==h.$[c].V){ia();break a}}
Yu.prototype.Db=function(a){this.clear();this.Ah=a.Ah;this.Tf=a.Tf;this.bb=a.bb;this.ng=a.ng;this.Ya=a.Ya.slice();var b,c=a.$.length,d=0,e=0;if(0<c){var f=new Zu(0,null);this.bb[f.Ra]=f}for(b=0;b<c;b++){var g=a.$[b],h=g.m,k=h.length,g=vv(g);this.e[g.V]=g;this.$.push(g);var l=g.labels;if(l){void 0===this.b[g.Ra]&&(f=new Zu(g.Ra,l),this.b[g.Ra]=f,e++);this.b[g.Ra].og.push(g.V);k=[0,k-1];for(f=0;2>f;f++){var m=h[k[f]],n=m[0],r=m[1],s=Math.round(n),t=Math.round(r),m=null,v=this.c[t];v?(m=v[s],m||(m=v[s]=
new wv(this.d++,n,r),this.P.push(m))):(this.c[t]=v=[],m=v[s]=new wv(this.d++,n,r),this.P.push(m));m.$.push(g);yv(m,g.Ra)||m.bb.push(g.Ra);g.P[f]=m}g.labels=l}else d++}for(a=0;a<this.P.length;a++)m=this.P[a],m.Pe=1===m.$.length,m.Yc=1===m.bb.length&&2===m.$.length};
function Vi(a){var b=a.length,c,d=a[0],e=d[2],f=null===e||void 0===e?1:0;for(c=1;c<b;c++)d=a[c],2==d.length||null===d[2]?null===e||void 0===e?f++:d[2]=e:e=d[2];if(0<f&&f<b)for(d=a[b-1],e=d[2],f-=null===e||void 0===e?1:0,c=b-2;0<=c;c--)d=a[c],2==d.length||null===d[2]?null!==e&&void 0!==e&&(d[2]=e,f--):e=d[2];return 0==f};function Wu(a,b,c){this.Mg=void 0!==c?c:Bv;this.a=new kh(this.Mg,function(){la()});this.b=a;this.c=b}var Bv=20;Wu.prototype.t=function(){this.c=this.b=null;this.a.clear();this.a=null};function Cv(a,b){null===a.a.get(b)&&a.a.set(b,a.b(b))}Wu.prototype.clear=function(){na();this.a.clear()};Wu.prototype.Zg=function(a){return this.a.get(a)};
function Xu(a,b,c){a.a.Jj(b.length,!1);if(!c&&void 0!==b){var d,e;d=0;for(e=b.length;d<e;d++)Cv(a,b[d])}Dv(a,b);if(!c)for(d=0,b=a.a.keys,c=b.length,d=0;d<c;d++)if(e=mh(a.a,b[d]),null===e.Lk||!e.pi&&e.oi&&(new Date).getTime()/1E3>e.oi+30)e.Lk=(new Date).getTime()/1E3,e.pi=null,e.oi=null,e.Kk=null,e.data=null,a.c(a,e,function(b,c){na();if(null===a.a)ja();else{var d=a.a.get(b);null!==d&&(d.data=c,d.pi=(new Date).getTime()/1E3,"function"===typeof d.Um&&d.Um(),a.C.U(1,[d]))}},function(b,c){ja();var d=
a.a.get(b);null!==d?(d.data={},d.oi=(new Date).getTime()/1E3,d.Kk=c,"function"===typeof d.Tm&&d.Tm(),a.C.U(2,[d])):a.C.U(2,[b])})}function Dv(a,b){for(var c=0,d=b.length,e=[],f=[],c=0;c<d;c++){var g=a.a.get(b[c]);g&&null!==g.data&&(g.pi?e.push(g):f.push(g))}0<e.length&&a.C.U(1,e);0<f.length&&a.C.U(2,f)};var Gv=function(){var a=[0,0,0],b=[0,0,0],c=[0,0,0],d=[0,0,0],e,f=[0,0,0],g=[0,0,0];return function(h,k,l){Ev(h.origin,k.J,a);Ev(k.W,k.J,b);Ev(k.Ye,k.J,c);k=b[0];var m=b[1],n=b[2],r=c[0],s=c[1],t=c[2];d[0]=m*t-n*s;d[1]=n*r-k*t;d[2]=k*s-m*r;k=Fv(h.direction,d);if(1E-6<k)e=1;else if(-1E-6>k)e=-1,k=-k;else return l.np=0,!1;var m=a[0],n=a[1],r=a[2],s=c[0],t=c[1],v=c[2];f[0]=n*v-r*t;f[1]=r*s-m*v;f[2]=m*t-n*s;m=e*Fv(h.direction,f);if(0<=m){var n=b[0],r=b[1],s=b[2],t=a[0],v=a[1],w=a[2];g[0]=r*w-s*v;g[1]=
s*t-n*w;g[2]=n*v-r*t;h=e*Fv(h.direction,g);if(0<=h&&m+h<=k&&(n=-e*Fv(a,d),0<=n))return k=1/k,l.uu=n*k,l.tg=m*k,l.ug=h*k,l.Gi=1-l.tg-l.ug,l.np=1,!0}l.np=0;return!1}}();function Ev(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2]}function Fv(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};function Hv(a,b,c){this.a=c;this.ud=new Iv(0,0,a,b,0.5*a,0.5*b,0)}p=Hv.prototype;p.ud=null;p.Hk=function(a){this.ud.Hk(a,this.a)};p.clear=function(){this.ud.clear()};p.sort=function(){this.ud.sort()};p.tj=function(a,b,c){a<this.ud.x||b<this.ud.y||a>this.ud.vg||b>this.ud.ye||this.ud.tj(a,b,c)};p.qi=function(a,b){var c=a-this.ud.n,d=b-this.ud.c;return c*c+d*d-this.ud.ih};p.forEach=function(a){this.ud.forEach(a,null)};function Jv(a,b,c,d,e){this.x=a;this.y=b;this.vg=c;this.ye=d;this.Nc=e}
function Iv(a,b,c,d,e,f,g){this.x=a;this.y=b;this.vg=c;this.ye=d;this.n=e;this.c=f;a=0.5*(c-a);b=0.5*(d-b);this.ih=a*a+b*b;this.o=g;this.b=this.a=null;this.g=0;this.j=1;this.d=2;this.e=3}p=Iv.prototype;
p.Hk=function(a,b){if(this.o>=b)null===this.b&&(this.b=[]),this.b.push(a);else{var c=-1;a.x>=this.x&&a.vg<=this.n?a.y>=this.y&&a.ye<=this.c?c=this.g:a.y>=this.c&&a.ye<=this.ye&&(c=this.d):a.x>=this.n&&a.vg<=this.vg&&(a.y>=this.y&&a.ye<=this.c?c=this.j:a.y>=this.c&&a.ye<=this.ye&&(c=this.e));if(-1!=c){null===this.a&&(this.a=[null,null,null,null]);var d=this.a[c];if(null===d){var d=this.o+1,e=this.x,f=this.y,g=0.5*(this.vg-this.x),h=0.5*(this.ye-this.y),k=0.5*g,l=0.5*h,m=e+g,n=f+h;null===this.a&&(this.a=
[null,null,null,null]);switch(c){case this.g:this.a[this.g]=new Iv(e,f,e+g,f+h,e+k,f+l,d);break;case this.j:this.a[this.j]=new Iv(m,f,m+g,f+h,m+k,f+l,d);break;case this.d:this.a[this.d]=new Iv(e,n,e+g,n+h,e+k,n+l,d);break;case this.e:this.a[this.e]=new Iv(m,n,m+g,n+h,m+k,n+l,d)}d=this.a[c]}d.Hk(a,b)}else null===this.b&&(this.b=[]),this.b.push(a)}};p.sort=function(){null!==this.b&&this.b.sort(this.gr);if(this.a)for(var a=0,b=this.a.length;a<b;a++)this.a[a]&&this.a[a].sort()};
p.gr=function(a,b){return a.x-b.x};p.tj=function(a,b,c){var d;if(null!==this.b)for(var e=0,f=this.b,g=f.length;e<g;)d=f[e],a>=d.x&&b>=d.y&&a<=d.vg&&b<=d.ye&&c(d),e++;this.a&&(d=a<=this.n?b<=this.c?this.g:this.d:b<=this.c?this.j:this.e,this.a[d]&&this.a[d].tj(a,b,c))};p.forEach=function(a,b){a(this,b);this.a&&(this.a[0]&&this.a[0].forEach(a,this),this.a[1]&&this.a[1].forEach(a,this),this.a[2]&&this.a[2].forEach(a,this),this.a[3]&&this.a[3].forEach(a,this))};
p.clear=function(){null!==this.b&&(this.b.length=0);if(this.a){var a=this.a.length;if(a){for(var b=0;b<a;b++)this.a[b]&&this.a[b].clear();this.a=null}}};function Kv(a){this.id=a;this.a=this.Ve=null;this.Ya=[0,0,0,0,0,0];this.c=null;this.b=0;this.Qg=this.ph=null;this.d=this.j=this.e=0;this.Qb=!1;this.g=[{id:-1,J:[0,0,0],W:[0,0,0],Ye:[0,0,0]},{id:-1,J:[0,0,0],W:[0,0,0],Ye:[0,0,0]}]}p=Kv.prototype;p.clear=function(){this.Qg=this.ph=null};p.eb=function(){return this.Ve};p.kf=function(){return null!==this.c&&null!==this.a};p.Xk=function(a){this.a=z.I(a,this.eb())};
p.Hj=function(a,b){var c=a-this.a[0],d=b-this.a[1],e=null,f={origin:[c,d,-1E6],direction:[0,0,1E6]},g={},h=this,k=this.g,l=null;this.c.tj(c,d,function(a){k[0].id===a.Nc?(h.e++,l=k[0]):k[1].id===a.Nc?(h.e++,l=k[1]):(l=k[1-h.d],h.d=1-h.d,h.j++,Lv(h,a.Nc,l),l.id=a.Nc);Gv(f,l,g)&&(a=g.Gi*l.J[2]+g.tg*l.W[2]+g.ug*l.Ye[2],e=null===e?a:Math.min(e,a))});return e};var Mv={origin:[0,0,-1E6],direction:[0,0,1E6]};
Kv.prototype.Ij=function(a,b,c){a-=this.a[0];b-=this.a[1];var d=null,e=null;Mv.origin[0]=a;Mv.origin[1]=b;var f={},g=this,h=this.g,k=null,l=this.Zh,m=c.ua,n=c.Id,r=Number.MAX_VALUE,s=Number.MIN_VALUE;this.c.tj(a,b,function(a){h[0].id===a.Nc?(g.e++,k=h[0]):h[1].id===a.Nc?(g.e++,k=h[1]):(k=h[1-g.d],g.d=1-g.d,g.j++,Lv(g,a.Nc,k),k.id=a.Nc);if(Gv(Mv,k,f)){var b=f.Gi*k.J[2]+f.tg*k.W[2]+f.ug*k.Ye[2];null!=d&&(0==m.length&&(m.push(d),n.push(e)),m.push(b),n.push(l[a.Nc/3]));e=l[a.Nc/3];0==e&&(c.Og=b);b<r&&
(r=b);b>s&&(s=b);d=null===d?b:Math.min(d,b)}});c.minHeight=r;c.maxHeight=s;return d};function Lv(a,b,c){var d=a.ph,e=a.Qg;a=3*e[b+0];var f=3*e[b+1];b=3*e[b+2];c.J[0]=d[a];c.J[1]=d[a+1];c.J[2]=d[a+2];c.W[0]=d[f];c.W[1]=d[f+1];c.W[2]=d[f+2];c.Ye[0]=d[b];c.Ye[1]=d[b+1];c.Ye[2]=d[b+2]}Kv.prototype.qi=function(a,b){return this.c.qi(a-this.a[0],b-this.a[1])};var $k={};function Nv(a){this.id=a;this.la=!1;this.a=this.data=this.Kk=this.oi=this.pi=this.Lk=null;this.ve={}}function Ov(a,b,c,d){for(;0<d.length;){var e=d[d.length-1],f=a[e];d.length--;if(f&&0>b[e]){b[e]=c;for(var g in f)b[g]!=c&&0>b[g]&&d.push(g)}}}
function Pv(a,b,c){for(var d=b.length,e=Array(a),f=Array(d),g=0;g<a;g++)e[g]=-1;var h=[],k=0;h.push(0);Ov(c,e,k,h);for(g=0;g<a;g++)c[g]&&0>e[g]&&(k++,h.push(g),Ov(c,e,k,h));for(g=a=0;g<d;g+=3){var h=e[b[g+0]],l=e[b[g+1]];c=e[b[g+2]];h=h<l?h:l;h=c<h?c:h;f[a++]=h}return{Zh:f,Nr:k+1}}
Nv.prototype.getData=function(a,b,c){function d(a,b){var c=g[a];c?c[b]||(c[b]=!0):(c=[],c[b]=!0,g[a]=c);(c=g[b])?c[a]||(c[a]=!0):(c=[],c[a]=!0,g[b]=c)}c=c||!1;if(this.la)return null;var e=this.ve[a];if(e){if(e.la)return null;c&&Qv(e);return e}if(!this.a&&(na(),this.a=Up(this.data),na(),!this.a))return this.la=!0,null;var f=this.a[a+".cs3d"];if(!f)return ia(),null;e={Bn:a,tr:null,ta:null,Ya:null,ph:null,Qg:null,Fi:null,la:!1,Zh:null,Qb:!1};this.ve[a]=e;a=Qp(f.Sg,0);if(!a)return e.la=!0,null;var f=
a.O.length/3,g=[];if($k.$r){for(var h=a.O,k={},l={},m=0,n=0;n<a.O.length-1;n+=3){var r=h[n].toString()+h[n+1].toString()+h[n+2].toString(),s=k[r];void 0==s?(k[r]=m,l[m]=m):l[m]=s;m++}h=a.Oa.length;for(n=0;n<h;n+=3)a.Oa[n+0]=l[a.Oa[n+0]],a.Oa[n+1]=l[a.Oa[n+1]],a.Oa[n+2]=l[a.Oa[n+2]]}h=a.Oa.length;for(n=0;n<h;n+=3){var t=a.Oa[n+0],v=a.Oa[n+1],w=a.Oa[n+2];d(t,v);d(v,w);d(w,t)}na();l=new Me({position:new Le(7,3,0)});n=Pv(f,a.Oa,g);m=e.Zh=n.Zh;n=n.Nr;if(1<n){e.Qb=!0;k=Array(n);for(n=r=0;n<h;n+=3)t=m[r],
0<t&&((s=k[t])||(s=k[t]=[]),t=a.Oa[n+0],v=a.Oa[n+1],w=a.Oa[n+2],s.push(t),s.push(v),s.push(w)),r++;e.Lr=[];e.Mr=[];for(n=0;n<k.length;n++)(s=k[n])&&0<s.length&&(h=new qd(l,f,new Uint8Array(a.O.buffer),new Uint16Array(s)),h=new pd(b,h),m=new Be(h,null),je(m,Lg.TERRAIN),e.Lr.push(h),e.Mr.push(m))}f=new qd(l,f,new Uint8Array(a.O.buffer),a.Oa);b=new pd(b,f);e.Gc=b;e.Ya=b.Ug();e.ta=new Bo(Gp(a.Wj));e.ph=a.O;e.Qg=a.Oa;c&&Qv(e);return e};Nv.prototype.Um=function(){this.la=!1};
Nv.prototype.Tm=function(){this.la=!0};
function Qv(a){if(!a.Fi){a.Fi=new Kv(a.Bn);a.Fi.Qb=a.Qb;var b=a.Fi;if(null===b.c){b.clear();na();var c=b.Ya=a.Ya.Zb.concat(a.Ya.Nb),d=b.ph=a.ph,e=b.Qg=a.Qg;b.Zh=a.Zh;b.Ve=Ra(a.ta);a=a=0;for(var c=b.c=new Hv(c[3]-c[0],c[4]-c[1],6),f=0,g=e.length;f<g;f+=3){var h,k,l,m;m=3*e[f+0];var n=3*e[f+1],r=3*e[f+2];h=Math.min(d[m],Math.min(d[n],d[r]));k=Math.min(d[m+1],Math.min(d[n+1],d[r+1]));l=Math.max(d[m],Math.max(d[n],d[r]));m=Math.max(d[m+1],Math.max(d[n+1],d[r+1]));c.Hk(new Jv(h,k,h+(l-h),k+(m-k),f));a++}na();
b.c.sort();na()}}}$k.Aa=null;$k.Mg=16;$k.$r=!1;$k.ke=function(){$k.Aa||($k.Aa=new Wu($k.Zq,$k.$q,$k.Mg),Dr($k.Aa));return $k.Aa};$k.deleteInstance=function(){$k.Aa&&($k.Aa.t(),$k.Aa=null)};$k.Zq=function(a){return new Nv(a)};
$k.$q=function(a,b,c,d){a=b.id.replace(".zip",".cs3d.cstgz");"http://navteq-maps.ovi.com.edgesuite.net/"!==$k.xg&&(a=a.split("/").slice(-3).join("/"),a=$k.xg+a);Gk&&(a=a.replace("://sli.data.here.com","://7.sli.data.here.com"));a=yp(a,!0);na();jp(Wn(),a,function(a,f){f.Ub()&&a?c(b.id,a):d(b.id,f.mj())})};$k.xg="http://sli.data.here.com/";$k.bn=function(a){"/"!=a.substr(-1)&&(a+="/");$k.xg=a;$k.Aa&&$k.Aa.clear()};function Rv(a,b,c){this.name=c;this.f=a;this.Fa=a.$g();this.M=b;this.r=null;this.Rc=this.Td=this.vf=!0;this.zi=0.1;this.Ia=null;this.Kc=a.Kc;this.aa=new lv;this.a=[];this.dd=[];this.va=new Kf;this.Xf=new Kf;this.b=[];this.Bd=[];this.s=new Kf;this.Kb=new Kf;this.hc=this.g=this.j=!1;this.Sc=!Pk;this.p=this.c=this.d=0;this.Dk=a.Dk;this.Ho=a.Ho;this.ce=new ie;this.ce.name="buildingGroup";this.n=new ie;this.n.name="groundGroup";this.o=new ie;this.o.name="onGroundGroup";this.bd=new ie;this.bd.name="roadGroup";
this.dc=new ie;this.dc.name="labelGroup";this.eh=new ie;this.eh.name="markerGroup";this.e=new pp(this.f.wa,void 0,this.f.Tp);var d;ib?d=this.f.dj:d=new bv(this.f.Jc,2);this.Ci=d;b=new Jp(0,this.Ci.ed,ib);b.M("LocationReady",this.Mq.bind(this));b.M("TileReady",this.Nq.bind(this));this.rg=b;this.fe=!1;this.M.add(this.e);this.M.add(this.ce);this.M.add(this.n);this.M.add(this.o);this.o.add(this.bd);this.o.add(this.dc);this.M.add(this.eh);this.tb=$k.ke();this.xa=al.ke();this.cd=Vu.ke();this.Hc=a.Hc;this.Nd=
a.Nd;this.ic=this.Qc=this.H=this.Va=this.v=!1}var Mk=50,Nk=75,Ok=50,Ik=!1,Hk=!0,Lk=!1,Jk=75,Kk=10,Pk=!1,Xc=z.create(),Sv=z.create();p=Rv.prototype;p.clear=function(){this.a=[];this.dd=[];this.va.clear();this.Xf.clear();this.g=!1;this.b=[];this.Bd=[];this.s.clear();this.Kb.clear();this.Qc=this.H=this.Va=this.v=this.hc=this.j=!1;this.Ia=null;Er(this.cd.C,this);Er(this.tb.C,this);Er(this.xa.C,this);Tv(this.ce);Tv(this.n);Tv(this.bd);Tv(this.dc);Tv(this.eh)};
p.t=function(){0!==this.p&&(window.clearTimeout(this.p),this.p=0);0!==this.d&&(window.clearTimeout(this.d),this.d=0);0!==this.c&&(window.clearTimeout(this.c),this.c=0);this.clear();ti(this.Kc,this.f);ti(this.Kc,this.f);this.Hc.length=0;this.Nd.length=0;Tv(this.dc);this.M=this.Fa=this.f=this.aa=this.Kc=this.Nd=this.Hc=this.cd=this.xa=this.tb=this.Ci=this.rg=this.e=null;this.ic=!0};function Mr(a){a.rg.cancel();a.fe=!1}
function Pr(a,b){a.r=b;a.clear();if(null!==b){a.ah();a.Bd=b.ve;for(var c=Uv(a)?Mk:Nk,d=cr().en(b.ta.get(0),c+Ok),c={},e=0;e<d.length;e++)for(var f=d[e].Bb.ve,g=0;g<f.length;g++)for(var h=f[g],k=0;k<h.length;k++){var l=h[k];c[l.Ii]=l}var d=[],m;for(m in c)l=c[m],d.push(l);a.b=0==d.length?b.ve:d;a.dd=b.jf;var n;if(Hk){l=cr().en(b.ta.get(0),Jk+Kk);m={};for(d=0;d<l.length;d++)for(e=l[d].Bb.jf,f=0;f<e.length;f++)for(g=e[f],h=0;h<g.length;h++)c=g[h],m[c.If]=c;l=[];for(n in m)c=m[n],l.push(c);n=0==l.length?
b.jf:l}else n=b.jf;a.a=n;Fr(a.tb.C,a,1,a.gp);Fr(a.tb.C,a,2,a.gp);Fr(a.cd.C,a,1,a.Br);Fr(a.xa.C,a,1,a.fp);Fr(a.xa.C,a,2,a.fp)}}function Vv(a,b){return a.hc||b?(0!==a.p&&(window.clearTimeout(a.p),a.p=0),a.hc=!0,a.v&&(Ua(a),a.f.u()),a.Va&&(Wv(a),a.f.u()),a.H&&(Ya(a),a.f.u()),!0):!1}p.Vm=function(){if(zk)if(null===this.r)ma();else{var a=Ej(this.r);this.cd.Vm(a[0],a[1],a[2])}else Vv(this,!0)};
p.Br=function(a){if(null===this.r)ma();else{if(null===this.Ia){this.Ia=new Yu;var b=Uv(this)?250:60;Av(this.Ia,a[0].Ia,this.r.eb(),b,function(a){var b;a.Tg?b=a.Tg:b=a.label?3:8;if(0>b||b>=Gh.length)b=3;return!Gh[b].na});this.hc=!0}if(!Vv(this,!1)){var c=this;this.p=window.setTimeout(function(){na();c.ic||Vv(c,!0)},3E4)}}};
function Xv(a,b){if(a.j||a.ic)return!0;var c=b||a.b.length==a.s.size();c&&(0!==a.d&&(window.clearTimeout(a.d),a.d=0),a.j=!0,Yv(a)&&(na(),Tv(a.n),Zv(a.f,Ej(a.r),a.f.mb),$v(a,a.f.fm)),mv(a.aa,a.Kb),Ua(a),Ya(a),a.f.u());return c}
function Qr(a,b){if(null===a.r)ma();else if(xk){0!==a.d&&(window.clearTimeout(a.d),a.d=0);for(var c=new Kf,d=0;d<a.b.length;d++)c.set(a.b[d].URL,1);var e=[];c.forEach(function(a){e.push(a)});Xu(a.tb,e,b);Xv(a,!1)||b||(a.d=window.setTimeout(function(){na();Xv(a,!0)},5E3))}else Xv(a,!0)}
p.gp=function(a){if(null===this.r)ia();else{for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<this.b.length;d++)if(this.b[d].URL==c.id&&!this.s.get(this.b[d].Ii)){var e;if(c.la)e={la:!0};else if(e=c.getData(this.b[d].Ii,this.f.mb,!0),!e||c.la)e={la:!0};this.s.set(this.b[d].Ii,e)}aw(this)}};
function aw(a){var b=!1,c=Uv(a)?Mk:Nk;a.s.forEach(function(d,e){if(!e.la){for(var f=!1,g=0;g<a.Bd.length;g++)if(a.Bd[g].Ii==d){$v(a,e);f=b=!0;a.Kb.set(d,e);$v(a,e);break}if(!f){f=e.Gc.vk();g=e.sd?we(e.sd):null;if(!g){var g=R(),h=Ra(e.ta);Oa(h.slice(3,7),g);g[12]=h[0];g[13]=h[1];g[14]=h[2]}g=z.I(g,f.wk());z.distance(a.r.eb(),g)-f.qj()>c||(b=!0,a.Kb.set(e.Bn,e),$v(a,e))}}});Xv(a,!1);b&&a.f.u()}
function bw(a,b){if(a.g)return!0;var c=b||a.a.length==a.va.size();if(c){0!==a.c&&(window.clearTimeout(a.c),a.c=0);a.g=!0;a.v&&(Ua(a),a.f.u());a.Va&&(Wv(a),a.f.u());a.H&&(Ya(a),a.f.u());a.Qc&&a.Gd();var d=a.f.ca;if(0<d.a.size())for(var e in d.a.a){var f=d.a.get(e);f.Nm=!1;f.jd=null}}return c}
function Rr(a,b){0!==a.c&&(window.clearTimeout(a.c),a.c=0);if(yk){for(var c=new Kf,d=0;d<a.a.length;d++)c.set(a.a[d].URL,1);var e=[];c.forEach(function(a){e.push(a)});1>a.a.length&&(a.g=!0);Xu(a.xa,e,b);bw(a,!1)||b||(a.c=window.setTimeout(function(){na();bw(a,!0)},5E3))}else bw(a,!0)}
p.fp=function(a){if(null===this.r)ia();else{for(var b=0;b<a.length;b++)for(var c=a[b],d=null,e=0;e<this.a.length;e++)if(this.a[e].URL==c.id&&!this.va.get(this.a[e].If)){if(c.la)d=new cv(this.a[e].If,null),d.la=!0;else if(d=iv(c,this.a[e].If),!d||c.la)d=new cv(this.a[e].If,null),d.la=!0;this.va.set(this.a[e].If,d)}cw(this)}};
function cw(a){for(var b=!1,c=a.dd.length+1,d=a.f.ej,e=a.dd,f=0;f<e.length;f++)d.fl(e[f].If);d.Jj(Math.ceil(1.5*c),!1);a.va.forEach(function(c,d){if(!d.la){for(var f=!1,l=0;l<e.length;l++)if(e[l].If==c){dw(a,d);f=b=!0;a.Xf.set(c,d);break}if(!f&&Hk){var l=Ra(d.ta),f=d.Ya.qj(),m=Zc(l.slice(3,7)),n=R();Oa(m,n);n[12]=l[0];n[13]=l[1];n[14]=l[2];Xc[0]=0;Xc[1]=0;Xc[2]=100;n=z.I(n,Xc,Sv);(m=Ra(a.r.ta))?(l=z.jr(l,n,m),l=z.distance(l,m),f=l-f):f=0;f<=Jk?(a.Xf.set(d.buildingId,d),Ik&&(b=!0,dw(a,d))):Lk&&!d.Rh&&
d.compact(void 0)}}});bw(a,!1);b&&a.f.u()}
function Wv(a){if(a.r&&a.Ia&&0!==a.Ia.bb.length&&a.g&&a.j){for(var b=a.bd,c=b.dg()-1;0<=c;c--){var d=b.Zg(c);d&&d.sa==Lg.ROUTE&&b.remove(d)}var e=a.f.Ip.on;if(e&&0<e.length){for(var f=ew(a),g=a.r.eb(),h=hj(a.Ia.eb()),k=z.I(h,g),l=null,m=null,n=Number.MAX_VALUE,r=[],s=!1,c=0;c<e.length;c++){var t=e[c];if(t.Di){s=!0;break}}for(c=0;c<e.length;c++){var t=e[c],v;var w=f,x=t,y=h,A=k,C=t.width,B=t.color,I=t.Di,G=void 0,D=void 0,L=x.Tb.length;if(1>L)v=null;else{for(var O=[],M=x.Tb,Z=A[2]-3,V=w.Qb()?new oj(w):
new nj(w,2,Fh),Q=[],ga=0;ga<L;ga++){for(var fa=[],Ia=M[ga],za=Ia.m,zf=za.length,Tb=[0,0,0],ad=[0,0,0],bd=[0,0,0],kb=0;kb<zf;kb++){var lc=za[kb];Tb[0]=lc[0];Tb[1]=lc[1];var cd=Tb,yd=ad,yd=yd||z.create(),Og=cd[1]*u,dd=cd[0]*u,Af=Math.sin(dd),Sd=Math.cos(dd),ed=6378137/Math.sqrt(1-kq*Af*Af);yd[0]=ed*Sd*Math.cos(Og);yd[1]=ed*Sd*Math.sin(Og);yd[2]=ed*(1-kq)*Af;z.I(y,ad,bd);var Li=[bd[0],bd[1],null];Li.mf=0;fa.push(Li)}wh(fa,A,Math.max(1,110));1<fa.length&&Q.push({es:Ia,m:fa})}V.b(Q);for(ga=0;ga<Q.length;ga++){var Bf=
Q[ga],Ia=Bf.es,fa=Bf.m;V.a(Q,ga,Z,{});for(D=0;D<fa.length;D++)G=fa[D],null===G[2]&&(G[2]=Z);Eh(fa);O.push({Hp:x,m:fa,Y:Ia.Y,color:B,mk:mj.ROUND,lk:mj.ROUND})}v={Tb:O,width:C,color:B,Di:I,Y:null}}if(v&&v.Tb&&0<v.Tb.length){for(var Ab=v.Tb,fd=0;fd<Ab.length;fd++){var Jb=Ab[fd];if(Jb&&Jb.m&&1<Jb.m.length&&(Jb.Y=t.Y,s)){var gd=th(Jb.m,k);gd&&gd.Zf<n&&(l=v,m=Jb,n=gd.Zf)}}r.push(v)}}if(l&&m){for(var Ab=l.Tb,zd=Ab.indexOf(m),fd=0;fd<zd;fd++)Jb=Ab[fd],Jb.color=l.Di;var De=uh(m.m,k);De&&De.Rd&&(m.m=De.Rd,
m.color=l.Di,m.mk=mj.ROUND,m.lk=mj.TRIANGLE,De.split&&Ab.splice(zd+1,0,{m:De.Le,color:l.color,mk:mj.FLAT,lk:mj.ROUND,Y:m.Y}))}for(c=0;c<r.length;c++){v=r[c];var Ad;var Mi=a.Kc,Ni=v,Oi=Ni.Tb,Ee=Oi.length;if(1>Ee)Ad=null;else{for(var Fe={},Ge=[],Pg=0;Pg<Ee;Pg++){var Cf=Oi[Pg],Df=Cf.color,Ef=Fe[Df];if(!Ef){var Pi=Mi.lb,hl=Df,Qg=Pi.wa.Ob("attribute vec3 a_vertex;\nuniform mat4 u_mat_proj;\nuniform mat4 u_mat_view;\nuniform mat4 u_mat_model;\nvarying vec4 v_position;\nvoid main(void)\n{\n  vec4 vertex = vec4(a_vertex, 1.0); \n  gl_Position = u_mat_proj * u_mat_view * u_mat_model * vertex;\n  v_position = u_mat_model * vertex;\n}",
"#ifdef GL_ES \n\nprecision highp float;\n\n#endif\n\nuniform vec4 u_solid_color;\nuniform vec3 u_center_point;\nuniform float u_distance_limit_start;\nuniform float u_distance_limit_end;\nuniform float u_fadeFactor;\nvarying vec4 v_position;\nvoid main(void) \n{ \n   gl_FragColor = u_solid_color;\n   gl_FragColor.a *= u_fadeFactor;\n   float dist = length(v_position.xyz - u_center_point);\n   if (dist > u_distance_limit_end) {\n     discard;\n   } else {\n     if (dist > u_distance_limit_start) {\n       float vv = 1. - smoothstep(u_distance_limit_start,u_distance_limit_end, dist);\n       gl_FragColor.a = gl_FragColor.a * vv;\n     }\n   }\n}",
{position:"a_vertex",normal:"a_normal"}),Td=Yb(Pi.a.Bc);Td.u_solid_color=hl;Td.u_fadeFactor=1;Td.u_center_point=[0,0,0,1];Td.u_distance_limit_start=75;Td.u_distance_limit_end=105;var Rg=new Ld(Qg,Td);Rg.fb("routeMaterial");var Cc=new Nd;fr(Cc,!0);dh(Cc,!0);aj(Cc,6,7,1,7);cj(Cc,!0);cj(Cc,!0);bj(Cc,!1);dj(Cc,2);ej(Cc,6,3,255);Rg.pg(Cc);Ef=Rg;Fe[Df]=Ef}var $=Mi,il=Ni,Ma=Cf,Qi=Ef,jl=Ge,ea=Ma.m;if(!(2>ea.length)){z.distance(Ma.m[0],Ma.m[Ma.m.length-1]);z.distance(Ma.m[0],Ma.m[Ma.m.length-1]);var Ud=il.width,
Kb=0.5*Ud,Ri=Ma.Y,Bb=[0,0],Ff=fc/24,ka=new qf(ei);sf(ka);var Sa={bh:!0,start:ea[0],end:ea[0]};Ma.mk==mj.ROUND?jj($,ka,ea[0][0],ea[0][1],ea[0][2],ea[1][0],ea[1][1],Ud,24,Sa):Ma.mk==mj.TRIANGLE&&jj($,ka,ea[0][0],ea[0][1],ea[0][2],ea[1][0],ea[1][1],Ud,2,Sa);var Na=ea.length-1,fb=void 0,He=void 0,hd=void 0,id=void 0,lb=void 0,bb=void 0,La=void 0,Vd=void 0,Lb=void 0,Ec;var Wd=120*u,Mb=Ma.m,Gc=!1;if(!(2>Mb.length)){var Ic=Mb.length-1,mb=1,Sg=void 0,Tg=void 0,Wb=void 0,Ie=void 0,nb=Mb[0],Jc=Mb[1],Sg=nb[0],
Tg=nb[1],Wb=Jc[0],Ie=Jc[1],Gf=Math.atan2(Ie-Tg,Wb-Sg);nb.pb=Gf;nb.mf=null;for(mb=1;mb<=Ic;mb++){var nb=Mb[mb],Wb=nb[0],Ie=nb[1],Yd=0,Ug=0;if(mb<Ic){Jc=Mb[mb+1];Ug=Math.atan2(Jc[1]-Ie,Jc[0]-Wb);P.X(nb,Mb[mb-1]);var Vg=P.normalize(P.sub(nb,Mb[mb-1])),Si=P.normalize(P.sub(Jc,nb)),Yd=Math.acos(P.gl(Vg,Si));Gc||(Gc=Math.abs(Yd)>Wd);var Ti=P.Up(Si,-Vg[1],Vg[0]),Yd=Yd*(0===Ti?0:0>Ti?-1:1);nb.pb=Ug;nb.mf=Yd}else nb.pb=Gf,nb.mf=null;Gf=Ug}}Ec=Gc;if(Ec||3>ea.length)for(fb=1;fb<=Na;fb++){var Hf=ea[fb-1],ek=
ea[fb],Sa={bh:!0,start:Hf,end:ek};ij($,ka,Hf[0],Hf[1],Hf[2],ek[0],ek[1],ek[2],Ud,Sa)}else{var Qc=ea[0],Ln=ea[1],He=Qc[0],hd=Qc[1],id=Qc[2],Lb=Vd=0,Gd=Qc.pb,We=Math.sin(Gd),Xe=Math.cos(Gd),bc=Kb*We,cc=Kb*Xe,Sh=[He+bc,hd-cc,id?id:0],Th=[He-bc,hd+cc,id?id:0],dc=void 0,ec=void 0,aa=S(ka,Th,$.b,$.a);S(ka,Sh,$.b,$.a);for(fb=1;fb<=Na;fb++){var Qc=ea[fb],lb=Qc[0],bb=Qc[1],La=Qc[2],fk,Mn=!0,gk=Qc.mf,ng=0;fb<Na?(Ln=ea[fb+1],Vd=Ln[0],Lb=Ln[1],ng=Qc.pb,fk=Gd+0.5*gk,Mn=Math.abs(gk)<Ff):(fk=Gd,Mn=!0);Sa={bh:!0,
start:ea[fb-1],end:Qc};if(Mn)We=Math.sin(fk),Xe=Math.cos(fk),bc=Kb*We,cc=Kb*Xe,dc=[lb+bc,bb-cc,La?La:0],ec=[lb-bc,bb+cc,La?La:0],S(ka,ec,$.b,$.a),aa=S(ka,dc,$.b,$.a),xf(ka,aa-3,aa-2,aa,aa-3,aa,aa-1,Sa);else{var hk=Math.round(Math.abs(gk)/Ff),ik,jk,og,pg;if(0<gk){We=Math.sin(ng);Xe=Math.cos(ng);ik=Math.sin(Gd);jk=Math.cos(Gd);bc=Kb*We;cc=Kb*Xe;og=Kb*ik;pg=Kb*jk;lj(Th[0],Th[1],lb-og,bb+pg,lb-bc,bb+cc,Vd-bc,Lb+cc,Bb);var ec=[Bb[0],Bb[1],La?La:0],dc=[lb+og,bb-pg,La?La:0],Uh=[lb+bc,bb-cc,La?La:0];S(ka,
dc,$.b,$.a);aa=S(ka,ec,$.b,$.a);1===hk?(aa=S(ka,Uh,$.b,$.a),If(ka,aa-4,aa-3,aa-1,aa-3,aa-2,aa-1,aa-2,aa,aa-1,Sa)):(xf(ka,aa-3,aa-2,aa,aa-2,aa-1,aa,Sa),kj($,ka,lb,bb,La,ec[0],ec[1],dc[0],dc[1],Uh[0],Uh[1],hk,Sa),S(ka,ec,$.b,$.a),S(ka,Uh,$.b,$.a));Th=ec;Sh=Uh}else{We=Math.sin(ng);Xe=Math.cos(ng);ik=Math.sin(Gd);jk=Math.cos(Gd);bc=Kb*We;cc=Kb*Xe;og=Kb*ik;pg=Kb*jk;var ec=[lb-og,bb+pg,La?La:0],Vh=[lb-bc,bb+cc,La?La:0];lj(Sh[0],Sh[1],lb+og,bb-pg,lb+bc,bb-cc,Vd+bc,Lb-cc,Bb);dc=[Bb[0],Bb[1],La?La:0];1===
hk?(S(ka,ec,$.b,$.a),S(ka,Vh,$.b,$.a),aa=S(ka,dc,$.b,$.a),If(ka,aa-4,aa-3,aa-2,aa-3,aa,aa-2,aa,aa-1,aa-2,Sa)):(S(ka,ec,$.b,$.a),aa=S(ka,dc,$.b,$.a),xf(ka,aa-3,aa-2,aa-1,aa-2,aa,aa-1,Sa),kj($,ka,lb,bb,La,dc[0],dc[1],Vh[0],Vh[1],ec[0],ec[1],hk,Sa),S(ka,Vh,$.b,$.a),S(ka,dc,$.b,$.a));Th=Vh;Sh=dc}}Gd=ng}}Sa={bh:!0,start:ea[Na-1],end:ea[Na],Y:Ri};Ma.lk==mj.ROUND?jj($,ka,ea[Na][0],ea[Na][1],ea[Na][2]?ea[Na][2]:0,ea[Na-1][0],ea[Na-1][1],Ud,24,Sa):Ma.lk==mj.TRIANGLE&&jj($,ka,ea[Na][0],ea[Na][1],ea[Na][2]?
ea[Na][2]:0,ea[Na-1][0],ea[Na-1][1],Ud,2,Sa);if(0<ka.c){Qi.Sf=3;var Nn=new Be(new pd($.mb,ka.hb()),Qi);je(Nn,Lg.ROUTE);Nn.Y=Ri;jl.push(Nn)}}}Ad=Ge}if(Ad)for(var On=0;On<Ad.length;On++)b.add(Ad[On])}}a.Va=!1}else a.Va=!0}p.Xe=function(a){this.vf!==a&&(this.vf=a,this.e.G(a),this.dc.G(a),this.bd.G(a),this.f.u())};function Wa(a,b){a.ce.forEach(function(c){c.M&&(c.Ha=a.Rc?b:a.f.Hd)})}p.Lc=function(a){if(this.Rc!==a){this.Rc=a;var b=this;this.ce.forEach(function(c){c.M?c.Ha=b.Rc?b.f.Hf:b.f.Hd:c.G(a)})}};
p.Pd=function(a){this.Td!==a&&(this.Td=a,this.n.forEach(function(b){b.G(a)}))};p.Bf=function(a){this.o.forEach(function(b){b.G(a)})};function Tv(a){if(a&&a.ea)for(;0<a.ea.length;)a.remove(a.ea[0])}
function dw(a,b){var c=b.buildingId;if(!(0<re(a.ce,c).length)){var d=b.sd;if(!d){var e=a.f.ej.get(b.buildingId);e&&(d=e.sd,b.sd=e.sd)}if(d)d&&a.f.ej.fl(b.buildingId);else if(e=b.nd(a.f.mb))d=new Be(e,null),b.sd=d,je(d,Lg.BUILDING),d.fb(c),d.M=!0,d.fr=b.Ya,c=Ra(b.ta),se(d,c),ue(d,c.slice(3,7)),a.f.ej.set(b.buildingId,b);d&&a.ce.add(d)}}
function $v(a,b){var c=b.sd,d=Ra(b.ta);c||(c=new Be(b.Gc,null),b.sd=c,je(c,Lg.TERRAIN),c.Ha=a.f.cl);se(c,d);ue(c,d.slice(3,7));c.G(a.Td);c instanceof Be&&(c.Ha.Sf=a.Dk?2:3);c instanceof ie&&0<c.ea.length&&(c.ea[0].Ha.Sf=a.Dk?2:3);a.n.add(c)}function Yv(a){if(!xk)return!0;var b=!1;a.s.forEach(function(a,d){d.la&&(b=!0)});return b||0==a.b.length}function Uv(a){var b=!1;a.Kb.forEach(function(a,d){if(!d.la&&d.Qb)return b=!0});return b}
function ew(a){if(!Yv(a))return a.aa;Zv(a.f,Ej(a.r),a.f.mb);return a.f.qk}p.Md=function(){Tv(this.eh)};p.u=function(){this.f.u()};
function Pa(a){try{if(a.r&&(a.r&&a.r.Rb?1>a.r.Rb.a:1)&&!a.r.a&&ew(a).kf()){Ej(a.r);var b;var c=a.Ia,d=ew(a);if(d.kf()&&c){var e=c.eb(),f=hj(e),g=a.r.ib(),h=z.I(f,g),k=d.ue(h[0],h[1],8);b=null===k?null:k}else b=null;if(null!==b){var l=a.r.eb().slice(0,3);a.r.b=Ej(a.r).slice(0,3);var m=Ej(a.r);m[2]=b+3;a.r.ta.set(m);a.r.a=!0;z.$f(l,a.f.ya.S)&&se(a.f.ya,a.r.eb())}}}catch(n){ia()}}
p.Mq=function(a){var b=this.f,c=this.r;ib&&this.f.k.r&&Mr(this.f.k);a.status?b.Za.Ga.handleEvent("PANORAMA_LOADED",c):b.Za.Ga.handleEvent("PANORAMA_NOT_FOUND",c);(a=cr())&&a.Cp(c.ta.get(0));b.u()};p.Nq=function(a){this.ic||(a.status?(this.Ci.a(a.face,a.me,a.x,a.y,a.Im),this.rg.ad(a),this.f.u()):ia("Unable to load skybox tile: "+a.Th.xb()))};p.uf=function(){if(this.dc.Qa()&&this.Ia&&0<this.Hc.length){var a=[this.Hc,this.Nd],b=this.Ia;null!==b&&gj(this.Kc,this,a,b,!1)}this.f.Za.pj().uf()};
function fw(a,b){a.Sc=!Pk||b;a.Sc&&(a.v&&Ua(a),a.H&&Ya(a))}
function Ua(a){if(a.r&&a.Ia&&a.Sc&&0!==a.Ia.bb.length&&a.g&&a.j){a.aa&&a.aa.Xk(a.Ia.eb());Pa(a);a.Kc.clear(a.r);if(a.Ia){var b=a.Ia.eb(),c=Yc(b[3],b[4],b[5],b[6]);se(a.o,b);ue(a.o,c);void 0!==a.bd&&se(a.bd,[0,0,0.1]);void 0!==a.dc&&se(a.dc,[0,0,0.1])}if(0===a.bd.dg()){var b=a.Kc,d=a.Ia,e=ew(a);if(null!==d&&null!==e&&e.kf()){var f,g,h;b.c=0.5*b.n;if(e.kf()){c=$h;b.c=0.5*b.n;if(null===b.j||b.e!=c){b.e=c;bi[3]=0.25;b.j=gw(b.lb,bi,b.e,!1);ci[3]=0.25;b.o=gw(b.lb,ci,b.e,!b.e);var k=b.lb,c=b.e,l=k.wa.Ob("attribute vec3 a_vertex;\nattribute float a_opacity;\nuniform mat4 u_mat_proj;\nuniform mat4 u_mat_view;\nuniform mat4 u_mat_model;\nvarying float v_opacity;\nvoid main(void)\n{\n  vec4 vertex = vec4(a_vertex, 1.0); \n  gl_Position = u_mat_proj * u_mat_view * u_mat_model * vertex;\n  v_opacity = a_opacity;\n}",
"#ifdef GL_ES \n\nprecision highp float;\n\n#endif\n\nuniform vec4 u_solid_color;\nuniform float u_fadeFactor;\nvarying float v_opacity;\nvoid main(void) \n{ \n   gl_FragColor = u_solid_color;\n   gl_FragColor.a = gl_FragColor.a * v_opacity * u_fadeFactor;\n}",{position:"a_vertex",normal:"a_normal",opacity:"a_opacity"}),k=Yb(k.a.Bc);k.u_solid_color=bi;k.u_fadeFactor=1;l=new Ld(l,k);l.fb("roadPieceMaterial");k=new Nd;fr(k,!0);dh(k,!0);aj(k,6,7);cj(k,!0);c?(bj(k,!1),dj(k,3),ej(k,3,1,3)):(bj(k,!0),er(k),
dj(k,2),ej(k,4,1,1));l.pg(k)}var c=[],l=[0,0],k=Math.round(Math.PI/0.5),m=d.$,n=0,n=hi+ii,m=pv(d,e),r=a.r.eb(),n=n*n||1E4,e=z.create();z.I(d.Nf,r,e);r=[];for(d=0;d<m.length;d++){var s=m[d];s.qd||(g=th(s.m,e))&&g.Zf<n&&r.push(s)}m=r;n=0;r=new qf(di);d=new qf(di);sf(r);for(sf(d);n<m.length;n++)if(e=m[n],!(2>e.m.length||(Eh(e.m),e.qd&&(e.qd=!Vi(e.m)),e.qd))){s=e.Tg?e.Tg:3;if(0>s||s>=Gh.length)s=3;g=Gh[s];if(g.na){var s=e.tm(b.p),t={name:s,bh:!1,mn:n,start:e.m[0],end:e.m[0]},v=b.n*g.Pc,w=0.5*v,x=e.labels?
r:d;jj(b,x,e.m[0][0],e.m[0][1],e.m[0][2],e.m[1][0],e.m[1][1],v,k,t);g=e.m.length-1;var y,A,C,B;h=e.m;B=!1;var I=120*u;for(f=1;f<g;f++)if(Math.abs(h[f].mf)>I){B=!0;break}if(B||3>e.m.length)for(f=1;f<=g;f++)w=e.m[f-1],h=e.m[f],t={name:s,bh:!1,mn:n,start:w,end:h},ij(b,x,w[0],w[1],w[2],h[0],h[1],h[2],v,t);else{t=e.m[0];B=e.m[1];f=t[0];y=t[1];A=t[2];B=h=0;var G=t.pb,D=Math.sin(G),L=Math.cos(G),D=w*D,L=w*L,I=[f+D,y-L,A?A:0],O=[f-D,y+L,A?A:0],M,D=S(x,O,b.b,b.a);S(x,I,b.b,b.a);for(f=1;f<=g;f++){t=e.m[f];
y=t[0];A=t[1];C=t[2];var Z,L=!0,D=t.mf,V=0;f<g?(B=e.m[f+1],h=B[0],B=B[1],V=t.pb,Z=G+0.5*D,L=0.5>Math.abs(D)):(Z=G,L=!0);t={name:s,bh:!1,mn:n,start:e.m[f-1],end:t};if(L)D=Math.sin(Z),L=Math.cos(Z),D*=w,L*=w,M=[y+D,A-L,C?C:0],G=[y-D,A+L,C?C:0],S(x,G,b.b,b.a),D=S(x,M,b.b,b.a),xf(x,D-3,D-2,D,D-3,D,D-1,t);else{Z=Math.round(Math.abs(D)/0.5);var Q;0<D?(D=Math.sin(V),L=Math.cos(V),M=Math.sin(G),G=Math.cos(G),D*=w,L*=w,M*=w,Q=w*G,lj(O[0],O[1],y-M,A+Q,y-D,A+L,h-D,B+L,l),G=[l[0],l[1],C?C:0],M=[y+M,A-Q,C?C:0],
I=[y+D,A-L,C?C:0],S(x,M,b.b,b.a),D=S(x,G,b.b,b.a),1===Z?(D=S(x,I,b.b,b.a),If(x,D-4,D-3,D-1,D-3,D-2,D-1,D-2,D,D-1,t)):(xf(x,D-3,D-2,D,D-2,D-1,D,t),kj(b,x,y,A,C,G[0],G[1],M[0],M[1],I[0],I[1],Z,t),S(x,G,b.b,b.a),S(x,I,b.b,b.a)),O=G):(D=Math.sin(V),L=Math.cos(V),M=Math.sin(G),G=Math.cos(G),D*=w,L*=w,M*=w,Q=w*G,G=[y-M,A+Q,C?C:0],O=[y-D,A+L,C?C:0],lj(I[0],I[1],y+M,A-Q,y+D,A-L,h+D,B-L,l),M=[l[0],l[1],C?C:0],1===Z?(S(x,G,b.b,b.a),S(x,O,b.b,b.a),D=S(x,M,b.b,b.a),If(x,D-4,D-3,D-2,D-3,D,D-2,D,D-1,D-2,t)):(S(x,
G,b.b,b.a),D=S(x,M,b.b,b.a),xf(x,D-3,D-2,D-1,D-2,D,D-1,t),kj(b,x,y,A,C,M[0],M[1],O[0],O[1],G[0],G[1],Z,t),S(x,O,b.b,b.a),S(x,M,b.b,b.a)),I=M)}G=V}}t={name:s,bh:!1,mn:n,start:e.m[g-1],end:e.m[g]};jj(b,x,e.m[g][0],e.m[g][1],e.m[g][2]?e.m[g][2]:0,e.m[g-1][0],e.m[g-1][1],v,k,t)}}0<r.c&&(b.j.Sf=3,l=new Be(new pd(b.mb,r.hb()),b.j),je(l,Wg),c.push(l));0<d.c&&(b.o.Sf=3,b=new Be(new pd(b.mb,d.hb()),b.o),je(b,Xg),c.push(b));b=c}else b=0;Tv(a.bd);if(b)for(c=0;c<b.length;c++)a.bd.add(b[c])}}a.v=!1;Wv(a)}else a.v=
!0}
function Ya(a){if(0<a.f.Ea.Pb().height&&a.r&&a.Ia&&a.Sc&&0!==a.Ia.bb.length&&a.g&&a.j){if(0===a.dc.dg()){Tv(a.dc);var b;b=a.Kc;var c=a.Ia,d=ew(a);if(null!==c&&null!==d&&d.kf()){var e=a.f.N();b.aa=a.f.Ea.Pb().height;b.H=wc(e.cg());b.M=2*Math.tan(0.5*b.H)/b.aa;var e=null,e=hj(c.eb()),f=a.r.ib(),e=z.I(e,f),e=[e[0]-0,e[1]-0,e[2]-a.bd.S[2]],f=a.f.nh,g=[],h=new Yu;h.Db(c);var k=h.b,l=null;for(l in k){var m=k[l],n=m.tm(b.p),r=Ji(b,a,g,m,h,d,e,f,n);if(!r)for(;!r;){r=Math.floor(0.7*n.length);if(2>r)break;n=
n.substr(0,r);r=Ji(b,a,g,m,h,d,e,f,n+"...")}}e=g;gj(b,a,[e],c,!0);b=e}else b=null;if(b){for(c=a.Hc.length=0;c<a.Nd.length;c++)a.Hc[c]=a.Nd[c];for(c=0;c<b.length;c++){d=b[c];f=e=void 0;g=null;for(h=h=0;h<a.Hc.length;h++)if(g=a.Hc[h],g.Vk==d.Vk){f=g.kh!=d.kh;if(g.Xm!=d.Xm){e=!0;break}if(null!=g.Ai){h=z.X(g.Ai,d.Ai);e=1<h?!0:!1;break}break}g&&!1===e&&!1===f?(se(d.we,g.we.S),ue(d.we,g.we.Ak()),d.we.ea[0].ie=1):d.we.ea[0].ie=null;a.dc.add(d.we)}for(c=a.Nd.length=0;c<b.length;c++)a.Nd[c]=b[c];if(0==a.Hc.length)for(c=
0;c<b.length;c++)a.Hc[c]=b[c]}else a.Hc.length=0,a.Nd.length=0;a.dc.G(a.vf)}a.H=!1}else a.H=!0}p.ah=function(){this.f.ca.ah(this)};p.Gd=function(){this.r&&this.g&&this.j?this.f.ca.Gd(this)&&(this.Qc=!1,this.f.u()):this.Qc=!0};function Kf(a){a instanceof Kf?(this.a=Yb(a.a),this.da=a.da):this.clear()}p=Kf.prototype;p.Db=function(){return new this.constructor(this)};p.clear=function(){this.a={};this.da=0};p.size=function(){return this.da};p.get=function(a){return this.a[a]};p.set=function(a,b){var c=this.a;if(c[a])return c[a]=b,!1;c[a]=b;++this.da;return!0};p.remove=function(a){var b=this.a,c=b[a];if(!J(c))return delete b[a],--this.da,c};p.forEach=function(a){var b=this.a,c;for(c in b){var d=a(c,b[c]);if(!J(d))return d}};function hw(){}p=hw.prototype;p.clear=function(){};p.dg=function(){};p.sc=function(){};p.update=function(){};p.sg=function(){};function iw(){this.ea=new Kf}iw.prototype=Object.create(hw.prototype);p=iw.prototype;p.clear=function(){this.ea=new Kf};p.dg=function(){return this.ea.size()};p.sc=function(){return null};p.update=function(a,b){var c=this.ea;a.forEach(function(a,b){c.set(a,b)});b.forEach(function(a){c.remove(a)})};p.sg=function(a){this.ea.forEach(function(b,c){a(c)})};function le(a){a instanceof le?(this.ra=new a.ra.constructor,this.a=Yb(a.a),this.b=Yb(a.b),this.c=Yb(a.c),ie.call(this,a)):(this.ra=a||new iw,this.a=new Kf,this.b=new Kf,this.c=new Kf,ie.call(this))}le.prototype=Object.create(ie.prototype);le.prototype.sc=function(){return this.ra.sc()};
le.prototype.update=function(){var a=this.ra,b=this.a,c=this.b,d=this.c;(0<d.size()||0<b.size())&&oe(this,null,function(a){var c=a.Da();return d.get(c)||b.get(c)?(Ae(a),!1):!0});a.update(b,c,d);b.clear();c.clear();d.clear()};le.prototype.clear=function(){for(;0<this.ea.length;)this.remove(this.ea[0]);this.ra.clear();this.a.clear();this.b.clear();this.c.clear()};le.prototype.sg=function(a,b){this.update();b&&!b(this.sc())||this.ra.sg(a,b)};
function eh(a,b,c,d,e){e=e||{Qo:!0,ne:!0};var f=K(e.Qo,!0),g=K(e.ne,!0);b=wd(b);e=wd(c);var h=R(),k=R();c=Cd(c);var l,m,n=c[12],r=c[13],s=c[14];e[12]=0;e[13]=0;e[14]=0;var t=new he;t.a=b;t.sf=e;t.rf=h;g&&(t.ne=k);f&&(c=xd(b,e),l=new Xd(c));a.sg(function(a){if(a.Qa()){wd(we(a),h);h[12]-=n;h[13]-=r;h[14]-=s;g&&(Cd(h,k),Bd(k,k));var b=!1;if(f){var b=m=l.d(h),c=a.sc(),b=c?gf(c,b):!1;t.b=m}b||(t.object=a,d(a,t))}},function(a){return f&&a?!gf(a,l):!0})}
function jw(a,b,c,d,e){var f=fe(),g=z.create();a.sg(function(a){if(!d||d(a)){nf(xe(a),b,f);var k=a.$h(f,g,e);0<=k&&c(a,k,g)}},function(a){return a?a.le(b):!0})}function ne(a,b){var c=b.Da();a.a.set(c,b)&&(a.b.remove(c),a.c.remove(c))}function me(a,b){var c=b.Da();a.b.set(c,b)&&(a.a.remove(c),a.c.remove(c))}function ke(a,b){var c=b.Da();a.a.get(c)||a.b.get(c)||a.c.set(c,b)};function kw(a,b){this.df=a;this.ed=this.o(b);this.ze=void 0;this.gk=0;hu&&(this.gk=window.devicePixelRatio||1);this.ho=this.g();this.Ng=this.j()}
ca(kw.prototype,{Ac:function(){delete this.df;delete this.ba;delete this.ze},n:function(){return this.ze},b:function(){return this.ed},a:function(a,b,c,d,e){b=Math.pow(2,b);var f=this.ho[a];a=f.getContext("2d");var g=f.width,f=f.height;a.drawImage(e,c*g/b,d*f/b,g/b,f/b)},o:function(a){a=void 0!==a?a:3;var b=Kc(1024)-8;return b<a?b:a},v:function(){},g:function(a){var b=[],c=Yk?Cu:2048;a=a?a:c;for(c=0;6>c;c++){var d=document.createElement("canvas");d.width=lw;d.height=lw;d.style.width=a+"px";d.style.height=
a+"px";d.style.display="block";this.gk&&(d.style.padding=this.gk+"px");b[c]=d}return b},j:function(){for(var a=new mw,b=2*this.gk+Cu,c=0;6>c;c++){var d=new nw(c,b);d.de.appendChild(this.ho[c]);a.de.appendChild(d.de);a.To.push(d)}return a}});var lw=1024,Cu=Math.floor(1024/(window.devicePixelRatio||1)),ow=[[0,0],[0,270],[0,180],[0,90],[90,0],[-90,0]];
function mw(){this.To=[];this.de=document.createElement("div");this.gj=document.createElement("div");3<=(window.devicePixelRatio||1)&&nu(this.de,"transformStyle","preserve-3d");pw(this.de,1);pw(this.gj,2)}function pw(a,b){var c=a.style;c.pointerEvents="none";c.position="absolute";c.top="50%";c.left="50%";c.zIndex=b}
function nw(a,b){this.index=a;this.de=document.createElement("div");nu(this.de,"backfaceVisibility","hidden");var c=this.de.style;c.position="absolute";c.top=c.left=(-b/2).toFixed(2)+"px";c.width=c.height=b+"px"};var Hs=0,Ls=1,Ks=2,Ps=3,Js=4,Is=5,Ms={Yn:Hs,hq:Ls,Bs:Ks,As:Ps,rs:Js,ss:Is,ROAD:6};function qw(a,b){if(a instanceof qw)ie.call(this,a),this.a=this.Zg(0),this.Jd=this.Zg(1);else if(a instanceof Oe){var c=ch,d=b||Qb;ie.call(this);je(this,c);this.fb("cursorGroup");var e=new Ne(a,d);je(e,c);e.fb("cursormarker");this.a=e;this.add(e);d=new Ne(a,d);je(d,c);d.fb("cursoricon");this.Jd=d;this.add(d)}this.c=Hs;this.b=1;this.an=new ph}qw.prototype=Object.create(ie.prototype);qw.prototype.qb=function(){return this.a};
qw.prototype.aa=function(){return this.Jd};qw.prototype.vd=function(a){this.b=tc(a,0,1);this.a.vd(this.b);this.Jd.vd(this.b)};function rw(a,b,c){var d=a.Pa();this.e=new ph;this.d=new ph;this.c=new ph;this.g=a;b||(b=window.devicePixelRatio||1,b=new Pe(0,0,Math.round(a.La.width/b),Math.round(a.La.height/b)));this.b=b;this.Ml=c||Ku(a)+1;this.df=d.$l();this.a=this.Vf=!0;a.a.push(this)}rw.prototype.Pb=function(){return Rc(this.b)};
function sw(a,b){var c=a.g,d=a.b;if(d.x!=b.x||d.y!=b.y)Ju(c,d).forEach(function(a){a.a=!0}),d.x=b.x,d.y=b.y,a.d.call({target:a}),a.a=!0;if(d.width!=b.width||d.height!=b.height)Ju(c,d).forEach(function(a){a.a=!0}),d.width=b.width,d.height=b.height,a.e.call({target:a}),a.a=!0}function tw(a){var b=a.b.width;return(a=a.b.height|0)?b/a:1}rw.prototype.Qa=function(){return this.Vf};rw.prototype.Ik=function(){return this.a};function ir(a,b){var c=a.Pb();return new jr(b.x-c.x,b.y-c.y)}
function kr(a,b){var c;c=c||z.create();var d=a.Pb();d.width&&d.height?(c[0]=b.x/d.width*2-1,c[1]=-(b.y/d.height*2-1)):(c[0]=0,c[1]=0);c[2]=-1;return c};function uw(){this.ak=new Kf;this.Gh=[]}uw.prototype=Object.create(hw.prototype);var Mg=2,Ng=4,Wg=5,Xg=6,ah=10,bh=11,xg=12,wr=13,wg=14,Yg=20,Zg=21,$g=22,ch=1014,Lg={Yn:0,TERRAIN:1,us:Mg,BUILDING:3,Ds:Ng,Hs:Wg,Zs:Xg,ROUTE:8,Qs:ah,Ps:bh,Rs:xg,Ts:wr,Ss:wg,Js:Yg,ts:Zg,Es:$g,ws:ch,xs:9999,Cs:1E4};p=uw.prototype;p.dg=function(){var a=0;this.ak.forEach(function(b,c){c.forEach(function(){a++})});return a};p.clear=function(){this.ak=new Kf;this.Gh=[]};p.sc=function(){return null};
p.update=function(a,b,c){var d=this.ak;a.forEach(function(a,b){var c=b.sa,h=d.get(c);J(h)&&(h=new Kf,d.set(c,h));h.set(a,b)});c.forEach(function(a,b){var c=b.sa,h=d.get(c),k=void 0;J(h)?(h=new Kf,d.set(c,h)):k=h.get(a);J(k)&&(d.forEach(function(b,c){var d=c.get(a);if(!J(d))return c.remove(a),!0}),h.set(a,b))});b.forEach(function(a,b){var c=d.get(b.sa);c&&c.remove(a)})};p.sg=function(a){for(var b=0,c=this.Gh.length;b<c;++b){var d=this.ak.get(this.Gh[b]);!J(d)&&d.forEach(function(b,c){a(c)})}};
function Kg(a,b){a.Gh=b};function vw(a,b){this.a=Yb(ww);this.n=Yb(xw);this.wa=a;this.Vb=b;this.c=this.b=null;this.d=this.wa.Ob(yw,zw,Aw)}
var yw="precision highp float;\nattribute vec3 a_position;\nattribute vec2 a_texcoord0;\nuniform mat4 u_mat_proj;\nuniform mat4 u_mat_view;\nuniform mat4 u_mat_model;\nvarying vec2 v_texcoord0;\nvoid main() {\nvec4 position = vec4(a_position, 1.0);\nv_texcoord0 = a_texcoord0;\ngl_Position = u_mat_proj * u_mat_view * u_mat_model * position;\n}",zw="precision highp float;\nuniform sampler2D u_texunit0;\nuniform mat3 u_mat_tex;\nuniform float u_opacity;\nuniform float u_fadeFactor;\nvarying vec2 v_texcoord0;\nvoid main() {\nvec3 texcoord0 = u_mat_tex * vec3(v_texcoord0, 1.0);\nvec4 color = texture2D(u_texunit0, texcoord0.xy);\ncolor.a *= u_opacity * u_fadeFactor;\ngl_FragColor = color;\n}",Aw=
{position:"a_position",texcoord:"a_texcoord0"},ww={Bc:{u_texunit0:0}},xw={Bc:{u_texunit0:0,u_ambient_color:[0.4,0.4,0.4,1],u_directional_light_direction:[-1,1,0],u_directional_light_color:[0.9,0.9,0.9,1],u_point_light_position:[0,0,0],u_point_light_color:[1,1,1,1]}};
function wn(a){J(a.e)&&(a.e=a.wa.Ob("attribute vec3 a_vertex;\nattribute vec2 a_texcoord;\nattribute vec4 a_color;\nuniform mat4 u_mat_proj;\nuniform mat4 u_mat_view;\nuniform mat4 u_mat_model;\nvarying vec4 v_color;\nvoid main(void)\n{\n vec4 vertex = vec4(a_vertex, 1.0); \n  v_color = a_color; \n  gl_Position = u_mat_proj * u_mat_view * u_mat_model * vertex;\n}","#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 v_color;\nvoid main(void) \n{ \n   gl_FragColor = v_color;\n}",{position:"a_vertex",
texcoord:"a_texcoord"}));a=new Ld(a.e,a.a.Bc);a.fb("createColoredMaterial");return a}
function un(a,b){var c=b||[0.3,0,1,1],c=a.wa.Ob(["attribute vec3 a_vertex;\nattribute vec2 a_texcoord;\nuniform mat4 u_mat_proj;\nuniform mat4 u_mat_view;\nuniform mat4 u_mat_model;\nvarying vec4 v_color;\nvoid main(void)\n{\n vec4 vertex = vec4(a_vertex, 1.0); \n  v_color = vec4(",c[0]+", ",c[1]+", ",c[2]+", ",c[3]+"); ","  gl_Position = u_mat_proj * u_mat_view * u_mat_model * vertex;\n}"].join("\n"),"#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 v_color;\nuniform float u_alphaFactor;\nvoid main(void) \n{ \n   gl_FragColor = v_color;\n   gl_FragColor.a = gl_FragColor.a * u_alphaFactor;\n}",{position:"a_vertex",
texcoord:"a_texcoord"});a.a.Bc.u_alphaFactor=1;c=new Ld(c,a.a.Bc);c.fb("cplMaterial");var d=c.tc();dh(d,!0);$i(d,0,1);bj(d,!1);aj(d,6,7,12,12);return c}
function vn(a){J(a.j)&&(a.j=a.wa.Ob("attribute vec3 a_vertex;\nattribute vec2 a_texcoord;\nuniform mat4 u_mat_proj;\nuniform mat4 u_mat_view;\nuniform mat4 u_mat_model;\nvarying vec2 v_texcoord;\nvoid main(void)\n{\n  vec4 vertex = vec4(a_vertex, 1.0); \n  gl_Position = u_mat_proj * u_mat_view * u_mat_model * vertex;\n  v_texcoord = a_texcoord;\n}","#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec2 v_texcoord;\nuniform sampler2D u_texunit0;\nuniform float u_alphaFactor;\nvoid main(void) \n{ \n   gl_FragColor = texture2D(u_texunit0, v_texcoord);\n   if (gl_FragColor.a < 0.001) {\n     discard;\n   }\n   gl_FragColor.a = gl_FragColor.a * u_alphaFactor;\n}",
{position:"a_vertex",texcoord:"a_texcoord"}));a.a.Bc.u_alphaFactor=1;a=new Ld(a.j,a.a.Bc);a.fb("MarkerMaterial");var b=a.tc();dh(b,!0);$i(b,1,1);aj(b,6,7,12,12);return a}function Bw(a){if(!a.b){var b=Yb(a.a.Bc);b.u_fadeFactor=1;b=new Ld(a.d,b);b.fb("spriteMaterial");var c=b.tc();bj(c,!1);dh(c,!0);$i(c,0,1);aj(c,6,7,12,12);a.b=b}return a.b}function ih(a){a.c||(a.c=vg(a));return a.c}
function vg(a){var b=Yb(a.a.Bc);b.u_opacity=1;b.u_fadeFactor=1;a=new Ld(a.d,b);a.fb("markerMaterial");b=a.tc();bj(b,!1);dh(b,!0);$i(b,0,1);aj(b,6,7,12,12);fr(b,!1);return a}
function gw(a,b,c,d){var e=hi,f=ii,g=a.wa.Ob("attribute vec3 a_vertex;\nuniform mat4 u_mat_proj;\nuniform mat4 u_mat_view;\nuniform mat4 u_mat_model;\nvarying vec4 v_position;\nvoid main(void)\n{\n  vec4 vertex = vec4(a_vertex, 1.0); \n  gl_Position = u_mat_proj * u_mat_view * u_mat_model * vertex;\n  v_position = u_mat_model * vertex;\n}","#ifdef GL_ES \n\nprecision highp float;\n\n#endif\n\nuniform vec4 u_solid_color;\nuniform vec3 u_center_point;\nuniform float u_distance_limit_start;\nuniform float u_distance_limit_end;\nuniform float u_fadeFactor;\nvarying vec4 v_position;\nvoid main(void) \n{ \n   gl_FragColor = u_solid_color;\n   gl_FragColor.a *= u_fadeFactor;\n   float dist = length(v_position.xyz - u_center_point);\n   if (dist > u_distance_limit_end) {\n     discard;\n   } else {\n     if (dist > u_distance_limit_start) {\n       float vv = 1. - smoothstep(u_distance_limit_start,u_distance_limit_end, dist);\n       gl_FragColor.a = gl_FragColor.a * vv;\n     }\n   }\n}",
{position:"a_vertex",normal:"a_normal"}),e=e?e:20,f=f?e+f:e+20;a=Yb(a.a.Bc);a.u_solid_color=b;a.u_fadeFactor=1;a.u_center_point=[0,0,0,1];a.u_distance_limit_start=e;a.u_distance_limit_end=f;b=new Ld(g,a);b.fb("roadMaterial");g=new Nd;fr(g,!0);dh(g,!0);aj(g,6,7,1,7);cj(g,!0);c?(bj(g,!1),dj(g,3),ej(g,3,1,255)):(bj(g,!d),er(g),dj(g,2),ej(g,4,1,1));b.pg(g);return b}function Cw(a){a=Dw(a,"transition",{position:"a_vertex"});a.Pm=!0;return a}
function Dw(a,b,c){var d="__"+b,e;if(a[d])e=a[d];else{var f;if(J(Ob))F("No shader code!"),f=null;else{e=Ob[b];f=e.defaultUniformValues;if(!J(f)&&"string"==typeof f)try{e.defaultUniformValues=window.JSON.parse(f)}catch(g){}f=e}e={};e.os=f.defaultUniformValues;e.object=a.wa.Ob(f.vs,f.fs,c);a[d]=e}a=new Ld(e.object,e.os);a.fb(b);return a};function Ew(a){this.Ea=this.c=this.wa=this.Jc=null;this.Za=a;this.Nd=this.Hc=this.nh=this.Fa=this.b=this.ya=this.Ca=null;this.wi=this.xi=this.vf=!0;this.Ho=this.Dk=!1;this.lg=!0;this.ej=new jv;this.Z=this.k=null;this.Cd=new Xr;this.Cd.name="current";this.Zd=new Xr;this.Zd.name="next";this.Vb=this.mb=null;this.vo=ib?!0:!1;this.gg=!0;this.Dp=!1;this.e=[];this.Hp=this.fm=this.qk=null;this.globalLabelOpacity=0;this.globalOverlayOpacity=1;this.g=!0;this.v=0;this.p=this.M=this.H=null;this.l=new Hb(this);
this.ic=[xg,wg,bh,ah,Lg.ROUTE,Wg,Xg,Ng,Lg.TERRAIN,Lg.BUILDING];this.hc=[Lg.TERRAIN,Mg,Lg.BUILDING,Ng,Wg,Xg,Lg.ROUTE,Yg,Zg,$g,ah,bh,xg,wg,ch];this.a={};this.a[0]=0;this.a[Lg.TERRAIN]=Lg.TERRAIN;this.a[Mg]=Mg;this.a[Lg.BUILDING]=Lg.BUILDING;this.a[Ng]=Ng;this.a[Wg]=Wg;this.a[Xg]=Xg;this.a[Lg.ROUTE]=Lg.ROUTE;this.a[Yg]=Yg;this.a[Zg]=Zg;this.a[$g]=0;this.a[xg]=$g;this.a[wg]=$g;this.a[wr]=$g;this.a[ah]=ah;this.a[bh]=bh;this.a[ch]=ch;this.a[9999]=9999;this.a[1E4]=1E4;this.aa=new sa;this.ca=new Vm(this);
this.j=new Hg;this.Ip=new pt}var Yr=115;p=Ew.prototype;p.kb=pa();
function Fw(a,b,c){a.va=0;a.c=ib?new Fu(b,"software"):new Fu(b,"webgl");a.Ea=new rw(a.c);a.wa=a.c.Pa();a.Jc=a.Ea.df;Hu(a.c,new Pe(0,0,b.clientWidth,b.clientHeight));sw(a.Ea,a.c.Pb());a.ya=new Nf({ld:Yr*u,Tl:tw(a.Ea),Nk:1,tk:1E3});a.ya.fb("panoramaCamera");a.b=new Nf({ld:Yr*u,Tl:tw(a.Ea),Nk:1,tk:1E3});a.b.fb("freeCamera");a.Ca=a.ya;a.p=a.mr.bind(a);a.Ea.c.qc(a.p);a.mb=a.wa.oj();a.Vb=a.wa.Ck();ib||(a.Jc.Wk(0,0,0,0),a.Jc.clear());a.lb=new vw(a.wa,a.Vb);var d=a.lb;a.xa=Dw(d,"fixedCube",{position:"a_vertex"});
var e=Dw(d,"transitionFixedCube",{position:"a_vertex"});e.Pm=!0;a.Tp=e;var e=Dw(d,"renderToDepthBuffer",{position:"a_vertex"}),f=new Nd;f.p=0;gr(f);e.pg(f);a.Hd=e;e=Dw(d,"transitionHighlight",{position:"a_vertex",normal:"a_normal"});e.Pm=!0;a.o=e;e=sh(1081565,0.5);e=d.wa.Ob(["attribute vec3 a_vertex;\nattribute vec3 a_normal;\nuniform mat4 u_mat_proj;\nuniform mat4 u_mat_view;\nuniform mat4 u_mat_model;\nuniform mat4 u_mat_normal;\nuniform vec4 u_ambient_color;\nuniform vec3 u_directional_light_direction;\nuniform vec4 u_directional_light_color;\nuniform vec3 u_point_light_position;\nuniform vec4 u_point_light_color;\nvarying vec4 v_color;\nvarying vec4 v_light_weight;\nvoid main(void)\n{\n  vec4 vertex = vec4(a_vertex, 1.0); \n  v_color = vec4(",
e[0]+", ",e[1]+", ",e[2]+", ",e[3]+"); ","  vec4 mv_position = u_mat_view * u_mat_model * vertex;\n  gl_Position = u_mat_proj * mv_position;\n  vec4 trans_normal = u_mat_normal * vec4(a_normal, 0.0);\n  vec3 point_light_dir =\n     normalize(u_point_light_position - mv_position.xyz);\n  float point_light_weight =\n     max(dot(trans_normal.xyz, point_light_dir), 0.0);\n  float dir_light_weight = \n    max(dot(trans_normal.xyz,\n      normalize(u_directional_light_direction)), 0.0);\n  v_light_weight = u_ambient_color +\n    u_directional_light_color * dir_light_weight +\n    u_point_light_color * point_light_weight;\n}"].join("\n"),
"#ifdef GL_ES \n\nprecision highp float;\n\n#endif\n\nvarying vec4 v_color;\nvarying vec4 v_light_weight;\nvoid main(void) \n{ \n   gl_FragColor = vec4(v_color.rgb * v_light_weight.rgb, v_color.a);\n}",{position:"a_vertex",normal:"a_normal"});(new Ld(e,d.n.Bc)).fb("createLightedMaterial");a.cl=Cw(d);a.Hf=Cw(d);d=a.Hd.tc();cj(d,!0);dj(d,2);ej(d,7,3,4294967295);d=a.o.tc();cj(d,!0);dj(d,2);ej(d,7,3,4294967295);d=a.Hf.tc();cj(d,!0);dj(d,2);ej(d,7,3,4294967295);d=a.cl.tc();cj(d,!0);dj(d,2);ej(d,7,1,4294967295);
a.Va=a.Hd;a.Kb=a.cl;a.tb=a.xa;a.n=[a.xa,a.Tp,a.o,a.cl,a.Hf];Od(a.o,"u_highlight_color",sh(1081565,0.5));Zs();a.nh=new Tu(a.Vb);d=a.nh;d.b=new Su(d.Vb);d.a=new Pu(d.b,!0);a.Hc=[];a.Nd=[];a.d=new uw;a.Fa=new le(a.d);a.Kc=new Qh(a.mb,a.Vb,a.lb);Fr(Zs().C,a,"loaded",a.Ar);Fr(Zs().C,a,"failed",a.zr);J(window.WebFontConfig)&&(la(),bt("loading"),d=Us,e=ji,na(),f=Ys,Ws[e]="loaded",et(d),0===d.a&&0<f.length&&gt(d));d=new it(a);d.$c.qc(a.xr.bind(a));a.K=d;d=Bw(a.lb);null===a.wa?ia():(d=new qw(a.wa,{Se:d}),
d.G(!1),a.gh=d,a.Fa.add(d));d=Bw(a.lb);null===a.wa?ia():(d=new qw(a.wa,{Se:d}),d.G(!1),a.cursor=d,a.Fa.add(d));ib&&(a.dj=new kw(a.Jc,2));a.k=new Rv(a,a.Fa,"#######ONE#########");a.k.Xe(!1);a.Z=new Rv(a,a.Fa,"#######TWO#########");a.Z.Xe(!1);Za(a);a.Zd.set(a.Cd);a.e=[a.k,a.Z];a.Fa.add(a.ya);a.Fa.add(a.b);d=a.j;e=a.mb;f=a.lb;d.f=a;d.mb=e;d.lb=f;d.Jc=d.f.Jc;d.wa=d.f.wa;d.Vb=d.f.Vb;d.d=new uw;d.Fa=new le(d.d);d.c=[];ib&&Yk&&(c.removeChild(b),b=document.createElement("div"),b.style.position="relative",
b.style.width="100%",b.style.height="100%",b.style.zIndex=1,b.style.overflow="hidden",nu(b,"userSelect","none"),nu(b,"transform","translateZ(0)"),b.appendChild(a.dj.Ng.de),b.appendChild(a.dj.Ng.gj),c.appendChild(b),a.jp=b,a.Po=a.dj.Ng.de,a.Qk=a.dj.Ng.gj);At&&(a.s=new zu,d=new kw(a.s),b=document.createElement("div"),b.style.position="absolute",b.style.top="0",b.style.left="0",b.style.width="100%",b.style.height="100%",b.style.zIndex=1,b.style.overflow="hidden",nu(b,"userSelect","none"),b.appendChild(d.Ng.gj),
c.appendChild(b),a.jp=b,a.Qk=d.Ng.gj)}p.pd=function(){var a=this.Ea.Pb();return a.width-a.x};p.md=function(){var a=this.Ea.Pb();return a.height-a.y};p.mr=function(){Gw(this)};
p.t=function(){Er(Zs().C,this);this.Ea.c.disconnect(this.p);this.cursor.an.disconnect();this.K&&this.K.$c&&this.K.$c.disconnect();this.ej.t();this.l.t();this.ca.t();this.j.Ac();this.cursor=this.j=this.ca=this.l=null;this.Z.t();this.k.t();this.Ca=this.b=this.ya=this.K=this.e=this.k=this.Z=null;this.Fa.clear();this.Fa=null;this.nh.Xl();this.p=this.Ea=this.Nd=this.Hc=this.nh=null;this.Kc.t();this.Za=this.Kc=null};p.$g=function(){return this.Fa};p.N=function(){return this.K};
function Os(a,b,c,d){var e={},f=a.$g(),g=a.Ca;b=kr(a.Ea,new jr(b,c));var g=g.Wg().rj(b),h=null,k=Infinity;b=z.create();var l=z.create();a.d.Gh=a.ic;jw(f,g,function(a,b,c){b<k&&(h=a,k=b,z.A(c,l))},d,e);h&&(of(g,k,b),z.normalize(l,l),z.tf(we(h),l,l));return{object:h,point:b,Ab:l,info:e}}function tr(a){return qe(a.Fa,function(a){return a.sa===Lg.TERRAIN})}function sr(a){return qe(a.Fa,function(a){return a.sa===Lg.BUILDING||a.sa===Ng})}
function rr(a){return qe(a.Fa,function(a){return a.sa===xg||a.sa===wg||a.sa===wr||a.sa===bh})}function ur(a){return qe(a.Fa,function(a){return a.sa===Wg||a.sa===Xg})}function vr(a){return qe(a.Fa,function(a){return a.sa===Lg.ROUTE})}function Hw(a){for(var b=a.k.Ci.ze,c=a.Z.Ci.ze,d=0;d<a.n.length;d++)a.n[d].za(0,b),a.n[d].za(1,c)}
function Qa(a,b){for(var c=0;c<a.n.length;c++)Od(a.n[c],"u_transition_factor",b);Od(a.Va,"u_transition_factor",b);Od(a.Kb,"u_transition_factor",b);Od(a.tb,"u_transition_factor",b)}function hb(a){return ib?!1:200>=z.distance(a.k.r.ib(),a.Z.r.ib())?!0:!1}function Or(a){return a.k.r?a.Z:a.k}function Iw(a,b,c,d,e,f){var g=void 0;b=b||a.K.Ua();c||(a.k.r?(d=K(d,a.K.fa()),e=K(e,a.K.ia())):(d=K(d,0),e=K(e,0)),g||(g=f===a.Zd?ds(a.Cd,!0):ds(a.Zd,!0),0===g&&(g=50)));(f||a.Zd).set(b,c,d,e,g)}
function Lr(a,b,c,d,e){Iw(a,b,c,d,e,a.Zd)}function Za(a){Iw(a,void 0,void 0,void 0,void 0,a.Cd);a.Cd.Ja(xc(a.ya.ka()))}p.Xe=function(a){this.vf=a;this.e.forEach(function(b){b.Xe(a)})};p.Lc=function(a){this.wi=a;this.e.forEach(function(b){b.Lc(a)})};p.Bf=function(a){this.lg=a;this.e.forEach(function(b){b.Bf(a)})};p.Pd=function(a){this.xi=a;this.e.forEach(function(b){b.Pd(a)})};p.u=function(){this.g=!0;this.Za&&this.Za.Af()};
p.na=function(a){var b;b=this.l.l;b.timestamp=a.timestamp;a=!1;for(var c in b.i){var d=b.i[c];d.qa()&&(d.Dh(b.timestamp),a=!0)}b=b.a=a;this.g&&(this.Ea.a=!0);Lu(this.c);return this.g||b};
function Gw(a){4<=a.v?(a.g=!1,a.v=0):(a.g=!0,a.v++);a.aa.call(a);a.H&&a.H(a);var b=a.Ca.hi(),c=xe(a.Ca);we(a.Ca);var d=0;if(ib||null!==a.Jc){var e=a.Jc,f=a.ya.S,g=a.k.r?a.k.r.ib():[0,0,0],h=a.Z.r?a.Z.r.ib():[0,0,0];if(f[0]||f[1]||f[0]){var k=nq(f);ue(a.Z.e,k);ue(a.k.e,k)}se(a.k.e,f);se(a.Z.e,f);a.Fa.update();Jw(a);Hw(a);ib||(Kw&&a.Jc.Wk(0,0,0,0),a.Jc.clear());var l={};a.d.Gh=a.hc;ib&&Yk&&Bu(e,a.k);At&&Bu(a.s,a.k);eh(a.Fa,b,c,function(b,c){var f=b.sa;switch(f){case 0:break;case $g:1===a.globalOverlayOpacity?
Od(b.Ha,"u_alphaFactor",a.globalLabelOpacity):Od(b.Ha,"u_alphaFactor",a.globalOverlayOpacity);case Wg:case Xg:case Lg.ROUTE:Od(b.Ha,"u_fadeFactor",a.globalOverlayOpacity);case ch:b.$o&&Od(b.Ha,"u_fadeFactor",a.globalOverlayOpacity),b.aa&&b.qb&&(Od(b.Jd.Ha,"u_fadeFactor",a.globalOverlayOpacity),Od(b.qb().Ha,"u_fadeFactor",a.globalOverlayOpacity)),ib&&Yk&&(7==b.ga&&Eu(e,b,c,a.k,250),f==$g&&Eu(e,b,c,a.k,125));case xg:case wg:case bh:case ah:case wr:case Yg:var k=!1;f==xg&&(ib&&Yk&&(Eu(e,b,c,a.k,250/
3),k=!0),At&&(Eu(a.s,b,c,a.k,250/3.5),k=!0));k||(f=a.a[f]||f,k=l[f],void 0===k&&(k=[],l[f]=k),k.push(c.Db()));break;case Mg:if(ib){var m=a.k,k=m.f;if(k.jp&&"panoramaCube"===b.De){f=k.K.fa();k=k.K.ia();m=m.Ci.Ng.To;yb(k,0,1E-5,0.001)&&(k+=0.001);var w=" translateZ(-"+e.n+"px)",x;x="translateZ("+e.b+") ";for(var y,A=0,C=m.length;A<C;A++)y=5==A?"rotateX("+(k+ow[A][0])+"deg) rotateZ("+(f+ow[A][1])+"deg)":4==A?"rotateX("+(k+ow[A][0])+"deg) rotateZ("+(-f+ow[A][1])+"deg)":"rotateX("+(k+ow[A][0])+"deg) rotateY("+
(f+ow[A][1])+"deg)",nu(m[A].de,"transform",""+x+y+w)}break}default:Lw(b,g,h);if(!Kw||f!=Mg&&f!=Lg.TERRAIN&&f!=Lg.BUILDING)ib||b.na(e,c);++d}});ib&&Yk&&Du(e,a);At&&Du(a.s,a);var b=[],m;for(m in l)b.push(parseInt(m,10));b.sort(function(a,b){return a-b});for(m=0;m<b.length;m++)c=l[b[m]],0<c.length&&(c.sort(fh),c.forEach(function(b){var c=b.object,f=c.$o?c.Ha:null;if(f||c.tn){var k=a.globalLabelOpacity;E(c.ie)||null==c.ie?E(c.opacity)||(k=c.opacity*a.globalLabelOpacity):k=c.ie;c.tn?c.tn(k):Od(f,"u_alphaFactor",
k)}Lw(c,g,h);ib||c.na(e,b);++d}));a.M&&a.M(a);ib||a.Jc.B.flush()}else ia()}p.Ar=function(a){la();a==ji&&(J(window.WebFontConfig)&&(la(),bt("loaded")),this.k&&Ya(this.k))};p.zr=function(a){la();a==ji&&(J(window.WebFontConfig)&&(la(),bt("loaded")),a=this.Kc,ji="Arial, Helvetica, Sans-serif",Zh(a),this.k&&Ya(this.k))};p.xr=function(){this.k.uf();this.ca.oh();this.u()};function Jw(a){var b=a.ya;if(b){var c=a.k;a=a.Z;var d=c.e;a.rg.Ch&&a.fe&&Mw(d,a.rg,b);c.rg.Ch&&c.fe&&Mw(d,c.rg,b)}}
function Mw(a,b,c){var d=b.ed,e=b.cf;c=c.Wg().d(we(a));a.sg(c,function(a,c,h,k){var l=b.dp(a,c,h,k);if(c==e&&l==d)return!1;if(1==c||0<=l&&l<d)return!0;b.qp(a,c,h,k);return!1})}
function Gj(a,b,c){var d=a.$g(),e=Ha(b);b=z.cb(b,e,1E4);b=lf(b[0],b[1],b[2],-e[0],-e[1],-e[2]);var f=null,g=Infinity,h=z.create();Kg(a.d,[Lg.TERRAIN]);jw(d,b,function(a,b,c){b<g&&(f=a,g=b,z.A(c,h))},function(a){return a.sa==Lg.TERRAIN&&a.Qa()});if(f){c?(z.normalize(h,h),z.tf(we(f),h,h)):h=e;a=of(b,g);c=R();d=Yc();b=Ja(a);var k=z.pa(h,b);z.pa(k,h,b);Ed(b,k,h,c);md(c,d);a.splice(3,0,d[0],d[1],d[2],d[3]);a.splice(7,0,e[0],e[1],e[2]);return a}return null}
function Nj(a,b){if(!a.k)return null;var c=a.k.Ia,d=ew(a.k);if(!d.kf()||!c)return la(),null;c=c.eb();c=hj(c);c=z.I(c,b);d=d.ue(c[0],c[1],8);return null===d?(na(),null):[c[0],c[1],d]}
function Zv(a,b,c){if(a.fm)a=a.qk,a.ta=new Bo(b),a.a.ta=new Bo([b[0],b[1],b[2]-3]),a.height=b[2]-3;else{a.qk=new qt(0);var d=a.qk;d.height=b[2]-3;for(var e={Bn:null,tr:null,ta:null,Ya:null,ph:null,Qg:null,Fi:null,la:!1,sd:null,Gc:null},f=[[-100,-100,-3],[100,-100,-3],[-100,100,-3],[100,100,-3]],g=f.length,h=new Me({position:new Le(7,3,0),texcoord:new Le(7,3,12),normal:new Le(7,3,20)}),h=new qf(h),k=0,l=[0,0,0],m=[0,0,1];k<g;k++)S(h,f[k],l,m);xf(h,0,1,2,1,3,2);g=h.hb();c=new pd(c,g);f=new hf(f[0],
f[3]);g.j=f;c.e=f;e.Gc=c;e.Ya=f;e.ta=new Bo(b);d.a=e;a.fm=d.a}}p.Gd=function(){this.k.Gd()};function Lw(a,b,c){if(a.Ha&&a.Ha.Pm){var d=a.Ha;if(b){b=z.sub(a.S,b);var e=a.Xg();b=z.tf(e,b);Od(d,"u_mesh_diff_0",b)}c&&(b=z.sub(a.S,c),e=a.Xg(),b=z.tf(e,b),Od(d,"u_mesh_diff_1",b))}}function fh(a,b){return b.object.R-a.object.R}function Nw(a,b){a.Ip.on=b;Wv(a.k)};var ib=!1,Yk=!1,At=!1,Kw=!1,xk=!0,yk=!0,zk=!0;
function Ow(a,b,c){Dr(this);this.d={};this.n=!1;this.g=new ph;this.f=new Ew(this);Fw(this.f,a,b);this.c=zr(this.na.bind(this));c&&Lr(this.f,c);this.o=[0,0,0];this.navigation=new Ss(this);this.b=new lr(this);this.a=new Qs(this.f);this.e=new oh;var d=this.f;this.e.$c.qc(function(a){d.Kc.ir.bind(d.Kc)(a);Tv(d.k.dc);Ya(d.k);d.u()});this.Ga=Kr(this);this.navigation.a=this.Ga;this.navigation.b=this.a;this.g.qc(this.wr.bind(this));Pw(this);this.j=new T;this.j.xa(this);this.Ga.start(void 0)}p=Ow.prototype;
p.na=function(a){return this.f.na(a)};p.kj=function(){return this.f.c.kj()};p.pj=function(){return this.j};function Pw(a){function b(b,c){a.d[b]=c;d+=1;d>=e&&(a.n=!0,a.g.call())}var c=[{name:"cursor_wall",url:Br.pr,size:256},{name:"cursor_ground",url:Br.or,size:256},{name:"cursor_road",url:Br.nr,size:256}],d=0,e=c.length,f=a.f.wa;c.forEach(function(a){E(a.url)?e--:null===f?ia():Qw(f,a,b,b)})}
function Rw(a,b,c,d,e,f){try{var g=b.createTexture(c,c,jh);g.re(0,d);var h=new gh;h.b=6;h.a=hh;g.Cf(h);g.ci();g.sn(b.Vg().ei());e(a,g)}catch(k){ia(),f(a,null)}}
function Qw(a,b,c,d){var e=b.name,f=b.url;if(f)if("string"==typeof f)Vn(Wn(),f,function(b,f){f.Ub()?Rw(e,a,b.width,b,c,d):(ia(f.xb()),d(e,null))});else if("function"==typeof f){var g=document.createElement("CANVAS");g.setAttribute("width",b.size);g.setAttribute("height",b.size);var h=g.getContext("2d");f(h);Rw(e,a,b.size,g,c,d)}else ia(),d(e,null);else d(e,null)}
p.wr=function(){var a=this.f,b=a.cursor;b.qb().za(a.Za.d.cursor);b.qb().vd(0.65);b.Jd.za(a.Za.d.cursor);a=a.Za.a.d;b.an.qc(a.g.bind(a));b=this.f;a=b.gh;a.fb("panoramaMarker");je(a,Yg);a.qb().za(b.Za.d.cursor_ground);a.Jd.G(!1)};function Nr(){var a=Wn();a.clear();for(var b=a.b.a,c=0;c<b.length;c++)bp(a.b,b[c].Th)}
p.t=function(a){Nr();this.f.t();this.j.Ac();this.c.stop();this.c=null;this.C.jh();al.ke().clear();al.ke().C.jh();$k.ke().clear();$k.ke().C.jh();Vu.ke().clear();Vu.ke().C.jh();cr().clear();a&&zq().clear();this.Ga=null;this.a.t();this.a=null;this.navigation.t();this.e=this.b=this.navigation=null;this.g.disconnect();Us&&Us.t();$k.deleteInstance();al.deleteInstance();Vu.deleteInstance();tm.deleteInstance();nm.deleteInstance();Ts.deleteInstance();a&&(tq.deleteInstance(),ar.deleteInstance(),Wn()&&Wn().t(),
dp.deleteInstance());ss=np=null;ms.deleteInstance()};p.pause=function(){this.c&&this.c.stop()};p.Af=function(){this.c&&this.c.start()};function Sw(a){Tw&&Sw.Rp(arguments);this.c=Zj(this.j.bind(this),a);this.e=zq();wp(this.c.coverageServer_MRSUrl);Aq(this.e,this.c.coverageServer_mode);this.g=cr();this.b=this.d=this.a=null;Tw&&Sw.Sp(this)}da("H.PanoramaSearchService.isCovered",function(a,b,c,d){var e=Uw();Sw.a&&(c=jo(c,"<callback isCovered()>"));mk(a,1);e.g.Ap(uk(a),vk(a),b,c,d)});da("H.PanoramaSearchService.getClosestPanoramas",function(a,b,c,d,e){return Vw(Uw(),a,b,c,d,e)});
da("H.PanoramaSearchService.getImageUrl",function(a,b,c,d,e){Uw();return Lp(a.uj,b||0,c||0,d||0,e||0)});da("H.PanoramaSearchService.traceCalls",function(a){Tw||(Tw=!0,fo(Sw,"H.PanoramaSearchService",a||[]))});
function Vw(a,b,c,d,e,f){var g=uk(b);b=vk(b);ok(c,"function","",2);Sw.a&&(c=jo(c,"<callback getClosestPanoramas()>"));d=Fc(d||1,1,1E3);e=Fc(e||99,1,5E5);f=Fc(f||0,0,e-1);g=[[g,b],function(b){var d=[];if(b)for(var e=0,f=b.length;e<f;e++)d.push(Eo(b[e]));try{c(d)}catch(g){}if(a.a){a.b=a.a;a.a=null;a.d=null;var h=cr();Tc(function(){h.Gj.apply(h,a.b)})}else a.b=null},d,e,f];if(a.b){if(a.a){var h=a.d;a.a=null;a.d=null;Tc(function(){h()})}a.a=g;a.d=c;return!0}a.b=g;g=cr();g.Gj.apply(g,a.b);return!1}
var Tw=!1,Ww=null;Sw.prototype.j=function(a){switch(a){case "coverageServer_mode":Xw(this,function(){},this.c.coverageServer_mode);break;case "coverageServer_MRSUrl":wp(this.c.coverageServer_MRSUrl),Xw(this,function(){},this.c.coverageServer_mode)}};function Uw(){return Ww=Ww||new Sw}
function Xw(a,b,c){Sw.a&&(b=jo(b,"<callback loadCoverage()>"));switch(c){case 0:case 1:case 2:case 3:case 4:Aq(a.e,c)}a.g.Bp(!0,function(){b&&"function"===typeof b&&b(!0)},function(){b&&"function"===typeof b&&b(!1)})};function Y(a,b){0>Yw.indexOf(this)&&Yw.push(this);Zw&&Y.Rp(arguments);try{Po.call(this);b=b||{};var c=this;this.Zm=new $w;this.aa=new lk;this.aa.a=this.Zm;Uw();var d=sk(b,"object","settings");this.cd=Zj(this.Fk.bind(this),d);d||this.cd.rendering_useSoftware||Ho()||(dl("rendering_useSoftware",!0),dl("load_all_metacells",!1),dl("metacell_cache_size",16),dl("metacell_lookup_steps",1),dl("metacell_prefetch_radius",50),dl("metacell_prefetch_steps",1),dl("compact_out_of_range_buildings",!0),dl("visibility_load_buildings_in_range",
!0),dl("visibility_range_buildings",40),dl("visibility_prefetch_range_buildings",50),dl("defer_road_creation",!0));this.Sc=!1;this.va=this.Va=0;this.ic=void 0;this.dd=!0;this.hc=null;this.g=[];this.Ge=a.clientWidth;this.Vd=a.clientHeight;this.v=Yr;Zr=-90;$r=90;as=20;bs=150;this.a=new Xr;this.a.wd(new Bo([0,0,0]));this.a.sb(0);this.a.Cb(0);this.a.Ja(this.v);this.d=new Xr(this.a);new Xr(this.a);this.e=document.createElement("canvas");a.appendChild(this.e);this.e.style.setProperty("width","100%","");
this.e.style.setProperty("height","100%","");this.Bd=function(a){a.preventDefault();ax(c,Error("event webglcontextlost: "+a))};this.e.addEventListener("webglcontextlost",this.Bd,!1);this.b=new Ow(this.e,a);this.c=this.b.f;this.n=this.c.l;this.n.a.qc(function(){var a=Ib(c.n);bx(c,!a);a||cx(c)});this.c.Dp=!0;var e=this.c.N();e.$c.qc(this.yr.bind(this));this.xa=new eo(this.c,this.yg.bind(this,Y.ANIMATION_STATE.Vj),this.yg.bind(this,Y.ANIMATION_STATE.jl));this.Qc=Y.ANIMATION_STATE.NONE;this.state=Y.STATE.INIT;
this.transition=dx;this.o=this.p=this.s=0;this.j=!0;ex(this);jt(e,ht.HEADING,0,360);jt(e,4,-90,90);jt(e,16,20,150);is(this.a,cs.HEADING,0,360);is(this.a,"tilt",-90,90);is(this.a,"fov",20,150);this.b.a.a.Ej.qc(function(){this.yg(Y.ANIMATION_STATE.jl,!0)}.bind(this));this.b.a.a.yp.qc(function(){this.yg(Y.ANIMATION_STATE.Vj,!0)}.bind(this));var f=sk(b,"object","position");f?(uk(f),vk(f),sk(f,"number","alt"),this.wd(f)):Xa(this.c.N(),Ga([0,0,0]));var g=sk(b,"number","heading");!E(g)&&this.c.N().sb(g);
var h=sk(b,"number","pitch");!E(h)&&this.c.N().Cb(h);var k=sk(b,"number","fov");!E(k)&&this.Ja(k)}catch(l){throw fx(this),Zw&&Y.ms(l),l;}Zw&&Y.Sp(this)}ha(Y,Po);da("H.PanoramaView",Y);var Zw=!1,Yw=[];Y.traceCalls=function(a){Zw||(a=a||["setPointer","getObjectsAt"],Zw=!0,fo(Y,"H.PanoramaView",a))};function fx(a){a=Yw.indexOf(a);0<=a&&Yw.splice(a,1)}Y.getInstances=function(){return Yw.slice(0)};Y.prototype.Ph=function(){return this.state};Y.prototype.getState=Y.prototype.Ph;Y.prototype.Ln=function(){return this.Qc};
Y.prototype.getAnimationState=Y.prototype.Ln;Y.prototype.Fk=function(){};function bx(a,b){b?Ib(a.n)||a.b.a.c||a.b.a.b||os().pause(!1):os().pause(!0);var c=a.c;fw(c.Z,b);fw(c.k,b)}Y.STATE={INIT:"initializing",ERROR:"error",IDLE:"idle",BUSY:"busy",SHUTDOWN:"shutdown"};var dx=0;Y.ANIMATION_STATE={NONE:0,Vj:1,jl:2};Y.POV_PARAM={POSITION:1,HEADING:2,PITCH:4,ZOOM:8};Y.OBJECT_TYPE={NONE:0,TERRAIN:1,BUILDING:2,ROAD:3,ROUTE:4,oq:5};
Y.prototype.Ac=function(){fx(this);try{this.state!==Y.STATE.SHUTDOWN&&(this.c.N().$c.disconnect(),this.n.a.disconnect(),this.e.removeEventListener("webglcontextlost",this.Bd,!1),this.b.Ga.handleEvent("SHUTDOWN")),this.xa.Ac(),this.e=this.n=this.xa=null,this.Sc=!0,this.d=this.a=this.c=this.b=null}catch(a){ax(this,a)}};Y.prototype.shutdown=Y.prototype.Ac;
Y.prototype.rk=function(a,b){try{var c=this.b.f,d=c.c,e=c.Ea,f=a+0+0,g=b+0+0;sw(e,new Pe(0,0,a,b));Hu(d,new Pe(0,0,f,g));var h=c.Ca,k=tw(e);if(k!==h.Lb){var l=Pf(h),m=k/h.Lb;h.Lb=k;h.Yb*=m;h.ac*=m;Of(h,l);h.Xd=!1;h.bf=!1}Lu(d);c.u()}catch(n){ax(this,n)}};Y.prototype.resize=Y.prototype.rk;Y.prototype.qq=function(a){var b=this.b;b.c&&yr(b.c,a)};Y.prototype.setRedrawFrequency=Y.prototype.qq;Y.prototype.pj=function(){try{return this.b.pj()}catch(a){ax(this,a)}};Y.prototype.getPanoramaMarkerManager=Y.prototype.pj;
function $w(){this.maxDistance=5E5}Y.prototype.kl=function(){return{min:-90,max:90}};Y.prototype.getPitchRange=Y.prototype.kl;Y.prototype.cq=function(){return{min:20,max:150}};Y.prototype.getZoomRange=Y.prototype.cq;Y.prototype.Rn=function(){return{min:0,max:360}};Y.prototype.getHeadingRange=Y.prototype.Rn;Y.prototype.Ua=function(){try{var a=this.c.N().Ua().get();return Wj(a)}catch(b){ax(this,b)}};Y.prototype.getPosition=Y.prototype.Ua;
Y.prototype.wd=function(a){mk(a,1);a=new Bo([uk(a),vk(a)]);try{if(Vr(a,this.a.Ua(!0)))return!1;gx(this);this.a.wd(a,!1);hx(this,this.a);return!0}catch(b){ax(this,b)}};Y.prototype.setPosition=Y.prototype.wd;Y.prototype.sb=function(a,b){try{return ok(a,"number","",1),qk(a,1,0,360),gx(this),this.a.sb(a),ix(this,dx),hx(this,this.a,!b),this.a.fa()}catch(c){ax(this,c)}};Y.prototype.setHeading=Y.prototype.sb;Y.prototype.fa=function(){return this.c.N().fa()};Y.prototype.getHeading=Y.prototype.fa;
Y.prototype.nq=function(a,b){ok(a,"number","",1);qk(a,1,-90,90);try{return gx(this),this.a.Cb(a),ix(this,dx),hx(this,this.a,!b),this.a.ia()}catch(c){ax(this,c)}};Y.prototype.setPitch=Y.prototype.nq;Y.prototype.rq=function(a,b){b?ix(this,dx):ix(this,1);this.Ja(a)};Y.prototype.setZoom=Y.prototype.rq;Y.prototype.bq=function(){return this.ka()};Y.prototype.getZoom=Y.prototype.bq;Y.prototype.On=function(){return this.v};Y.prototype.getDefaultZoom=Y.prototype.On;
Y.prototype.kq=function(a){try{mk(a,1);var b=lk.x(a,this.pd(),1),c=lk.y(a,this.md(),1),d;a:{var e=this.b.b,f=[X.TERRAIN,X.PANORAMA,X.BUILDING];a=[];for(var g=0;g<f.length;g++)a=a.concat(nr(e,f[g]));e.a.f.$g().update();var h=hr(b,c,e.a.f.Ca,e.a.f.Ea,a,!0,!1);if(h)if(or(h.object)==X.PANORAMA){var k=cr().dn(h.object.ku);if(k){d=k.ib();break a}}else{d=Jj(h.point);break a}d=null}return d?Wj(d):null}catch(l){ax(this,l)}};Y.prototype.pixelToGeo=Y.prototype.kq;
Y.prototype.Gn=function(a){mk(a,1);try{var b=[uk(a),vk(a),sk(a,"number","alt")];if(E(b[2])){var c=this.c.N().Ua().get();b[2]=c[2]}var d=this.c,e=Ga(b);a=[];var f;var g=d.ya.Wg(),h=e[0],k=e[1],l=e[2],m=g.Cg,n=m[3]*h+m[7]*k+m[11]*l+m[15];yb(n,0)?f=!1:(e=1/n,z.set(h,k,l,a),z.I(m,a,a),z.scale(a,e,a),f=-1>a[2]||1<a[2]?!1:!0);if(!f)return null;var r;r=r||new jr(0,0);var s=d.Ea.Pb();r.x=Math.round(s.width*(a[0]+1)/2);r.y=Math.round(-(s.height*(a[1]-1)/2));var t,v=d.Ea.Pb();t=new jr(r.x+v.x,r.y+v.y);return{x:t.x,
y:t.y}}catch(w){ax(this,w)}};Y.prototype.geoToPixel=Y.prototype.Gn;Y.prototype.Un=function(){return this.c.N().ia()};Y.prototype.getPitch=Y.prototype.Un;Y.prototype.pd=function(){return this.c.pd()};Y.prototype.md=function(){return this.c.md()};
Y.prototype.lq=function(a){mk(a,1);var b=lk.x(a,this.pd(),1);a=lk.y(a,this.md(),1);try{var c=mr(this.b.b,b,a),d=new Xr;if(c)if(c.type===X.BUILDING)if(es(d,new Bo(c.point,1)),c.Ab){var e=z.add(c.point,z.scale(c.Ab,5));d.wd(new Bo(e,1),!0)}else d.wd(new Bo(c.point,1)),d.sb(this.a.fa(!0)||0),d.Cb(this.a.ia(!0)||0);else if(c.type!==X.ROAD||J(c.Pn))d.wd(new Bo(c.point,1)),d.sb(this.a.fa(!0)||0),d.Cb(this.a.ia(!0)||0);else{var f=z.add(c.point,z.scale(c.Pn,100));es(d,new Bo(f,1));d.wd(new Bo(c.point,1),
!0)}else{var g=jx(this,b,a);es(d,new Bo(g));d.wd(this.a.Ua(!0),!0)}var h=kx(this,d);return 5E5<h.distance?null:h}catch(k){ax(this,k)}};Y.prototype.pixelToPov=Y.prototype.lq;Y.prototype.pn=function(){ix(this,1)};Y.prototype.cancelMoveTo=Y.prototype.pn;
Y.prototype.moveTo=function(a,b,c){!E(b)||(b=!0);this.state==Y.STATE.INIT&&(b=!1);b?ix(this,dx):ix(this,1);try{tk(a);var d,e=a.position;d=zo({lat:e.lat,lng:e.lng,alt:e.alt||0},a.heading,a.pitch,a.distance);var f=tk(d),g=new Bo([uk(f),vk(f),rk(f,"alt",1)]),h=this.aa.heading(d,1),k=this.aa.pitch(d,1),l=this.aa.distance(d,1);this.Td();this.wg();gx(this);var m;l?(m=!0,es(this.a,g)):(m=!1,this.a.wd(g));this.a.sb(h,m);this.a.Cb(k,m);fs(this.a,l,m);c&&(this.H=c);hx(this,this.a);return kx(this)}catch(n){ax(this,
n)}};Y.prototype.moveTo=Y.prototype.moveTo;Y.prototype.Jk=function(){lx(this,!0)};function lx(a,b,c){if(a.H){var d={Ub:b};b||(d.error=c);a.H(d);a.H=null}}function ix(a,b){try{switch(a.transition=b||dx,a.transition){case 1:a.c.l.enable(!1);a.transition=1;break;default:a.c.l.enable(!0),a.transition=dx}}catch(c){ax(a,c)}}
Y.prototype.hn=function(a,b,c){try{if(this.b.a.c||Nb(this.n))return!1;this.yg(Y.ANIMATION_STATE.Vj,!0);this.j&&pr(this.b.b,!1);bx(this,!1);var d=this.b.a;d.b=!0;var e=d.a;e.d.stop();e.b.stop();e.p.length=0;var f=e.K;e.e=f.fa();e.g=f.ia();e.c=f.ka();var g=e.H;g.set(a,b,c,0,0);ys(g,f);return!0}catch(h){ax(this,h)}};Y.prototype.beginInteraction=Y.prototype.hn;Y.prototype.gq=function(a,b,c){try{var d=this.b.a;d.b&&xs(d.a,a,b,c);this.c.u()}catch(e){ax(this,e)}};Y.prototype.interact=Y.prototype.gq;
Y.prototype.wg=function(a,b,c){try{if(this.b.a.b){this.j&&pr(this.b.b,!0);var d=this.b.a;if(d.b){d.b=!1;var e=d.a,f=e.p,g=a||Date.now();if(0<f.length&&50<g-f[f.length+0-1].Sk)e.Ej.call();else if(E(b)||E(c)||xs(e,g,b,c),e.update(),3>f.length)e.Ej.call();else{b=a=0;for(c=1;3>c;++c){var h=f[c-1],k=f[c],l=k.Sk-h.Sk,m=k.gf-h.gf;a+=(k.ff-h.ff)/l;b+=m/l}a/=2;b/=2;0.00285>xb(a)&&0.00285>xb(b)?e.Ej.call():Cs(e.d,a,b,0)}}bx(this,!0)}}catch(n){ax(this,n)}};Y.prototype.endInteraction=Y.prototype.wg;
Y.prototype.pq=function(a,b){try{var c=this.b.b;this.j||(pr(c,!0),this.j=!0);var d=c.a.a.d,e=d.e;if(a!==e[0]||b!==e[1])e[0]=a,e[1]=b,qr(d)}catch(f){ax(this,f)}};Y.prototype.setPointer=Y.prototype.pq;Y.prototype.dq=function(){try{var a=this.b.b;this.j&&(pr(a,!1),this.j=!1)}catch(b){ax(this,b)}};Y.prototype.hidePointer=Y.prototype.dq;
Y.prototype.jq=function(a,b){try{var c;var d=this.b.b,e=!1,f=[X.BUILDING,X.TERRAIN,X.PLACE,X.ROAD,X.ROUTE],g=[],e=e||!1,h=null;f||(h=[X.PLACE,X.TERRAIN,X.BUILDING,X.PANORAMA],Zk&&h.push(X.ROAD));f=f||h;for(h=0;h<f.length;h++)g=g.concat(nr(d,f[h]));d.a.f.$g().update();var k;var l=d.a.f.Ca,m=d.a.f.Ea;if((d=g)&&d.length){var n=ir(m,new jr(a,b)),r=kr(m,n),s=l.Wg().rj(r),l=[];Oj(d,s,null,!1,e,l,!0);if(0<l.length){s=[];for(m=0;m<l.length;m++){var t=l[m];s.push({point:t.Bm,xj:t.xj,object:t.object,Ab:t.Ab,
distance:t.distance,oc:t.oc})}k=s}else k=null}else k=null;if(k&&0<k.length){t=[];for(h=0;h<k.length;h++){var v=k[h],w=or(v.object);w.point=v.point;w.Ab=v.Ab;w.distance=v.distance;v.object&&v.object.Y?w.Y=v.object.Y:v.oc&&v.oc.Oc&&(w.Y=v.oc.Oc.Y);t.push(w)}c=t}else c=null;k=[];if(c)for(v=0;v<c.length;v++){var w=null,x=Y.OBJECT_TYPE.NONE,n=m=l=s=t=h=null,y=c[v];if(y&&(l=y.Ab,s=y.point,t=new Bo(s,1),y.type==X.BUILDING?(x=Y.OBJECT_TYPE.BUILDING,h=y.id):y.type==X.PLACE?(x=Y.OBJECT_TYPE.oq,y.Y&&(y.Y instanceof
U?n=y.Y:y.Y instanceof mn?n=y.Y.marker:y.Y instanceof nn&&(n=y.Y.clientObject))):y.type==X.ROUTE?(x=Y.OBJECT_TYPE.ROUTE,n=y.Y):y.type==X.TERRAIN?x=Y.OBJECT_TYPE.TERRAIN:y.type==X.ROAD&&(x=Y.OBJECT_TYPE.ROAD,h=y.Y.name),x)){if(l){var A=z.cb(s,l,100),C=(new Bo(A,1)).get(),B=t.get();if(C&&B)var I=B[0]*u,G=C[0]*u,D=(C[1]-B[1])*u,L=Math.sin(D)*Math.cos(G),O=Math.cos(I)*Math.sin(G)-Math.sin(I)*Math.cos(G)*Math.cos(D),m=(Math.atan2(L,O)*kc+360)%360}var M=Wj(t.get()),w={type:x,id:h,position:M,heading:m||
0,pitch:0,hitData:n||null};k.push(w)}}return k}catch(Z){ax(this,Z)}};Y.prototype.pickObjects=Y.prototype.jq;Y.prototype.fq=function(a,b){try{if(a){var c=this.b.b,d=re(c.a.f.k.ce,a);0<d.length&&(b?(je(d[0],Ng),d[0].Ha=c.a.f.o):(je(d[0],Lg.BUILDING),d[0].Ha=c.a.f.Hd),c.a.f.u())}}catch(e){ax(this,e)}};Y.prototype.highlightObject=Y.prototype.fq;
Y.prototype.gn=function(){try{if(this.b.a.b||Nb(this.n))return!1;this.j&&pr(this.b.b,!1);var a=this.b.a;a.c=!0;var b=a.a;b.d.stop();b.b.stop();b.a=new Bs(Date.now(),0,0,0,0,0,0,0);return!0}catch(c){ax(this,c)}};Y.prototype.beginControl=Y.prototype.gn;Y.prototype.rh=function(a,b){try{ok(a,"number","",1);ok(b,"number","",2);if(this.b.a.b)return!1;a===Y.POV_PARAM.PITCH?this.s=b:a===Y.POV_PARAM.HEADING?this.p=b:a===Y.POV_PARAM.ZOOM?this.o=b:dk();Rs(this.b.a,this.s,this.p,this.o)}catch(c){ax(this,c)}};
Y.prototype.control=Y.prototype.rh;Y.prototype.Td=function(a){try{if(a?a===Y.POV_PARAM.PITCH?this.s=0:a===Y.POV_PARAM.HEADING?this.p=0:a===Y.POV_PARAM.ZOOM?this.o=0:dk():this.o=this.p=this.s=0,Rs(this.b.a,this.s,this.p,this.o),0===this.s&&0===this.p&&0===this.o){this.j&&pr(this.b.b,!0);var b=this.b.a;if(b.c){b.c=!1;var c=b.a;c.a&&(c.a.ff=c.b.p,c.a.gf=c.b.s,c.a.a=c.b.a);c.b.stop();if(c.a){var d=c.a.ff,e=c.a.gf,f=c.a.a;0.00285>xb(d)&&0.00285>xb(e)&&0.00285>xb(f)||Cs(c.d,d,e,f)}}}}catch(g){ax(this,g)}};
Y.prototype.endControl=Y.prototype.Td;Y.prototype.Yp=function(a,b){var c;c=this.b.b;var d=c.a.f.Ea,e=c.a.f.Ca;if(e){var f=ir(d,new jr(a,b)),d=kr(d,f),e=e.Wg().rj(d);c=c.a.f.k.e;nf(xe(c),e,e);d=-c.nl(e);e=of(e,d);z.scale(e,1/c.od(),e);e[0]=tc(e[0],-0.5,0.5);e[1]=tc(e[1],-0.5,0.5);e[2]=tc(e[2],-0.5,0.5);c=e}else c=null;return c};Y.prototype.getViewVector=Y.prototype.Yp;Y.prototype.sk=function(a){try{var b=this.b.e;a=a.toLowerCase();rh[a]&&b.a!==a&&(b.a=a,b.$c.call(a))}catch(c){ax(this,c)}};
Y.prototype.setLanguage=Y.prototype.sk;Y.prototype.Nh=function(){try{return this.b.e.a}catch(a){ax(this,a)}};Y.prototype.getLanguage=Y.prototype.Nh;Y.prototype.Tn=function(){try{var a=this.c.k;return a&&a.r?a.r.id:""}catch(b){ax(this,b)}};Y.prototype.getPanoramaId=Y.prototype.Tn;Y.prototype.uk=function(a,b){try{var c=this.c;c.H=a;c.M=b}catch(d){ax(this,d)}};Y.prototype.setRenderCallbacks=Y.prototype.uk;
Y.prototype.Ja=function(a,b,c){ok(a,"number","",1);qk(a,1,20,150);try{if(!this.a.$a())return null;var d=this.b,e=this.c.ya.ka();this.a.Ja(a);if(e*Bc===this.a.ka())return this.a.ka();a=b||0;c=c||0;if(a||c){var f=mr(d.b,a,c),g;null===f?g=Ga(jx(this,a,c)):g=f.point;var h=new Xr(d.f.Cd);es(h,new Bo(g,1),!0);var k=h.fa(!0),l=h.ia(!0);d.f.ya.Ja(wc(this.a.ka()||this.v));var f=mr(d.b,a,c),m;null===f?m=Ga(jx(this,a,c)):m=f.point;d.f.ya.Ja(e);es(h,new Bo(m,1),!0);var n=h.fa(!0),r=h.ia(!0),e=k-n,l=l-r,s=this.a.fa(!0)+
e,t=this.a.ia(!0)+l;d.f.ya.Ja(wc(this.a.ka()||this.v));this.c.N().Cb(t);this.c.N().sb(s);mx(this);d.f.u();cx(this)}else{if(1===this.transition)this.c.ya.Ja(Hc(this.a.ka()||this.v)),this.c.u(),cx(this,Y.POV_PARAM.ZOOM);else{var v=this.a.ka();d.f.l.i.ld.Fl=v*u;d.f.l.i.ld.start()}return this.a.ka()}}catch(w){ax(this,w)}};Y.prototype.setFov=Y.prototype.Ja;Y.prototype.ka=function(){try{return this.c.ya.ka()*Bc}catch(a){ax(this,a)}};
Y.prototype.Jh=function(){try{var a=this.c.ya;return 2*Math.atan(Math.tan(0.5*a.Ce)*a.Lb)*Bc}catch(b){ax(this,b)}};Y.prototype.getFovX=Y.prototype.Jh;p=Y.prototype;p.pc=function(a){try{!0===a?this.b.Ga.handleEvent("EXIT"):this.c.l.i.hm.start()}catch(b){ax(this,b)}};function kx(a,b){var c=b||a.a;return c.$a()?zo(Wj(Ta(c,!0).get()),c.fa(!0),c.ia(!0),ds(c,!0)):null}
function hx(a,b,c){if(b.$a()){var d;(d=!a.d.$a())||(d=a.d,d=Wr(b.Ua(!0),d.Ua(!0))?b.ia(!0)==d.ia(!0)&&b.fa(!0)==d.fa(!0)&&Wr(Ta(b,!0),Ta(d,!0))&&b.ka()===d.ka()?!0:!1:!1,d=!d);d&&(b.ka()!==a.d.ka()&&a.Ja(b.ka()||a.v),a.d.$a()&&Vr(a.d.Ua(!0),b.Ua(!0))?(b=!c&&1!==a.transition,c=a.a.ia(!0)||0,d=a.a.fa(!0)||0,!0===b||void 0===b?0!==ds(a.a,!0)?a.b.Ga.handleEvent("CHANGE_LOOK_AT",Ta(a.a,!0),null,null):a.b.Ga.handleEvent("CHANGE_LOOK_AT",null,d,c):(a.c.N().Cb(c),a.c.N().sb(d),mx(a)),a.d=null):a.b.b.a.Ga.handleEvent("CHANGE_PANORAMA_TO_GEO",
b.Ua(!0),b.fa(),b.ia(),Ta(b),99,!1))}else a.g.unshift("Invalid view point."),nx(a,Y.STATE.ERROR)}p.Yq=function(a,b){this.dr.call(this,a,b);this.cr.call(this,0,b)};p.Vq=function(a){this.H&&(a||lx(this,!1,"Could not load Panorama"))};p.Uq=function(){this.a=new Xr(this.b.f.Cd);this.a.Cb(this.a.ia(!0)||0);this.a.Ja(this.ka());cx(this,Y.POV_PARAM.HEADING|Y.POV_PARAM.POSITION|Y.POV_PARAM.PITCH)};
p.Tq=function(){this.a=new Xr(this.b.f.Cd);this.a.Cb(this.a.ia(!0)||0);this.a.Ja(this.ka());cx(this,Y.POV_PARAM.HEADING|Y.POV_PARAM.PITCH)};p.Kq=function(){this.a.Ja(this.ka());cx(this,Y.POV_PARAM.ZOOM)};p.Iq=function(){mx(this);this.Kb&&"function"===typeof this.Kb&&(this.Kb(),this.Kb=null)};p.Jq=function(){mx(this)};
p.Qq=function(a){a?this.d=null:(this.d&&(this.a=new Xr(this.d),this.d=null),this.state==Y.STATE.INIT?(this.g.unshift("No panorama found."),nx(this,Y.STATE.ERROR)):nx(this,Y.STATE.IDLE),this.H&&lx(this,!1,"No panorama available at given coordinates"))};function mx(a){Za(a.b.f);a.a=new Xr(a.b.f.Cd)}
function cx(a,b){if(a.state!=Y.STATE.INIT){var c=b||0;a.dd&&(a.dd=!1,c=c|Y.POV_PARAM.HEADING|Y.POV_PARAM.PITCH|Y.POV_PARAM.POSITION|Y.POV_PARAM.ZOOM);a.hc||(a.hc=a.Pq.bind(a));a.Va|=c;a.ic||(a.ic=Tc(a.hc))}}p.Pq=function(){if(!this.Sc){this.ic=void 0;var a=this.Va;this.Va=0;this.va|=a;var b=!Ib(this.c.l);b&&(a|=this.va,this.va=0);(a||b&&a)&&this.dispatchEvent(new yo(a,b),!0)}};
p.dr=function(a,b){switch(b){case "loadingPanoramaState":case "loadingMetacellState":nx(this,Y.STATE.BUSY);break;case "navigateState":case "transitionState":case "enterState":case "exitState":nx(this,Y.STATE.IDLE);break;case "offState":if(!this.cd.rendering_useSoftware)try{this.e.parentElement.removeChild(this.e)}catch(c){}delete this.b;nx(this,Y.STATE.SHUTDOWN);break;case "initState":void 0!==a&&(this.g.unshift("No panorama found."),nx(this,Y.STATE.ERROR))}};
function nx(a,b){a.state!==b&&(a.state=b,a.Sc||a.dispatchEvent(new xo(b)))}p.cr=function(a,b){switch(b){case "idleState":case "navigateState":case "offState":case "initState":this.yg(Y.ANIMATION_STATE.jl);break;case "transitionState":case "enterState":case "exitState":case "rotateState":case "interspaceState":case "fovChangeFinished":case "loadingPanoramaState":case "loadingMetacellState":this.yg(Y.ANIMATION_STATE.Vj)}};p.yg=function(a,b){!b&&1===this.transition||this.Qc===a||(this.Qc=a,this.dispatchEvent(new wo(a)))};
p.yr=function(){mx(this);var a=this.c.N(),b=0;Vr(a.Ua(),this.Wm)||(b|=Y.POV_PARAM.POSITION,this.Wm=a.Ua());a.ia()!=this.Ym&&(b|=Y.POV_PARAM.PITCH,this.Ym=a.ia());a.fa()!=this.Sm&&(b|=Y.POV_PARAM.HEADING,this.Sm=a.fa());a.ka()!=this.Rm&&(b|=Y.POV_PARAM.ZOOM,this.Rm=a.ka());new Xr(this.a);b&&cx(this,b)};function ax(a,b){if(b instanceof Xj)throw b;a.g.unshift(b.toString());10<a.g.length&&(a.g.length=10);try{Yj("exception: "+b)}catch(c){}nx(a,Y.STATE.ERROR)}
p.ur=function(){return this.g?this.g.pop():""};Y.prototype.getLastErrorInfo=Y.prototype.ur;function jx(a,b,c){a=a.c;b=ir(a.Ea,new jr(b,c));b=kr(a.Ea,b);a=a.ya.Wg().rj(b);a=z.add(a.slice(0,3),z.scale(a.slice(3,6),50));return Jj(a)}function gx(a){a.d||(a.d=new Xr(a.a))}
function ex(a){var b=a.b.C;Fr(b,a,"stateChanged",a.Yq);Fr(b,a,"panoramaChanged",a.Uq);Fr(b,a,"panoramaLoaded",a.Vq);Fr(b,a,"enterAnimationFinished",a.Iq);Fr(b,a,"enterAnimationStarted",a.Jq);Fr(b,a,"lookAtChangeFinished",a.Tq);Fr(b,a,"fovChangeFinished",a.Kq);Fr(b,a,"panoramaAvailable",a.Qq);Fr(b,a,"moveToEnd",a.Jk)}function ox(a,b){pk(a);ok(b,"function","",1);switch(a){case "povchanged":case "statechanged":case "povanimation":break;default:dk()}}
Y.prototype.M=function(a,b,c){ox(a,b);Po.prototype.M.call(this,a,b,c)};Y.prototype.addEventListener=Y.prototype.M;Y.prototype.Rc=function(a,b,c){ox(a,b);Po.prototype.Rc.call(this,a,b,c)};Y.prototype.removeEventListener=Y.prototype.Rc;Y.prototype.iq=function(a,b){var c=this.b.f.Ca.S,d=uk(a),e=vk(a),f=rk(a,"alt",1),d=Ga([d,e,f]),d=z.sub(d,c),e=z.length(d),d=z.scale(d,(e+b)/e),c=z.add(c,d),c=Jj(c);return Wj(c)};Y.prototype.moveGeoPosAwayFromCamera=Y.prototype.iq;
Y.prototype.kd=function(a,b){try{var c,d;switch(arguments.length){case 1:"number"===typeof arguments[0]?c=arguments[0]:"function"===typeof arguments[0]&&(d=arguments[0]);break;case 2:ok(arguments[0],"number","heading",1),c=arguments[0],ok(arguments[1],"function","callback",2),d=arguments[1]}this.xa.kd(c,d)}catch(e){ax(this,e)}};Y.prototype.exit=Y.prototype.kd;
Y.prototype.gb=function(a,b){try{var c,d;switch(arguments.length){case 1:"number"===typeof arguments[0]?c=arguments[0]:"function"===typeof arguments[0]&&(d=arguments[0]);break;case 2:ok(arguments[0],"number","heading",1),c=arguments[0],ok(arguments[1],"function","callback",2),d=arguments[1]}this.xa.gb(c,d)}catch(e){ax(this,e)}};Y.prototype.enter=Y.prototype.gb;Y.prototype.zn=function(){this.c&&Nw(this.c,null)};Y.prototype.clearRoutes=Y.prototype.zn;
Y.prototype.Ek=function(a){try{px(this,a)}catch(b){ax(this,b)}};Y.prototype.setRoutes=Y.prototype.Ek;
function px(a,b){if(a.c)if(b){for(var c=[],d=0;d<b.length;d++){var e=new Lo,f=b[d],g=f.segments;if(!g||!Array.isArray(g)){ak("missing segments array in route");return}for(var h=0;h<g.length;h++){var k=g[h];if(!k){ak("empty segment in route");return}var l=k.points;if(!l||!Array.isArray(l)){ak("missing points array in route segment");return}for(var m=No(e,k.hitData),k=0;k<l.length;k++){var n=l[k];if(!l||!Mc(n.lat)||!Mc(n.lng)){ak("illegal point in route segment. point= "+window.JSON.stringify(n));return}m.Ol([n.lat,
n.lng],null)}}g=0==k?1.5:1;h=0==k?[0,1,1,0.5]:[0.2,0.4,0.4,0.4];l=null;m=function(a,b){if(!Array.isArray(b))ak(a+" color is no array");else if(Array.isArray(b)&&4!=b.length)ak(a+" color array need a length of 4");else if(Array.isArray(b)&&4==b.length)for(var c=0;4>c;c++)if(!Mc(b[c])){ak("color channel "+c+" of color "+a+" is "+b[c]+" and not a number");break}else if(0>b[c]){ak("color channel "+c+" of color "+a+" is "+b[c]+" and smaller than 0");break}else if(1<b[c]){ak("color channel "+c+" of color "+
a+" is "+b[c]+" and larger than 1");break}};f.color&&(m("color",f.color),h=f.color);f.splitColor&&(m("splitColor",f.splitColor),l=f.splitColor);if(f.width){if(Mc(f.width)){if(0.1>f.width){ak("parameter route width is "+f.width+" and smaller than 0.1");return}if(10<f.width){ak("parameter route width is "+f.width+" and larger than 10.");return}}else{ak("route width is "+f.width+" and not a number");return}g=f.width}Oo(e,h,l);e.width=g;c.push(e)}Nw(a.c,c)}else Nw(a.c,null)}
Y.prototype.nk=function(){Nw(this.c,null)};Y.prototype.removeRoutes=Y.prototype.nk;var hu=window.MSBlobBuilder?!0:!1;}})();
//# sourceMappingURL=panorama.js.map
H.util.eval("function $(a,b,c,d){var e=a.element,f=e.ownerDocument.createElement(\"div\");xg();$.a.constructor.call(this,a,b,c,d);this.R=t(this.R,this);f.style.width=\"100%\";f.style.height=\"100%\";f.style.position=\"absolute\";e.insertBefore(f,e.firstChild);this.i=b=new H.PanoramaView(f);this.Zd=20;a=b.getZoomRange();this.hc={zoom:{min:this.Zd,max:this.Zd},camera:{pitch:b.getPitchRange(),roll:{min:0,max:0},yaw:b.getHeadingRange(),fov:a}};this.di=a.min;this.ci=a.max;this.Yi=f;b.addEventListener(yg,this.R);this.Pa=t(this.Pa,"+
"this);b.addEventListener(yg,this.Pa);b.moveTo(zg(this,this.vb.Za()))}var Ag;r($,Kf);q(\"H.map.render.panorama.RenderEngine\",$);var yg=\"povchanged\";$.prototype.type=Of.PANORAMA;$.prototype.type=$.prototype.type;$.getClosestPanoramas=function(a,b){xg();H.PanoramaSearchService.getClosestPanoramas(a,b)};$.getImageUrl=function(a){xg();return H.PanoramaSearchService.getImageUrl(a)};"+
"$.configure=function(a,b,c){var d=H.PanoramaSettings;d.set(\"auth_appId\",a);d.set(\"auth_appCode\",b);d.set(\"server_useSSL\",c);Ag=!0};$.prototype.va=function(){this.i.endInteraction(-1);this.i.beginControl()};$.prototype.startControl=$.prototype.va;function xg(){if(!Ag)throw new lc($,\"Engine must be configured with H.platform.Platform\");}$.prototype.control=function(a,b,c,d,e,f,g){a=H.PanoramaView.POV_PARAM;b=this.i;d&&b.control(a.PITCH,d);e&&b.control(a.HEADING,e);g&&b.control(a.ZOOM,g)};"+
"$.prototype.control=$.prototype.control;$.prototype.endControl=function(){this.i.endControl()};$.prototype.endControl=$.prototype.endControl;$.prototype.wa=function(){this.i.endControl()};$.prototype.startInteraction=$.prototype.wa;$.prototype.pa=function(a,b,c,d,e){this.lg||(this.lg=!0,this.i.beginInteraction(fe(),a,b));this.i.interact(e||fe(),a,b)};$.prototype.interaction=$.prototype.pa;$.prototype.endInteraction=function(){this.lg=!1;this.i.endInteraction(fe())};$.prototype.endInteraction=$.prototype.endInteraction;"+
"p=$.prototype;p.Uc=function(){};p.Tb=function(){this.i.resize(this.ja.width,this.ja.height)};p.c=function(){var a=this.i;a.removeEventListener(yg,this.R);a.removeEventListener(yg,this.Pa);a.shutdown();W.a.c.call(this)};p.R=function(){var a=this.i;this.bi||this.vb.Qd({position:a.getPosition(),pitch:a.getPitch(),yaw:a.getHeading(),fov:a.getZoom(),zoom:this.Zd})};p.Pa=function(a){a.isFinal&&this.dispatchEvent(this.b.Ef)};p.Ra=function(a,b){return this.i.pixelToGeo({x:a,y:b})};"+
"$.prototype.screenToGeo=$.prototype.Ra;$.prototype.Xa=function(a){return this.i.geoToPixel(a)};$.prototype.geoToScreen=$.prototype.Xa;$.prototype.Yb=function(a,b){var c=this.i.pixelToPov({x:a,y:b});this.Uf=c.distance;return{fov:this.i.getZoom(),position:c.position,pitch:c.pitch,yaw:c.heading}};$.prototype.screenToCameraData=$.prototype.Yb;"+
"$.prototype.Bc=function(a){a=a.requested.camera;var b=a.fov;this.Ki!==b&&(this.Uf=u);b&&(this.i.setZoom(kb(b,this.di,this.ci)),this.Ki=b);this.i.moveTo(zg(this,a))};function zg(a,b){return{position:b.position,pitch:b.pitch,heading:b.yaw,distance:a.Uf}}$.prototype.Ca=function(){var a=this.i.getPosition();return Bb(a,a)};$.prototype.getBBox=$.prototype.Ca;$.prototype.D=function(){return[]};$.prototype.getObjectsAt=$.prototype.D;$.prototype.ed=function(){return this.hc};$.prototype.getCapabilities=$.prototype.ed;"+
"$.prototype.setPointer=function(a,b){this.i.setPointer(a,b)};$.prototype.setPointer=$.prototype.setPointer;$.prototype.enter=function(){this.i.enter(0,ec)};$.prototype.enter=$.prototype.enter;$.prototype.Da=function(){return{zoom:this.hc.zoom.max,position:this.i.getPosition()}};$.prototype.getCamForBounds=$.prototype.Da;$.prototype.exit=function(a){var b=this.Yi;b.style.zIndex=1E3;this.bi=!0;this.i.exit(0,function(){Mf(b,function(){a();b.parentNode.removeChild(b)})})};$.prototype.exit=$.prototype.exit;"+
"$.prototype.getPanoramaId=function(){return this.i.getPanoramaId()};$.prototype.getPanoramaId=$.prototype.getPanoramaId;"+
"");//# sourceMappingURL=mapsjs-pano.map;// Source: ./source/javascripts/api/mapsjs-service.js
(function(ns){var H = ns;var e=this;
function h(a){var c=typeof a;if("object"==c)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return c;var b=Object.prototype.toString.call(a);if("[object Window]"==b)return"object";if("[object Array]"==b||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==b||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
c&&"undefined"==typeof a.call)return"object";return c}function k(a,c){var b=a.split("."),d=e;b[0]in d||!d.execScript||d.execScript("var "+b[0]);for(var f;b.length&&(f=b.shift());)b.length||void 0===c?d=d[f]?d[f]:d[f]={}:d[f]=c};function n(a,c,b,d,f,g,l,p){if(a&&c)this.G(a),this.B(c),this.n(b),this.X(f),this.W(g,l),this.U(p),this.Y(d);else throw Error('Parameters "scheme" and "host" must be specified');}k("H.service.Url",n);
function q(a){if("string"!==typeof a)throw Error('Parameter "urlString" must be a string.');var c=/(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(a);a=c[1];var b=c[2],d=c[3],f=c[4],g=c[5],l=c[6],p=c[7],c=c[8];!b&&f&&/@/.test(f)&&(f=f.split("@"),b=f[0],f=f[1]);for(var l=l&&0<l.length?l.substr(1):"",r={},m=/([?&]?([^=&+]+))(=([^&]+))?/g,z;z=m.exec(p);)r[decodeURIComponent(z[2])]=z[4]?decodeURIComponent(z[4]):void 0;return new n(a,f,l,r,g,b,d,c&&0<
c.length?c.substr(1):"")}n.parse=q;n.prototype.clone=function(){return new n(this.F,this.s,this.b,this.N(),this.w,this.C,this.v,this.q)};n.prototype.clone=n.prototype.clone;n.prototype.G=function(a){if(!a||"string"!==typeof a)throw Error('The "scheme" parameter must be a non-empty string.');this.F=a;return this};n.prototype.setScheme=n.prototype.G;n.prototype.va=function(){return this.F};n.prototype.getScheme=n.prototype.va;
n.prototype.B=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw Error('The "host" parameter is not a valid host name.');this.s=a;return this};n.prototype.setHost=n.prototype.B;n.prototype.la=function(){return this.s};n.prototype.getHost=n.prototype.la;n.prototype.n=function(a){this.b=a||void 0;return this};n.prototype.setPath=n.prototype.n;n.prototype.pa=function(){return this.b};n.prototype.getPath=n.prototype.pa;
n.prototype.Y=function(a){if(a)if("object"==typeof a)this.j=a;else throw Error('Parameter "params" must be an object.');else this.j={};return this};n.prototype.setQuery=n.prototype.Y;n.prototype.Q=function(){return!s(this)};n.prototype.hasQuery=n.prototype.Q;n.prototype.sa=function(){return this.j};n.prototype.getQuery=n.prototype.sa;n.prototype.X=function(a){if(a&&isNaN(parseInt(a,10)))throw Error('Parameter "port" must be a number or undefined');this.w=+a||void 0;return this};
n.prototype.setPort=n.prototype.X;n.prototype.ra=function(){return this.w};n.prototype.getPort=n.prototype.ra;n.prototype.W=function(a,c){if(a&&"string"!==typeof a)throw Error('Parameter "user" was specified but is not a string.');if(c&&"string"!==typeof c)throw Error('Parameter "password" was specified but is not a string.');if(!a&&c)throw Error('Parameter "user" must be defined when setting a password.');this.C=a;this.v=c;return this};n.prototype.setCredentials=n.prototype.W;n.prototype.xa=function(){return this.C};
n.prototype.getUser=n.prototype.xa;n.prototype.oa=function(){return this.v};n.prototype.getPassword=n.prototype.oa;n.prototype.U=function(a){this.q=a||void 0;return this};n.prototype.setAnchor=n.prototype.U;n.prototype.getAnchor=function(){return this.q};n.prototype.getAnchor=n.prototype.getAnchor;n.prototype.d=function(a){if("object"!==typeof a)throw Error('Parameter "other" must be an object.');var c=this.j,b;for(b in a)a.hasOwnProperty(b)&&"function"!==typeof a[b]&&(c[b]=a[b]);return this};
n.prototype.mergeQuery=n.prototype.d;n.prototype.h=function(a){if(!a||"string"!==typeof a)throw Error('Parameter "subDomain" must be a non-empty string');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.B(a+"."+this.s)};n.prototype.addSubDomain=n.prototype.h;n.prototype.e=function(a){if(!a||"string"!==typeof a)throw Error('Parameter "subPath" must be a non-empty string');return this.n((this.b?this.b+"/":"")+a)};n.prototype.addSubPath=n.prototype.e;
n.prototype.toString=function(){return[this.F+"://",this.C?encodeURIComponent(this.C)+(this.v?":"+encodeURIComponent(this.v):"")+"@":"",this.s,this.w?":"+this.w:"",this.b||!s(this)||this.q?"/":"",this.b?encodeURI(this.b):"",t(this),this.q?"#"+encodeURIComponent(this.q):""].join("")};n.prototype.toString=n.prototype.toString;n.prototype.N=function(){var a={},c;for(c in this.j)a[c]=this.j[c];return a};n.prototype.cloneQuery_=n.prototype.N;
function t(a){var c=[],b,d=a.j,f;for(b in d)d.hasOwnProperty(b)&&"function"!==typeof d[b]&&(f=a.j[b],c.push(encodeURIComponent(b)+(void 0===f?"":"="+encodeURIComponent(f))));return 0<c.length?"?"+c.join("&"):""}function s(a){var c,b=0;for(c in a.j)if(a.j.hasOwnProperty(c)&&"function"!==typeof a.j[c]&&(b++,0<b))break;return!b};function u(a){function c(b){d.removeChild(f);p=function(){};m&&clearTimeout(m);delete u.requests[g];b&&a.k&&a.k.call(r,b)}if(a.url&&a.i){if("string"!==typeof a.url&&!(a.url instanceof n))throw Error("Parmaters options.url must be string or H.service.Url");if("function"!==typeof a.i)throw Error("Parmaters options.callback must be a function");}else throw Error('Parameter "options" must specify at least a URL and a callback.');var b=a.Ea||document,d=b.getElementsByTagName("head")[0],f=b.createElement("script"),
b="string"===typeof a.url?q(a.url):a.url,g=u.Ba++,l=a.m||"callback",p=a.i,r={},m=null;r.id=g;r.cancel=function(){c("cancelled")};0!==a.timeout&&(m=setTimeout(function(){c("timeout")},a.timeout||3E4));u.requests[g]=function(a){var b=p;c();b.call(r,a)};f.type="text/javascript";f.src=b.toString()+(b.Q()?"&":"?")+l+"="+(a.S?"H.service.jsonp.requests["+g+"]":encodeURI("H.service.jsonp.requests["+g+"]"));d.appendChild(f);return r}k("H.service.jsonp",u);u.Ba=0;u.requests={};function v(a){a=w(x,a);this.V(a.baseUrl);this.H(a.useCIT);this.I(a.useHTTPS);y(this,a.app_id,a.app_code);this.Z={}}k("H.service.Platform",v);function y(a,c,b){a.M=c;a.L=b;a.g.d({app_id:c,app_code:b})}v.prototype.c=function(a){if(a.configure)return a.configure(this.M,this.L,this.aa,this.$,this.g);throw Error("Object is not configurable");};v.prototype.configure=v.prototype.c;v.prototype.I=function(a){this.aa=a;this.g.G(a?"https":"http")};v.prototype.setUseHTTPS=v.prototype.I;
v.prototype.H=function(a){this.$=a;this.g.B((a?"cit.":"")+this.Aa.s)};v.prototype.setUseCIT=v.prototype.H;v.prototype.V=function(a){this.Aa=a.clone();this.g=a.clone();this.H(this.$);this.I(this.aa);y(this,this.M,this.L);this.g.d({xnlp:"CL_JSMv3."+H.buildInfo().version})};v.prototype.setBaseUrl=v.prototype.V;v.prototype.ia=function(){return this.g};v.prototype.getBaseUrl=v.prototype.ia;
function w(a,c){var b={},d;for(d in a)!a.hasOwnProperty(d)||d in b||(b[d]=a[d]),c&&c.hasOwnProperty(d)&&(b[d]=c[d]);return b}var x={app_id:null,app_code:null,useHTTPS:!1,useCIT:!1,baseUrl:new n("http","api.here.com")};function A(a){a=w(x.routing,a);this.l=a.subDomain;this.b=a.path}k("H.service.RoutingService",A);A.prototype.c=function(a,c,b,d,f){this.f=(this.f||f).clone().h(this.l).n(this.b);return this};A.prototype.configure=A.prototype.c;A.prototype.D=function(a,c,b){a=this.f.clone().e("calculateroute.json").d(a);u({url:a,i:function(a){c(a)},k:function(a){b(Error("["+a+"] The routing request failed"))},m:"jsoncallback"})};A.prototype.calculateRoute=A.prototype.D;x.routing={subDomain:"route",path:"routing/7.2"};
v.prototype.ua=function(a){return this.c(new A(a))};v.prototype.getRoutingService=v.prototype.ua;function B(){this.l="places";this.b="places/v1"}k("H.service.PlacesService",B);B.prototype.c=function(a,c,b,d,f){f&&(this.f=f.clone().h(this.l).n(this.b));return this};B.prototype.configure=B.prototype.c;B.EntryPoint={SEARCH:"discover/search",SUGGEST:"suggest",EXPLORE:"discover/explore",AROUND:"discover/around",HERE:"discover/here",CATEGORIES:"categories/places"};
function C(a,c,b){if("function"!=h(c))throw Error("onResult callback needed");if("function"!=h(b))throw Error("onError callback needed");return u({url:a,i:function(a){c(a)},k:function(a){b(Error("["+a+"] The places request failed"))},m:"callback"})}B.prototype.p=function(a,c,b,d){c=c||{};a=this.f.clone().e(a).d(c);return C(a,b,d)};B.prototype.request=B.prototype.p;B.prototype.search=function(a,c,b){return this.p("discover/search",a,c,b)};B.prototype.search=B.prototype.search;
B.prototype.Da=function(a,c,b){return this.p("suggest",a,c,b)};B.prototype.suggest=B.prototype.Da;B.prototype.fa=function(a,c,b){return this.p("discover/explore",a,c,b)};B.prototype.explore=B.prototype.fa;B.prototype.ba=function(a,c,b){return this.p("discover/around",a,c,b)};B.prototype.around=B.prototype.ba;B.prototype.za=function(a,c,b){return this.p("discover/here",a,c,b)};B.prototype.here=B.prototype.za;B.prototype.da=function(a,c,b){return this.p("categories/places",a,c,b)};
B.prototype.categories=B.prototype.da;B.prototype.ga=function(a,c,b,d){a=q(a);d&&a.d(d);return C(a,c,b)};B.prototype.follow=B.prototype.ga;v.prototype.qa=function(){return this.c(new B)};v.prototype.getPlacesService=v.prototype.qa;function D(a){a=w(x.geocoding,a);this.l=a.subDomain;this.b=a.path}k("H.service.GeocodingService",D);D.prototype.c=function(a,c,b,d,f){f&&(this.f=f.clone().h(this.l).n(this.b));return this};D.prototype.configure=D.prototype.c;D.prototype.ha=function(a,c,b){a=this.f.clone().e("geocode.json").d(a);u({url:a,i:function(a){c(a)},k:function(a){b(Error("["+a+"] The geocoding request failed"))},m:"jsoncallback"})};D.prototype.geocode=D.prototype.ha;
D.prototype.Ca=function(a,c,b){a=this.f.clone().h("reverse").e("reversegeocode.json").d(a);u({url:a,i:function(a){c(a)},k:function(a){b(Error("["+a+"] The reverse geocoding request failed"))},m:"jsoncallback"})};D.prototype.reverseGeocode=D.prototype.Ca;D.prototype.search=function(a,c,b){a=this.f.clone().e("search.json").d(a);u({url:a,i:function(a){c(a)},k:function(a){b(Error("["+a+"] The search request failed"))},m:"jsoncallback"})};D.prototype.search=D.prototype.search;
x.geocoding={subDomain:"geocoder",path:"6.2"};v.prototype.ka=function(a){return this.c(new D(a))};v.prototype.getGeocodingService=v.prototype.ka;function E(a){var c=0,b,d,f=a.length;if(0===f)return c;for(b=0;b<f;b++)d=a.charCodeAt(b),c=(c<<5)-c+d,c|=0;return c};function F(){this.K={}}function G(a){var c,b=a.boxes,d,f;this.alt=a.alt;this.label=a.label;this.min=a.minLevel;this.max=a.maxLevel;this.A=[];if(b&&(c=b.length))for(d=b[0],f=new H.geo.Rect(d[0],d[1],d[2],d[3]),this.A.push(f),this.u=new H.geo.Rect(d[0],d[1],d[2],d[3]),a=1;a<c;a++)d=b[a],f=new H.geo.Rect(d[0],d[1],d[2],d[3]),this.A.push(f),this.u.mergeRect(f,!1,this.u)}
G.prototype.intersects=function(a,c){var b;if(a>=this.min&&a<=this.max)if((b=this.A.length)&&this.u){if(this.u.intersects(c))for(;b--;)if(this.A[b].intersects(c))return!0}else return!0;return!1};function I(a,c,b,d,f,g){var l=this;g=g?g:{};var p=a.f.clone().e(c+"/"+a.o+"/"+b).d(g);H.map.provider.ImageTileProvider.call(this,{tileSize:d,max:512==d?19:20,min:512==d?2:0,getURL:function(a,b,c){var g=l.tileBaseUrl_.clone();g.h(""+((c+b+a)%4+1));g.e(c+"/"+a+"/"+b+"/"+d+"/"+f);return g.toString()}});this.service_=a;this.tileBaseUrl_=p;this.tileType_=c;this.scheme_=b;this.params_=g;this.copyrightKey_=b.split(".")[0];this.updateAndReload_=H.lang.bind(this.updateAndReload_,this);a.addEventListener("versionupdate",
this.updateAndReload_)}H.lang.inherits(I,H.map.provider.ImageTileProvider);I.prototype.getCopyrights=function(a,c){var b=this.service_.getCopyrights().K[this.copyrightKey_],d,f=b?b.length:0,g=[];for(d=0;d<f;d++)b[d].intersects(c,a)&&g.push(b[d]);return g};I.prototype.updateAndReload_=function(){var a=this.service_;this.tileBaseUrl_=a.f.clone().e(this.tileType_+"/"+a.o+"/"+this.scheme_).d(this.params_);this.reload(!1)};function J(a){a=w(x.maptile,a);H.util.EventTarget.call(this);this.J=a.type;this.b=a.path;this.l=a.subDomain;this.o=a.version;this.O=new F;this.T={};this.t=0}H.lang.inherits(J,H.util.EventTarget);k("H.service.MapTileService",J);function K(a,c){for(var b={},d=a[c+"s"][c],f=d.length;f--;)b[d[f].id]=d[f];a[c+"s"]=b}J.prototype.c=function(a,c,b,d,f){f&&(this.f=f.clone().h(this.J+"."+this.l).n(this.b));"newest"===this.o&&L(this);return this};J.prototype.configure=J.prototype.c;J.prototype.wa=function(){return this.J};
J.prototype.getType=J.prototype.wa;J.prototype.ya=function(){return this.o};J.prototype.getVersion=J.prototype.ya;J.prototype.getCopyrights=function(){this.t||this.R&&M(this);return this.O};J.prototype.getCopyrights=J.prototype.getCopyrights;
function L(a){var c=a.f.clone().h("1").e("info").d({output:"json"});u({url:c,m:"callback_func",i:function(b){b=JSON.parse(b.replace(/,\s?\]/g,"]")).response;var c;K(b,"map");K(b,"scheme");K(b,"tiletype");K(b,"format");K(b,"resolution");K(b,"language");if("newest"===a.o&&"traffic"!==a.J)for(c in b.maps)b.maps[c].hash&&b.maps[c].newest&&(a.o=b.maps[c].hash,a.dispatchEvent({type:"versionupdate"}));a.R=b;a.dispatchEvent("infoupdate")},k:function(a){throw Error("["+a+"]: Could not fetch meta-info from map tile service @"+
c.toString());},S:!0})}function M(a){var c=a.f.clone().h("1").e("copyright").e(a.o).d({output:"json"});a.t=1;u({url:c,m:"callback_func",i:function(b){this.t=2;b=JSON.parse(b);var c=a.O,f;for(f in b)if(b.hasOwnProperty(f))for(var g=b[f],l=c.K[f]||(c.K[f]=[]),p=void 0,r=g.length,p=0;p<r;p++)l.push(new G(g[p]));a.dispatchEvent("copyrightupdate")},k:function(a){this.t=-1;throw Error("["+a+"]: Could not fetch copyrights from map tile service @"+c.toString());},S:!0})}J.prototype.ma=function(){return this.R};
J.prototype.getInfo=J.prototype.ma;J.prototype.P=function(a,c,b,d,f){var g;g=E(this.f.clone().e(a+"/"+this.o+"/"+c+"/"+b+"/"+d).d(f?f:{}).toString());var l=this.T[g];l||(l=new I(this,a,c,b,d,f),this.T[g]=l);return l};J.prototype.createTileProvider=J.prototype.P;J.prototype.a=function(a,c,b,d,f,g,l){a=this.P(a,c,b,d,f);return new H.map.layer.TileLayer(a,{opacity:g,dark:!!l})};J.prototype.createTileLayer=J.prototype.a;x.maptile={type:"base",version:"newest",subDomain:"maps",path:"maptile/2.1"};
v.prototype.r=function(a){var c;c=w(x.maptile,a);c=E(c.type+c.path+c.subDomain+c.version);var b=this.Z[c];b||(b=this.c(new J(a)),this.Z[c]=b);return b};v.prototype.getMapTileService=v.prototype.r;
v.prototype.ea=function(a,c,b,d,f){var g=this.r(),l=this.r({type:"aerial"}),p=this.r({type:"traffic"}),r=this.r({type:"pano"}),m={};a=a||256;c&&(m.ppi=c);b&&(m.lg=b);d&&(m.lg2=d);f&&(m.style=f);return{normal:{xbase:g.a("xbasetile","normal.day",a,"png8",m,1,!1),base:g.a("basetile","normal.day",a,"png8",m,1,!1),map:g.a("maptile","normal.day",a,"png8",m,1,!1),traffic:p.a("traffictile","normal.day",a,"png8",m,1,!1),transit:g.a("maptile","normal.day.transit",a,"png8",m,1,!1),panorama:r.a("rctile","normal.day",
a,"png8",m,1,!1),labels:g.a("labeltile","normal.day",a,"png",m,1,!1)},satellite:{xbase:l.a("xbasetile","hybrid.day",a,"jpg",m,1,!0),base:l.a("basetile","hybrid.day",a,"jpg",m,1,!0),map:l.a("maptile","hybrid.day",a,"jpg",m,1,!0),traffic:p.a("traffictile","hybrid.day",a,"jpg",m,1,!0),panorama:r.a("rctile","hybrid.day",a,"jpg",m,1,!0),labels:l.a("labeltile","hybrid.day",a,"png",m,1,!0)},terrain:{xbase:l.a("xbasetile","terrain.day",a,"jpg",m,1,!1),base:l.a("basetile","terrain.day",a,"jpg",m,1,!1),map:l.a("maptile",
"terrain.day",a,"jpg",m,1,!1),traffic:p.a("traffictile","terrain.day",a,"jpg",m,1,!1),panorama:r.a("rctile","terrain.day",a,"jpg",m,1,!1),labels:l.a("labeltile","terrain.day",a,"png",m,1,!1)}}};v.prototype.createDefaultLayers=v.prototype.ea;function N(a){a=w(x.enterpriseRouting,a);this.l=a.subDomain;this.b=a.path;this.g=a.baseUrl}k("H.service.EnterpriseRoutingService",N);N.prototype.c=function(a,c,b,d,f){this.g=(this.g||f).clone();d&&this.g.h("st");this.g.h(this.l).n(this.b);return this};N.prototype.configure=N.prototype.c;N.prototype.D=function(a,c,b){O(this,a,"calculateroute",c,b)};N.prototype.calculateRoute=N.prototype.D;N.prototype.ta=function(a,c,b){O(this,a,"getroute",c,b)};N.prototype.getRoute=N.prototype.ta;
N.prototype.na=function(a,c,b){O(this,a,"getlinkinfo",c,b)};N.prototype.getLinkInfo=N.prototype.na;N.prototype.ca=function(a,c,b){O(this,a,"calculateisoline",c,b)};N.prototype.calculateIsoline=N.prototype.ca;function O(a,c,b,d,f){a=a.g.clone().e(b+".json").d(c);u({url:a,i:function(a){d(a)},k:function(a){f(Error("["+a+"] "+b+" request failed"))},m:"jsoncallback"})}x.enterpriseRouting={subDomain:"route",path:"routing/6.2",baseUrl:new n("http","nlp.nokia.com")};v.prototype.ja=function(a){return this.c(new N(a))};
v.prototype.getEnterpriseRoutingService=v.prototype.ja;var H=H||{};k("H.service.buildInfo",function(){return H.util.BuildInfo.get("mapsjs-service","0.3.0","463bd5ea063635dd34a6db35fc31cd20fb5ebda1")});
}(H));//# sourceMappingURL=mapsjs-service.map;// Source: ./source/javascripts/api/mapsjs-ui.js
(function(ns){var H = ns;var f,aa=this;function g(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b};function h(a){this.$a=a?a:this.Ta()}h.prototype.Ta=function(){var a=Function("return this;")(),b=a.navigator,c=[];b&&(b.msPointerEnabled?c.push(ba):b.Jb&&c.push(da));1>c.length&&("TouchEvent"in a&&c.push(ea),c.push(fa));return c};g("H.ui.util.Events.prototype.detectEventSets",h.prototype.Ta);h.prototype.addEventListener=function(a,b,c,d){for(var e=this.$a,p,t=e.length;t--;)(p=e[t][b])&&a.addEventListener(p,c,d||!1)};
h.prototype.removeEventListener=function(a,b,c,d){for(var e=this.$a,p,t=e.length;t--;)(p=e[t][b])&&a.removeEventListener(p,c,d||!1)};
var da={start:"pointerenter",end:"pointerenter",move:"pointermove",cancel:"pointercancel",over:"pointerover",out:"pointerout",hover:"pointerhover"},ba={start:"MSPointerDown",end:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel",over:"MSPointerOver",out:"MSPointerOut",hover:"MSPointerHover"},ea={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},fa={start:"mousedown",end:"mouseup",move:"mousemove",over:"pointerenter",out:"mouseout",hover:"mousehover"};function k(a,b,c,d){a=a.createElement(b);c&&(a.className=c);d&&(a.innerHTML=d);return a}function l(a,b){for(var c=1,d=arguments.length;c<d;c++)a.appendChild(arguments[c])}var m=new h;function n(a,b,c){m.addEventListener(a,b,c,void 0)};function q(a,b){H.util.EventTarget.call(this);this.Ib=a||"div";this.w=b?b.split(" "):[];this.h(!1);this.setData(null);this.el=null}H.lang.inherits(q,H.util.EventTarget);g("H.ui.base.Element",q);q.prototype.render=function(a){if(!a)throw Error("Wrong document object");this.el=k(a,this.Ib,this.w.join(" "));this.d(this.el,a);this.h(this.s,!0);r(this,this.Hb);this.setVisibility(this.Oa);return this.getElement()};q.prototype.d=function(){};q.prototype.qb=function(){return this.s};
q.prototype.isDisabled=q.prototype.qb;q.prototype.h=function(a,b){if(a!==this.s||b)(this.s=a)?this.e("H_disabled"):this.j("H_disabled");return this};q.prototype.setDisabled=q.prototype.h;q.prototype.getData=function(){return this.hb};q.prototype.getData=q.prototype.getData;q.prototype.setData=function(a){this.hb=a};q.prototype.setData=q.prototype.setData;function r(a,b){a.Hb=b;a.getElement()&&(b?a.getElement().setAttribute("title",b):a.getElement().removeAttribute("title"))}
q.prototype.getElement=function(){return this.el};q.prototype.getElement=q.prototype.getElement;q.prototype.Oa=!0;q.prototype.setVisibility=function(a){var b;this.Oa=a;if(b=this.el)b.style.display=a?"":"none"};q.prototype.setVisibility=q.prototype.setVisibility;q.prototype.getVisibility=function(){return this.Oa};q.prototype.getVisibility=q.prototype.getVisibility;q.prototype.e=function(a){var b=this.getElement();0>this.w.indexOf(a)&&this.w.push(a);b&&(b.className=this.w.join(" "));return this};
q.prototype.addClass=q.prototype.e;q.prototype.j=function(a){a=this.w.indexOf(a);var b=this.getElement();-1<a&&this.w.splice(a,1);b&&(b.className=this.w.join(" "));return this};q.prototype.removeClass=q.prototype.j;q.prototype.remove=function(){var a=this.getElement();a&&a.parentNode&&a.parentNode.removeChild(a)};function s(a,b,c){q.call(this,a,b);this.G=c?[].concat(c):[]}H.lang.inherits(s,q);g("H.ui.base.Container",s);s.prototype.c=function(a){var b=this.getElement();this.G.push(a);b&&(a.render(b.ownerDocument),b.appendChild(a.getElement()));return this};s.prototype.addChild=s.prototype.c;s.prototype.Ua=function(){return[].concat(this.G)};s.prototype.getChildren=s.prototype.Ua;s.prototype.removeChild=function(a){var b=this.G.indexOf(a),c=this.getElement();0<=b&&(this.G.splice(b,1),c&&c.removeChild(a.getElement()))};
s.prototype.removeChild=s.prototype.removeChild;s.prototype.d=function(a,b){for(var c=0,d=this.G.length;c<d;c++)a.appendChild(this.G[c].render(b))};function u(){this.g=v.CLOSED;s.call(this,"div","H_overlay")}H.lang.inherits(u,s);g("H.ui.base.OverlayPanel",u);u.prototype.a=function(a,b){if(a!==this.g||b)this.g=a,a===v.OPEN?this.e("H_open"):this.j("H_open");return this};u.prototype.setState=u.prototype.a;u.prototype.getState=function(){return this.g};u.prototype.getState=u.prototype.getState;
u.prototype.Xa=function(a){var b=a.F;a=a.getElement();var c=this.getElement(),d=c.style,e;this.j("H_top");this.j("H_middle");this.j("H_bottom");this.j("H_left");this.j("H_center");this.j("H_right");d.bottom=d.top=d.left=d.right=d.margin="";/top/g.test(b)?(this.e("H_top"),d.top="0",d.margin="0 1.2em",e=-1):/bottom/g.test(b)?(this.e("H_bottom"),d.bottom="0",d.margin="0 1.2em",e=1):(this.e("H_middle"),d.top="50%",d.margin="0 1.2em",d.marginTop=-Math.round(0.5*c.offsetHeight)+"px",e=0);/left/g.test(b)?
(this.e("H_left"),d.left=a.offsetWidth+"px",d.marginLeft="1.2em"):/right/g.test(b)?(this.e("H_right"),d.right=a.offsetWidth+"px",d.marginRight="1.2em"):(this.e("H_center"),d.left="50%",0>e?(d.top=a.offsetHeight+"px",d.marginTop="1.2em"):0<e&&(d.bottom=a.offsetHeight+"px",d.marginBottom="1.2em"),d.marginLeft=-Math.round(0.5*c.offsetWidth)+"px",a.appendChild(c))};u.prototype.pointToControl=u.prototype.Xa;var v={OPEN:"open",CLOSED:"closed"};u.State=v;function w(a){a=a||{};s.call(this,"div","H_rdo");this.Na=new q("div","H_rdo_title");this.X=new s("div","H_rdo_buttons");this.c(this.Na);this.c(this.X);this.rb=H.lang.bind(function(a){a.target.getState()===x.DOWN?(this.K(a.target,!0),this.dispatchEvent("activebuttonchange")):a.target.a(x.DOWN,!0)},this);this.addEventListener("statechange",this.rb);this.La(a.title||"");a.onActiveButtonChange&&this.addEventListener("activebuttonchange",a.onActiveButtonChange);a.buttonsOptions&&a.buttonsOptions.forEach(function(a){this.ta(new y(a))},
this)}H.lang.inherits(w,s);g("H.ui.base.RadioGroup",w);w.prototype.d=function(a,b){s.prototype.d.call(this,a,b);this.La(this.pa,!0)};w.prototype.La=function(a,b){if(a!==this.pa||b)this.pa=a,this.Na.getElement()&&(this.Na.getElement().innerHTML=this.pa);return this};w.prototype.setTitle=w.prototype.La;w.prototype.ob=function(){return this.pa};w.prototype.getTitle=w.prototype.ob;
w.prototype.ta=function(a){if(!(a instanceof y))throw Error("PushButton expected");a.setParentEventTarget(this);this.X.c(a);return this};w.prototype.addButton=w.prototype.ta;w.prototype.Ab=function(a){this.X.removeChild(a);a.setParentEventTarget(null);return this};w.prototype.removeButton=w.prototype.Ab;w.prototype.$=function(){return this.X.Ua()};w.prototype.getButtons=w.prototype.$;w.prototype.K=function(a,b){for(var c=this.$(),d=c.length;d--;)c[d].a(c[d]===a?x.DOWN:x.UP,b)};
w.prototype.setActiveButton=w.prototype.K;function z(a){a=a||{};q.call(this,"div","H_btn");this.L(a.label||" ");r(this,a.tooltip||"");this.setData(a.data);this.h(!!a.disabled);this.a(x.UP,!0);a.onStateChange&&this.addEventListener("statechange",a.onStateChange);this.Ca=H.lang.bind(this.Ca,this);this.ma=H.lang.bind(this.ma,this)}H.lang.inherits(z,q);g("H.ui.base.Button",z);z.prototype.d=function(a){n(a,"start",this.Ca);n(a,"end",this.ma);n(a,"out",this.ma);this.L(this.aa,!0)};z.prototype.getState=function(){return this.g};
z.prototype.getState=z.prototype.getState;z.prototype.a=function(a,b){a!==this.g&&(this.g=a,a===x.DOWN?this.e("H_active"):this.j("H_active"),b||this.dispatchEvent("statechange"));return this};z.prototype.setState=z.prototype.a;z.prototype.nb=function(){return this.aa};z.prototype.getLabel=z.prototype.nb;z.prototype.L=function(a,b){if(b||a!==this.aa)this.aa=a,this.getElement()&&(this.getElement().innerHTML=a);return this};z.prototype.setLabel=z.prototype.L;
z.prototype.Ca=function(a){this.s||this.a(x.DOWN);a.preventDefault()};z.prototype.ma=function(a){this.s||this.a(x.UP);a.preventDefault()};var x={UP:"up",DOWN:"down"};z.State=x;function y(a){z.call(this,a);this.tb=function(a){a.preventDefault()};this.Ea=H.lang.bind(function(a){this.s||this.cb();a.preventDefault()},this)}H.lang.inherits(y,z);g("H.ui.base.PushButton",y);y.prototype.d=function(a){n(a,"start",this.Ea);n(a,"end",this.tb);this.L(this.aa,!0)};y.prototype.cb=function(){var a=x.DOWN;this.a(this.getState()===a?x.UP:a);return this};y.prototype.toggleState=y.prototype.cb;var ga={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",LEFT_TOP:"left-top",LEFT_MIDDLE:"left-middle",LEFT_BOTTOM:"left-bottom",RIGHT_TOP:"right-top",RIGHT_MIDDLE:"right-middle",RIGHT_BOTTOM:"right-bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"};var ha=["O","Ms","ms","Moz","Webkit"];var A=new function(){this.ya={};this.Ja="";this.Ma=document.createElement("span").style};function B(a,b,c){var d=A.ya.transform;if(!d)if("transform"in A.Ma)d=A.ya.transform="transform";else{var d=ha.length,e="",p="",t=!1;A.Ja&&(p=A.Ja+"Transform",t=p in A.Ma);for(;d--&&!t;)e=ha[d],p=e+"Transform",t=p in A.Ma;t&&(A.Ja=e);if(d=t?p:null)A.ya.transform=d;else throw Error("Could not find any variant of CSS property [transform]");}a.style[d]="translate("+b+"px,"+c+"px)"};function C(){s.call(this,"div","H_pano_mm");this.n=new q("div","H_pano_circle H_noevs");this.Q=new q("div","H_pano_man H_noevs");this.c(this.n);this.c(this.Q)}H.lang.inherits(C,s);C.prototype.d=function(a,b){s.prototype.d.call(this,a,b);B(this.Q.el,-1E3,-1E3);B(this.n.el,-1E3,-1E3);this.n.el.innerHTML='<svg class="H_icon H_noevs" viewBox="0 0 120 60"><ellipse cx="60" cy="30" rx="40" ry="20" stroke-width="3" /></svg>';D(this,!1)};
function D(a,b,c,d){a.Q.el.innerHTML=b?'<svg class="H_icon H_noevs" viewBox="0 0 120 192"><path d="m5,83c8,-15 16,-18 23,-20c6,-2 16,-1 17,-1c0,0 11,0 15,0c5,0 6,0 11,0c7,0 20,-6 27,-18c3,-6 4,-9 6,-12c2,-3 7,-5 11,-3c4,2 4,8 3,11c-1,4 -6,15 -9,20c-19,30 -37,32 -38,32l0,94c0,3 -3,7 -8,7c-4,0 -9,-3 -9,-7l-3,-53c0,0 -3,0 -4,0l-3,53c0,3 -3,7 -9,7c-4,0 -9,-3 -9,-7l0,-88c0,0 -9,0 -9,29c0,3 -1,10 -9,10c-7,0 -10,-7 -10,-11c0,-14 0,-31 6,-41l0,0l1,-2z" stroke-width="10"/><circle r="25" cy="25" cx="49" stroke-width="10"/></svg>':'<svg class="H_icon H_noevs" viewBox="0 0 120 192"><path d="m96,85c-6,-13 -17,-18 -23,-21c-6,-2 -12,-2 -12,-2c0,0 -22,0 -22,0c0,0 -6,0 -12,2c-6,2 -16,8 -23,21c-4,9 -4,27 -4,38c0,6 5,9 9,9c3,0 8,-3 8,-9c0,-28 9,-27 9,-27l0,88c0,4 3,7 8,7c4,0 9,-1 9,-7l4,-52c0,0 2,0 3,0l4,52c0,5 4,7 9,7c4,0 8,-3 8,-7l0,-88c0,0 9,0 9,27c0,5 5,9 8,9c3,0 9,-2 9,-9c0,-11 3,-28 -1,-38l0,0m-22,-60c0,14 -11,25 -25,25c-14,0 -25,-11 -25,-25c0,-14 11,-25 25,-25c14,0 25,11 25,25z" stroke-width="10"/></svg>';
b&&B(a.n.el,c||0,d||0);a.h(!b)};function G(a){this.t=a;this.map=a.I();this.C=this.B=Number.MAX_VALUE;this.J=H.lang.bind(this.J,this);this.ja=H.lang.bind(this.ja,this);this.Da=H.lang.bind(this.Da,this);this.ga=H.lang.bind(this.ga,this);this.fa=H.lang.bind(this.fa,this);this.ea=H.lang.bind(this.ea,this);this.ha=H.lang.bind(this.ha,this);this.ia=H.lang.bind(this.ia,this);this.f=new C;this.f.render(a.getElement().ownerDocument);this.A=H.lang.bind(this.A,this);n(this.f.n.el,"start",this.A);this.ca=this.ba=Number.MAX_VALUE;this.ka=H.lang.bind(this.ka,
this);this.la=H.lang.bind(this.la,this);this.b=new I(this.map.getCenter());this.b.e("H_ib_noclose H_pano_ib");this.va=!1;this.q=0}H.lang.inherits(G,H.util.EventTarget);f=G.prototype;
f.enable=function(){var a=this.map;this.va||(this.t.getElement().insertBefore(this.f.el,this.t.getElement().firstChild),this.t.sa(this.b),this.b.close(),n(this.b.el,"start",this.A),a.addEventListener("pointermove",this.J),a.addEventListener("drag",this.J),a.addEventListener("tap",this.la),a.addEventListener("mapviewchange",this.ga),a.addEventListener("mapviewchangestart",this.fa),a.addEventListener("mapviewchangeend",this.ea),a.addEventListener("pointerleave",this.ia),a.addEventListener("pointerenter",
this.ha),this.va=!0)};f.ia=function(a){"mouse"===a.currentPointer.type&&(this.f.remove(),this.t.Ka(this.b))};f.ha=function(a){"mouse"===a.currentPointer.type&&(this.t.getElement().insertBefore(this.f.el,this.t.getElement().firstChild),this.t.sa(this.b),n(this.b.el,"start",this.A),this.b.close())};f.A=function(){ia(this,this.B,this.C)};f.Gb=25;
f.disable=function(){var a=this.b.el,b=this.map;this.f.remove();this.t.Ka(this.b);a&&m.removeEventListener(a,"start",this.A,void 0);m.removeEventListener(this.f.n.el,"start",this.A,void 0);b.removeEventListener("pointermove",this.J);b.removeEventListener("drag",this.J);b.removeEventListener("tap",this.la);b.removeEventListener("mapviewchange",this.ga);b.removeEventListener("mapviewchangestart",this.fa);b.removeEventListener("mapviewchangeend",this.ea);b.removeEventListener("pointerleave",this.ia);
b.removeEventListener("pointerenter",this.ha);this.va=!1};function ia(a,b,c){a.ba=b;a.ca=c;H.map.render.panorama.RenderEngine.getClosestPanoramas(a.map.screenToGeo(a.ba,a.ca),a.ka)}
f.J=function(a){var b=a.currentPointer;if(this.map.getEngine().type===H.Map.EngineType.P2D&&"touch"!==b.type&&(a=b.viewportX,b=b.viewportY,this.B!==a||this.C!==b)){this.f.Q.el.style.display="block";this.ab&&clearTimeout(this.ab);this.Ya&&this.Ya.cancel();this.Aa=null;this.B=a;this.C=b;a=this.f;var b=this.B,c=this.C;B(a.Q.el,b,c);B(a.n.el,b,c);this.ab=setTimeout(this.ja,350);D(this.f,!1);this.b.close()}};
f.ja=function(){H.map.render.panorama.RenderEngine.getClosestPanoramas(this.map.screenToGeo(this.B,this.C),this.Da)};f.Da=function(a){var b=this,c;a&&0<a.length?(c=this.map.geoToScreen(a[0].position),this.Aa=a[0].position,D(this.f,!0,c.x,c.y),this.Ya=H.net.images.load(H.map.render.panorama.RenderEngine.getImageUrl(a[0]),function(c){b.b.setPosition(a[0].position);b.b.T('<img src="'+c.src+'" />');b.b.open()})):this.q&&this.ka(a)};f.fa=function(){this.f.n.e("H_pano_notransition");this.b.close()};
f.ea=function(){this.f.n.j("H_pano_notransition")};f.ga=function(){if(this.Aa){var a=this.map.geoToScreen(this.Aa);a&&D(this.f,!0,a.x,a.y)}this.q=0};f.la=function(a){var b=a.currentPointer;a="mouse"===b.type;var c=b.viewportX,b=b.viewportY,d=this.Gb,e=Math.abs;1===this.q&&e(this.B-c)<d&&e(this.C-b)<d?this.q++:0===this.q&&this.q++;1!==this.q||a||(this.b.close(),this.B=c,this.C=b,this.ba=c,this.ca=b,this.ja());if(2===this.q||a)ia(this,c,b),this.q=0};
f.ka=function(a){a&&0<a.length?this.dispatchEvent({type:"enter",position:a[0].position}):(a=this.map.screenToGeo(this.ba,this.ca),this.b.setPosition(a),this.b.T("Can't show you street level here"),this.b.open())};function J(){s.call(this,"div","H_ctl");this.map=null;this.F="top-left"}H.lang.inherits(J,s);g("H.ui.Control",J);J.prototype.el=null;J.prototype.U=function(a){this.map=a};J.prototype.render=function(a){return s.prototype.render.call(this,a)};J.prototype.d=function(a,b){s.prototype.d.call(this,a,b);this.p(this.F)};J.prototype.Ha=function(){};J.prototype.onUnitSystemChange=J.prototype.Ha;J.prototype.o=function(){};J.prototype.onMapEngineTypeChange=J.prototype.o;J.prototype.I=function(){return this.map};
J.prototype.getMap=J.prototype.I;J.prototype.kb=function(){return this.F};J.prototype.getAlignment=J.prototype.kb;J.prototype.p=function(a){"string"===typeof a&&ga[a.replace("-","_").toUpperCase()]===a&&(this.F=a,this.dispatchEvent("alignmentchange"));return this};J.prototype.setAlignment=J.prototype.p;function K(a){var b=this.V,c=this,d;(this.Fb=H.util.getSuperProto(K)).constructor.call(this);this.h(!0);a&&(ja(this,a.mapTypes),(d=a.alignment)&&this.p(d));this.Sa=new y({onStateChange:function(){var a=c.V;c.a("down"===this.getState()?a.gb:a.P)}});this.Va=a=new z({onStateChange:function(){c.map.setEngineType(H.Map.EngineType.P2D);c.a(c.Ia)}});a.L(b.panorama.label);r(a,b.panorama.qa);this.c(this.Sa);this.c(this.Va);this.g=this.Ia=b.P}H.lang.inherits(K,J);g("H.ui.Pano",K);
function ja(a,b){var c,d,e,p;if(b){a.m=b;a.jb=c=[];e=["normal","satellite","terrain"];for(p=0;p<e.length;p++)b[d=e[p]]&&c.unshift(b[d]);for(d in b)0>e.indexOf(d)&&c.unshift(b[d]);a.h(!c.length)}}
K.prototype.V={P:{label:'<svg class="H_icon" viewBox="75 67 180 200"><path d="m214,153c-6,-13 -17,-18 -23,-21c-6,-2 -12,-2 -12,-2c0,0 -22,0 -22,0c0,0 -6,0 -12,2c-6,2 -16,8 -23,21c-4,9 -4,27 -4,38c0,6 5,9 9,9c3,0 8,-3 8,-9c0,-28 9,-27 9,-27l0,88c0,4 3,7 8,7c4,0 9,-1 9,-7l4,-52c0,0 2,0 3,0l4,52c0,5 4,7 9,7c4,0 8,-3 8,-7l0,-88c0,0 9,0 9,27c0,5 5,9 8,9c3,0 9,-2 9,-9c0,-11 3,-28 -1,-38l0,0z"/><circle cx="167" cy="93" r="25"/></svg>',qa:"Show street level areas"},gb:{label:'<svg class="H_icon" viewBox="73 72 178 205"><path d="m120,158c8,-15 16,-18 23,-20c6,-2 16,-1 17,-1c0,0 11,0 15,0c5,0 6,0 11,0c7,0 20,-6 27,-18c3,-6 4,-9 6,-12c2,-3 7,-5 11,-3c4,2 4,8 3,11c-1,4 -6,15 -9,20c-19,30 -37,32 -38,32l0,94c0,3 -3,7 -8,7c-4,0 -9,-3 -9,-7l-3,-53c0,0 -3,0 -4,0l-3,53c0,3 -3,7 -9,7c-4,0 -9,-3 -9,-7l0,-88c0,0 -9,0 -9,29c0,3 -1,10 -9,10c-7,0 -10,-7 -10,-11c0,-14 0,-31 6,-41l0,0l1,-2z"/><circle cx="166" cy="99" r="25"/></svg>',
qa:"Hide street level areas"},panorama:{label:'<span style="padding: 0 0.5em">Leave street level<span>',qa:"Leave street level"}};K.prototype.d=function(a,b){this.Fb.d.apply(this,arguments);this.a(this.V.P);this.H=new G(this.getParentEventTarget());var c=this;this.H.addEventListener("enter",function(a){c.H.disable();c.map.setCenter(a.position,!0);setTimeout(function(){c.map.setEngineType(H.Map.EngineType.PANORAMA)},200)})};
K.prototype.a=function(a){var b=this.g,c=this.V,d=a===c.panorama,e=this.Sa,p;b===c.P&&(this.zb=this.map.getBaseLayer());if(d)this.Ia=b;else{if(a===c.P)b="UP",p=this.zb,this.H&&this.H.disable();else{var b="DOWN",c=this.map.getBaseLayer(),t,E,F,V;if(V=c){t=this.m;var ca;a:for(E in t)for(E in F=t[E],F)if(F[E]===c){ca=!0;break a}V=t=ca?F:void 0}V&&(p=t.panorama);if(!p)for(E=this.jb,F=E.length;F--&&!(p=E[F].panorama););this.H&&this.H.enable()}p&&this.map.setBaseLayer(p);e.L(a.label);r(e,a.qa);e.a(x[b])}this.Va.setVisibility(d);
e.setVisibility(!d);this.g=a};K.prototype.o=function(a){var b=this.V;this.a(a===H.Map.EngineType.PANORAMA?b.panorama:this.Ia)};K.prototype.onMapEngineTypeChange=K.prototype.o;function L(a){a=a||{};J.call(this);this.Fa=H.lang.bind(this.Fa,this);this.Ga=H.lang.bind(this.Ga,this);this.R=H.lang.bind(this.R,this);this.da=H.lang.bind(this.da,this);this.ua=H.lang.bind(this.ua,this);this.D=new u;this.m=new w({title:"choose view",onActiveButtonChange:this.R});this.l=new y({label:"Show public transport",onStateChange:this.Ga});this.k=new y({label:"Show traffic flow",onStateChange:this.Fa});this.Wa=new y({label:'<svg version="1.1" class="H_icon" viewBox="0 0 26 26"><path d="M24,7.75c0,.55-.45,1-1,1H3c-.55,0-1-.45-1-1v-1.5c0-.55,.45-1,1-1h20c.55,0,1,.45,1,1V7.75z"/><path d="M24,13.75c0,.55-.45,1-1,1H3c-.55,0-1-.45-1-1v-1.5c0-.55,.45-1,1-1h20c.55,0,1,.45,1,1V13.75z"/><path d="M24,19.75c0,.55-.45,1-1,1H3c-.55,0-1-.45-1-1v-1.5c0-.55,.45-1,1-1h20c.55,0,1,.45,1,1V19.75z"/></svg>',
tooltip:"Show map settings",onStateChange:H.lang.bind(function(a){a.target.getState()===x.DOWN?(this.D.a(v.OPEN),this.D.Xa(this)):this.D.a(v.CLOSED)},this)});this.D.c(this.m);this.D.c(this.k);this.D.c(this.l);this.c(this.Wa);this.c(this.D);a.entries&&a.entries.forEach(function(a){this.m.ta(new y({label:a.name,data:a.mapType}))},this);this.p(a.alignment||"bottom-right")}H.lang.inherits(L,J);g("H.ui.MapSettingsControl",L);f=L.prototype;
f.d=function(a,b){J.prototype.d.call(this,a,b);this.I().addEventListener("baselayerchange",this.da);this.I().addEventListener("tap",this.ua);this.da()};
f.R=function(){var a;a:{a=this.m.$();for(var b=a.length;b--;)if(a[b].getState()===x.DOWN){a=a[b];break a}a=null}(a=a?a.getData():null)?(b=a.map,this.l.h(!a.transit),a.transit&&(this.l.s||this.l.getState()!==x.DOWN||(b=a.transit)),this.k.h(!a.traffic),a.traffic&&(this.k.s||this.k.getState()!==x.DOWN||(b=a.traffic)),b&&this.map&&this.map.setBaseLayer(b)):(this.l.h(!0),this.k.h(!0))};f.Fa=function(){this.k.getState()===x.DOWN&&this.l.a(x.UP,!0);this.R()};
f.Ga=function(){this.l.getState()===x.DOWN&&this.k.a(x.UP,!0);this.R()};f.da=function(a){var b=null,c=a?a.newValue:this.map.getBaseLayer();this.m.$().forEach(function(a){var e=a.getData();e.map===c?(this.m.K(a,!0),this.l.a(x.UP,!0),this.k.a(x.UP,!0),b=e):e.transit&&e.transit===c?(this.m.K(a,!0),this.l.a(x.DOWN,!0),this.k.a(x.UP,!0),b=e):e.traffic&&e.traffic===c&&(this.m.K(a,!0),this.l.a(x.UP,!0),this.k.a(x.DOWN,!0),b=e)},this);b?(this.l.h(!b.transit),this.k.h(!b.traffic)):this.m.K(null,!0)};
f.o=function(a){a=a!==H.Map.EngineType.P2D;this.getElement().style.display=a?"none":""};L.prototype.onMapEngineTypeChange=L.prototype.o;L.prototype.ua=function(){this.Wa.a(x.UP)};function M(a,b){var c={},d={};c["top-left"]=k(b,"div",[N,O].join(" "));c["top-center"]=k(b,"div",[N,P,ka,O].join(" "));c["top-right"]=k(b,"div",[N,O].join(" "));c["left-top"]=k(b,"div",[N,Q].join(" "));c["left-middle"]=k(b,"div",[N,R,la,Q].join(" "));c["left-bottom"]=k(b,"div",[N,Q].join(" "));c["right-top"]=k(b,"div",[N,Q].join(" "));c["right-middle"]=k(b,"div",[N,S,la,Q].join(" "));c["right-bottom"]=k(b,"div",[N,Q].join(" "));c["bottom-left"]=k(b,"div",[N,O].join(" "));c["bottom-center"]=k(b,"div",
[N,T,ka,O].join(" "));c["bottom-right"]=k(b,"div",[N,O].join(" "));d["top-left"]=k(b,"div",[P,R].join(" "));d["top-right"]=k(b,"div",[P,S].join(" "));d["bottom-left"]=k(b,"div",[T,R].join(" "));d["bottom-right"]=k(b,"div",[T,S].join(" "));l(d["top-left"],c["top-left"],c["left-top"]);l(d["top-right"],c["top-right"],c["right-top"]);l(d["bottom-left"],c["left-bottom"],c["bottom-left"]);l(d["bottom-right"],c["right-bottom"],c["bottom-right"]);l(a,d["top-left"],d["top-right"],d["bottom-left"],d["bottom-right"],
c["top-center"],c["left-middle"],c["right-middle"],c["bottom-center"]);this.Qa=c}var P="H_l_top",T="H_l_bottom",R="H_l_left",S="H_l_right",ka="H_l_center",la="H_l_middle",O="H_l_horizontal",Q="H_l_vertical",N="H_l_anchor";M.prototype.update=function(){var a=this.Qa;U(a["top-center"],!0);U(a["bottom-center"],!0);U(a["left-middle"],!1);U(a["right-middle"],!1)};
function U(a,b){var c;b?(c=a.offsetWidth,a.style.marginLeft=-Math.round(0.5*c)+"px"):(c=a.offsetHeight,a.style.marginTop=-Math.round(0.5*c)+"px")}M.prototype.put=function(a,b){var c=a?a.getElement():null,d=b?this.Qa[b]:null;c&&d&&(c.parentElement&&c.parentElement.removeChild(c),d.appendChild(c));this.update()};var W={IMPERIAL:"imperial",METRIC:"metric"};g("H.ui.UnitSystem",W);function X(a,b){var c=a.getElement(),d=this;H.util.EventTarget.call(this);this.i=a;this.Z=c.ownerDocument;this.N={};this.v=[];this.O=k(this.Z,"div","H_ui");this.sb=H.lang.bind(function(a){this.Ba.put(a.target,a.target.F)},this);this.addEventListener("alignmentchange",this.sb);this.vb=H.lang.bind(function(){this.eb()},this);this.addEventListener("toggleunitsystem",this.vb);this.ub=H.lang.bind(function(){var a=this.i.getEngine().type;if(a!==this.wa){var a=this.wa=a,b=this.N,c;for(c in b)if(b[c]instanceof
J)b[c].onMapEngineTypeChange(a);this.Ba.update()}},this);this.i.addEventListener("enginechange",this.ub);this.preventDefaultListener=H.lang.bind(function(a){a.preventDefault()},this);this.O.addEventListener("contextmenu",this.preventDefaultListener,!1);this.O.addEventListener("MSHoldVisual",this.preventDefaultListener,!1);this.Ba=new M(this.O,this.Z);this.u=W.METRIC;this.wa=this.i.getEngine().type;b&&ma(this,b);c.appendChild(this.O);setTimeout(function(){d.Ba.update()},1)}H.lang.inherits(X,H.util.EventTarget);
g("H.ui.UI",X);X.prototype.getElement=function(){return this.O};X.prototype.getElement=X.prototype.getElement;X.prototype.I=function(){return this.i};X.prototype.getMap=X.prototype.I;X.prototype.oa=function(a){var b=this.N,c;if(a!==this.u)for(c in this.u=a,b)if(b[c]instanceof J)b[c].onUnitSystemChange(this.u)};X.prototype.setUnitSystem=X.prototype.oa;X.prototype.eb=function(){this.u===W.METRIC?this.oa(W.IMPERIAL):this.oa(W.METRIC)};X.prototype.toggleUnitSystem=X.prototype.eb;
X.prototype.sa=function(a){var b=this.v.length,c=this.getElement(),d;0<=this.v.indexOf(a)||(a.setParentEventTarget(this),a.U(this.i),d=a.render(this.Z),b=0<b?this.v[b-1].el.nextSibling:this.getElement().firstChild,c.insertBefore(d,b),this.v.push(a))};X.prototype.addBubble=X.prototype.sa;X.prototype.Ka=function(a){var b=this.v.indexOf(a);-1<b&&(a.setParentEventTarget(null),a.U(null),this.v.splice(b,1),this.getElement().removeChild(a.getElement()))};X.prototype.removeBubble=X.prototype.Ka;
X.prototype.lb=function(){return this.v};X.prototype.getBubbles=X.prototype.lb;X.prototype.M=function(a,b){if(this.xa(a))throw Error("A control with name ["+a+"] is already registered.");b.setParentEventTarget(this);b.U(this.i);b.render(this.Z);b.onUnitSystemChange(this.u);b.onMapEngineTypeChange(this.i.getEngine().type);this.N[a]=b};X.prototype.addControl=X.prototype.M;
X.prototype.Bb=function(a){var b=this.xa(a);if(b)b.setParentEventTarget(null),b.U(null),b.remove(),delete this.N[a];else throw Error("Control ["+a+"] not found in this UI's controls.");return b};X.prototype.removeControl=X.prototype.Bb;X.prototype.xa=function(a){return this.N[a]};X.prototype.getControl=X.prototype.xa;
function ma(a,b){var c;b.unitSystem&&a.oa(b.unitSystem);(c=b.zoom)&&a.M("zoom",new Y("object"===typeof c?c:null));(c=b.scalebar)&&a.M("scalebar",new Z("object"===typeof c?c:null));(c=b.mapsettings)&&a.M("mapsettings",new L("object"===typeof c?c:null));(c=b.panorama)&&a.M("panorama",new K("object"===typeof c?c:null))}
X.createDefault=function(a,b){var c=[];b.normal&&c.push({name:"Map view",mapType:b.normal});b.satellite&&c.push({name:"Satellite",mapType:b.satellite});b.terrain&&c.push({name:"Terrain",mapType:b.terrain});if(!c.length)throw Error("The mapTypes parameter does not contain any known map types.");return new X(a,{unitSystem:W.METRIC,zoom:{alignment:"right-middle"},mapsettings:{alignment:"bottom-right",entries:c},scalebar:{alignment:"bottom-right"},panorama:{alignment:"top-right",mapTypes:b}})};var na={"in":'<svg class="H_icon" viewBox="0 0 25 25"><path d="M 18.5,11 H 14 V 6.5 c 0,-.8 -.7,-1.5 -1.5,-1.5 -.8,0 -1.5,.7 -1.5,1.5 V 11 H 6.5 C 5.7,11 5,11.7 5,12.5 5,13.3 5.7,14 6.5,14 H 11 v 4.5 c 0,.8 .7,1.5 1.5,1.5 .8,0 1.5,-.7 1.5,-1.5 V 14 h 4.5 C 19.3,14 20,13.3 20,12.5 20,11.7 19.3,11 18.5,11 z" /></svg>',xb:'<svg class="H_icon" viewBox="0 0 25 25"><path d="m 6.5,11 h 12 c .8,0 1.5,.7 1.5,1.5 0,.8 -.7,1.5 -1.5,1.5 H 6.5 C 5.7,14 5,13.3 5,12.5 5,11.7 5.67,11 6.5,11 z" /></svg>'};function Y(a){a=a||{};J.call(this);this.na=H.lang.bind(this.na,this);this.ra=new z({label:na["in"],tooltip:"Zoom in",onStateChange:this.na});this.Pa=new z({label:na.xb,tooltip:"Zoom out",onStateChange:this.na});this.c(this.ra);this.c(this.Pa);this.e("H_zoom");this.e("H_grp");this.Za(a.zoomSpeed||0.05);this.p(a.alignment||"right-middle")}H.lang.inherits(Y,J);g("H.ui.ZoomControl",Y);
Y.prototype.na=function(a){a=a.target;var b=a===this.ra?1:-1,c=0<b?Math.ceil:Math.floor,d=this.map;d&&("down"===a.getState()?(d.getViewModel().startControl(),d.getViewModel().control(0,0,b*this.fb,0,0,0)):(d.getViewModel().endControl(!0),d.setZoom(c(d.getZoom()),!0)))};Y.prototype.p=function(a){J.prototype.p.call(this,a);a=this.F;var b;/^top/g.test(a)||/^bottom/g.test(a)?(a=this.Pa,b=this.ra):(a=this.ra,b=this.Pa);this.removeChild(a);this.removeChild(b);this.c(a);this.c(b);return this};
Y.prototype.setAlignment=Y.prototype.p;Y.prototype.o=function(a){a=a!==H.Map.EngineType.P2D;this.getElement().style.display=a?"none":""};Y.prototype.onMapEngineTypeChange=Y.prototype.o;Y.prototype.pb=function(){return this.fb};Y.prototype.getZoomSpeed=Y.prototype.pb;Y.prototype.Za=function(a){this.fb=a};Y.prototype.setZoomSpeed=Y.prototype.Za;function I(a,b){var c=b||{};q.call(this,"div","H_ib");this.wb=H.lang.bind(function(a){this.close();a.preventDefault()},this);this.update=H.lang.bind(this.update,this);this.setPosition(a);this.g=$.CLOSED;this.T(c.content);c.onStateChange&&this.addEventListener("statechange",c.onStateChange)}H.lang.inherits(I,q);g("H.ui.InfoBubble",I);I.prototype.i=null;I.prototype.setPosition=function(a){this.yb=H.geo.Point.fromIPoint(a);this.update()};I.prototype.setPosition=I.prototype.setPosition;
I.prototype.U=function(a){this.i=a};I.prototype.render=function(a){q.prototype.render.call(this,a);this.update();return this.getElement()};
I.prototype.d=function(a,b){this.W=k(b,"div","H_ib_body");this.bb=k(b,"div","H_ib_tail",oa);this.Ra=k(b,"div","H_ib_close",pa);this.r=k(b,"div","H_ib_content","&nbsp;");this.W.appendChild(this.Ra);this.W.appendChild(this.r);n(this.Ra,"end",this.wb);this.i.getViewModel().addEventListener("sync",this.update);a.appendChild(this.W);a.appendChild(this.bb);this.T(this.Y);this.a($.OPEN)};
I.prototype.update=function(){var a=this.el,b=this.i,c,d,e;b&&this.getState()==$.OPEN&&(d=(c=b.geoToScreen(this.yb))&&c.x,e=c&&c.y,c=b.getViewPort().width,b.getViewPort(),b.getEngine().type!==H.Map.EngineType.P2D?a.style.display="none":d<-c||d>2*c||e<-c||e>2*c?a.style.display="none":(a.style.display="",B(a,d,e),a=this.r.offsetWidth,d-=a,40>d&&(d=Math.max(0,Math.min((a||this.r.offsetWidth)-this.bb.offsetWidth,-d)),this.W.style.right=d?-d+"px":"0")))};I.prototype.update=I.prototype.update;
I.prototype.getState=function(){return this.g};I.prototype.getState=I.prototype.getState;I.prototype.a=function(a){a!==this.g&&(this.g=a,this.dispatchEvent("statechange"));this.getElement()&&(this.g===$.OPEN?(this.getElement().style.display="block",this.update()):this.getElement().style.display="none")};I.prototype.setState=I.prototype.a;I.prototype.mb=function(){return this.r};I.prototype.getContentElement=I.prototype.mb;
I.prototype.T=function(a){if(a)if("string"===typeof a||"number"===typeof a.nodeType&&"string"===typeof a.nodeName)this.Y=a;else throw Error("InfoBubble content must be a string or HTML node.");else this.Y=void 0;this.getElement()&&(this.Y?(this.r.innerHTML="","string"===typeof this.Y?this.r.innerHTML=a:"number"===typeof a.nodeType&&"string"===typeof a.nodeName&&this.r.appendChild(a)):this.r.innerHTML="&nbsp;",this.update())};I.prototype.setContent=I.prototype.T;I.prototype.close=function(){this.a($.CLOSED)};
I.prototype.close=I.prototype.close;I.prototype.open=function(){this.a($.OPEN)};I.prototype.open=I.prototype.open;
var oa='<svg viewBox="0 0 25 25"><g><path d="M 11.3,0.23 5.08,12.1 C 2.28,12.2 0,13.2 0,14.5 0,15.9 2.28,17 5.08,17 c 2.8,0 5.12,-1.1 5.12,-2.5 0,-0.6 -0.62,-1.2 -1.52,-1.7 L 20.9,1.13 21,0.23 l -9.7,0 z" style="fill:#0d2e41;fill-opacity:0.3" /><path d="M 19.9,0.266 4.88,14.8 12.5,0.266 z" /></g></svg>',pa='<svg version="1.1" class="H_icon" viewBox="0 0 12 22"><path d="M 9.01,17 6.04,14 3,17 0.03,14.1 3,11 0.096,8.17 3.07,5.15 6.04,8.07 8.95,5.15 11.9,8.17 9.01,11 12,14.1 9.01,17" /></svg>',$={OPEN:"open",
CLOSED:"closed",DISPOSED:"disposed"};I.State=$;function Z(a){a=a||{};J.call(this);this.e("H_scalebar");this.p(a.alignment||"bottom-right");r(this,"Tap to change unit systems");this.maxWidth=150;this.update=H.lang.bind(this.update,this);this.S=this.za=null}H.lang.inherits(Z,J);g("H.ui.ScaleBar",Z);
Z.prototype.d=function(a,b){J.prototype.d.call(this,a,b);this.map.addEventListener("mapviewchangeend",this.update);this.za=k(b,"div","H_scalebar_label");this.S=k(b,"div","H_scalebar_scale");this.Db=k(b,"div","H_scalebar_left");this.Eb=k(b,"div","H_scalebar_right");this.Cb=k(b,"div","H_scalebar_bottom");this.S.appendChild(this.Db);this.S.appendChild(this.Eb);this.S.appendChild(this.Cb);a.appendChild(this.za);a.appendChild(this.S);this.u=W.METRIC;this.ib=H.lang.bind(function(a){this.dispatchEvent("toggleunitsystem");
a.preventDefault()},this);this.Ea=H.lang.bind(function(a){a.preventDefault()},this);n(a,"start",this.Ea);n(a,"end",this.ib);this.update()};Z.prototype.Ha=function(a){this.u=a;this.update()};Z.prototype.onUnitSystemChange=Z.prototype.Ha;Z.prototype.o=function(a){a=a!==H.Map.EngineType.P2D;this.getElement().style.display=a?"none":""};Z.prototype.onMapEngineTypeChange=Z.prototype.o;
Z.prototype.update=function(){if(!this.map||this.map.getEngine().type===H.Map.EngineType.P2D){var a,b=0,c=this.map,d,e;c&&(a=Math.round(0.5*c.getViewPort().width),d=Math.round(0.5*c.getViewPort().height),e=c.screenToGeo(a,d))&&(b=H.geo.Point.fromIPoint(e),c=H.geo.Point.fromIPoint(c.screenToGeo(a+1,d)),b=100*b.distance(c));a=b;c=0.8*this.maxWidth;this.u===W.IMPERIAL?a<qa?(b=a/ra,d="ft"):(b=a/qa,d="mi"):1E3>a?(b=a,d="m"):(b=a/1E3,d="km");a=Math.pow(10,Math.floor(Math.log(b)/Math.LN10));b=a/b*100;b<
c/5?(a*=5,b*=5):b<c/2?(a*=2,b*=2):b>c&&(a/=2,b/=2);this.el&&(this.za.innerHTML=a+d,this.getElement().style.width=Math.round(b)+"px")}};Z.prototype.update=Z.prototype.update;var qa=1609.344,ra=0.3048006;var H=H||{};g("H.ui.buildInfo",function(){return H.util.BuildInfo.get("mapsjs-ui","0.3.0","ebe5cbed2b94bc135c18574138ae3f3df2ca3c61")});
}(H));//# sourceMappingURL=mapsjs-ui.map